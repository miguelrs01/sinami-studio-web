var CI=Object.defineProperty;var NI=(n,e,t)=>e in n?CI(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var De=(n,e,t)=>NI(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var be=function(n,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(g){try{m(r.next(g))}catch(_){c(_)}}function h(g){try{m(r.throw(g))}catch(_){c(_)}}function m(g){g.done?l(g.value):a(g.value).then(d,h)}m((r=r.apply(n,e||[])).next())})},H;(function(n){(function(r){r[r.SETUP=6777001]="SETUP",r[r.LOAD=6777002]="LOAD",r[r.PURCHASE=6777003]="PURCHASE",r[r.LOAD_RECEIPTS=6777004]="LOAD_RECEIPTS",r[r.CLIENT_INVALID=6777005]="CLIENT_INVALID",r[r.PAYMENT_CANCELLED=6777006]="PAYMENT_CANCELLED",r[r.PAYMENT_INVALID=6777007]="PAYMENT_INVALID",r[r.PAYMENT_NOT_ALLOWED=6777008]="PAYMENT_NOT_ALLOWED",r[r.UNKNOWN=6777010]="UNKNOWN",r[r.REFRESH_RECEIPTS=6777011]="REFRESH_RECEIPTS",r[r.INVALID_PRODUCT_ID=6777012]="INVALID_PRODUCT_ID",r[r.FINISH=6777013]="FINISH",r[r.COMMUNICATION=6777014]="COMMUNICATION",r[r.SUBSCRIPTIONS_NOT_AVAILABLE=6777015]="SUBSCRIPTIONS_NOT_AVAILABLE",r[r.MISSING_TOKEN=6777016]="MISSING_TOKEN",r[r.VERIFICATION_FAILED=6777017]="VERIFICATION_FAILED",r[r.BAD_RESPONSE=6777018]="BAD_RESPONSE",r[r.REFRESH=6777019]="REFRESH",r[r.PAYMENT_EXPIRED=6777020]="PAYMENT_EXPIRED",r[r.DOWNLOAD=6777021]="DOWNLOAD",r[r.SUBSCRIPTION_UPDATE_NOT_AVAILABLE=6777022]="SUBSCRIPTION_UPDATE_NOT_AVAILABLE",r[r.PRODUCT_NOT_AVAILABLE=6777023]="PRODUCT_NOT_AVAILABLE",r[r.CLOUD_SERVICE_PERMISSION_DENIED=6777024]="CLOUD_SERVICE_PERMISSION_DENIED",r[r.CLOUD_SERVICE_NETWORK_CONNECTION_FAILED=6777025]="CLOUD_SERVICE_NETWORK_CONNECTION_FAILED",r[r.CLOUD_SERVICE_REVOKED=6777026]="CLOUD_SERVICE_REVOKED",r[r.PRIVACY_ACKNOWLEDGEMENT_REQUIRED=6777027]="PRIVACY_ACKNOWLEDGEMENT_REQUIRED",r[r.UNAUTHORIZED_REQUEST_DATA=6777028]="UNAUTHORIZED_REQUEST_DATA",r[r.INVALID_OFFER_IDENTIFIER=6777029]="INVALID_OFFER_IDENTIFIER",r[r.INVALID_OFFER_PRICE=6777030]="INVALID_OFFER_PRICE",r[r.INVALID_SIGNATURE=6777031]="INVALID_SIGNATURE",r[r.MISSING_OFFER_PARAMS=6777032]="MISSING_OFFER_PARAMS",r[r.VALIDATOR_SUBSCRIPTION_EXPIRED=6778003]="VALIDATOR_SUBSCRIPTION_EXPIRED"})(n.ErrorCode||(n.ErrorCode={}));function t(r,a,l,c){return{isError:!0,code:r,message:a,platform:l,productId:c}}n.storeError=t})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.config=r,r.url||(r.url="https://validator.iaptic.com"),this.store=a??n.store,this.log=this.store.log.child("Iaptic")}get braintreeClientTokenProvider(){return r=>{this.log.info("Calling Braintree clientTokenProvider"),n.Utils.ajax(this.log,{url:`${this.config.url}/v3/braintree/client-token?appName=${this.config.appName}&apiKey=${this.config.apiKey}`,method:"POST",data:{applicationUsername:n.store.getApplicationUsername(),customerId:n.Braintree.customerId},success:a=>{this.log.info("clientTokenProvider success: "+JSON.stringify(a)),r(a.clientToken)},error:a=>{this.log.info("clientTokenProvider error: "+JSON.stringify(a)),r(n.storeError(a,"ERROR "+a,n.Platform.BRAINTREE,null))}})}}get appStoreDiscountEligibilityDeterminer(){let r;this.log.debug("AppStore eligibility determiner is listening..."),this.store.when().verified(c=>{c.platform===n.Platform.APPLE_APPSTORE&&(this.log.debug("Got a verified AppStore receipt."),r=c)},"appStoreDiscountEligibilityDeterminer_listening");const a=(c,d,h)=>{if(this.log.debug("AppStore eligibility determiner"),r)return this.log.debug("Using cached receipt"),h(l(r,d));const m=g=>{g.platform===n.Platform.APPLE_APPSTORE&&(this.log.debug("Receipt is verified, let's analyze the content and respond."),this.store.off(m),h(l(g,d)))};this.log.debug("Waiting for receipt"),this.store.when().verified(m,"appStoreDiscountEligibilityDeterminer_waiting")};return a.cacheReceipt=function(c){r=c},a;function l(c,d){const h=c.raw.ineligible_for_intro_price;return d.map(m=>{var g;return m.discountType==="Introductory"&&h&&h.find(_=>m.productId===_)?!1:m.discountType==="Subscription"?!!((g=c.raw.collection)===null||g===void 0?void 0:g.find(v=>v.id===m.productId)):!0})}}get validator(){return`${this.config.url}/v1/validate?appName=${this.config.appName}&apiKey=${this.config.apiKey}`}}n.Iaptic=e})(H||(H={}));var H;(function(n){let e;(function(c){c[c.QUIET=0]="QUIET",c[c.ERROR=1]="ERROR",c[c.WARNING=2]="WARNING",c[c.INFO=3]="INFO",c[c.DEBUG=4]="DEBUG"})(e=n.LogLevel||(n.LogLevel={}));class t{constructor(d,h=""){this.prefix="",this.store=d,this.prefix=h||"CdvPurchase"}child(d){return new t(this.store,this.prefix+"."+d)}error(d){l(this.store.verbosity,e.ERROR,this.prefix,d);try{throw new Error(a(d))}catch(h){l(this.store.verbosity,e.ERROR,this.prefix,h.stack)}}warn(d){l(this.store.verbosity,e.WARNING,this.prefix,d)}info(d){l(this.store.verbosity,e.INFO,this.prefix,d)}debug(d){l(this.store.verbosity,e.DEBUG,this.prefix,d)}logCallbackException(d,h){if(this.warn("A callback in '"+d+"' failed with an exception."),typeof h=="string")this.warn("           "+h);else if(h){const m=h;m.fileName&&this.warn("           "+m.fileName+":"+m.lineNumber),h.message&&this.warn("           "+h.message),h.stack&&this.warn("           "+h.stack)}}}t.console=window.console,n.Logger=t;const r=["QUIET","ERROR","WARNING","INFO","DEBUG"];function a(c){return typeof c!="string"&&(c=JSON.stringify(c)),c}function l(c,d,h,m){var g=c===!0?1:c;if(d>g)return;typeof m!="string"&&(m=JSON.stringify(m));const _=h?`[${h}] `:"",v=d===e.ERROR?(T=>t.console.error(T)):d===e.WARNING?(T=>t.console.warn(T)):(T=>t.console.log(T));r[d]?v(`${_}${r[d]}: ${m}`):v(`${_}${m}`)}})(H||(H={}));var H;(function(n){(function(e){e.nonEnumerable=(t,r,a)=>{if(a)return a.enumerable=!1,a;Object.defineProperty(t,r,{set(l){Object.defineProperty(this,r,{value:l,writable:!0,configurable:!0})},configurable:!0})}})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.className="Product",this.title="",this.description="",this.platform=r.platform,this.type=r.type,this.id=r.id,this.group=r.group,this.offers=[],Object.defineProperty(this,"pricing",{enumerable:!1,get:()=>{var l;return(l=this.offers[0])===null||l===void 0?void 0:l.pricingPhases[0]}}),Object.defineProperty(this,"canPurchase",{enumerable:!1,get:()=>a.canPurchase(this)}),Object.defineProperty(this,"owned",{enumerable:!1,get:()=>a.owned(this)})}get pricing(){var r;return(r=this.offers[0])===null||r===void 0?void 0:r.pricingPhases[0]}get canPurchase(){return!1}get owned(){return!1}getOffer(r=""){return r?this.offers.find(a=>a.id===r):this.offers[0]}addOffer(r){return this.getOffer(r.id)?this:(this.offers.push(r),this)}}n.Product=e})(H||(H={}));var H;(function(n){(function(e){function t(r){const a=[];for(let l in r)r.hasOwnProperty(l)&&a.push(r[l]);return a}e.objectValues=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(r){switch(r){case n.Platform.APPLE_APPSTORE:return"App Store";case n.Platform.GOOGLE_PLAY:return"Google Play";case n.Platform.WINDOWS_STORE:return"Windows Store";case n.Platform.BRAINTREE:return"Braintree";case n.Platform.TEST:return"Test";default:return r}}e.platformName=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.array=[]}get length(){return this.array.length}get(){return this.array.concat()}add(c){this.has(c)||this.array.push(c)}clear(){for(;this.array.length!==0;)this.array.pop()}has(c){return!!this.array.find(d=>d===c)}}e.ReceiptsToValidate=t;class r{constructor(c,d){this.receiptsToValidate=new t,this.verifiedReceipts=[],this.numRequests=0,this.numResponses=0,this.cache={},this.controller=c,this.log=d.child("Validator")}incrRequestsCounter(){this.numRequests=this.numRequests+1|0,this.log.debug(`Validation requests=${this.numRequests} responses=${this.numResponses}`)}incrResponsesCounter(){this.numResponses=this.numResponses+1|0,this.log.debug(`Validation requests=${this.numRequests} responses=${this.numResponses}`)}addVerifiedReceipt(c,d){for(const m of this.verifiedReceipts)if(m.platform===c.platform&&m.id===d.id)return this.log.debug("Updating existing receipt."),m.set(c,d),m;this.log.debug("Register a new verified receipt.");const h=new n.VerifiedReceipt(c,d,this.controller);return this.verifiedReceipts.push(h),h}add(c){this.log.debug("Schedule validation: "+JSON.stringify(c));const d=c instanceof n.Transaction?c.parentReceipt:c;this.receiptsToValidate.has(d)||(this.incrRequestsCounter(),this.receiptsToValidate.add(d))}run(){const c=this.receiptsToValidate.get();this.receiptsToValidate.clear();const d=h=>be(this,void 0,void 0,function*(){var m;const{receipt:g,payload:_}=h;this.incrResponsesCounter();try{const v=this.controller.adapters.find(g.platform);if(yield v==null?void 0:v.handleReceiptValidationResponse(g,_),_.ok){const T=this.addVerifiedReceipt(g,_.data);this.controller.verifiedCallbacks.trigger(T,"payload_ok")}else if(_.code===n.ErrorCode.VALIDATOR_SUBSCRIPTION_EXPIRED){const T=(m=g.lastTransaction())===null||m===void 0?void 0:m.transactionId,I=T?this.verifiedReceipts.find(A=>{var C;return((C=A.collection[0])===null||C===void 0?void 0:C.transactionId)===T}):void 0;I?(I==null||I.collection.forEach(A=>{A.transactionId===T&&(A.isExpired=!0)}),this.controller.verifiedCallbacks.trigger(I,"payload_expired")):this.controller.unverifiedCallbacks.trigger({receipt:g,payload:_},"no_verified_receipt")}else this.controller.unverifiedCallbacks.trigger({receipt:g,payload:_},"validator_error")}catch(v){this.log.error("Exception probably caused by an invalid response from the validator."+v.message),this.controller.unverifiedCallbacks.trigger({receipt:g,payload:{ok:!1,code:n.ErrorCode.VERIFICATION_FAILED,message:v.message}},"validator_exception")}});c.forEach(h=>this.runOnReceipt(h,d))}runOnReceipt(c,d){var h,m;return be(this,void 0,void 0,function*(){if(c.platform===n.Platform.TEST)return this.log.debug("Using Test Adapter mock verify function."),n.Test.Adapter.verify(c,d);if(!this.controller.validator){this.incrResponsesCounter(),d({receipt:c,payload:{ok:!0,data:{id:((m=(h=c.transactions)===null||h===void 0?void 0:h[0])===null||m===void 0?void 0:m.transactionId)||"unknown",latest_receipt:!0,transaction:{type:"test"}}}});return}const g=yield this.buildRequestBody(c);if(!g){this.incrResponsesCounter();return}if(typeof this.controller.validator=="function")return this.runValidatorFunction(this.controller.validator,c,g,d);const _=typeof this.controller.validator=="string"?{url:this.controller.validator,timeout:2e4}:this.controller.validator;return this.runValidatorRequest(_,c,g,d)})}runValidatorFunction(c,d,h,m){try{c(h,g=>m({receipt:d,payload:g}))}catch(g){this.log.warn("user provided validator function failed with error: "+(g==null?void 0:g.stack))}}buildRequestBody(c){var d,h,m;return be(this,void 0,void 0,function*(){const g=this.controller.adapters.find(c.platform),_=yield g==null?void 0:g.receiptValidationBody(c);if(_){if(_.additionalData=Object.assign(Object.assign({},(d=_.additionalData)!==null&&d!==void 0?d:{}),{applicationUsername:this.controller.getApplicationUsername()}),_.additionalData.applicationUsername||delete _.additionalData.applicationUsername,_.device=Object.assign(Object.assign({},(h=_.device)!==null&&h!==void 0?h:{}),n.Validator.Internal.getDeviceInfo(this.controller)),((m=_.offers)===null||m===void 0?void 0:m.length)===1){const v=_.offers[0];if(v.pricingPhases.length===1){const T=v.pricingPhases[0];_.currency=T.currency,_.priceMicros=T.priceMicros}else if(v.pricingPhases.length===2){const T=v.pricingPhases[1];_.currency=T.currency,_.priceMicros=T.priceMicros;const I=v.pricingPhases[0];_.introPriceMicros=I.priceMicros}}return _}})}removeExpiredCache(){const c=+new Date,d=[];for(const h in this.cache)this.cache[h].expires<c&&d.push(h);for(const h of d)delete this.cache[h]}runValidatorRequest(c,d,h,m){this.removeExpiredCache();const g=n.Utils.md5(JSON.stringify(h.transaction)),_=this.cache[g];if(_)return this.log.debug("validator cache hit, using cached response"),m({receipt:d,payload:_.payload});n.Utils.ajax(this.log.child("Ajax"),{url:c.url,method:"POST",customHeaders:c.headers,timeout:c.timeout,data:h,success:v=>{var T;if(this.log.debug("validator success, response: "+JSON.stringify(v)),!a(v))return m({receipt:d,payload:{ok:!1,code:n.ErrorCode.BAD_RESPONSE,message:"Validator responded with invalid data",data:{latest_receipt:(T=v==null?void 0:v.data)===null||T===void 0?void 0:T.latest_receipt}}});this.cache[g]={payload:v,expires:+new Date+12e4},m({receipt:d,payload:v})},error:(v,T,I)=>{var A="Error "+v+": "+T;this.log.debug("validator failed, response: "+JSON.stringify(A)),this.log.debug("body => "+JSON.stringify(I)),m({receipt:d,payload:{ok:!1,message:A,code:n.ErrorCode.COMMUNICATION,status:v,data:{}}})}})}}e.Validator=r;function a(l){return!!l&&typeof l=="object"&&"ok"in l&&typeof l.ok=="boolean"}})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.list=[]}add(a,l,c){l.forEach(d=>{if(a.info(""),!this.find(d.platform))switch(d.platform){case n.Platform.APPLE_APPSTORE:return this.list.push(new n.AppleAppStore.Adapter(c,d.options||{}));case n.Platform.GOOGLE_PLAY:return this.list.push(new n.GooglePlay.Adapter(c));case n.Platform.BRAINTREE:return d.options||a.error("Options missing for Braintree initialization. Use {platform: Platform.BRAINTREE, options: {...}} in your call to store.initialize"),this.list.push(new n.Braintree.Adapter(c,d.options));case n.Platform.TEST:return this.list.push(new n.Test.Adapter(c));default:return}})}initialize(a,l){return be(this,void 0,void 0,function*(){typeof a=="string"&&(a=[a]);const c=a.map(g=>typeof g=="string"?{platform:g}:g).filter(g=>!this.find(g.platform)),d=l.log.child("Adapters");d.info("Adding platforms: "+JSON.stringify(c)),this.add(d,c,l);const h=l.registeredProducts.byPlatform();return(yield Promise.all(c.map(g=>be(this,void 0,void 0,function*(){var _,v,T;const I=(T=(v=(_=h.filter(z=>z.platform===g.platform))===null||_===void 0?void 0:_[0])===null||v===void 0?void 0:v.products)!==null&&T!==void 0?T:[],A=this.find(g.platform);if(!A)return;if(d.info(`${A.name} initializing...`),!A.isSupported){d.info(`${A.name} is not supported.`);return}const C=yield A.initialize();if(A.ready=!0,d.info(`${A.name} initialized. ${C?JSON.stringify(C):""}`),C!=null&&C.code)return C;if(d.info(`${A.name} products: ${JSON.stringify(I)}`),I.length===0)return;let L=[],x=[];A.supportsParallelLoading?[L,x]=yield Promise.all([A.loadProducts(I),A.loadReceipts()]):(L=yield A.loadProducts(I),x=yield A.loadReceipts()),d.info(`${A.name} products loaded: ${JSON.stringify(L)}`);const U=L.filter(z=>z instanceof n.Product);return l.listener.productsUpdated(g.platform,U),d.info(`${A.name} receipts loaded: ${JSON.stringify(x)}`),L.filter(z=>"code"in z&&"message"in z)[0]})))).filter(g=>g)})}find(a){return this.list.filter(l=>l.id===a)[0]}findReady(a){return this.list.filter(l=>(!a||l.id===a)&&l.ready)[0]}}e.Adapters=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a,l){this.supportedPlatforms=[],this.platformWithReceiptsReady=[],this.lastTransactionState={},this.lastCallTimeForState={},this.updatedReceiptsToProcess=[],this.delegate=a,this.log=l.child("AdapterListener")}static makeTransactionToken(a){return a.platform+"|"+a.transactionId}setSupportedPlatforms(a){this.log.debug(`setSupportedPlatforms: ${a.join(",")} (${this.platformWithReceiptsReady.length} have their receipts ready)`),this.supportedPlatforms=a,this.supportedPlatforms.length===this.platformWithReceiptsReady.length&&(this.log.debug("triggering receiptsReady()"),this.delegate.receiptsReadyCallbacks.trigger(void 0,"adapterListener_setSupportedPlatforms"))}receiptsReady(a){if(this.supportedPlatforms.length>0&&this.platformWithReceiptsReady.length===this.supportedPlatforms.length){this.log.debug("receiptsReady: "+a+"(skipping)");return}this.platformWithReceiptsReady.indexOf(a)<0&&(this.platformWithReceiptsReady.push(a),this.log.debug(`receiptsReady: ${a} (${this.platformWithReceiptsReady.length}/${this.supportedPlatforms.length})`),this.platformWithReceiptsReady.length===this.supportedPlatforms.length&&(this.log.debug("triggering receiptsReady()"),this.delegate.receiptsReadyCallbacks.trigger(void 0,"adapterListener_receiptsReady")))}productsUpdated(a,l){l.forEach(c=>this.delegate.updatedCallbacks.trigger(c,"adapterListener_productsUpdated"))}receiptsUpdated(a,l){this.log.debug("receiptsUpdated: "+JSON.stringify(l.map(c=>({platform:c.platform,transactions:c.transactions}))));for(const c of l)this.updatedReceiptsToProcess.indexOf(c)<0&&this.updatedReceiptsToProcess.push(c);this.updatedReceiptsProcessor!==void 0&&clearTimeout(this.updatedReceiptsProcessor),this.updatedReceiptsProcessor=setTimeout(()=>{this._processUpdatedReceipts()},500)}_processUpdatedReceipts(){this.log.debug("processing "+this.updatedReceiptsToProcess.length+" updated receipts");const a=+new Date,l=this.updatedReceiptsToProcess;this.updatedReceiptsToProcess=[],l.forEach(c=>{this.delegate.updatedReceiptCallbacks.trigger(c,"adapterListener_receiptsUpdated"),c.transactions.forEach(d=>{var h;const m=t.makeTransactionToken(d),g=m+"@"+d.state,_=this.lastTransactionState[m];if(d.state===n.TransactionState.APPROVED){const v=(h=this.lastCallTimeForState[g])!==null&&h!==void 0?h:0;a-v>6e4?(this.lastCallTimeForState[g]=a,this.delegate.approvedCallbacks.trigger(d,"adapterListener_receiptsUpdated_approved")):this.log.debug(`Skipping ${g}, because it has been last called ${v>0?Math.round(a-v)+"ms ago ("+a+"-"+v+")":"never"}`)}else _!==d.state&&(d.state===n.TransactionState.INITIATED?(this.lastCallTimeForState[g]=a,this.delegate.initiatedCallbacks.trigger(d,"adapterListener_receiptsUpdated_initiated")):d.state===n.TransactionState.FINISHED?(this.lastCallTimeForState[g]=a,this.delegate.finishedCallbacks.trigger(d,"adapterListener_receiptsUpdated_finished")):d.state===n.TransactionState.PENDING&&(this.lastCallTimeForState[g]=a,this.delegate.pendingCallbacks.trigger(d,"adapterListener_receiptsUpdated_pending")));this.lastTransactionState[m]=d.state})})}}e.StoreAdapterListener=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a,l,c=!1){this.callbacks=[],this.numTriggers=0,this.logger=a,this.className=l,this.finalStateMode=c}push(a,l){if(this.finalStateMode&&this.numTriggers>0)a(this.lastTriggerArgument);else{for(const c of this.callbacks)if(c.callback===a)throw new Error("REGISTERING THE SAME CALLBACK TWICE? This is indicative of a bug in your integration.");this.callbacks.push({callback:a,callbackName:l})}}trigger(a,l){this.lastTriggerArgument=a,this.numTriggers++;const c=this.callbacks;this.finalStateMode&&(this.callbacks=[]),c.forEach(d=>{n.Utils.safeCall(this.logger,this.className,d.callback,a,d.callbackName,l)})}remove(a){this.callbacks=this.callbacks.filter(l=>l.callback!==a)}}e.Callbacks=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.isReady=!1,this.readyCallbacks=[],this.logger=a}add(a){if(this.isReady)return setTimeout(a,0);this.readyCallbacks.push(a)}trigger(a){this.isReady=!0,this.readyCallbacks.forEach(l=>n.Utils.safeCall(this.logger,"ready()",l,void 0,void 0,a)),this.readyCallbacks=[]}remove(a){this.readyCallbacks=this.readyCallbacks.filter(l=>l!==a)}}e.ReadyCallbacks=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){function t(a){return typeof a!="object"?!1:a.hasOwnProperty("platform")&&a.hasOwnProperty("id")&&a.hasOwnProperty("type")}class r{constructor(){this.list=[]}find(l,c){return this.list.find(d=>d.platform===l&&d.id===c)}add(l){const c=[],h=(Array.isArray(l)?l:[l]).filter(m=>!this.find(m.platform,m.id));for(const m of h)t(m)?this.list.push(m):c.push(n.storeError(n.ErrorCode.LOAD,'Invalid parameter to "register", expected "id", "type" and "platform". Got: '+JSON.stringify(m),null,null));return c}byPlatform(){const l={};return this.list.forEach(c=>{l[c.platform]=(l[c.platform]||[]).concat(c)}),Object.keys(l).map(c=>({platform:c,products:l[c]}))}}e.RegisteredProducts=r})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.monitors=[],this.isListening=!1,this.when=a}findMonitors(a){return this.monitors.filter(l=>l.transaction.platform===a.platform&&l.transaction.transactionId===a.transactionId)}startListening(){this.isListening||(this.isListening=!0,this.when.approved(a=>this.callOnChange(a),"transactionStateMonitors_callOnChange").finished(a=>this.callOnChange(a),"transactionStateMonitors_callOnChange"))}callOnChange(a){this.findMonitors(a).forEach(l=>{l.lastChange!==a.state&&(l.lastChange=a.state,l.onChange(a.state))})}start(a,l){this.startListening();const c=n.Utils.uuidv4();return this.monitors.push({monitorId:c,transaction:a,onChange:l,lastChange:a.state}),setTimeout(l,0,a.state),{transaction:a,stop:()=>this.stop(c)}}stop(a){this.monitors=this.monitors.filter(l=>l.monitorId!==a)}}e.TransactionStateMonitors=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.hasCalledReceiptsVerified=!1,this.controller=a,this.log=a.log.child("ReceiptsMonitor")}callReceiptsVerified(){this.hasCalledReceiptsVerified||(this.hasCalledReceiptsVerified=!0,this.log.info("receiptsVerified()"),this.controller.when().receiptsReady(()=>{setTimeout(()=>{this.controller.receiptsVerified()},0)},"receiptsMonitor_callReceiptsVerified"))}launch(){const a=()=>{this.log.debug(`check(${this.controller.numValidationResponses()}/${this.controller.numValidationRequests()})`),this.controller.numValidationRequests()===this.controller.numValidationResponses()&&(this.intervalChecker!==void 0&&(clearInterval(this.intervalChecker),this.intervalChecker=void 0),this.controller.off(a),this.callReceiptsVerified())};this.controller.when().verified(a,"receiptsMonitor_check").unverified(a,"receiptsMonitor_check").receiptsReady(()=>{this.log.debug("receiptsReady..."),(!this.controller.hasLocalReceipts()||!this.controller.hasValidator())&&setTimeout(()=>{a()},0),this.intervalChecker=setInterval(()=>{this.log.debug("keep checking every 10s..."),a()},1e4)},"receiptsMonitor_setup")}}e.ReceiptsMonitor=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.activePurchases={},this.notifiedPurchases={},this.controller=a}launch(){this.interval=setInterval(()=>{var a,l;const c=+new Date;for(const d of this.controller.verifiedReceipts){const h=(a=t.GRACE_PERIOD_MS[d.platform])!==null&&a!==void 0?a:t.GRACE_PERIOD_MS.DEFAULT;for(const m of d.collection)if(m.expiryDate){const g=m.expiryDate+h,_=(l=m.transactionId)!==null&&l!==void 0?l:`${g}`;g>c&&(this.activePurchases[_]=!0),g<c&&this.activePurchases[_]&&!this.notifiedPurchases[_]&&(this.notifiedPurchases[_]=!0,this.controller.onVerifiedPurchaseExpired(m,d))}}},t.INTERVAL_MS)}}t.INTERVAL_MS=1e4,t.GRACE_PERIOD_MS={DEFAULT:6e4,"ios-appstore":6e4,"android-playstore":3e4},e.ExpiryMonitor=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){n.PLUGIN_VERSION="13.12.1";class e{constructor(){this.adapters=new n.Internal.Adapters,this.registeredProducts=new n.Internal.RegisteredProducts,this.log=new n.Logger(this),this.verbosity=n.LogLevel.ERROR,this._readyCallbacks=new n.Internal.ReadyCallbacks(this.log),this.updatedCallbacks=new n.Internal.Callbacks(this.log,"productUpdated()"),this.updatedReceiptsCallbacks=new n.Internal.Callbacks(this.log,"receiptUpdated()"),this.initiatedCallbacks=new n.Internal.Callbacks(this.log,"initiated()"),this.approvedCallbacks=new n.Internal.Callbacks(this.log,"approved()"),this.finishedCallbacks=new n.Internal.Callbacks(this.log,"finished()"),this.pendingCallbacks=new n.Internal.Callbacks(this.log,"pending()"),this.verifiedCallbacks=new n.Internal.Callbacks(this.log,"verified()"),this.unverifiedCallbacks=new n.Internal.Callbacks(this.log,"unverified()"),this.receiptsReadyCallbacks=new n.Internal.Callbacks(this.log,"receiptsReady()",!0),this.receiptsVerifiedCallbacks=new n.Internal.Callbacks(this.log,"receiptsVerified()",!0),this.errorCallbacks=new n.Internal.Callbacks(this.log,"error()"),this.initializedHasBeenCalled=!1,this.lastUpdate=0,this.minTimeBetweenUpdates=6e5,this.version=n.PLUGIN_VERSION;const r=this;this.listener=new n.Internal.StoreAdapterListener({updatedCallbacks:this.updatedCallbacks,updatedReceiptCallbacks:this.updatedReceiptsCallbacks,initiatedCallbacks:this.initiatedCallbacks,approvedCallbacks:this.approvedCallbacks,finishedCallbacks:this.finishedCallbacks,pendingCallbacks:this.pendingCallbacks,receiptsReadyCallbacks:this.receiptsReadyCallbacks},this.log),this.transactionStateMonitors=new n.Internal.TransactionStateMonitors(this.when()),this._validator=new n.Internal.Validator({adapters:this.adapters,getApplicationUsername:this.getApplicationUsername.bind(this),get localReceipts(){return r.localReceipts},get validator(){return r.validator},get validator_privacy_policy(){return r.validator_privacy_policy},verifiedCallbacks:this.verifiedCallbacks,unverifiedCallbacks:this.unverifiedCallbacks,finish:a=>this.finish(a)},this.log),new n.Internal.ReceiptsMonitor({hasLocalReceipts:()=>this.localReceipts.length>0,hasValidator:()=>!!this.validator,numValidationRequests:()=>this._validator.numRequests,numValidationResponses:()=>this._validator.numResponses,off:this.off.bind(this),when:this.when.bind(this),receiptsVerified:()=>{r.receiptsVerifiedCallbacks.trigger(void 0,"receipts_monitor_controller")},log:this.log}).launch(),this.expiryMonitor=new n.Internal.ExpiryMonitor({get verifiedReceipts(){return r.verifiedReceipts},onVerifiedPurchaseExpired(a,l){r.verify(l.sourceReceipt)}}),this.expiryMonitor.launch()}getAdapter(r){return this.adapters.find(r)}getApplicationUsername(){return this.applicationUsername instanceof Function?this.applicationUsername():this.applicationUsername}register(r){this.registeredProducts.add(r).forEach(l=>{n.store.errorCallbacks.trigger(l,"register_error"),this.log.error(l)})}initialize(r=[this.defaultPlatform()]){return be(this,void 0,void 0,function*(){if(this.initializedHasBeenCalled)return this.log.warn("store.initialized() has been called already."),[];this.log.info("initialize("+JSON.stringify(r)+") v"+n.PLUGIN_VERSION),this.initializedHasBeenCalled=!0,this.lastUpdate=+new Date;const a=this,l=this.adapters.initialize(r,{error:this.triggerError.bind(this),get verbosity(){return a.verbosity},getApplicationUsername(){return a.getApplicationUsername()},get listener(){return a.listener},get log(){return a.log},get registeredProducts(){return a.registeredProducts},apiDecorators:{canPurchase:this.canPurchase.bind(this),owned:this.owned.bind(this),finish:this.finish.bind(this),order:this.order.bind(this),verify:this.verify.bind(this)}});return l.then(()=>{this._readyCallbacks.trigger("initialize_promise_resolved"),this.listener.setSupportedPlatforms(this.adapters.list.filter(c=>c.isSupported).map(c=>c.id))}),l})}refresh(){throw new Error("use store.initialize() or store.update()")}update(){var r;return be(this,void 0,void 0,function*(){if(this.log.info("update()"),!this._readyCallbacks.isReady){this.log.warn("Do not call store.update() at startup! It is meant to reload the price of products (if needed) long after initialization.");return}const a=+new Date;if(this.lastUpdate>a-this.minTimeBetweenUpdates){this.log.info("Skipping store.update() as the last call occurred less than store.minTimeBetweenUpdates millis ago.");return}this.lastUpdate=a;for(const l of this.registeredProducts.byPlatform()){const c=yield(r=this.adapters.findReady(l.platform))===null||r===void 0?void 0:r.loadProducts(l.products);c==null||c.forEach(d=>{d instanceof n.Product&&this.updatedCallbacks.trigger(d,"update_has_loaded_products")})}})}ready(r){this._readyCallbacks.add(r)}get isReady(){return this._readyCallbacks.isReady}when(){const r={productUpdated:(a,l)=>(this.updatedCallbacks.push(a,l),r),receiptUpdated:(a,l)=>(this.updatedReceiptsCallbacks.push(a,l),r),updated:(a,l)=>(this.updatedCallbacks.push(a,l),this.updatedReceiptsCallbacks.push(a,l),r),approved:(a,l)=>(this.approvedCallbacks.push(a,l),r),initiated:(a,l)=>(this.initiatedCallbacks.push(a,l),r),pending:(a,l)=>(this.pendingCallbacks.push(a,l),r),finished:(a,l)=>(this.finishedCallbacks.push(a,l),r),verified:(a,l)=>(this.verifiedCallbacks.push(a,l),r),unverified:(a,l)=>(this.unverifiedCallbacks.push(a,l),r),receiptsReady:(a,l)=>(this.receiptsReadyCallbacks.push(a,l),r),receiptsVerified:(a,l)=>(this.receiptsVerifiedCallbacks.push(a,l),r)};return r}off(r){this.updatedCallbacks.remove(r),this.updatedReceiptsCallbacks.remove(r),this.approvedCallbacks.remove(r),this.finishedCallbacks.remove(r),this.pendingCallbacks.remove(r),this.verifiedCallbacks.remove(r),this.unverifiedCallbacks.remove(r),this.receiptsReadyCallbacks.remove(r),this.receiptsVerifiedCallbacks.remove(r),this.errorCallbacks.remove(r),this._readyCallbacks.remove(r)}monitor(r,a,l){return this.transactionStateMonitors.start(r,n.Utils.safeCallback(this.log,"monitor()",a,l,"transactionStateMonitors_stateChanged"))}get products(){return[].concat(...this.adapters.list.map(r=>r.products))}get(r,a){var l;return(l=this.adapters.findReady(a))===null||l===void 0?void 0:l.products.find(c=>c.id===r)}get localReceipts(){return[].concat(...this.adapters.list.map(r=>r.receipts))}get localTransactions(){const r=[];for(const a of this.localReceipts)r.push(...a.transactions);return r}get verifiedReceipts(){return this._validator.verifiedReceipts}get verifiedPurchases(){return n.Internal.VerifiedReceipts.getVerifiedPurchases(this.verifiedReceipts)}findInVerifiedReceipts(r){return n.Internal.VerifiedReceipts.find(this.verifiedReceipts,r)}findInLocalReceipts(r){return n.Internal.LocalReceipts.find(this.localReceipts,r)}canPurchase(r){const a=r instanceof n.Offer?this.get(r.productId,r.platform):r,l=this.adapters.findReady(r.platform);return l!=null&&l.checkSupport("order")?n.Internal.LocalReceipts.canPurchase(this.localReceipts,a):!1}owned(r){return n.Internal.owned({product:typeof r=="string"?{id:r}:r,verifiedReceipts:this.validator?this.verifiedReceipts:void 0,localReceipts:this.localReceipts})}order(r,a){return be(this,void 0,void 0,function*(){this.log.info(`order(${r.productId})`);const l=this.adapters.findReady(r.platform);if(!l)return n.storeError(n.ErrorCode.PAYMENT_NOT_ALLOWED,"Adapter not found or not ready ("+r.platform+")",r.platform,null);const c=yield l.order(r,a||{});return c&&"isError"in c&&n.store.triggerError(c),c})}requestPayment(r,a){var l,c,d,h,m;const g=this.adapters.findReady(r.platform);if(!g)return n.PaymentRequestPromise.failed(n.ErrorCode.PAYMENT_NOT_ALLOWED,"Adapter not found or not ready ("+r.platform+")",r.platform,null);if(!r.amountMicros){r.amountMicros=0;for(const v of r.items)r.amountMicros+=(c=(l=v==null?void 0:v.pricing)===null||l===void 0?void 0:l.priceMicros)!==null&&c!==void 0?c:0}if(r.currency)for(const v of r.items)if(!((h=v==null?void 0:v.pricing)===null||h===void 0)&&h.currency){if(r.currency!==v.pricing.currency)return n.PaymentRequestPromise.failed(n.ErrorCode.PAYMENT_INVALID,"Currencies do not match",r.platform,v.id)}else v!=null&&v.pricing&&(v.pricing.currency=r.currency);else for(const v of r.items)!((d=v==null?void 0:v.pricing)===null||d===void 0)&&d.currency&&(r.currency=v.pricing.currency);if(r.items.length===1){const v=r.items[0];v&&!v.pricing&&(v.pricing={priceMicros:(m=r.amountMicros)!==null&&m!==void 0?m:0,currency:r.currency})}const _=new n.PaymentRequestPromise;return g.requestPayment(r,a).then(v=>{if(_.trigger(v),v instanceof n.Transaction){const T=A=>{_.trigger(v),v.state===n.TransactionState.FINISHED&&I.stop()},I=this.monitor(v,T,"requestPayment_onStateChange")}}),_}checkSupport(r,a){const l=this.adapters.find(r);return l?l.checkSupport(a):!1}verify(r){return be(this,void 0,void 0,function*(){this.log.info(`verify(${r.className})`),this._validator.add(r),setTimeout(()=>this._validator.run(),200)})}finish(r){return be(this,void 0,void 0,function*(){this.log.info(`finish(${r.className})`),(r instanceof n.VerifiedReceipt?r.sourceReceipt.transactions:r instanceof n.Receipt?r.transactions:[r]).forEach(l=>{var c;(c=this.adapters.findReady(l.platform))===null||c===void 0||c.finish(l)})})}restorePurchases(){return be(this,void 0,void 0,function*(){let r;for(const a of this.adapters.list)a.ready&&(r=r??(yield a.restorePurchases()));return r})}manageSubscriptions(r){return be(this,void 0,void 0,function*(){this.log.info("manageSubscriptions()");const a=this.adapters.findReady(r);return a?a.manageSubscriptions():n.storeError(n.ErrorCode.SETUP,"Found no adapter ready to handle 'manageSubscription'",r??null,null)})}manageBilling(r){return be(this,void 0,void 0,function*(){this.log.info("manageBilling()");const a=this.adapters.findReady(r);return a?a.manageBilling():n.storeError(n.ErrorCode.SETUP,"Found no adapter ready to handle 'manageBilling'",r??null,null)})}defaultPlatform(){switch(n.Utils.platformId()){case"android":return n.Platform.GOOGLE_PLAY;case"ios":return n.Platform.APPLE_APPSTORE;default:return n.Platform.TEST}}error(r){this.errorCallbacks.push(r)}triggerError(r){this.errorCallbacks.trigger(r,"triggerError")}}n.Store=e})(H||(H={}));window.cordova?setTimeout(Yv,0):Yv();function Yv(){var n;console.log("Create CdvPurchase...");const e=(n=window.CdvPurchase)===null||n===void 0?void 0:n.store;window.CdvPurchase=H,e?window.CdvPurchase.store=e:window.CdvPurchase.store=new H.Store,Object.assign(window.CdvPurchase.store,H.LogLevel,H.ProductType,H.ErrorCode,H.Platform)}var H;(function(n){(function(e){e.CONSUMABLE="consumable",e.NON_CONSUMABLE="non consumable",e.FREE_SUBSCRIPTION="free subscription",e.PAID_SUBSCRIPTION="paid subscription",e.NON_RENEWING_SUBSCRIPTION="non renewing subscription",e.APPLICATION="application"})(n.ProductType||(n.ProductType={})),(function(e){e.NON_RECURRING="NON_RECURRING",e.FINITE_RECURRING="FINITE_RECURRING",e.INFINITE_RECURRING="INFINITE_RECURRING"})(n.RecurrenceMode||(n.RecurrenceMode={})),(function(e){e.PAY_AS_YOU_GO="PayAsYouGo",e.UP_FRONT="UpFront",e.FREE_TRIAL="FreeTrial"})(n.PaymentMode||(n.PaymentMode={})),(function(e){e.APPLE_APPSTORE="ios-appstore",e.GOOGLE_PLAY="android-playstore",e.WINDOWS_STORE="windows-store-transaction",e.BRAINTREE="braintree",e.TEST="test"})(n.Platform||(n.Platform={})),(function(e){e.INITIATED="initiated",e.PENDING="pending",e.APPROVED="approved",e.CANCELLED="cancelled",e.FINISHED="finished",e.UNKNOWN_STATE=""})(n.TransactionState||(n.TransactionState={})),(function(e){e.LAPSE="Lapse",e.RENEW="Renew"})(n.RenewalIntent||(n.RenewalIntent={})),(function(e){e.NOTIFIED="Notified",e.AGREED="Agreed"})(n.PriceConsentStatus||(n.PriceConsentStatus={})),(function(e){e.NOT_CANCELED="",e.DEVELOPER="Developer",e.SYSTEM="System",e.SYSTEM_REPLACED="System.Replaced",e.SYSTEM_PRODUCT_UNAVAILABLE="System.ProductUnavailable",e.SYSTEM_BILLING_ERROR="System.BillingError",e.SYSTEM_DELETED="System.Deleted",e.CUSTOMER="Customer",e.CUSTOMER_TECHNICAL_ISSUES="Customer.TechnicalIssues",e.CUSTOMER_PRICE_INCREASE="Customer.PriceIncrease",e.CUSTOMER_COST="Customer.Cost",e.CUSTOMER_FOUND_BETTER_APP="Customer.FoundBetterApp",e.CUSTOMER_NOT_USEFUL_ENOUGH="Customer.NotUsefulEnough",e.CUSTOMER_OTHER_REASON="Customer.OtherReason",e.UNKNOWN="Unknown"})(n.CancelationReason||(n.CancelationReason={}))})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.className="Offer",this.id=r.id,this.pricingPhases=r.pricingPhases,Object.defineProperty(this,"productId",{enumerable:!0,get:()=>r.product.id}),Object.defineProperty(this,"productType",{enumerable:!0,get:()=>r.product.type}),Object.defineProperty(this,"productGroup",{enumerable:!0,get:()=>r.product.group}),Object.defineProperty(this,"platform",{enumerable:!0,get:()=>r.product.platform}),Object.defineProperty(this,"order",{enumerable:!1,get:()=>l=>a.order(this,l)}),Object.defineProperty(this,"canPurchase",{enumerable:!1,get:()=>a.canPurchase(this)})}get productId(){return""}get productType(){return n.ProductType.APPLICATION}get productGroup(){}get platform(){return n.Platform.TEST}order(r){return be(this,void 0,void 0,function*(){})}get canPurchase(){return!1}}n.Offer=e})(H||(H={}));var H;(function(n){class e{constructor(){this.failedCallbacks=new n.Internal.PromiseLike,this.initiatedCallbacks=new n.Internal.PromiseLike,this.approvedCallbacks=new n.Internal.PromiseLike,this.finishedCallbacks=new n.Internal.PromiseLike,this.cancelledCallback=new n.Internal.PromiseLike}failed(r){return this.failedCallbacks.push(r),this}initiated(r){return this.initiatedCallbacks.push(r),this}approved(r){return this.approvedCallbacks.push(r),this}finished(r){return this.finishedCallbacks.push(r),this}cancelled(r){return this.cancelledCallback.push(r),this}trigger(r){if(!r)this.cancelledCallback.resolve();else if("isError"in r)this.failedCallbacks.resolve(r);else switch(r.state){case n.TransactionState.INITIATED:this.initiatedCallbacks.resolve(r);break;case n.TransactionState.APPROVED:this.approvedCallbacks.resolve(r);break;case n.TransactionState.FINISHED:this.finishedCallbacks.resolve(r);break}return this}static failed(r,a,l,c){return new e().trigger(n.storeError(r,a,l,c))}static cancelled(){return new e().trigger()}static initiated(r){return new e().trigger(r)}}n.PaymentRequestPromise=e})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.className="Receipt",this.transactions=[],this.platform=r,Object.defineProperty(this,"verify",{enumerable:!1,get(){return()=>a.verify(this)}}),Object.defineProperty(this,"finish",{enumerable:!1,get(){return()=>a.finish(this)}})}verify(){return be(this,void 0,void 0,function*(){})}finish(){return be(this,void 0,void 0,function*(){})}hasTransaction(r){return!!this.transactions.find(a=>a===r)}lastTransaction(){return this.transactions[this.transactions.length-1]}}n.Receipt=e})(H||(H={}));var H;(function(n){class e{constructor(r,a,l){this.className="Transaction",this.transactionId="",this.state=n.TransactionState.UNKNOWN_STATE,this.products=[],this.platform=r,Object.defineProperty(this,"finish",{enumerable:!1,get(){return()=>l.finish(this)}}),Object.defineProperty(this,"verify",{enumerable:!1,get(){return()=>l.verify(this)}}),Object.defineProperty(this,"parentReceipt",{enumerable:!1,get(){return a}})}finish(){return be(this,void 0,void 0,function*(){})}verify(){return be(this,void 0,void 0,function*(){})}get parentReceipt(){return{}}}n.Transaction=e})(H||(H={}));var H;(function(n){(function(e){class t{static find(a,l){var c,d;if(!l)return;let h;for(const m of a)if(!(l.platform&&m.platform!==l.platform))for(const g of m.transactions)for(const _ of g.products)_.id===l.id&&(!h||((c=g.purchaseDate)!==null&&c!==void 0?c:0)<((d=h.purchaseDate)!==null&&d!==void 0?d:1))&&(h=g);return h}static isOwned(a,l){if(!l)return!1;const c=t.find(a,l);return!c||c.isConsumed||c.isPending?!1:c.expirationDate?c.expirationDate.getTime()>+new Date:!0}static canPurchase(a,l){if(!l)return!1;const c=t.find(a,l);return!c||c.isConsumed?!0:c.expirationDate?c.expirationDate.getTime()<=+new Date:!0}}e.LocalReceipts=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){function t(r){return r.verifiedReceipts!==void 0?e.VerifiedReceipts.isOwned(r.verifiedReceipts,r.product):r.localReceipts!==void 0?e.LocalReceipts.isOwned(r.localReceipts,r.product):!1}e.owned=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.resolved=!1,this.callbacks=[]}push(a){this.resolved?setTimeout(a,0,this.resolvedArgument):this.callbacks.push(a)}resolve(a){this.resolved||(this.resolved=!0,this.resolvedArgument=a,this.callbacks.forEach(l=>setTimeout(l,0,a)),this.callbacks=[])}}e.PromiseLike=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a=5e3,l=12e4){this.maxTimeout=12e4,this.minTimeout=5e3,this.retryTimeout=5e3,this.retries=[],this.minTimeout=a,this.maxTimeout=l,this.retryTimeout=a,document.addEventListener("online",()=>{const c=this.retries;this.retries=[],this.retryTimeout=this.minTimeout;for(var d=0;d<c.length;++d)clearTimeout(c[d].tid),c[d].fn.call(this)},!1)}retry(a){var l=setTimeout(()=>{this.retries=this.retries.filter(function(c){return l!==c.tid}),a()},this.retryTimeout);this.retries.push({tid:l,fn:a}),this.retryTimeout*=2,this.retryTimeout>this.maxTimeout&&(this.retryTimeout=this.maxTimeout)}}e.Retry=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{static find(a,l){var c,d;if(!l)return;let h;for(const m of a)if(!(l.platform&&m.platform!==l.platform))for(const g of m.collection)g.id===l.id&&((c=h==null?void 0:h.purchaseDate)!==null&&c!==void 0?c:0)<((d=g.purchaseDate)!==null&&d!==void 0?d:1)&&(h=g);return h}static isOwned(a,l){if(!l)return!1;const c=t.find(a,l);return!c||c!=null&&c.isExpired?!1:c!=null&&c.expiryDate?c.expiryDate>+new Date:!0}static getVerifiedPurchases(a){var l,c,d,h;const m={};for(const g of a)for(const _ of g.collection){const v=g.platform+":"+_.id,T=m[v];(!T||T&&((c=(l=T.lastRenewalDate)!==null&&l!==void 0?l:T.purchaseDate)!==null&&c!==void 0?c:0)<((h=(d=_.lastRenewalDate)!==null&&d!==void 0?d:_.purchaseDate)!==null&&h!==void 0?h:0))&&(m[v]=Object.assign(Object.assign({},_),{platform:g.platform}))}return Object.keys(m).map(g=>m[g])}}e.VerifiedReceipts=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){t.Name="name",t.EmailAddress="emailAddress",t.PhoneNumber="phoneNumber",t.PostalAddress="postalAddress",t.PhoneticName="phoneticName"})(e.ContactField||(e.ContactField={})),(function(t){t.Amex="Amex",t.Barcode="Barcode",t.CartesBancaires="CartesBancaires",t.ChinaUnionPay="ChinaUnionPay",t.Dankort="Dankort",t.Discover="Discover",t.Eftpos="Eftpos",t.Electron="Electron",t.Elo="Elo",t.Girocard="Girocard",t.IDCredit="IDCredit",t.Interac="Interac",t.JCB="JCB",t.Mada="Mada",t.Maestro="Maestro",t.MasterCard="MasterCard",t.Mir="Mir",t.Nanaco="Nanaco",t.PrivateLabel="PrivateLabel",t.QuicPay="QuicPay",t.Suica="Suica",t.Visa="Visa",t.VPay="VPay",t.Waon="Waon"})(e.PaymentNetwork||(e.PaymentNetwork={})),(function(t){t.ThreeDS="3DS",t.EMV="EMV",t.Credit="Credit",t.Debit="Debit"})(e.MerchantCapability||(e.MerchantCapability={}))})(n.ApplePay||(n.ApplePay={}))})(H||(H={}));var H;(function(n){(function(e){function t(l){return`virtual.${l}`}class r{constructor(c,d){var h,m;this.id=n.Platform.APPLE_APPSTORE,this.name="AppStore",this.ready=!1,this._canMakePayments=!1,this.forceReceiptReload=!1,this._products=[],this.validProducts={},this._paymentMonitor=()=>{},this.supportsParallelLoading=!0,this._appStoreReceiptLoading=!1,this._appStoreReceiptCallbacks=[],this.context=c,this.bridge=new e.Bridge.Bridge,this.log=c.log.child("AppleAppStore"),this.discountEligibilityDeterminer=d.discountEligibilityDeterminer,this.needAppReceipt=(h=d.needAppReceipt)!==null&&h!==void 0?h:!0,this.autoFinish=(m=d.autoFinish)!==null&&m!==void 0?m:!1,this.pseudoReceipt=new n.Receipt(n.Platform.APPLE_APPSTORE,this.context.apiDecorators),this.receiptsUpdated=n.Utils.createDebouncer(()=>{this._receiptsUpdated()},300)}get products(){return this._products}getProduct(c){return this._products.find(d=>d.id===c)}get receipts(){return this.isSupported?(this._receipt?[this._receipt]:[]).concat(this.pseudoReceipt?this.pseudoReceipt:[]):[]}addValidProducts(c,d){d.forEach(h=>{const m=c.find(g=>g.id===h.id);m&&(this.validProducts[h.id]=Object.assign(Object.assign({},h),m))})}get isSupported(){return n.Utils.platformId()==="ios"}upsertTransactionInProgress(c,d){const h=t(c);return new Promise(m=>{const g=this.pseudoReceipt.transactions.find(_=>_.transactionId===h);if(g)g.state=d,g.refresh(c),m(g);else{const _=new e.SKTransaction(n.Platform.APPLE_APPSTORE,this.pseudoReceipt,this.context.apiDecorators);_.state=d,_.transactionId=h,_.refresh(c),this.pseudoReceipt.transactions.push(_),m(_)}})}removeTransactionInProgress(c){const d=t(c);this.pseudoReceipt.transactions=this.pseudoReceipt.transactions.filter(h=>h.transactionId!==d)}upsertTransaction(c,d,h){return be(this,void 0,void 0,function*(){return new Promise(m=>{this.initializeAppReceipt(()=>{var g;if(!this._receipt){this.log.warn("Failed to load the application receipt, cannot proceed with handling the purchase");return}const _=(g=this._receipt)===null||g===void 0?void 0:g.transactions.find(v=>v.transactionId===d);if(_)_.state=h,_.refresh(c),m(_);else{const v=new e.SKTransaction(n.Platform.APPLE_APPSTORE,this._receipt,this.context.apiDecorators);v.state=h,v.transactionId=d,v.refresh(c),this._receipt.transactions.push(v),m(v)}})})})}removeTransaction(c){this._receipt&&(this._receipt.transactions=this._receipt.transactions.filter(d=>d.transactionId!==c))}_receiptsUpdated(){this._receipt?(this.log.debug("receipt updated and ready."),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this._receipt,this.pseudoReceipt]),this.context.listener.receiptsReady(n.Platform.APPLE_APPSTORE)):(this.log.debug("receipt updated."),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt]))}setPaymentMonitor(c){this._paymentMonitor=c}callPaymentMonitor(c,d,h){this._paymentMonitor(c)}initialize(){return new Promise(c=>{this.log.info("bridge.init");const d=this.log.child("Bridge");this.bridge.init({autoFinish:this.autoFinish,debug:this.context.verbosity===n.LogLevel.DEBUG,log:h=>d.debug(h),error:(h,m,g)=>{if(this.log.error("ERROR: "+h+" - "+m),h===n.ErrorCode.PAYMENT_CANCELLED){this.callPaymentMonitor("cancelled",n.ErrorCode.PAYMENT_CANCELLED,m);return}else this.context.error(a(h,m,(g==null?void 0:g.productId)||null))},ready:()=>{this.log.info("ready")},purchased:(h,m,g,_,v)=>be(this,void 0,void 0,function*(){this.log.info("purchase: id:"+h+" product:"+m+" originalTransaction:"+g+" - date:"+_+" - discount:"+v),(yield this.upsertTransaction(m,h,n.TransactionState.APPROVED)).refresh(m,g,_,v),this.removeTransactionInProgress(m),this.receiptsUpdated.call(),this.callPaymentMonitor("purchased")}),purchaseEnqueued:(h,m)=>be(this,void 0,void 0,function*(){this.log.info("purchaseEnqueued: "+h+" - "+m),yield this.upsertTransactionInProgress(h,n.TransactionState.INITIATED),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt])}),purchaseFailed:(h,m,g)=>{this.log.info("purchaseFailed: "+h+" - "+m+" - "+g),this.removeTransactionInProgress(h),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt]),this.callPaymentMonitor("failed",m,g)},purchasing:h=>be(this,void 0,void 0,function*(){this.log.info("purchasing: "+h),yield this.upsertTransactionInProgress(h,n.TransactionState.INITIATED),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt])}),deferred:h=>be(this,void 0,void 0,function*(){this.log.info("deferred: "+h),yield this.upsertTransactionInProgress(h,n.TransactionState.PENDING),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt]),this.callPaymentMonitor("deferred")}),finished:(h,m)=>be(this,void 0,void 0,function*(){yield this.receiptsUpdated.wait(),this.log.info("finish: "+h+" - "+m),this.removeTransactionInProgress(m),yield this.upsertTransaction(m,h,n.TransactionState.FINISHED),this.receiptsUpdated.call()}),restored:(h,m)=>be(this,void 0,void 0,function*(){this.log.info("restore: "+h+" - "+m),yield this.upsertTransaction(m,h,n.TransactionState.APPROVED),this.receiptsUpdated.call()}),receiptsRefreshed:h=>{this.log.info("receiptsRefreshed"),this._receipt&&this._receipt.refresh(h,this.needAppReceipt,this.context.apiDecorators)},restoreFailed:h=>{this.log.info("restoreFailed: "+h),this.onRestoreCompleted&&(this.onRestoreCompleted(a(h,"Restore purchases failed",null)),this.onRestoreCompleted=void 0)},restoreCompleted:()=>{this.log.info("restoreCompleted"),this.onRestoreCompleted&&(this.onRestoreCompleted(void 0),this.onRestoreCompleted=void 0)}},()=>be(this,void 0,void 0,function*(){this.log.info("bridge.init done"),yield this.canMakePayments(),c(void 0)}),(h,m)=>{this.log.info("bridge.init failed: "+h+" - "+m),c(a(h,m,null))})})}loadReceipts(){return new Promise(c=>{setTimeout(()=>{this.initializeAppReceipt(()=>{this.receiptsUpdated.call(),this._receipt?c([this._receipt,this.pseudoReceipt]):c([this.pseudoReceipt])})},300)})}canMakePayments(){return be(this,void 0,void 0,function*(){return new Promise(c=>{this.bridge.canMakePayments(()=>{this._canMakePayments=!0,c(!0)},d=>{this.log.warn(`canMakePayments: ${d}`),this._canMakePayments=!1,c(!1)})})})}initializeAppReceipt(c){return be(this,void 0,void 0,function*(){if(this._receipt)return this.log.debug("initializeAppReceipt() => already initialized."),c(void 0);if(this._appStoreReceiptCallbacks.push(c),this._appStoreReceiptLoading){this.log.debug("initializeAppReceipt() => already loading.");return}this._appStoreReceiptLoading=!0;const d=yield this.loadAppStoreReceipt(),h=m=>{const g=this._appStoreReceiptCallbacks;this._appStoreReceiptCallbacks=[],g.forEach(_=>{_(m)})};if(!(d!=null&&d.appStoreReceipt)){this.log.warn("no appStoreReceipt"),this._appStoreReceiptLoading=!1,h(a(n.ErrorCode.REFRESH,"No appStoreReceipt",null));return}this._receipt=new e.SKApplicationReceipt(d,this.needAppReceipt,this.context.apiDecorators),h(void 0)})}prepareReceipt(c){c!=null&&c.appStoreReceipt&&(this._receipt?this._receipt.refresh(c,this.needAppReceipt,this.context.apiDecorators):this._receipt=new e.SKApplicationReceipt(c,this.needAppReceipt,this.context.apiDecorators))}loadAppStoreReceipt(){return be(this,void 0,void 0,function*(){let c=!1;return new Promise(d=>{var h;if(!((h=this.bridge.appStoreReceipt)===null||h===void 0)&&h.appStoreReceipt&&!this.forceReceiptReload)return this.log.debug("using cached appstore receipt"),d(this.bridge.appStoreReceipt);this.log.debug("loading appstore receipt..."),this.forceReceiptReload=!1,this.bridge.loadReceipts(m=>{this.log.debug("appstore receipt loaded"),c||d(m),c=!0},(m,g)=>{this.log.warn("Failed to load appStoreReceipt: "+m+" - "+g),c||d(void 0),c=!0}),setTimeout(function(){c||d(void 0),c=!0},5e3)}).then(d=>(this.context.listener.receiptsReady(n.Platform.APPLE_APPSTORE),d)).catch(d=>(this.context.listener.receiptsReady(n.Platform.APPLE_APPSTORE),d))})}loadEligibility(c){return be(this,void 0,void 0,function*(){if(this.log.debug("load eligibility: "+JSON.stringify(c)),!this.discountEligibilityDeterminer)return this.log.debug("No discount eligibility determiner, skipping..."),new e.Internal.DiscountEligibilities([],[]);const d=[];if(c.forEach(h=>{var m,g,_;(m=h.discounts)===null||m===void 0||m.forEach(v=>{d.push({productId:h.id,discountId:v.id,discountType:v.type})}),((_=(g=h.discounts)===null||g===void 0?void 0:g.length)!==null&&_!==void 0?_:0)===0&&h.introPrice&&d.push({productId:h.id,discountId:"intro",discountType:"Introductory"})}),d.length>0){const h=yield this.loadAppStoreReceipt();if(!h||!h.appStoreReceipt)return this.log.debug("no receipt, assuming introductory price are available."),new e.Internal.DiscountEligibilities(d,d.map(m=>m.discountType==="Introductory"));{this.log.debug("calling discount eligibility determiner.");const m=yield this.callDiscountEligibilityDeterminer(h,d);return this.log.debug("response: "+JSON.stringify(m)),new e.Internal.DiscountEligibilities(d,m)}}else return new e.Internal.DiscountEligibilities([],[])})}callDiscountEligibilityDeterminer(c,d){return new Promise(h=>{if(!this.discountEligibilityDeterminer)return h([]);this.discountEligibilityDeterminer(c,d,h)})}loadProducts(c){return new Promise(d=>{this.log.info("bridge.load"),this.bridge.load(c.map(h=>h.id),(h,m)=>be(this,void 0,void 0,function*(){this.log.info("bridge.loaded: "+JSON.stringify({validProducts:h,invalidProducts:m})),this.addValidProducts(c,h);const g=yield this.loadEligibility(h);this.log.info("eligibilities ready: "+JSON.stringify(g));const _=c.map(v=>{if(m.indexOf(v.id)>=0)return this.log.debug(`${v.id} is invalid`),a(n.ErrorCode.INVALID_PRODUCT_ID,"Product not found in AppStore. #400",v.id);{const T=h.find(A=>A.id===v.id);if(this.log.debug(`${v.id} is valid: ${JSON.stringify(T)}`),!T)return a(n.ErrorCode.INVALID_PRODUCT_ID,"Product not found in AppStore. #404",v.id);let I=this.getProduct(v.id);return I?(this.log.debug("refreshing existing product"),I==null||I.refresh(T,this.context.apiDecorators,g)):(this.log.debug("registering new product"),I=new e.SKProduct(T,v,this.context.apiDecorators,g),this._products.push(I)),I}});this.log.debug(`Products loaded: ${JSON.stringify(_)}`),d(_)}),(h,m)=>c.map(g=>a(h,m,null)))})}order(c,d){return be(this,void 0,void 0,function*(){let h=!1;return new Promise(m=>{var g;const _=C=>{h||(this.setPaymentMonitor(()=>{}),h=!0,m(C))};this.log.info("order");const v=c.id!==e.DEFAULT_OFFER_ID?c.id:void 0,T=(g=d==null?void 0:d.appStore)===null||g===void 0?void 0:g.discount;if(v&&!T)return _(a(n.ErrorCode.MISSING_OFFER_PARAMS,"Missing additionalData.appStore.discount when ordering a discount offer",c.productId));if(v&&(T==null?void 0:T.id)!==v)return _(a(n.ErrorCode.INVALID_OFFER_IDENTIFIER,"Offer identifier does not match additionalData.appStore.discount.id",c.productId));this.setPaymentMonitor((C,L,x)=>{if(this.log.info("order.paymentMonitor => "+C+" "+(L??"")+" "+(x??"")),!h)switch(C){case"cancelled":_(a(L??n.ErrorCode.PAYMENT_CANCELLED,x??"The user cancelled the order.",c.productId));break;case"failed":setTimeout(()=>{_(a(L??n.ErrorCode.PURCHASE,x??"Purchase failed",c.productId))},500);break;case"purchased":case"deferred":_(void 0);break}});const I=()=>{this.log.info("order.success")},A=()=>{this.log.info("order.error"),_(a(n.ErrorCode.PURCHASE,"Failed to place order",c.productId))};this.forceReceiptReload=!0,this.bridge.purchase(c.productId,1,this.context.getApplicationUsername(),T,I,A)})})}finish(c){return new Promise(d=>{if(this.log.info("finish("+c.transactionId+")"),c.transactionId===e.APPLICATION_VIRTUAL_TRANSACTION_ID||c.transactionId===t(c.products[0].id))return c.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[c.parentReceipt]),d(void 0);const h=()=>{c.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[c.parentReceipt]),d(void 0)},m=g=>{var _,v;g!=null&&g.includes("[#CdvPurchase:100]")?h():d(a(n.ErrorCode.FINISH,"Failed to finish transaction",(v=(_=c.products[0])===null||_===void 0?void 0:_.id)!==null&&v!==void 0?v:null))};this.bridge.finish(c.transactionId,h,m)})}refreshReceipt(){return new Promise(c=>{const d=m=>{c(m)},h=(m,g)=>{c(a(m,g,null))};this.bridge.refreshReceipts(d,h)})}receiptValidationBody(c){return be(this,void 0,void 0,function*(){if(c.platform!==n.Platform.APPLE_APPSTORE||c!==this._receipt)return;const d=c;let h=d.nativeData;if(this.forceReceiptReload){const g=yield this.loadAppStoreReceipt();this.forceReceiptReload=!1,g&&(h=g,this.prepareReceipt(g))}if(!d.nativeData.appStoreReceipt){this.log.info("Cannot prepare the receipt validation body, because appStoreReceipt is missing. Refreshing...");const g=yield this.refreshReceipt();if(!g||"isError"in g){this.log.warn("Failed to refresh receipt, cannot run receipt validation."),g&&this.log.error(g);return}this.log.info("Receipt refreshed."),h=g}const m=d.transactions.slice(-1)[0];return{id:h.bundleIdentifier,type:n.ProductType.APPLICATION,products:n.Utils.objectValues(this.validProducts).map(g=>new e.SKProduct(g,g,this.context.apiDecorators,{isEligible:()=>!0})),transaction:{type:"ios-appstore",id:m==null?void 0:m.transactionId,appStoreReceipt:h.appStoreReceipt}}})}handleReceiptValidationResponse(c,d){var h,m;return be(this,void 0,void 0,function*(){let g=!1;if(d.ok){const _=(h=d.data)===null||h===void 0?void 0:h.transaction;(_==null?void 0:_.type)==="ios-appstore"&&"original_application_version"in _&&((m=this._receipt)===null||m===void 0||m.transactions.forEach(v=>{v.transactionId===e.APPLICATION_VIRTUAL_TRANSACTION_ID&&_.original_purchase_date_ms&&(v.purchaseDate=new Date(parseInt(_.original_purchase_date_ms)),g=!0)}))}g&&this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[c])})}requestPayment(c,d){return be(this,void 0,void 0,function*(){return a(n.ErrorCode.UNKNOWN,"requestPayment not supported",null)})}manageSubscriptions(){return be(this,void 0,void 0,function*(){this.bridge.manageSubscriptions()})}manageBilling(){return be(this,void 0,void 0,function*(){this.bridge.manageBilling()})}checkSupport(c){return c==="order"?this._canMakePayments:["order","manageBilling","manageSubscriptions"].indexOf(c)>=0}restorePurchases(){return new Promise(c=>{this.onRestoreCompleted=d=>{this.onRestoreCompleted=void 0,this.bridge.refreshReceipts(h=>{c(d)},(h,m)=>{c(d||a(h,m,null))})},this.forceReceiptReload=!0,this.bridge.restore()})}presentCodeRedemptionSheet(){return new Promise(c=>{this.bridge.presentCodeRedemptionSheet(c)})}}e.Adapter=r;function a(l,c,d){return n.storeError(l,c,n.Platform.APPLE_APPSTORE,d)}})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){const r=h=>{};let a=r;function l(h,m,g,_){window.cordova.exec(g,_,"InAppPurchase",h,m)}function c(h,m,...g){if(h)try{h.apply(this,g)}catch(_){a("exception in "+m+': "'+_+'"')}}class d{constructor(){this.transactionsForProduct={},this.initialized=!1,this.registeredProducts=[],this.needRestoreNotification=!1,this.pendingUpdates=[],this.onPurchased=!1,this.onFailed=!1,this.onRestored=!1,window.storekit=this,this.options={error:r,ready:r,purchased:r,purchaseEnqueued:r,purchasing:r,purchaseFailed:r,deferred:r,finished:r,restored:r,receiptsRefreshed:r,restoreFailed:r,restoreCompleted:r}}init(m,g,_){this.options={error:m.error||r,ready:m.ready||r,purchased:m.purchased||r,purchaseEnqueued:m.purchaseEnqueued||r,purchasing:m.purchasing||r,purchaseFailed:m.purchaseFailed||r,deferred:m.deferred||r,finished:m.finished||r,restored:m.restored||r,receiptsRefreshed:m.receiptsRefreshed||r,restoreFailed:m.restoreFailed||r,restoreCompleted:m.restoreCompleted||r},m.debug&&(l("debug",[],r,r),a=m.log||function(I){console.log("[CdvPurchase.AppAppStore.Bridge] "+I)}),m.autoFinish&&l("autoFinish",[],r,r),l("setup",[],()=>{a("setup ok"),c(this.options.ready,"options.ready"),c(g,"init.success"),this.initialized=!0,setTimeout(()=>this.processPendingTransactions(),50)},I=>{a("setup failed"),c(_,"init.error",n.ErrorCode.SETUP,"Setup failed: "+I)})}processPendingTransactions(){a("processing pending transactions"),l("processPendingTransactions",[],()=>{this.finalizeTransactionUpdates()},void 0)}purchase(m,g,_,v,T,I){g=g|0||1;const A=this.options;if(this.registeredProducts.indexOf(m)<0){const x="Purchasing "+m+" failed.  Ensure the product was loaded first with Bridge.load(...)!";a(x),typeof A.error=="function"&&c(A.error,"options.error",n.ErrorCode.PURCHASE,"Trying to purchase a unknown product.",{productId:m,quantity:g});return}l("purchase",[m,g,_,v||{}],()=>{a("Purchase enqueued "+m),typeof A.purchaseEnqueued=="function"&&c(A.purchaseEnqueued,"options.purchaseEnqueued",m,g),c(T,"purchase.success")},()=>{const x="Purchase failed: "+m;a(x),typeof A.error=="function"&&c(A.error,"options.error",n.ErrorCode.PURCHASE,x,{productId:m,quantity:g}),c(I,"purchase.error")})}canMakePayments(m,g){return l("canMakePayments",[],m,g)}restore(m){this.needRestoreNotification=!0,l("restoreCompletedTransactions",[],m,m)}manageSubscriptions(m){l("manageSubscriptions",[],m,m)}manageBilling(m){l("manageBilling",[],m,m)}presentCodeRedemptionSheet(m){l("presentCodeRedemptionSheet",[],m,m)}load(m,g,_){const v=this.options;if(typeof m=="string"&&(m=[m]),!m)c(g,"load.success",[],[]);else if(!m.length)c(g,"load.success",[],[]);else{if(typeof m[0]!="string"){const A="invalid productIds given to store.load: "+JSON.stringify(m);a(A),c(v.error,"options.error",n.ErrorCode.LOAD,A),c(_,"load.error",n.ErrorCode.LOAD,A);return}a("load "+JSON.stringify(m));const T=A=>{const C=A[0],L=A[1];a("load ok: { valid:"+JSON.stringify(C)+" invalid:"+JSON.stringify(L)+" }"),c(g,"load.success",C,L)},I=A=>{a("load failed"),a(A);const C="Load failed: "+A;c(v.error,"options.error",n.ErrorCode.LOAD,C),c(_,"load.error",n.ErrorCode.LOAD,C)};this.registeredProducts=this.registeredProducts.concat(m),l("load",[m],T,I)}}finish(m,g,_){l("finishTransaction",[m],g,_)}finalizeTransactionUpdates(){for(let m=0;m<this.pendingUpdates.length;++m){const g=this.pendingUpdates[m];this.transactionUpdated(g.state,g.errorCode,g.errorText,g.transactionIdentifier,g.productId,g.transactionReceipt,g.originalTransactionIdentifier,g.transactionDate,g.discountId)}this.pendingUpdates=[]}lastTransactionUpdated(){}transactionUpdated(m,g,_,v,T,I,A,C,L){if(!this.initialized){this.pendingUpdates.push({state:m,errorCode:g,errorText:_,transactionIdentifier:v,productId:T,transactionReceipt:I,originalTransactionIdentifier:A,transactionDate:C,discountId:L});return}switch(a("transaction updated:"+v+" state:"+m+" product:"+T),T&&v&&(this.transactionsForProduct[T]?this.transactionsForProduct[T].push(v):this.transactionsForProduct[T]=[v]),m){case"PaymentTransactionStatePurchasing":c(this.options.purchasing,"options.purchasing",T);return;case"PaymentTransactionStatePurchased":c(this.options.purchased,"options.purchase",v,T,A,C,L);return;case"PaymentTransactionStateDeferred":c(this.options.deferred,"options.deferred",T);return;case"PaymentTransactionStateFailed":c(this.options.purchaseFailed,"options.purchaseFailed",T,g||n.ErrorCode.UNKNOWN,_||"ERROR"),c(this.options.error,"options.error",g||n.ErrorCode.UNKNOWN,_||"ERROR",{productId:T});return;case"PaymentTransactionStateRestored":c(this.options.restored,"options.restore",v,T);return;case"PaymentTransactionStateFinished":c(this.options.finished,"options.finish",v,T);return}}restoreCompletedTransactionsFinished(){this.needRestoreNotification&&(this.needRestoreNotification=!1,c(this.options.restoreCompleted,"options.restoreCompleted"))}restoreCompletedTransactionsFailed(m){this.needRestoreNotification&&(this.needRestoreNotification=!1,c(this.options.restoreFailed,"options.restoreFailed",m))}parseReceiptArgs(m){const g=m[0],_=m[1],v=m[2],T=m[3],I=m[4];return a("infoPlist: "+_+","+v+","+T+","+I),{appStoreReceipt:g,bundleIdentifier:_,bundleShortVersion:v,bundleNumericVersion:T,bundleSignature:I}}refreshReceipts(m,g){const _=T=>{const I=this.parseReceiptArgs(T);this.appStoreReceipt=I,c(this.options.receiptsRefreshed,"options.receiptsRefreshed",I),c(m,"refreshReceipts.success",I)},v=T=>{a("refresh receipt failed: "+T),T.includes("(@AMSErrorDomain:100)")&&a('authentication failed, indicated by the string "(@AMSErrorDomain:100)"'),c(this.options.error,"options.error",n.ErrorCode.REFRESH_RECEIPTS,"Failed to refresh receipt: "+T),c(g,"refreshReceipts.error",n.ErrorCode.REFRESH_RECEIPTS,"Failed to refresh receipt: "+T)};this.appStoreReceipt=null,a("refreshing appStoreReceipt"),l("appStoreRefreshReceipt",[],_,v)}loadReceipts(m,g){const _=T=>{const I=this.parseReceiptArgs(T);this.appStoreReceipt=I,c(m,"loadReceipts.callback",I)},v=T=>{};a("loading appStoreReceipt"),l("appStoreReceipt",[],_,v)}}t.Bridge=d})(e.Bridge||(e.Bridge={}))})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){class r{constructor(l,c){this.request=l,this.response=c}isEligible(l,c,d){var h;for(let m=0;m<this.request.length;++m){const g=this.request[m];if(g.productId===l&&g.discountId===d&&g.discountType===c)return(h=this.response[m])!==null&&h!==void 0?h:!1}return!0}}t.DiscountEligibilities=r})(e.Internal||(e.Internal={}))})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){e.DEFAULT_OFFER_ID="$";class t extends n.Offer{constructor(l,c){super(l,c),this.offerType=l.offerType}}e.SKOffer=t;class r extends n.Product{constructor(l,c,d,h){super(c,d),this.raw=l,this.refresh(l,d,h)}removeIneligibleDiscounts(l){this.offers=this.offers.filter(c=>{const d=c;return d.offerType==="Default"?!0:l.isEligible(this.id,d.offerType,c.id)})}refresh(l,c,d){var h;this.raw=l,this.title=l.title,this.description=l.description,this.countryCode=l.countryCode,l.group&&(this.group=l.group),this.removeIneligibleDiscounts(d);const m={price:l.price,priceMicros:l.priceMicros,currency:l.currency,billingPeriod:_(l.billingPeriod,l.billingPeriodUnit),paymentMode:this.type===n.ProductType.PAID_SUBSCRIPTION?n.PaymentMode.PAY_AS_YOU_GO:n.PaymentMode.UP_FRONT,recurrenceMode:this.type===n.ProductType.PAID_SUBSCRIPTION?n.RecurrenceMode.INFINITE_RECURRING:n.RecurrenceMode.NON_RECURRING};if((h=l.discounts)===null||h===void 0||h.forEach(v=>{if(d.isEligible(l.id,v.type,v.id)){const T=[],I=v.paymentMode===n.PaymentMode.PAY_AS_YOU_GO?v.period:1,A=v.paymentMode===n.PaymentMode.PAY_AS_YOU_GO?1:v.period,C={price:v.price,priceMicros:v.priceMicros,currency:l.currency,billingPeriod:_(A,v.periodUnit),billingCycles:I,paymentMode:v.paymentMode,recurrenceMode:n.RecurrenceMode.FINITE_RECURRING};T.push(C),T.push(m),this.addOffer(new t({id:v.id,product:this,pricingPhases:T,offerType:v.type},c))}}),!g(this)){const v=[];if(l.introPrice&&l.introPriceMicros!==void 0&&d.isEligible(l.id,"Introductory","intro")){const T={price:l.introPrice,priceMicros:l.introPriceMicros,currency:l.currency,billingPeriod:_(l.introPricePeriod,l.introPricePeriodUnit),paymentMode:l.introPricePaymentMode,recurrenceMode:n.RecurrenceMode.FINITE_RECURRING,billingCycles:1};v.push(T)}v.push(m),this.addOffer(new t({id:e.DEFAULT_OFFER_ID,product:this,pricingPhases:v,offerType:"Default"},c))}function g(v){return v.offers.filter(T=>{const I=T;return I.offerType==="Introductory"||I.offerType==="Default"&&I.pricingPhases.length>1}).length>0}function _(v,T){if(v&&T)return`P${v}${T[0]}`}}}e.SKProduct=r})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){e.APPLICATION_VIRTUAL_TRANSACTION_ID="appstore.application";class t extends n.Receipt{constructor(l,c,d){super(n.Platform.APPLE_APPSTORE,d),this.nativeData=l,this.refresh(this.nativeData,c,d)}refresh(l,c,d){if(this.nativeData=l,c){if(this.transactions.find(g=>g.transactionId===e.APPLICATION_VIRTUAL_TRANSACTION_ID))return;const m=new n.Transaction(n.Platform.APPLE_APPSTORE,this,d);m.transactionId=e.APPLICATION_VIRTUAL_TRANSACTION_ID,m.state=n.TransactionState.APPROVED,m.products.push({id:l.bundleIdentifier}),this.transactions.push(m)}}}e.SKApplicationReceipt=t;class r extends n.Transaction{refresh(l,c,d,h){l&&(this.products=[{id:l,offerId:h}]),c&&(this.originalTransactionId=c),d&&(this.purchaseDate=new Date(+d))}}e.SKTransaction=r})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.CANCELED="1",r.BILLING_ERROR="2",r.PRICE_INCREASE="3",r.PRODUCT_NOT_AVAILABLE="4",r.UNKNOWN="5"})(t.AppleExpirationIntent||(t.AppleExpirationIntent={}))})(e.VerifyReceipt||(e.VerifyReceipt={}))})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){class t extends n.Receipt{constructor(g,_,v){var T,I,A;super(n.Platform.BRAINTREE,v);const C=new n.Transaction(n.Platform.BRAINTREE,this,v);C.purchaseDate=new Date,C.products=((T=g.items)===null||T===void 0?void 0:T.filter(L=>L).map(L=>({id:(L==null?void 0:L.id)||""})))||[],C.state=n.TransactionState.APPROVED,C.transactionId=(A=(I=_.paymentMethodNonce)===null||I===void 0?void 0:I.nonce)!==null&&A!==void 0?A:`UNKNOWN_${_.paymentMethodType}_${_.paymentDescription}`,this.transactions=[C],this.dropInResult=_,this.paymentRequest=g,this.refresh(g,_,v)}refresh(g,_,v){var T,I;this.dropInResult=_,this.paymentRequest=g;const A=new n.Transaction(n.Platform.BRAINTREE,this,v);A.products=g.items.filter(C=>C).map(C=>({id:(C==null?void 0:C.id)||""})),A.state=n.TransactionState.APPROVED,A.transactionId=(I=(T=_.paymentMethodNonce)===null||T===void 0?void 0:T.nonce)!==null&&I!==void 0?I:`UNKNOWN_${_.paymentMethodType}_${_.paymentDescription}`,A.amountMicros=g.amountMicros,A.currency=g.currency,this.transactions=[A]}}e.BraintreeReceipt=t;class r{constructor(g,_){this.id=n.Platform.BRAINTREE,this.name="BrainTree",this.ready=!1,this.products=[],this._receipts=[],this.supportsParallelLoading=!1,this.context=g,this.log=g.log.child("Braintree"),this.options=_}get receipts(){return this._receipts}get isSupported(){return e.IosBridge.Bridge.isSupported()||e.AndroidBridge.Bridge.isSupported()}initialize(){return new Promise(g=>{if(this.log.info("initialize()"),e.IosBridge.Bridge.isSupported())this.log.info("instantiating ios bridge..."),this.iosBridge=new e.IosBridge.Bridge(this.log,_=>{this.options.tokenizationKey?_(this.options.tokenizationKey):this.options.clientTokenProvider?this.options.clientTokenProvider(_):_(h(n.ErrorCode.CLIENT_INVALID,"Braintree iOS Bridge requires a clientTokenProvider or tokenizationKey"))},this.options.applePay),this.iosBridge.initialize(this.context,g);else if(e.AndroidBridge.Bridge.isSupported()&&!this.androidBridge){this.log.info("instantiating android bridge..."),this.androidBridge=new e.AndroidBridge.Bridge(this.log),this.log.info("calling android bridge -> initialize...");const _=this.options.tokenizationKey?this.options.tokenizationKey:this.options.clientTokenProvider?this.options.clientTokenProvider:"";this.androidBridge.initialize(_,g)}else this.log.info("platform not supported..."),g(void 0);this.context.listener.receiptsReady(n.Platform.BRAINTREE)})}loadProducts(g){return be(this,void 0,void 0,function*(){return g.map(_=>h(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"N/A"))})}loadReceipts(){return be(this,void 0,void 0,function*(){return this.context.listener.receiptsReady(n.Platform.BRAINTREE),[]})}order(g){return be(this,void 0,void 0,function*(){return h(n.ErrorCode.UNKNOWN,"N/A: Not implemented with Braintree")})}finish(g){return be(this,void 0,void 0,function*(){g.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.TEST,[g.parentReceipt])})}manageSubscriptions(){return be(this,void 0,void 0,function*(){this.log.info("N/A: manageSubscriptions() is not available with Braintree")})}manageBilling(){return be(this,void 0,void 0,function*(){this.log.info("N/A: manageBilling() is not available with Braintree")})}launchDropIn(g,_){return be(this,void 0,void 0,function*(){return this.androidBridge?this.androidBridge.launchDropIn(_):this.iosBridge?this.iosBridge.launchDropIn(g,_):h(n.ErrorCode.PURCHASE,"Braintree is not available")})}requestPayment(g,_){var v,T,I,A,C,L,x,U,z;return be(this,void 0,void 0,function*(){this.log.info("requestPayment()"+JSON.stringify(g));const $=((v=_==null?void 0:_.braintree)===null||v===void 0?void 0:v.dropInRequest)||{};if((yield e.IosBridge.ApplePayPlugin.isSupported(this.log))||(this.log.info("Apple Pay is not supported."),$.applePayDisabled=!0),this.options.googlePay||$.googlePayRequest){const N=Object.assign(Object.assign({},(T=this.options.googlePay)!==null&&T!==void 0?T:{}),(I=$.googlePayRequest)!==null&&I!==void 0?I:{});N.transactionInfo||(N.transactionInfo={currencyCode:(A=g.currency)!==null&&A!==void 0?A:"",totalPrice:((C=g.amountMicros)!==null&&C!==void 0?C:0)/1e6,totalPriceStatus:e.GooglePay.TotalPriceStatus.FINAL}),$.googlePayRequest=N}if(this.options.threeDSecure||$.threeDSecureRequest){const N=Object.assign(Object.assign({},(L=this.options.threeDSecure)!==null&&L!==void 0?L:{}),(x=$.threeDSecureRequest)!==null&&x!==void 0?x:{});N.amount||(N.amount=a((U=g.amountMicros)!==null&&U!==void 0?U:0)),!N.billingAddress&&g.billingAddress&&(N.billingAddress={givenName:g.billingAddress.givenName,surname:g.billingAddress.surname,countryCodeAlpha2:g.billingAddress.countryCode,postalCode:g.billingAddress.postalCode,locality:g.billingAddress.locality,streetAddress:g.billingAddress.streetAddress1,extendedAddress:g.billingAddress.streetAddress2,line3:g.billingAddress.streetAddress3,phoneNumber:g.billingAddress.phoneNumber,region:g.billingAddress.region}),N.email||(N.email=g.email),$.threeDSecureRequest=N}const se=yield this.launchDropIn(g,$);if(!c(se))return d(this.log,se);const D=se;if(this.log.info("launchDropIn success: "+JSON.stringify({paymentRequest:g,dropInResult:D})),!(!((z=D.paymentMethodNonce)===null||z===void 0)&&z.nonce))return h(n.ErrorCode.BAD_RESPONSE,"launchDropIn returned no paymentMethodNonce");let P=this._receipts.find(N=>{var M,B;return((M=N.dropInResult.paymentMethodNonce)===null||M===void 0?void 0:M.nonce)===((B=D.paymentMethodNonce)===null||B===void 0?void 0:B.nonce)});return P?P.refresh(g,D,this.context.apiDecorators):(P=new t(g,D,this.context.apiDecorators),this.receipts.push(P)),this.context.listener.receiptsUpdated(n.Platform.BRAINTREE,[P]),P.transactions[0]})}receiptValidationBody(g){var _,v,T,I,A;return be(this,void 0,void 0,function*(){if(!l(g)){this.log.error("Unexpected error, expecting a BraintreeReceipt: "+JSON.stringify(g));return}return this.log.info("create receiptValidationBody for: "+JSON.stringify(g)),{id:(T=(v=(_=g.paymentRequest.items)===null||_===void 0?void 0:_[0])===null||v===void 0?void 0:v.id)!==null&&T!==void 0?T:"unknown",type:n.ProductType.CONSUMABLE,priceMicros:g.paymentRequest.amountMicros,currency:g.paymentRequest.currency,products:[],transaction:{type:n.Platform.BRAINTREE,deviceData:g.dropInResult.deviceData,id:"nonce",paymentMethodNonce:(A=(I=g.dropInResult.paymentMethodNonce)===null||I===void 0?void 0:I.nonce)!==null&&A!==void 0?A:"",paymentDescription:g.dropInResult.paymentDescription,paymentMethodType:g.dropInResult.paymentMethodType}}})}handleReceiptValidationResponse(g,_){var v;return be(this,void 0,void 0,function*(){if(this.log.info("receipt validation response: "+JSON.stringify(_)),_!=null&&_.data&&"transaction"in _.data&&_.data.transaction.type==="braintree"){const T=(v=_.data.transaction.data.transaction)===null||v===void 0?void 0:v.customer.id;T&&!e.customerId&&(this.log.info("customerId updated: "+T),e.customerId=T)}})}checkSupport(g){return g==="requestPayment"}restorePurchases(){return be(this,void 0,void 0,function*(){})}}e.Adapter=r;function a(m){const g=""+m/1e4;return(g.slice(0,-2)||"0")+"."+(g.slice(-2,-1)||"0")+(g.slice(-1)||"0")}function l(m){return m.platform===n.Platform.BRAINTREE}const c=m=>!!m&&!("code"in m&&"message"in m),d=(m,g)=>{if(g){if(g.code===n.ErrorCode.PAYMENT_CANCELLED){m.info("User cancelled the payment request");return}return m.warn("launchDropIn failed: "+JSON.stringify(g)),g}else return m.warn("launchDropIn failed: no response"),h(n.ErrorCode.BAD_RESPONSE,"Braintree failed to launch drop in")};function h(m,g){return n.storeError(m,g,n.Platform.BRAINTREE,null)}e.braintreeError=h})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){const t="BraintreePlugin";(function(r){class a{constructor(c){this.log=c.child("AndroidBridge")}listener(c){this.log.debug("listener: "+JSON.stringify(c)),!(!c||!c.type)&&(c.type==="getClientToken"?this.getClientToken():c.type)}initialize(c,d){try{if(typeof c=="string"){const m=c;this.clientTokenProvider=g=>{g(m)}}else this.clientTokenProvider=c;this.log.info("exec.setListener()");const h=this.listener.bind(this);window.cordova.exec(h,null,t,"setListener",[]),d(void 0)}catch(h){this.log.warn("initialization failed: "+(h==null?void 0:h.message)),d(e.braintreeError(n.ErrorCode.SETUP,"Failed to initialize Braintree Android Bridge: "+(h==null?void 0:h.message)))}}getClientToken(){this.log.info("getClientToken()"),this.clientTokenProvider?(this.log.debug("clientTokenProvider set, calling."),this.clientTokenProvider(c=>{typeof c=="string"?window.cordova.exec(null,null,t,"onClientTokenSuccess",[c]):window.cordova.exec(null,null,t,"onClientTokenFailure",[c.code,c.message])})):(this.log.debug("clientTokenProvider not set, retrying later..."),setTimeout(()=>this.getClientToken(),1e3))}static isSupported(){return n.Utils.platformId()==="android"}isApplePaySupported(){return be(this,void 0,void 0,function*(){return!1})}launchDropIn(c){return new Promise(d=>{window.cordova.exec(h=>{this.log.info("dropInSuccess: "+JSON.stringify(h)),d(h)},h=>{this.log.info("dropInFailure: "+h);const m=h.split("|")[0],g=h.split("|").slice(1).join("");d(m==="UserCanceledException"?e.braintreeError(n.ErrorCode.PAYMENT_CANCELLED,g):m==="AuthorizationException"?e.braintreeError(n.ErrorCode.UNAUTHORIZED_REQUEST_DATA,g):e.braintreeError(n.ErrorCode.UNKNOWN,h))},t,"launchDropIn",[c])})}}r.Bridge=a})(e.AndroidBridge||(e.AndroidBridge={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){const r="BraintreeApplePayPlugin";class a{static get(){return window.CdvPurchaseBraintreeApplePay}static requestPayment(c){return new Promise(d=>{var h;if(!((h=a.get())===null||h===void 0)&&h.installed){const m=_=>{d(_)},g=_=>{const v=_??"payment request failed";d(e.braintreeError(n.ErrorCode.PURCHASE,"Braintree+ApplePay ERROR: "+v))};window.cordova.exec(m,g,r,"presentDropInPaymentUI",[c])}else return d(e.braintreeError(n.ErrorCode.SETUP,"cordova-plugin-purchase-braintree-applepay does not appear to be installed."))})}static isSupported(c){return new Promise(d=>{var h;if(n.Utils.platformId()!=="ios")return c.info("BraintreeApplePayPlugin is only available for ios."),d(!1);if(!(!((h=a.get())===null||h===void 0)&&h.installed))return c.info("BraintreeApplePayPlugin does not appear to be installed."),d(!1);try{window.cordova.exec(m=>{d(m)},()=>{c.info("BraintreeApplePayPlugin is not available."),d(!1)},r,"isApplePaySupported",[])}catch{c.info("BraintreeApplePayPlugin is not installed."),d(!1)}})}}t.ApplePayPlugin=a})(e.IosBridge||(e.IosBridge={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){class r{constructor(l,c,d){this.log=l.child("IosBridge"),this.clientTokenProvider=c,this.applePayOptions=d}initialize(l,c){window.cordova.exec(null,null,"BraintreePlugin","setVerbosity",[l.verbosity]),window.cordova.exec(d=>this.log.debug("(Native) "+d),null,"BraintreePlugin","setLogger",[]),setTimeout(()=>c(void 0),0)}continueDropInForApplePay(l,c,d){var h,m,g,_,v,T,I,A,C;return be(this,void 0,void 0,function*(){const L=((m=(h=this.applePayOptions)===null||h===void 0?void 0:h.preparePaymentRequest)===null||m===void 0?void 0:m.call(h,l))||{merchantCapabilities:[n.ApplePay.MerchantCapability.ThreeDS]};if(!L.paymentSummaryItems){const U=l.items.filter($=>$).map(($,se)=>{var D,P,N;return{type:"final",label:($==null?void 0:$.title)||($==null?void 0:$.id)||`Item #${se+1}`,amount:`${Math.round(((N=(P=(D=$==null?void 0:$.pricing)===null||D===void 0?void 0:D.priceMicros)!==null&&P!==void 0?P:l.amountMicros)!==null&&N!==void 0?N:0)/1e4)/100}`}}),z={type:"final",label:(_=(g=this.applePayOptions)===null||g===void 0?void 0:g.companyName)!==null&&_!==void 0?_:"Total",amount:`${Math.round(((v=l.amountMicros)!==null&&v!==void 0?v:0)/1e4)/100}`};L.paymentSummaryItems=[...U,z]}const x=yield t.ApplePayPlugin.requestPayment(L);return this.log.info("Result from Apple Pay: "+JSON.stringify(x)),"isError"in x?x:x.userCancelled?e.braintreeError(n.ErrorCode.PAYMENT_CANCELLED,"User cancelled the payment request"):{paymentMethodNonce:{isDefault:!1,nonce:(I=(T=x.applePayCardNonce)===null||T===void 0?void 0:T.nonce)!==null&&I!==void 0?I:"",type:(C=(A=x.applePayCardNonce)===null||A===void 0?void 0:A.type)!==null&&C!==void 0?C:""},paymentMethodType:d.paymentMethodType,deviceData:d.deviceData,paymentDescription:d.paymentDescription}})}launchDropIn(l,c){return new Promise(d=>be(this,void 0,void 0,function*(){const h=g=>{this.log.info("dropInSuccess: "+JSON.stringify(g)),g.paymentMethodType===e.DropIn.PaymentMethod.APPLE_PAY?(this.log.info("it's an ApplePay request, we have to process it."),this.continueDropInForApplePay(l,c,g).then(d)):d(g)},m=g=>{this.log.info("dropInFailure: "+g);const[_,v]=g.split("|");d(_==="UserCanceledException"?e.braintreeError(n.ErrorCode.PAYMENT_CANCELLED,v):e.braintreeError(n.ErrorCode.UNKNOWN,"ERROR "+_+": "+v))};this.clientTokenProvider(g=>{typeof g=="string"?window.cordova.exec(h,m,"BraintreePlugin","launchDropIn",[g,c]):d(g)})}))}braintreePlugin(){return window.CdvPurchaseBraintree}static isSupported(){return n.Utils.platformId()==="ios"}}t.Bridge=r})(e.IosBridge||(e.IosBridge={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r[r.DISABLED=0]="DISABLED",r[r.OPTIONAL=1]="OPTIONAL",r[r.REQUIRED=2]="REQUIRED"})(t.CardFormFieldStatus||(t.CardFormFieldStatus={}))})(e.DropIn||(e.DropIn={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.GOOGLE_PAY="GOOGLE_PAY",r.LASER="LASER",r.UK_MAESTRO="UK_MAESTRO",r.SWITCH="SWITCH",r.SOLOR="SOLO",r.APPLE_PAY="APPLE_PAY",r.AMEX="AMEX",r.DINERS_CLUB="DINERS_CLUB",r.DISCOVER="DISCOVER",r.JCB="JCB",r.MAESTRO="MAESTRO",r.MASTERCARD="MASTERCARD",r.PAYPAL="PAYPAL",r.VISA="VISA",r.VENMO="VENMO",r.UNIONPAY="UNIONPAY",r.HIPER="HIPER",r.HIPERCARD="HIPERCARD",r.UNKNOWN="UNKNOWN"})(t.PaymentMethod||(t.PaymentMethod={}))})(e.DropIn||(e.DropIn={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r[r.MIN=0]="MIN",r[r.FULL=1]="FULL"})(t.BillingAddressFormat||(t.BillingAddressFormat={})),(function(r){r[r.NOT_CURRENTLY_KNOWN=1]="NOT_CURRENTLY_KNOWN",r[r.ESTIMATED=2]="ESTIMATED",r[r.FINAL=3]="FINAL"})(t.TotalPriceStatus||(t.TotalPriceStatus={}))})(e.GooglePay||(e.GooglePay={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.UNSPECIFIED="00",r.CREDIT="01",r.DEBIT="02"})(t.AccountType||(t.AccountType={})),(function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.SAME_DAY=1]="SAME_DAY",r[r.EXPEDITED=2]="EXPEDITED",r[r.PRIORITY=3]="PRIORITY",r[r.GROUND=4]="GROUND",r[r.ELECTRONIC_DELIVERY=5]="ELECTRONIC_DELIVERY",r[r.SHIP_TO_STORE=6]="SHIP_TO_STORE"})(t.ShippingMethod||(t.ShippingMethod={})),(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2"})(t.Version||(t.Version={}))})(e.ThreeDSecure||(e.ThreeDSecure={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){class t extends n.Transaction{constructor(d,h,m){super(n.Platform.GOOGLE_PLAY,h,m),this.nativePurchase=d,this.refresh(d,!0)}static toState(d,h,m,g){switch(h){case e.Bridge.PurchaseState.PENDING:return n.TransactionState.INITIATED;case e.Bridge.PurchaseState.PURCHASED:return g?n.TransactionState.FINISHED:m?n.TransactionState.APPROVED:d?n.TransactionState.INITIATED:n.TransactionState.APPROVED;case e.Bridge.PurchaseState.UNSPECIFIED_STATE:return n.TransactionState.UNKNOWN_STATE}}refresh(d,h){var m,g;this.nativePurchase=d,this.transactionId=`${d.orderId||d.purchaseToken}`,this.purchaseId=`${d.purchaseToken}`,this.products=d.productIds.map(_=>({id:_})),d.purchaseTime&&(this.purchaseDate=new Date(d.purchaseTime)),this.isPending=d.getPurchaseState===e.Bridge.PurchaseState.PENDING,typeof d.acknowledged<"u"&&(this.isAcknowledged=d.acknowledged),typeof d.consumed<"u"&&(this.isConsumed=d.consumed),typeof d.autoRenewing<"u"&&(this.renewalIntent=d.autoRenewing?n.RenewalIntent.RENEW:n.RenewalIntent.LAPSE),this.state=t.toState(h??!1,d.getPurchaseState,(m=this.isAcknowledged)!==null&&m!==void 0?m:!1,(g=this.isConsumed)!==null&&g!==void 0?g:!1)}}e.Transaction=t;class r extends n.Receipt{constructor(d,h){super(n.Platform.GOOGLE_PLAY,h),this.transactions=[new t(d,this,h)],this.purchaseToken=d.purchaseToken,this.orderId=d.orderId}refreshPurchase(d){var h;(h=this.transactions[0])===null||h===void 0||h.refresh(d),this.orderId=d.orderId}}e.Receipt=r;class a{constructor(d,h=1e3*3600*24){if(this.id=n.Platform.GOOGLE_PLAY,this.name="GooglePlay",this.ready=!1,this.supportsParallelLoading=!1,this._receipts=[],this.bridge=new e.Bridge.Bridge,this.initialized=!1,this.retry=new n.Internal.Retry,this.autoRefreshIntervalMillis=0,a._instance)throw new Error("GooglePlay adapter already initialized");this._products=new e.Products(d.apiDecorators),this.autoRefreshIntervalMillis=h,this.context=d,this.log=d.log.child("GooglePlay"),a._instance=this}get products(){return this._products.products}get receipts(){return this._receipts}get isSupported(){return n.Utils.platformId()==="android"}initialize(){return be(this,void 0,void 0,function*(){return this.log.info("Initialize"),this.initializationPromise?this.initializationPromise:this.initializationPromise=new Promise(d=>{const h=this.log.child("Bridge"),m={onSetPurchases:this.onSetPurchases.bind(this),onPurchasesUpdated:this.onPurchasesUpdated.bind(this),onPurchaseConsumed:this.onPurchaseConsumed.bind(this),showLog:this.context.verbosity>=n.LogLevel.DEBUG,log:v=>h.info(v)},g=()=>{this.log.debug("Ready"),this.autoRefreshIntervalMillis>0&&window.setInterval(()=>this.getPurchases(),this.autoRefreshIntervalMillis),d(void 0)},_=v=>{this.initialized=!1,this.context.error(l(n.ErrorCode.SETUP,"Init failed - "+v,null)),this.retry.retry(()=>this.initialize())};this.bridge.init(g,_,m)})})}getSkusOf(d){const h=[],m=[];for(const g of d)g.type===n.ProductType.PAID_SUBSCRIPTION?m.push(g.id):h.push(g.id);return{inAppSkus:h,subsSkus:m}}loadReceipts(){return new Promise(d=>{this.getPurchases().then(h=>{d(this._receipts)})})}loadProducts(d){return new Promise(h=>{this.log.debug("Load: "+JSON.stringify(d));const m=_=>{if(this.log.debug("Loaded: "+JSON.stringify(_)),!Array.isArray(_)){const T=`Invalid product list received: ${JSON.stringify(_)}, retrying later...`;this.log.warn(T),this.retry.retry(g),this.context.error(l(n.ErrorCode.LOAD,T,null));return}const v=d.map(T=>{const I=_.find(A=>A.productId===T.id);return I&&I.productId?this._products.addProduct(T,I):l(n.ErrorCode.INVALID_PRODUCT_ID,`Product with id ${T.id} not found.`,T.id)});h(v)},g=()=>{const{inAppSkus:_,subsSkus:v}=this.getSkusOf(d);this.log.debug("getAvailableProducts: "+JSON.stringify(_)+" | "+JSON.stringify(v)),this.bridge.getAvailableProducts(_,v,m,T=>{this.retry.retry(g),this.context.error(l(n.ErrorCode.LOAD,"Loading product info failed - "+T+" - retrying later...",null))})};g()})}finish(d){return new Promise(h=>{const m=()=>{d.state!==n.TransactionState.FINISHED&&(d.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[d.parentReceipt])),h(void 0)},g=d.products[0];if(!g)return h(l(n.ErrorCode.FINISH,"Cannot finish a transaction with no product",null));const _=this._products.getProduct(g.id);if(!_)return h(l(n.ErrorCode.FINISH,"Cannot finish transaction, unknown product "+g.id,g.id));const v=this._receipts.find(I=>I.hasTransaction(d));if(!v)return h(l(n.ErrorCode.FINISH,"Cannot finish transaction, linked receipt not found.",_.id));if(!v.purchaseToken)return h(l(n.ErrorCode.FINISH,"Cannot finish transaction, linked receipt contains no purchaseToken.",_.id));const T=(I,A)=>h(l(A||n.ErrorCode.UNKNOWN,I,_.id));if(_.type===n.ProductType.NON_RENEWING_SUBSCRIPTION||_.type===n.ProductType.CONSUMABLE){if(!d.isConsumed)return this.bridge.consumePurchase(m,T,v.purchaseToken)}else if(!d.isAcknowledged)return this.bridge.acknowledgePurchase(m,T,v.purchaseToken);h(void 0)})}onPurchaseConsumed(d){this.log.debug("onPurchaseConsumed: "+d.orderId),d.acknowledged=!0,d.consumed=!0,this.onPurchasesUpdated([d])}onPurchasesUpdated(d){this.log.debug("onPurchaseUpdated: "+d.map(h=>h.orderId).join(", ")),d.forEach(h=>{const m=this.receipts.find(g=>g.purchaseToken===h.purchaseToken);if(m)m.refreshPurchase(h),this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[m]);else{const g=new r(h,this.context.apiDecorators);this.receipts.push(g),this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[g]),g.transactions[0].state===n.TransactionState.INITIATED&&!g.transactions[0].isPending&&(g.refreshPurchase(h),this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[g]))}})}onSetPurchases(d){this.log.debug("onSetPurchases: "+JSON.stringify(d)),this.onPurchasesUpdated(d),this.context.listener.receiptsReady(n.Platform.GOOGLE_PLAY)}onPriceChangeConfirmationResult(d){}getPurchases(){return new Promise(d=>{this.log.debug("getPurchases");const h=()=>{this.log.debug("getPurchases success"),setTimeout(()=>d(void 0),0)},m=(g,_)=>{this.log.warn("getPurchases failed: "+g+" ("+_+")"),setTimeout(()=>d(l(_||n.ErrorCode.UNKNOWN,g,null)),0)};this.bridge.getPurchases(h,m)})}order(d,h){return be(this,void 0,void 0,function*(){return new Promise(m=>{this.log.info("Order - "+JSON.stringify(d));const g=()=>m(void 0),_=(v,T)=>{this.log.warn("Order failed: "+JSON.stringify({message:v,code:T})),m(l(T??n.ErrorCode.UNKNOWN,v,d.productId))};if(d.productType===n.ProductType.PAID_SUBSCRIPTION){const v="token"in d?d.productId+"@"+d.token:d.productId,T=this.findOldPurchaseToken(d.productId,d.productGroup);T&&(h.googlePlay?h.googlePlay.oldPurchaseToken||(h.googlePlay.oldPurchaseToken=T):h.googlePlay={oldPurchaseToken:T}),this.bridge.subscribe(g,_,v,h)}else this.bridge.buy(g,_,d.productId,h)})})}findOldPurchaseToken(d,h){if(!h)return;const m=this._receipts.find(g=>!!g.transactions.find(_=>!!_.products.find(v=>{const T=this._products.getProduct(v.id);return!T||!n.Internal.LocalReceipts.isOwned([g],T)?!1:v.id===d||h&&T.group===h})));return m==null?void 0:m.purchaseToken}receiptValidationBody(d){var h;return be(this,void 0,void 0,function*(){const m=d.transactions[0];if(!m)return;const g=(h=m.products[0])===null||h===void 0?void 0:h.id;if(!g)return;const _=this._products.getProduct(g);if(!_)return;const v=m.nativePurchase;return{id:g,type:_.type,offers:_.offers,products:this._products.products,transaction:{type:n.Platform.GOOGLE_PLAY,id:d.transactions[0].transactionId,purchaseToken:v.purchaseToken,signature:v.signature,receipt:v.receipt}}})}handleReceiptValidationResponse(d,h){var m;return be(this,void 0,void 0,function*(){if(h!=null&&h.ok){const g=(m=h==null?void 0:h.data)===null||m===void 0?void 0:m.transaction;if((g==null?void 0:g.type)!==n.Platform.GOOGLE_PLAY)return;g.kind}})}requestPayment(d,h){return be(this,void 0,void 0,function*(){return l(n.ErrorCode.UNKNOWN,"requestPayment not supported",null)})}manageSubscriptions(){return be(this,void 0,void 0,function*(){this.bridge.manageSubscriptions()})}manageBilling(){return be(this,void 0,void 0,function*(){this.bridge.manageBilling()})}checkSupport(d){return["order","manageBilling","manageSubscriptions"].indexOf(d)>=0}restorePurchases(){return new Promise(d=>{this.bridge.getPurchases(()=>d(void 0),(h,m)=>{this.log.warn("getPurchases() failed: "+(m??"ERROR")+": "+h),d(l(m??n.ErrorCode.UNKNOWN,h,null))})})}}a.trimProductTitles=!0,e.Adapter=a;function l(c,d,h){return n.storeError(c,d,n.Platform.GOOGLE_PLAY,h)}})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.FINITE_RECURRING="FINITE_RECURRING",r.INFINITE_RECURRING="INFINITE_RECURRING",r.NON_RECURRING="NON_RECURRING"})(t.RecurrenceMode||(t.RecurrenceMode={}))})(e.Bridge||(e.Bridge={}))})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){t.IMMEDIATE_WITH_TIME_PRORATION="IMMEDIATE_WITH_TIME_PRORATION",t.IMMEDIATE_AND_CHARGE_PRORATED_PRICE="IMMEDIATE_AND_CHARGE_PRORATED_PRICE",t.IMMEDIATE_WITHOUT_PRORATION="IMMEDIATE_WITHOUT_PRORATION",t.DEFERRED="DEFERRED",t.IMMEDIATE_AND_CHARGE_FULL_PRICE="IMMEDIATE_AND_CHARGE_FULL_PRICE"})(e.ProrationMode||(e.ProrationMode={})),(function(t){t.WITH_TIME_PRORATION="IMMEDIATE_WITH_TIME_PRORATION",t.CHARGE_PRORATED_PRICE="IMMEDIATE_AND_CHARGE_PRORATED_PRICE",t.WITHOUT_PRORATION="IMMEDIATE_WITHOUT_PRORATION",t.DEFERRED="DEFERRED",t.CHARGE_FULL_PRICE="IMMEDIATE_AND_CHARGE_FULL_PRICE"})(e.ReplacementMode||(e.ReplacementMode={})),(function(t){let r=function(m){console.log("InAppBilling[js]: "+m)};(function(h){h[h.UNSPECIFIED_STATE=0]="UNSPECIFIED_STATE",h[h.PURCHASED=1]="PURCHASED",h[h.PENDING=2]="PENDING"})(t.PurchaseState||(t.PurchaseState={}));class a{constructor(){this.options={}}init(m,g,_){_||(_={}),_.log&&(r=_.log),this.options={showLog:_.showLog!==!1,onPurchaseConsumed:_.onPurchaseConsumed,onPurchasesUpdated:_.onPurchasesUpdated,onSetPurchases:_.onSetPurchases},this.options.showLog&&r("setup ok");const v=this.listener.bind(this);window.cordova.exec(v,function(T){},"InAppBillingPlugin","setListener",[]),window.cordova.exec(m,l(g),"InAppBillingPlugin","init",[])}load(m,g,_,v,T){if(typeof _<"u"&&(typeof _=="string"&&(_=[_]),_.length>0)){if(typeof _[0]!="string"){var I="invalid productIds: "+JSON.stringify(_);this.options.showLog&&r(I),g(I,n.ErrorCode.INVALID_PRODUCT_ID);return}this.options.showLog&&r("load "+JSON.stringify(_))}window.cordova.exec(m,l(g),"InAppBillingPlugin","load",[_,v,T])}listener(m){this.options.showLog&&r("listener: "+JSON.stringify(m)),!(!m||!m.type)&&(m.type==="setPurchases"&&this.options.onSetPurchases&&this.options.onSetPurchases(m.data.purchases),m.type==="purchasesUpdated"&&this.options.onPurchasesUpdated&&this.options.onPurchasesUpdated(m.data.purchases),m.type==="purchaseConsumed"&&this.options.onPurchaseConsumed&&this.options.onPurchaseConsumed(m.data.purchase),m.type==="onPriceChangeConfirmationResultOK"&&this.options.onPriceChangeConfirmationResult&&this.options.onPriceChangeConfirmationResult("OK"),m.type==="onPriceChangeConfirmationResultUserCanceled"&&this.options.onPriceChangeConfirmationResult&&this.options.onPriceChangeConfirmationResult("UserCanceled"),m.type==="onPriceChangeConfirmationResultUnknownSku"&&this.options.onPriceChangeConfirmationResult&&this.options.onPriceChangeConfirmationResult("UnknownProduct"))}getPurchases(m,g){return this.options.showLog&&r("getPurchases()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","getPurchases",["null"])}buy(m,g,_,v){return this.options.showLog&&r("buy()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","buy",[_,d(v)])}subscribe(m,g,_,v){var T;return this.options.showLog&&r("subscribe()"),!((T=v.googlePlay)===null||T===void 0)&&T.oldPurchaseToken&&this.options.showLog&&r("subscribe() -> upgrading from an old purchase"),window.cordova.exec(m,l(g),"InAppBillingPlugin","subscribe",[_,d(v)])}consumePurchase(m,g,_){return this.options.showLog&&r("consumePurchase()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","consumePurchase",[_])}acknowledgePurchase(m,g,_){return this.options.showLog&&r("acknowledgePurchase()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","acknowledgePurchase",[_])}getAvailableProducts(m,g,_,v){return this.options.showLog&&r("getAvailableProducts()"),window.cordova.exec(_,l(v),"InAppBillingPlugin","getAvailableProducts",[m,g])}manageSubscriptions(){return window.cordova.exec(function(){},function(){},"InAppBillingPlugin","manageSubscriptions",[])}manageBilling(){return window.cordova.exec(function(){},function(){},"InAppBillingPlugin","manageBilling",[])}launchPriceChangeConfirmationFlow(m){return window.cordova.exec(function(){},function(){},"InAppBillingPlugin","launchPriceChangeConfirmationFlow",[m])}}t.Bridge=a;function l(h){return function(m){if(!h)return;const g=typeof m=="string"?m.split("|"):[];if(g.length>1&&/^[-+]?(\d+)$/.test(g[0])){var _=g[0],v=g[1];h(v,+_)}else h(m)}}function c(h){return h&&h.constructor===Object?h:{}}function d(h){const m=c(h==null?void 0:h.googlePlay);return!m.accountId&&(h!=null&&h.applicationUsername)&&(m.accountId=n.Utils.md5(h.applicationUsername)),m}})(e.Bridge||(e.Bridge={}))})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){class t extends n.Product{}e.GProduct=t;class r extends n.Offer{constructor(){super(...arguments),this.type="inapp"}}e.InAppOffer=r;class a extends n.Offer{constructor(d,h){super(d,h),this.type="subs",this.tags=d.tags,this.token=d.token}}e.SubscriptionOffer=a;class l{constructor(d){this.products=[],this.offers=[],this.decorator=d}getProduct(d){return this.products.find(h=>h.id===d)}getOffer(d){return this.offers.find(h=>h.id===d)}addProduct(d,h){const m=this.getProduct(d.id),g=m??new t(d,this.decorator);return g.title=h.title||h.name||g.title,e.Adapter.trimProductTitles&&(g.title=g.title.replace(/ \(.*\)$/,"")),g.description=h.description||g.description,"product_format"in h&&h.product_format==="v12.0"?h.product_type==="subs"?this.onSubsV12Loaded(g,h):this.onInAppLoaded(g,h):this.onInAppLoaded(g,h),m||this.products.push(g),g}onSubsV12Loaded(d,h){h.offers.forEach(g=>{const _=g.pricing_phases.slice(-1)[0];if((_==null?void 0:_.recurrence_mode)===n.RecurrenceMode.FINITE_RECURRING){const T=m(g.base_plan_id);T&&T!==g&&g.pricing_phases.push(...T.pricing_phases)}const v=this.iabSubsOfferV12Loaded(d,h,g);d.addOffer(v)});function m(g){if(!g)return null;for(const _ of h.offers)if(_.base_plan_id===g&&!_.offer_id)return _;return null}return d}makeOfferId(d,h){return h.base_plan_id?h.offer_id?d+"@"+h.base_plan_id+"@"+h.offer_id:d+"@"+h.base_plan_id:d+"@"+h.token}iabSubsOfferV12Loaded(d,h,m){const g=this.makeOfferId(h.productId,m),_=this.getOffer(g),v=m.pricing_phases.map(T=>this.toPricingPhase(T));if(_)return _.pricingPhases=v,_;{const T=new a({id:g,product:d,pricingPhases:v,token:m.token,tags:m.tags},this.decorator);return this.offers.push(T),T}}onInAppLoaded(d,h){var m,g,_,v;const T=this.getOffer(h.productId),I=[{price:(g=(m=h.formatted_price)!==null&&m!==void 0?m:h.price)!==null&&g!==void 0?g:`${((_=h.price_amount_micros)!==null&&_!==void 0?_:0)/1e6} ${h.price_currency_code}`,priceMicros:(v=h.price_amount_micros)!==null&&v!==void 0?v:0,currency:h.price_currency_code,recurrenceMode:n.RecurrenceMode.NON_RECURRING}];if(T)T.pricingPhases=I,d.offers=[T];else{const A=new r({id:h.productId,product:d,pricingPhases:I},this.decorator);this.offers.push(A),d.offers=[A]}return d}toPaymentMode(d){return d.price_amount_micros===0?n.PaymentMode.FREE_TRIAL:d.recurrence_mode===e.Bridge.RecurrenceMode.NON_RECURRING?n.PaymentMode.UP_FRONT:n.PaymentMode.PAY_AS_YOU_GO}toRecurrenceMode(d){switch(d){case e.Bridge.RecurrenceMode.FINITE_RECURRING:return n.RecurrenceMode.FINITE_RECURRING;case e.Bridge.RecurrenceMode.INFINITE_RECURRING:return n.RecurrenceMode.INFINITE_RECURRING;case e.Bridge.RecurrenceMode.NON_RECURRING:return n.RecurrenceMode.NON_RECURRING}}toPricingPhase(d){return{price:d.formatted_price,priceMicros:d.price_amount_micros,currency:d.price_currency_code,billingPeriod:d.billing_period,billingCycles:d.billing_cycle_count,recurrenceMode:this.toRecurrenceMode(d.recurrence_mode),paymentMode:this.toPaymentMode(d)}}}e.Products=l})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.SUBSCRIPTION_NO_LONGER_AVAILABLE="subscriptionPurchaseNoLongerAvailable",r.PURCHASE_TOKEN_NO_LONGER_VALID="purchaseTokenNoLongerValid"})(t.GoogleErrorReason||(t.GoogleErrorReason={})),(function(r){r[r.GONE=410]="GONE"})(t.ErrorCode||(t.ErrorCode={}))})(e.PublisherAPI||(e.PublisherAPI={}))})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){const t=n.Platform.TEST;let r=[];function a(d){d.products.forEach(h=>{var m,g,_,v;const T=r.find(A=>h.id===A.id),I={id:h.id,purchaseDate:(m=d.purchaseDate)===null||m===void 0?void 0:m.getTime(),expiryDate:(g=d.expirationDate)===null||g===void 0?void 0:g.getTime(),lastRenewalDate:(_=d.lastRenewalDate)===null||_===void 0?void 0:_.getTime(),renewalIntent:d.renewalIntent,renewalIntentChangeDate:(v=d.renewalIntentChangeDate)===null||v===void 0?void 0:v.getTime()};T?Object.assign(T,I):r.push(I)})}class l{constructor(h){this.id=n.Platform.TEST,this.name="Test",this.ready=!1,this.products=[],this.receipts=[],this.supportsParallelLoading=!0,this.context=h,this.log=h.log.child("Test")}get isSupported(){return!0}initialize(){return be(this,void 0,void 0,function*(){})}loadReceipts(){return be(this,void 0,void 0,function*(){return new Promise(h=>{setTimeout(()=>{this.context.listener.receiptsReady(n.Platform.TEST),h(this.receipts)},600)})})}loadProducts(h){return be(this,void 0,void 0,function*(){return h.map(m=>{if(!e.testProductsArray.find(v=>v.id===m.id&&v.type===m.type))return c(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"This product is not available",m.id);const g=this.products.find(v=>v.id===m.id);if(g)return g;m.id===e.testProducts.PAID_SUBSCRIPTION_ACTIVE.id&&setTimeout(()=>{this.reportActiveSubscription()},500);const _=e.initTestProduct(m.id,this.context.apiDecorators);return _?(this.products.push(_),this.context.listener.productsUpdated(n.Platform.TEST,[_]),_):c(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"Could not load this product",m.id)})})}order(h){return be(this,void 0,void 0,function*(){if(h.id.indexOf("-fail-")>0)return c(n.ErrorCode.PURCHASE,"Purchase failed.",h.productId);const m=this.products.find(T=>T.id===h.productId);if(!n.Internal.LocalReceipts.canPurchase(this.receipts,m))return c(n.ErrorCode.PURCHASE,"Product already owned",h.productId);const g=prompt(`Do you want to purchase ${h.productId} for ${h.pricingPhases[0].price}?
Enter "Y" to confirm.
Enter "E" to fail with an error.Anything else to cancel.`);if((g==null?void 0:g.toUpperCase())==="E")return c(n.ErrorCode.PURCHASE,"Purchase failed",h.productId);if((g==null?void 0:g.toUpperCase())!=="Y")return c(n.ErrorCode.PAYMENT_CANCELLED,"Purchase flow has been cancelled by the user",h.productId);const _=new n.Receipt(t,this.context.apiDecorators),v=new n.Transaction(t,_,this.context.apiDecorators);_.transactions=[v],v.products=[{id:h.productId,offerId:h.id}],v.state=n.TransactionState.APPROVED,v.purchaseDate=new Date,v.transactionId=h.productId+"-"+new Date().getTime(),v.isAcknowledged=!1,h.productType===n.ProductType.PAID_SUBSCRIPTION&&(v.expirationDate=new Date(+new Date+6048e5),v.renewalIntent=n.RenewalIntent.RENEW),a(v),this.receipts.push(_),this.context.listener.receiptsUpdated(n.Platform.TEST,[_])})}finish(h){return new Promise(m=>{setTimeout(()=>{h.state=n.TransactionState.FINISHED,h.isAcknowledged=!0,a(h);const g=this.products.find(v=>h.products[0].id===v.id);(g==null?void 0:g.type)===n.ProductType.CONSUMABLE&&(h.isConsumed=!0);const _=this.receipts.filter(v=>v.hasTransaction(h));this.context.listener.receiptsUpdated(t,_),m(void 0)},500)})}receiptValidationBody(h){return be(this,void 0,void 0,function*(){})}handleReceiptValidationResponse(h,m){return be(this,void 0,void 0,function*(){})}requestPayment(h,m){var g;return be(this,void 0,void 0,function*(){yield n.Utils.asyncDelay(100);const _=prompt(`Mock payment of ${((g=h.amountMicros)!==null&&g!==void 0?g:0)/1e6} ${h.currency}. Enter "Y" to confirm. Enter "E" to trigger an error.`);if((_==null?void 0:_.toUpperCase())==="E")return c(n.ErrorCode.PAYMENT_NOT_ALLOWED,"Payment not allowed",null);if((_==null?void 0:_.toUpperCase())!=="Y")return;const v=new n.Receipt(t,this.context.apiDecorators),T=new n.Transaction(n.Platform.TEST,v,this.context.apiDecorators);return T.purchaseDate=new Date,T.products=h.items.filter(I=>I).map(I=>({id:(I==null?void 0:I.id)||""})),T.state=n.TransactionState.APPROVED,T.transactionId="payment-"+new Date().getTime(),T.amountMicros=h.amountMicros,T.currency=h.currency,v.transactions=[T],this.receipts.push(v),setTimeout(()=>{this.context.listener.receiptsUpdated(t,[v])},400),T})}manageSubscriptions(){return be(this,void 0,void 0,function*(){alert("Pseudo subscription management interface. Close it when you are done.")})}manageBilling(){return be(this,void 0,void 0,function*(){alert("Pseudo billing management interface. Close it when you are done.")})}reportActiveSubscription(){if(this.receipts.find(T=>T.transactions[0].transactionId===_(1)))return;const h=2*6e4,m=new n.Receipt(t,this.context.apiDecorators),g=T=>{var I,A;const C=new n.Transaction(t,m,this.context.apiDecorators);C.products=[{id:e.testProducts.PAID_SUBSCRIPTION_ACTIVE.id,offerId:e.testProducts.PAID_SUBSCRIPTION_ACTIVE.extra.offerId}],C.state=n.TransactionState.APPROVED,C.transactionId=_(T),C.isAcknowledged=T==1,C.renewalIntent=n.RenewalIntent.RENEW;const L=+(((A=(I=m==null?void 0:m.transactions)===null||I===void 0?void 0:I[0])===null||A===void 0?void 0:A.purchaseDate)||new Date);return C.purchaseDate=new Date(L),C.lastRenewalDate=new Date(L+h*(T-1)),C.expirationDate=new Date(L+h*T),a(C),C};m.transactions.push(g(1)),this.receipts.push(m),this.context.listener.receiptsUpdated(n.Platform.TEST,[m]);function _(T){return"test-active-subscription-transaction-"+T}let v=1;setInterval(()=>{this.log.info("auto-renewing the mock subscription"),v+=1,m.transactions.push(g(v)),this.context.listener.receiptsUpdated(n.Platform.TEST,[m])},h)}static verify(h,m){setTimeout(()=>{var g,_;m({receipt:h,payload:{ok:!0,data:{id:(_=(g=h.transactions[0])===null||g===void 0?void 0:g.products[0])===null||_===void 0?void 0:_.id,latest_receipt:!0,transaction:{type:"test"},collection:r}}})},500)}checkSupport(h){return!0}restorePurchases(){return be(this,void 0,void 0,function*(){})}}e.Adapter=l;function c(d,h,m){return n.storeError(d,h,n.Platform.TEST,m)}})(n.Test||(n.Test={}))})(H||(H={}));var H;(function(n){(function(e){const t=n.Platform.TEST;e.testProducts={CONSUMABLE:{platform:t,id:"test-consumable",type:n.ProductType.CONSUMABLE},CONSUMABLE_FAILING:{platform:t,id:"test-consumable-fail",type:n.ProductType.CONSUMABLE},NON_CONSUMABLE:{platform:t,id:"test-non-consumable",type:n.ProductType.NON_CONSUMABLE},PAID_SUBSCRIPTION:{platform:t,id:"test-subscription",type:n.ProductType.PAID_SUBSCRIPTION},PAID_SUBSCRIPTION_ACTIVE:{platform:t,id:"test-subscription-active",type:n.ProductType.PAID_SUBSCRIPTION,extra:{offerId:"test-paid-subscription-active-offer1"}}},e.testProductsArray=n.Utils.objectValues(e.testProducts);function r(a,l){const c=Object.keys(e.testProducts).find(h=>e.testProducts[h]&&e.testProducts[h].id===a);if(!c)return;const d=new n.Product(e.testProducts[c],l);switch(c){case"CONSUMABLE":d.title="Test Consumable",d.description="A consumable product that you can purchase",d.addOffer(new n.Offer({id:"test-consumable-offer1",pricingPhases:[{price:"$4.99",currency:"USD",priceMicros:499e4,paymentMode:n.PaymentMode.UP_FRONT,recurrenceMode:n.RecurrenceMode.NON_RECURRING}],product:d},l));break;case"CONSUMABLE_FAILING":d.title="Failing Consumable",d.description="A consumable product that cannot be purchased",d.addOffer(new n.Offer({id:"test-consumable-fail-offer1",pricingPhases:[{price:"$1.99",currency:"USD",priceMicros:199e4,paymentMode:n.PaymentMode.UP_FRONT,recurrenceMode:n.RecurrenceMode.NON_RECURRING}],product:d},l));break;case"NON_CONSUMABLE":d.title="Non Consumable",d.description="A non consumable product",d.addOffer(new n.Offer({id:"test-non-consumable-offer1",pricingPhases:[{price:"$9.99",currency:"USD",priceMicros:999e4,paymentMode:n.PaymentMode.UP_FRONT,recurrenceMode:n.RecurrenceMode.NON_RECURRING}],product:d},l));break;case"PAID_SUBSCRIPTION":d.title="A subscription product",d.description="An auto-renewing paid subscription with a trial period",d.addOffer(new n.Offer({id:"test-paid-subscription-offer1",product:d,pricingPhases:[{price:"$0.00",currency:"USD",priceMicros:0,paymentMode:n.PaymentMode.FREE_TRIAL,recurrenceMode:n.RecurrenceMode.FINITE_RECURRING,billingCycles:3,billingPeriod:"P1W"},{price:"$4.99",currency:"USD",priceMicros:499e4,paymentMode:n.PaymentMode.PAY_AS_YOU_GO,recurrenceMode:n.RecurrenceMode.INFINITE_RECURRING,billingPeriod:"P1M"}]},l));break;case"PAID_SUBSCRIPTION_ACTIVE":d.title="An owned subscription product",d.description="An active paid subscription",d.addOffer(new n.Offer({id:e.testProducts.PAID_SUBSCRIPTION_ACTIVE.extra.offerId,product:d,pricingPhases:[{price:"$19.99",currency:"USD",priceMicros:1999e4,paymentMode:n.PaymentMode.PAY_AS_YOU_GO,recurrenceMode:n.RecurrenceMode.INFINITE_RECURRING,billingPeriod:"P1Y"}]},l));break;default:const h=c;throw new Error(`Unhandled enum case: ${h}`)}return d}e.initTestProduct=r})(n.Test||(n.Test={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.id=n.Platform.WINDOWS_STORE,this.name="WindowsStore",this.ready=!1,this.supportsParallelLoading=!1,this.products=[],this.receipts=[]}initialize(){return be(this,void 0,void 0,function*(){})}get isSupported(){return!1}loadProducts(l){return be(this,void 0,void 0,function*(){return l.map(c=>r(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"TODO",c.id))})}loadReceipts(){return be(this,void 0,void 0,function*(){return[]})}order(l){return be(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"TODO: Not implemented",l.productId)})}finish(l){return be(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"TODO: Not implemented",null)})}handleReceiptValidationResponse(l,c){return be(this,void 0,void 0,function*(){})}receiptValidationBody(l){return be(this,void 0,void 0,function*(){})}requestPayment(l,c){return be(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"requestPayment not supported",null)})}manageSubscriptions(){return be(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"manageSubscriptions not supported",null)})}manageBilling(){return be(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"manageBilling not supported",null)})}checkSupport(l){return!1}restorePurchases(){return be(this,void 0,void 0,function*(){})}}e.Adapter=t;function r(a,l,c){return n.storeError(a,l,n.Platform.WINDOWS_STORE,c)}})(n.WindowsStore||(n.WindowsStore={}))})(H||(H={}));var H;(function(n){(function(e){let t;(function(l){l.HTTP_REQUEST_TIMEOUT=408})(t=e.Ajax||(e.Ajax={}));function r(l,c){if(typeof window<"u"&&window.cordova&&window.cordova.plugin&&window.cordova.plugin.http)return a(l,c);var d=function(){},h=new XMLHttpRequest;c.timeout&&(h.timeout=c.timeout,h.ontimeout=function(){l.warn("ajax -> request to "+c.url+" timeout"),e.callExternal(l,"ajax.error",c.error,t.HTTP_REQUEST_TIMEOUT,"Timeout")}),h.open(c.method||"POST",c.url,!0),h.onreadystatechange=function(){try{h.readyState===4&&(h.status===200?e.callExternal(l,"ajax.success",c.success,JSON.parse(h.responseText)):(l.warn("ajax -> request to "+c.url+" failed with status "+h.status+" ("+h.statusText+")"),e.callExternal(l,"ajax.error",c.error,h.status,h.statusText)))}catch(g){l.warn("ajax -> request to "+c.url+" failed with an exception: "+g.message),c.error&&c.error(417,g.message,null)}h.readyState===4&&e.callExternal(l,"ajax.done",d)};const m=c.customHeaders;return m&&Object.keys(m).forEach(function(g){l.debug("ajax -> adding custom header: "+g),h.setRequestHeader(g,m[g])}),h.setRequestHeader("Accept","application/json"),l.debug("ajax -> send request to "+c.url),c.data?(h.setRequestHeader("Content-Type","application/json;charset=UTF-8"),h.send(JSON.stringify(c.data))):h.send(),{done:function(g){return d=g,this}}}e.ajax=r;function a(l,c){let d=function(){};const h={method:(c.method||"get").toLowerCase(),data:c.data,serializer:"json"};c.customHeaders&&(l.debug("ajax[http] -> adding custom headers: "+JSON.stringify(c.customHeaders)),h.headers=c.customHeaders),l.debug("ajax[http] -> send request to "+c.url);const m=g=>{try{g.status==200?e.callExternal(l,"ajax.success",c.success,JSON.parse(g.data)):(l.warn("ajax[http] -> request to "+c.url+" failed with status "+g.status+" ("+g.error+")"),e.callExternal(l,"ajax.error",c.error,g.status,g.error))}catch(_){l.warn("ajax[http] -> request to "+c.url+" failed with an exception: "+_.message),c.error&&e.callExternal(l,"ajax.error",c.error,417,_.message)}e.callExternal(l,"ajax.done",d)};return window.cordova.plugin.http.sendRequest(c.url,h,m,m),{done:function(g){return d=g,this}}}})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(r,a,l,...c){try{const d=Array.prototype.slice.call(arguments,3);l&&l.apply(n.store,d)}catch(d){r.logCallbackException(a,d)}}e.callExternal=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(c,d){return setTimeout(c,d)}e.delay=t;function r(c,d){return a(c,d).call}e.debounce=r;function a(c,d){let h=null,m=[];const g=function(v,T){const I=m;m=[],h=null,c(),I.forEach(A=>A())};return{call:function(){h&&window.clearTimeout(h),h=setTimeout(g,d)},wait:()=>new Promise(v=>{h?m.push(v):v()})}}e.createDebouncer=a;function l(c){return new Promise(d=>setTimeout(d,c))}e.asyncDelay=l})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(a){switch(r(a)){case n.RecurrenceMode.FINITE_RECURRING:return`${a.billingCycles}x ${e.formatDurationEN(a.billingPeriod)}`;case n.RecurrenceMode.NON_RECURRING:return"for "+e.formatDurationEN(a.billingPeriod);default:return"every "+e.formatDurationEN(a.billingPeriod,{omitOne:!0})}}e.formatBillingCycleEN=t;function r(a){var l;const c=(l=a.billingCycles)!==null&&l!==void 0?l:0;if(a.recurrenceMode===n.RecurrenceMode.FINITE_RECURRING){if(c==1)return n.RecurrenceMode.NON_RECURRING;if(c<=0)return n.RecurrenceMode.INFINITE_RECURRING}return a.recurrenceMode}})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(r,a){if(!r)return"";const l=r.length,c=r.slice(1,l-1);if(c==="1")return a!=null&&a.omitOne?{D:"day",W:"week",M:"month",Y:"year"}[r[l-1]]||r[l-1]:{D:"1 day",W:"1 week",M:"1 month",Y:"1 year"}[r[l-1]]||r[l-1];{const d={D:"days",W:"weeks",M:"months",Y:"years"}[r[l-1]]||r[l-1];return`${c} ${d}`}}e.formatDurationEN=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){const t="0123456789abcdef".split("");function r(A){for(var C="",L=0;L<4;L++)C+=t[A>>8*L+4&15]+t[A>>8*L&15];return C}function a(A){const C=[];for(var L=A.length,x=0;x<L;x++)C.push(r(A[x]));return C.join("")}function l(A,C){return A+C&4294967295}function c(A,C,L,x,U,z,$){function se(P,N,M){return l(P<<N|P>>>32-N,M)}function D(P,N,M,B){return l(l(N,P),l(M,B))}return se(D(A,C,x,z),U,L)}var d=function(A,C,L,x,U,z,$,se){return c(L&x|~L&U,C,L,z,$,se)},h=function(A,C,L,x,U,z,$,se){return c(L&U|x&~U,C,L,z,$,se)},m=function(A,C,L,x,U,z,$,se){return c(L^x^U,C,L,z,$,se)},g=function(A,C,L,x,U,z,$,se){return c(x^(L|~U),C,L,z,$,se)};function _(A,C,L){L||(L=l);let x=A[0],U=A[1],z=A[2],$=A[3];var se=d.bind(null,L);x=se(x,U,z,$,C[0],7,-680876936),$=se($,x,U,z,C[1],12,-389564586),z=se(z,$,x,U,C[2],17,606105819),U=se(U,z,$,x,C[3],22,-1044525330),x=se(x,U,z,$,C[4],7,-176418897),$=se($,x,U,z,C[5],12,1200080426),z=se(z,$,x,U,C[6],17,-1473231341),U=se(U,z,$,x,C[7],22,-45705983),x=se(x,U,z,$,C[8],7,1770035416),$=se($,x,U,z,C[9],12,-1958414417),z=se(z,$,x,U,C[10],17,-42063),U=se(U,z,$,x,C[11],22,-1990404162),x=se(x,U,z,$,C[12],7,1804603682),$=se($,x,U,z,C[13],12,-40341101),z=se(z,$,x,U,C[14],17,-1502002290),U=se(U,z,$,x,C[15],22,1236535329);var D=h.bind(null,L);x=D(x,U,z,$,C[1],5,-165796510),$=D($,x,U,z,C[6],9,-1069501632),z=D(z,$,x,U,C[11],14,643717713),U=D(U,z,$,x,C[0],20,-373897302),x=D(x,U,z,$,C[5],5,-701558691),$=D($,x,U,z,C[10],9,38016083),z=D(z,$,x,U,C[15],14,-660478335),U=D(U,z,$,x,C[4],20,-405537848),x=D(x,U,z,$,C[9],5,568446438),$=D($,x,U,z,C[14],9,-1019803690),z=D(z,$,x,U,C[3],14,-187363961),U=D(U,z,$,x,C[8],20,1163531501),x=D(x,U,z,$,C[13],5,-1444681467),$=D($,x,U,z,C[2],9,-51403784),z=D(z,$,x,U,C[7],14,1735328473),U=D(U,z,$,x,C[12],20,-1926607734);var P=m.bind(null,L);x=P(x,U,z,$,C[5],4,-378558),$=P($,x,U,z,C[8],11,-2022574463),z=P(z,$,x,U,C[11],16,1839030562),U=P(U,z,$,x,C[14],23,-35309556),x=P(x,U,z,$,C[1],4,-1530992060),$=P($,x,U,z,C[4],11,1272893353),z=P(z,$,x,U,C[7],16,-155497632),U=P(U,z,$,x,C[10],23,-1094730640),x=P(x,U,z,$,C[13],4,681279174),$=P($,x,U,z,C[0],11,-358537222),z=P(z,$,x,U,C[3],16,-722521979),U=P(U,z,$,x,C[6],23,76029189),x=P(x,U,z,$,C[9],4,-640364487),$=P($,x,U,z,C[12],11,-421815835),z=P(z,$,x,U,C[15],16,530742520),U=P(U,z,$,x,C[2],23,-995338651);var N=g.bind(null,L);x=N(x,U,z,$,C[0],6,-198630844),$=N($,x,U,z,C[7],10,1126891415),z=N(z,$,x,U,C[14],15,-1416354905),U=N(U,z,$,x,C[5],21,-57434055),x=N(x,U,z,$,C[12],6,1700485571),$=N($,x,U,z,C[3],10,-1894986606),z=N(z,$,x,U,C[10],15,-1051523),U=N(U,z,$,x,C[1],21,-2054922799),x=N(x,U,z,$,C[8],6,1873313359),$=N($,x,U,z,C[15],10,-30611744),z=N(z,$,x,U,C[6],15,-1560198380),U=N(U,z,$,x,C[13],21,1309151649),x=N(x,U,z,$,C[4],6,-145523070),$=N($,x,U,z,C[11],10,-1120210379),z=N(z,$,x,U,C[2],15,718787259),U=N(U,z,$,x,C[9],21,-343485551),A[0]=L(x,A[0]),A[1]=L(U,A[1]),A[2]=L(z,A[2]),A[3]=L($,A[3])}function v(A){for(var C=[],L=0;L<64;L+=4)C[L>>2]=A.charCodeAt(L)+(A.charCodeAt(L+1)<<8)+(A.charCodeAt(L+2)<<16)+(A.charCodeAt(L+3)<<24);return C}function T(A,C){let L;const x=A.length,U=[1732584193,-271733879,-1732584194,271733878];for(L=64;L<=x;L+=64)_(U,v(A.substring(L-64,L)),C);const z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$=(A=A.substring(L-64)).length;let se;for(se=0;se<$;se++)z[se>>2]|=A.charCodeAt(se)<<(se%4<<3);if(z[se>>2]|=128<<(se%4<<3),se>55)for(_(U,z,C),se=16;se--;)z[se]=0;return z[14]=8*x,_(U,z,C),U}function I(A){if(!A)return"";let C;return a(T("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(C=function(L,x){const U=(65535&L)+(65535&x);return(L>>16)+(x>>16)+(U>>16)<<16|65535&U}),a(T(A,C))}e.md5=I})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(){var r,a,l;return!((r=window.cordova)===null||r===void 0)&&r.platformId?(a=window.cordova)===null||a===void 0?void 0:a.platformId:!((l=window.Capacitor)===null||l===void 0)&&l.getPlatform?window.Capacitor.getPlatform():"web"}e.platformId=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(a,l,c,d,h){return function(m){r(a,l,c,m,d,h)}}e.safeCallback=t;function r(a,l,c,d,h,m){c&&(h||(h=c.name||"#"+e.md5(c.toString())),setTimeout(()=>{try{a.debug(`Calling callback: type=${l} name=${h} reason=${m}`),c(d)}catch(g){a.error(`Error in callback: type=${l} name=${h} reason=${m}`),a.debug(c.toString());const _=g;"message"in _&&a.error(_.message),"fileName"in g&&a.error("in "+g.fileName+":"+g.lineNumber),"stack"in _&&a.error(_.stack)}},0))}e.safeCall=r})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(){return window.crypto||window.msCrypto}function r(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,function(a){return(a^t().getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16)})}e.uuidv4=r})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){function r(d){return Object.prototype.toString.call(d)==="[object Array]"}function a(d){return Object.prototype.toString.call(d)==="[object Object]"}function l(d){return typeof d.validator_privacy_policy=="string"?d.validator_privacy_policy.split(","):r(d.validator_privacy_policy)?d.validator_privacy_policy:["analytics","support","fraud"]}function c(d){const h=l(d);function m(I){return h.indexOf(I)>=0}const g={plugin:"cordova-plugin-purchase/"+n.PLUGIN_VERSION},_=window,v=a(_.device)?_.device:{};if(m("analytics")||m("support")){const I=_.Ionic||_.ionic;I&&I.version&&(g.ionic=I.version),v.cordova&&(g.cordova=v.cordova),v.model&&(g.model=v.model),v.platform&&(g.platform=v.platform),v.version&&(g.version=v.version),v.manufacturer&&(g.manufacturer=v.manufacturer)}if(m("tracking")&&(v.serial&&(g.serial=v.serial),v.uuid&&(g.uuid=v.uuid)),v.isVirtual&&(g.isVirtual=v.isVirtual),m("fraud")){var T="";v.serial?T="serial:"+v.serial:v.uuid?T="uuid:"+v.uuid:(v.model&&(T+="/"+v.model),v.manufacturer&&(T="/"+v.manufacturer)),T&&(g.fingerprint=n.Utils.md5(T))}return g}t.getDeviceInfo=c})(e.Internal||(e.Internal={}))})(n.Validator||(n.Validator={}))})(H||(H={}));var H;(function(n){(function(e){e.Request||(e.Request={})})(n.Validator||(n.Validator={}))})(H||(H={}));var H;(function(n){class e{constructor(r,a,l){var c;this.className="VerifiedReceipt",this.id=a.id,this.sourceReceipt=r,this.collection=(c=a.collection)!==null&&c!==void 0?c:[],this.latestReceipt=a.latest_receipt,this.nativeTransactions=[a.transaction],this.warning=a.warning,this.validationDate=a.date?new Date(a.date):new Date,Object.defineProperty(this,"raw",{enumerable:!1,get(){return a}}),Object.defineProperty(this,"finish",{enumerable:!1,get(){return()=>l.finish(this)}})}get platform(){return this.sourceReceipt.platform}get raw(){return{}}set(r,a){var l;this.id=a.id,this.sourceReceipt=r,this.collection=(l=a.collection)!==null&&l!==void 0?l:[],this.latestReceipt=a.latest_receipt,this.nativeTransactions=[a.transaction],this.warning=a.warning}finish(){return be(this,void 0,void 0,function*(){})}}n.VerifiedReceipt=e})(H||(H={}));function Ew(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var up={exports:{}},wc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv;function OI(){if(Kv)return wc;Kv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:n,type:r,key:c,ref:a!==void 0?a:null,props:l}}return wc.Fragment=e,wc.jsx=t,wc.jsxs=t,wc}var Wv;function xI(){return Wv||(Wv=1,up.exports=OI()),up.exports}var S=xI(),dp={exports:{}},Xe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qv;function DI(){if(Qv)return Xe;Qv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),v=Symbol.iterator;function T(j){return j===null||typeof j!="object"?null:(j=v&&j[v]||j["@@iterator"],typeof j=="function"?j:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,C={};function L(j,K,ue){this.props=j,this.context=K,this.refs=C,this.updater=ue||I}L.prototype.isReactComponent={},L.prototype.setState=function(j,K){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,K,"setState")},L.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function x(){}x.prototype=L.prototype;function U(j,K,ue){this.props=j,this.context=K,this.refs=C,this.updater=ue||I}var z=U.prototype=new x;z.constructor=U,A(z,L.prototype),z.isPureReactComponent=!0;var $=Array.isArray;function se(){}var D={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function N(j,K,ue){var pe=ue.ref;return{$$typeof:n,type:j,key:K,ref:pe!==void 0?pe:null,props:ue}}function M(j,K){return N(j.type,K,j.props)}function B(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function G(j){var K={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(ue){return K[ue]})}var k=/\/+/g;function Ve(j,K){return typeof j=="object"&&j!==null&&j.key!=null?G(""+j.key):K.toString(36)}function tt(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(se,se):(j.status="pending",j.then(function(K){j.status==="pending"&&(j.status="fulfilled",j.value=K)},function(K){j.status==="pending"&&(j.status="rejected",j.reason=K)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function ee(j,K,ue,pe,Pe){var je=typeof j;(je==="undefined"||je==="boolean")&&(j=null);var nt=!1;if(j===null)nt=!0;else switch(je){case"bigint":case"string":case"number":nt=!0;break;case"object":switch(j.$$typeof){case n:case e:nt=!0;break;case g:return nt=j._init,ee(nt(j._payload),K,ue,pe,Pe)}}if(nt)return Pe=Pe(j),nt=pe===""?"."+Ve(j,0):pe,$(Pe)?(ue="",nt!=null&&(ue=nt.replace(k,"$&/")+"/"),ee(Pe,K,ue,"",function(Ze){return Ze})):Pe!=null&&(B(Pe)&&(Pe=M(Pe,ue+(Pe.key==null||j&&j.key===Pe.key?"":(""+Pe.key).replace(k,"$&/")+"/")+nt)),K.push(Pe)),1;nt=0;var We=pe===""?".":pe+":";if($(j))for(var Ke=0;Ke<j.length;Ke++)pe=j[Ke],je=We+Ve(pe,Ke),nt+=ee(pe,K,ue,je,Pe);else if(Ke=T(j),typeof Ke=="function")for(j=Ke.call(j),Ke=0;!(pe=j.next()).done;)pe=pe.value,je=We+Ve(pe,Ke++),nt+=ee(pe,K,ue,je,Pe);else if(je==="object"){if(typeof j.then=="function")return ee(tt(j),K,ue,pe,Pe);throw K=String(j),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return nt}function he(j,K,ue){if(j==null)return j;var pe=[],Pe=0;return ee(j,pe,"","",function(je){return K.call(ue,je,Pe++)}),pe}function Ie(j){if(j._status===-1){var K=j._result;K=K(),K.then(function(ue){(j._status===0||j._status===-1)&&(j._status=1,j._result=ue)},function(ue){(j._status===0||j._status===-1)&&(j._status=2,j._result=ue)}),j._status===-1&&(j._status=0,j._result=K)}if(j._status===1)return j._result.default;throw j._result}var Le=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},Ge={map:he,forEach:function(j,K,ue){he(j,function(){K.apply(this,arguments)},ue)},count:function(j){var K=0;return he(j,function(){K++}),K},toArray:function(j){return he(j,function(K){return K})||[]},only:function(j){if(!B(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return Xe.Activity=_,Xe.Children=Ge,Xe.Component=L,Xe.Fragment=t,Xe.Profiler=a,Xe.PureComponent=U,Xe.StrictMode=r,Xe.Suspense=h,Xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Xe.__COMPILER_RUNTIME={__proto__:null,c:function(j){return D.H.useMemoCache(j)}},Xe.cache=function(j){return function(){return j.apply(null,arguments)}},Xe.cacheSignal=function(){return null},Xe.cloneElement=function(j,K,ue){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var pe=A({},j.props),Pe=j.key;if(K!=null)for(je in K.key!==void 0&&(Pe=""+K.key),K)!P.call(K,je)||je==="key"||je==="__self"||je==="__source"||je==="ref"&&K.ref===void 0||(pe[je]=K[je]);var je=arguments.length-2;if(je===1)pe.children=ue;else if(1<je){for(var nt=Array(je),We=0;We<je;We++)nt[We]=arguments[We+2];pe.children=nt}return N(j.type,Pe,pe)},Xe.createContext=function(j){return j={$$typeof:c,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:l,_context:j},j},Xe.createElement=function(j,K,ue){var pe,Pe={},je=null;if(K!=null)for(pe in K.key!==void 0&&(je=""+K.key),K)P.call(K,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(Pe[pe]=K[pe]);var nt=arguments.length-2;if(nt===1)Pe.children=ue;else if(1<nt){for(var We=Array(nt),Ke=0;Ke<nt;Ke++)We[Ke]=arguments[Ke+2];Pe.children=We}if(j&&j.defaultProps)for(pe in nt=j.defaultProps,nt)Pe[pe]===void 0&&(Pe[pe]=nt[pe]);return N(j,je,Pe)},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(j){return{$$typeof:d,render:j}},Xe.isValidElement=B,Xe.lazy=function(j){return{$$typeof:g,_payload:{_status:-1,_result:j},_init:Ie}},Xe.memo=function(j,K){return{$$typeof:m,type:j,compare:K===void 0?null:K}},Xe.startTransition=function(j){var K=D.T,ue={};D.T=ue;try{var pe=j(),Pe=D.S;Pe!==null&&Pe(ue,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(se,Le)}catch(je){Le(je)}finally{K!==null&&ue.types!==null&&(K.types=ue.types),D.T=K}},Xe.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Xe.use=function(j){return D.H.use(j)},Xe.useActionState=function(j,K,ue){return D.H.useActionState(j,K,ue)},Xe.useCallback=function(j,K){return D.H.useCallback(j,K)},Xe.useContext=function(j){return D.H.useContext(j)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(j,K){return D.H.useDeferredValue(j,K)},Xe.useEffect=function(j,K){return D.H.useEffect(j,K)},Xe.useEffectEvent=function(j){return D.H.useEffectEvent(j)},Xe.useId=function(){return D.H.useId()},Xe.useImperativeHandle=function(j,K,ue){return D.H.useImperativeHandle(j,K,ue)},Xe.useInsertionEffect=function(j,K){return D.H.useInsertionEffect(j,K)},Xe.useLayoutEffect=function(j,K){return D.H.useLayoutEffect(j,K)},Xe.useMemo=function(j,K){return D.H.useMemo(j,K)},Xe.useOptimistic=function(j,K){return D.H.useOptimistic(j,K)},Xe.useReducer=function(j,K,ue){return D.H.useReducer(j,K,ue)},Xe.useRef=function(j){return D.H.useRef(j)},Xe.useState=function(j){return D.H.useState(j)},Xe.useSyncExternalStore=function(j,K,ue){return D.H.useSyncExternalStore(j,K,ue)},Xe.useTransition=function(){return D.H.useTransition()},Xe.version="19.2.3",Xe}var Xv;function vg(){return Xv||(Xv=1,dp.exports=DI()),dp.exports}var te=vg();const Sw=Ew(te);var hp={exports:{}},bc={},fp={exports:{}},mp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function kI(){return Jv||(Jv=1,(function(n){function e(ee,he){var Ie=ee.length;ee.push(he);e:for(;0<Ie;){var Le=Ie-1>>>1,Ge=ee[Le];if(0<a(Ge,he))ee[Le]=he,ee[Ie]=Ge,Ie=Le;else break e}}function t(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var he=ee[0],Ie=ee.pop();if(Ie!==he){ee[0]=Ie;e:for(var Le=0,Ge=ee.length,j=Ge>>>1;Le<j;){var K=2*(Le+1)-1,ue=ee[K],pe=K+1,Pe=ee[pe];if(0>a(ue,Ie))pe<Ge&&0>a(Pe,ue)?(ee[Le]=Pe,ee[pe]=Ie,Le=pe):(ee[Le]=ue,ee[K]=Ie,Le=K);else if(pe<Ge&&0>a(Pe,Ie))ee[Le]=Pe,ee[pe]=Ie,Le=pe;else break e}}return he}function a(ee,he){var Ie=ee.sortIndex-he.sortIndex;return Ie!==0?Ie:ee.id-he.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var h=[],m=[],g=1,_=null,v=3,T=!1,I=!1,A=!1,C=!1,L=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function z(ee){for(var he=t(m);he!==null;){if(he.callback===null)r(m);else if(he.startTime<=ee)r(m),he.sortIndex=he.expirationTime,e(h,he);else break;he=t(m)}}function $(ee){if(A=!1,z(ee),!I)if(t(h)!==null)I=!0,se||(se=!0,G());else{var he=t(m);he!==null&&tt($,he.startTime-ee)}}var se=!1,D=-1,P=5,N=-1;function M(){return C?!0:!(n.unstable_now()-N<P)}function B(){if(C=!1,se){var ee=n.unstable_now();N=ee;var he=!0;try{e:{I=!1,A&&(A=!1,x(D),D=-1),T=!0;var Ie=v;try{t:{for(z(ee),_=t(h);_!==null&&!(_.expirationTime>ee&&M());){var Le=_.callback;if(typeof Le=="function"){_.callback=null,v=_.priorityLevel;var Ge=Le(_.expirationTime<=ee);if(ee=n.unstable_now(),typeof Ge=="function"){_.callback=Ge,z(ee),he=!0;break t}_===t(h)&&r(h),z(ee)}else r(h);_=t(h)}if(_!==null)he=!0;else{var j=t(m);j!==null&&tt($,j.startTime-ee),he=!1}}break e}finally{_=null,v=Ie,T=!1}he=void 0}}finally{he?G():se=!1}}}var G;if(typeof U=="function")G=function(){U(B)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,Ve=k.port2;k.port1.onmessage=B,G=function(){Ve.postMessage(null)}}else G=function(){L(B,0)};function tt(ee,he){D=L(function(){ee(n.unstable_now())},he)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ee){ee.callback=null},n.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ee?Math.floor(1e3/ee):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(ee){switch(v){case 1:case 2:case 3:var he=3;break;default:he=v}var Ie=v;v=he;try{return ee()}finally{v=Ie}},n.unstable_requestPaint=function(){C=!0},n.unstable_runWithPriority=function(ee,he){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Ie=v;v=ee;try{return he()}finally{v=Ie}},n.unstable_scheduleCallback=function(ee,he,Ie){var Le=n.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?Le+Ie:Le):Ie=Le,ee){case 1:var Ge=-1;break;case 2:Ge=250;break;case 5:Ge=1073741823;break;case 4:Ge=1e4;break;default:Ge=5e3}return Ge=Ie+Ge,ee={id:g++,callback:he,priorityLevel:ee,startTime:Ie,expirationTime:Ge,sortIndex:-1},Ie>Le?(ee.sortIndex=Ie,e(m,ee),t(h)===null&&ee===t(m)&&(A?(x(D),D=-1):A=!0,tt($,Ie-Le))):(ee.sortIndex=Ge,e(h,ee),I||T||(I=!0,se||(se=!0,G()))),ee},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(ee){var he=v;return function(){var Ie=v;v=he;try{return ee.apply(this,arguments)}finally{v=Ie}}}})(mp)),mp}var Zv;function MI(){return Zv||(Zv=1,fp.exports=kI()),fp.exports}var pp={exports:{}},Un={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eE;function LI(){if(eE)return Un;eE=1;var n=vg();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(h,m,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:_==null?null:""+_,children:h,containerInfo:m,implementation:g}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Un.createPortal=function(h,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(h,m,null,g)},Un.flushSync=function(h){var m=c.T,g=r.p;try{if(c.T=null,r.p=2,h)return h()}finally{c.T=m,r.p=g,r.d.f()}},Un.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(h,m))},Un.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Un.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var g=m.as,_=d(g,m.crossOrigin),v=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;g==="style"?r.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:v,fetchPriority:T}):g==="script"&&r.d.X(h,{crossOrigin:_,integrity:v,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Un.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var g=d(m.as,m.crossOrigin);r.d.M(h,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(h)},Un.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var g=m.as,_=d(g,m.crossOrigin);r.d.L(h,g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Un.preloadModule=function(h,m){if(typeof h=="string")if(m){var g=d(m.as,m.crossOrigin);r.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(h)},Un.requestFormReset=function(h){r.d.r(h)},Un.unstable_batchedUpdates=function(h,m){return h(m)},Un.useFormState=function(h,m,g){return c.H.useFormState(h,m,g)},Un.useFormStatus=function(){return c.H.useHostTransitionStatus()},Un.version="19.2.3",Un}var tE;function UI(){if(tE)return pp.exports;tE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),pp.exports=LI(),pp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nE;function VI(){if(nE)return bc;nE=1;var n=MI(),e=vg(),t=UI();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var s=i,o=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(o=s.return),i=s.return;while(i)}return s.tag===3?o:null}function c(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function h(i){if(l(i)!==i)throw Error(r(188))}function m(i){var s=i.alternate;if(!s){if(s=l(i),s===null)throw Error(r(188));return s!==i?null:i}for(var o=i,u=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(u=p.return,u!==null){o=u;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return h(p),i;if(y===u)return h(p),s;y=y.sibling}throw Error(r(188))}if(o.return!==u.return)o=p,u=y;else{for(var w=!1,R=p.child;R;){if(R===o){w=!0,o=p,u=y;break}if(R===u){w=!0,u=p,o=y;break}R=R.sibling}if(!w){for(R=y.child;R;){if(R===o){w=!0,o=y,u=p;break}if(R===u){w=!0,u=y,o=p;break}R=R.sibling}if(!w)throw Error(r(189))}}if(o.alternate!==u)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?i:s}function g(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=g(i),s!==null)return s;i=i.sibling}return null}var _=Object.assign,v=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),U=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function G(i){return i===null||typeof i!="object"?null:(i=B&&i[B]||i["@@iterator"],typeof i=="function"?i:null)}var k=Symbol.for("react.client.reference");function Ve(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===k?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case A:return"Fragment";case L:return"Profiler";case C:return"StrictMode";case $:return"Suspense";case se:return"SuspenseList";case N:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case I:return"Portal";case U:return i.displayName||"Context";case x:return(i._context.displayName||"Context")+".Consumer";case z:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return s=i.displayName||null,s!==null?s:Ve(i.type)||"Memo";case P:s=i._payload,i=i._init;try{return Ve(i(s))}catch{}}return null}var tt=Array.isArray,ee=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},Le=[],Ge=-1;function j(i){return{current:i}}function K(i){0>Ge||(i.current=Le[Ge],Le[Ge]=null,Ge--)}function ue(i,s){Ge++,Le[Ge]=i.current,i.current=s}var pe=j(null),Pe=j(null),je=j(null),nt=j(null);function We(i,s){switch(ue(je,s),ue(Pe,i),ue(pe,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?gv(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=gv(s),i=yv(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}K(pe),ue(pe,i)}function Ke(){K(pe),K(Pe),K(je)}function Ze(i){i.memoizedState!==null&&ue(nt,i);var s=pe.current,o=yv(s,i.type);s!==o&&(ue(Pe,i),ue(pe,o))}function Vt(i){Pe.current===i&&(K(pe),K(Pe)),nt.current===i&&(K(nt),_c._currentValue=Ie)}var Wt,Rn;function yn(i){if(Wt===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Wt=s&&s[1]||"",Rn=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wt+i+Rn}var Te=!1;function oe(i,s){if(!i||Te)return"";Te=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(ne){var Z=ne}Reflect.construct(i,[],de)}else{try{de.call()}catch(ne){Z=ne}i.call(de.prototype)}}else{try{throw Error()}catch(ne){Z=ne}(de=i())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(ne){if(ne&&Z&&typeof ne.stack=="string")return[ne.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),w=y[0],R=y[1];if(w&&R){var V=w.split(`
`),J=R.split(`
`);for(p=u=0;u<V.length&&!V[u].includes("DetermineComponentFrameRoot");)u++;for(;p<J.length&&!J[p].includes("DetermineComponentFrameRoot");)p++;if(u===V.length||p===J.length)for(u=V.length-1,p=J.length-1;1<=u&&0<=p&&V[u]!==J[p];)p--;for(;1<=u&&0<=p;u--,p--)if(V[u]!==J[p]){if(u!==1||p!==1)do if(u--,p--,0>p||V[u]!==J[p]){var ae=`
`+V[u].replace(" at new "," at ");return i.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",i.displayName)),ae}while(1<=u&&0<=p);break}}}finally{Te=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?yn(o):""}function Ue(i,s){switch(i.tag){case 26:case 27:case 5:return yn(i.type);case 16:return yn("Lazy");case 13:return i.child!==s&&s!==null?yn("Suspense Fallback"):yn("Suspense");case 19:return yn("SuspenseList");case 0:case 15:return oe(i.type,!1);case 11:return oe(i.type.render,!1);case 1:return oe(i.type,!0);case 31:return yn("Activity");default:return""}}function ve(i){try{var s="",o=null;do s+=Ue(i,o),o=i,i=i.return;while(i);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Ae=Object.prototype.hasOwnProperty,Se=n.unstable_scheduleCallback,ze=n.unstable_cancelCallback,it=n.unstable_shouldYield,Rt=n.unstable_requestPaint,et=n.unstable_now,we=n.unstable_getCurrentPriorityLevel,_e=n.unstable_ImmediatePriority,me=n.unstable_UserBlockingPriority,ge=n.unstable_NormalPriority,re=n.unstable_LowPriority,ye=n.unstable_IdlePriority,$e=n.log,qe=n.unstable_setDisableYieldValue,It=null,_t=null;function Fe(i){if(typeof $e=="function"&&qe(i),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(It,i)}catch{}}var Et=Math.clz32?Math.clz32:oi,ai=Math.log,Ei=Math.LN2;function oi(i){return i>>>=0,i===0?32:31-(ai(i)/Ei|0)|0}var ji=256,tr=262144,cs=4194304;function zi(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Si(i,s,o){var u=i.pendingLanes;if(u===0)return 0;var p=0,y=i.suspendedLanes,w=i.pingedLanes;i=i.warmLanes;var R=u&134217727;return R!==0?(u=R&~y,u!==0?p=zi(u):(w&=R,w!==0?p=zi(w):o||(o=R&~i,o!==0&&(p=zi(o))))):(R=u&~y,R!==0?p=zi(R):w!==0?p=zi(w):o||(o=u&~i,o!==0&&(p=zi(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function us(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function co(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tl(){var i=cs;return cs<<=1,(cs&62914560)===0&&(cs=4194304),i}function Rr(i){for(var s=[],o=0;31>o;o++)s.push(i);return s}function ds(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function In(i,s,o,u,p,y){var w=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var R=i.entanglements,V=i.expirationTimes,J=i.hiddenUpdates;for(o=w&~o;0<o;){var ae=31-Et(o),de=1<<ae;R[ae]=0,V[ae]=-1;var Z=J[ae];if(Z!==null)for(J[ae]=null,ae=0;ae<Z.length;ae++){var ne=Z[ae];ne!==null&&(ne.lane&=-536870913)}o&=~de}u!==0&&Al(i,u,0),y!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=y&~(w&~s))}function Al(i,s,o){i.pendingLanes|=s,i.suspendedLanes&=~s;var u=31-Et(s);i.entangledLanes|=s,i.entanglements[u]=i.entanglements[u]|1073741824|o&261930}function hs(i,s){var o=i.entangledLanes|=s;for(i=i.entanglements;o;){var u=31-Et(o),p=1<<u;p&s|i[u]&s&&(i[u]|=s),o&=~p}}function fs(i,s){var o=s&-s;return o=(o&42)!==0?1:Rl(o),(o&(i.suspendedLanes|s))!==0?0:o}function Rl(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Il(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ir(){var i=he.p;return i!==0?i:(i=window.event,i===void 0?32:zv(i.type))}function fu(i,s){var o=he.p;try{return he.p=i,s()}finally{he.p=o}}var nr=Math.random().toString(36).slice(2),Xt="__reactFiber$"+nr,Pn="__reactProps$"+nr,ir="__reactContainer$"+nr,ms="__reactEvents$"+nr,rr="__reactListeners$"+nr,mu="__reactHandles$"+nr,Pl="__reactResources$"+nr,Pr="__reactMarker$"+nr;function ya(i){delete i[Xt],delete i[Pn],delete i[ms],delete i[rr],delete i[mu]}function Cr(i){var s=i[Xt];if(s)return s;for(var o=i.parentNode;o;){if(s=o[ir]||o[Xt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(i=Tv(i);i!==null;){if(o=i[Xt])return o;i=Tv(i)}return s}i=o,o=i.parentNode}return null}function Nr(i){if(i=i[Xt]||i[ir]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function _a(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function Bi(i){var s=i[Pl];return s||(s=i[Pl]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function rn(i){i[Pr]=!0}var uo=new Set,ps={};function Bn(i,s){sr(i,s),sr(i+"Capture",s)}function sr(i,s){for(ps[i]=s,i=0;i<s.length;i++)uo.add(s[i])}var df=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cl={},Nl={};function pu(i){return Ae.call(Nl,i)?!0:Ae.call(Cl,i)?!1:df.test(i)?Nl[i]=!0:(Cl[i]=!0,!1)}function gs(i,s,o){if(pu(s))if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+o)}}function ys(i,s,o){if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+o)}}function wi(i,s,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(s,o,""+u)}}function Fn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function gu(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function hf(i,s,o){var u=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,y=u.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return p.call(this)},set:function(w){o=""+w,y.call(this,w)}}),Object.defineProperty(i,s,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function ho(i){if(!i._valueTracker){var s=gu(i)?"checked":"value";i._valueTracker=hf(i,s,""+i[s])}}function Ol(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return i&&(u=gu(i)?i.checked?"true":"false":i.value),i=u,i!==o?(s.setValue(i),!0):!1}function fo(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Or=/[\n"\\]/g;function Jt(i){return i.replace(Or,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function _s(i,s,o,u,p,y,w,R){i.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?i.type=w:i.removeAttribute("type"),s!=null?w==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Fn(s)):i.value!==""+Fn(s)&&(i.value=""+Fn(s)):w!=="submit"&&w!=="reset"||i.removeAttribute("value"),s!=null?mo(i,w,Fn(s)):o!=null?mo(i,w,Fn(o)):u!=null&&i.removeAttribute("value"),p==null&&y!=null&&(i.defaultChecked=!!y),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?i.name=""+Fn(R):i.removeAttribute("name")}function va(i,s,o,u,p,y,w,R){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ho(i);return}o=o!=null?""+Fn(o):"",s=s!=null?""+Fn(s):o,R||s===i.value||(i.value=s),i.defaultValue=s}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=R?i.checked:!!u,i.defaultChecked=!!u,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.name=w),ho(i)}function mo(i,s,o){s==="number"&&fo(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function St(i,s,o,u){if(i=i.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<i.length;o++)p=s.hasOwnProperty("$"+i[o].value),i[o].selected!==p&&(i[o].selected=p),p&&u&&(i[o].defaultSelected=!0)}else{for(o=""+Fn(o),s=null,p=0;p<i.length;p++){if(i[p].value===o){i[p].selected=!0,u&&(i[p].defaultSelected=!0);return}s!==null||i[p].disabled||(s=i[p])}s!==null&&(s.selected=!0)}}function Ea(i,s,o){if(s!=null&&(s=""+Fn(s),s!==i.value&&(i.value=s),o==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=o!=null?""+Fn(o):""}function vs(i,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(r(92));if(tt(u)){if(1<u.length)throw Error(r(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=Fn(s),i.defaultValue=o,u=i.textContent,u===o&&u!==""&&u!==null&&(i.value=u),ho(i)}function bi(i,s){if(s){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=s;return}}i.textContent=s}var ff=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xl(i,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":u?i.setProperty(s,o):typeof o!="number"||o===0||ff.has(s)?s==="float"?i.cssFloat=o:i[s]=(""+o).trim():i[s]=o+"px"}function yu(i,s,o){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var p in s)u=s[p],s.hasOwnProperty(p)&&o[p]!==u&&xl(i,p,u)}else for(var y in s)s.hasOwnProperty(y)&&xl(i,y,s[y])}function Dl(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ar(i){return pf.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Sn(){}var po=null;function go(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var xr=null,li=null;function _u(i){var s=Nr(i);if(s&&(i=s.stateNode)){var o=i[Pn]||null;e:switch(i=s.stateNode,s.type){case"input":if(_s(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Jt(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==i&&u.form===i.form){var p=u[Pn]||null;if(!p)throw Error(r(90));_s(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===i.form&&Ol(u)}break e;case"textarea":Ea(i,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&St(i,!!o.multiple,s,!1)}}}var kl=!1;function vu(i,s,o){if(kl)return i(s,o);kl=!0;try{var u=i(s);return u}finally{if(kl=!1,(xr!==null||li!==null)&&(pd(),xr&&(s=xr,i=li,li=xr=null,_u(s),i)))for(s=0;s<i.length;s++)_u(i[s])}}function Yn(i,s){var o=i.stateNode;if(o===null)return null;var u=o[Pn]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(r(231,s,typeof o));return o}var Fi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ml=!1;if(Fi)try{var or={};Object.defineProperty(or,"passive",{get:function(){Ml=!0}}),window.addEventListener("test",or,or),window.removeEventListener("test",or,or)}catch{Ml=!1}var ci=null,yo=null,lr=null;function Es(){if(lr)return lr;var i,s=yo,o=s.length,u,p="value"in ci?ci.value:ci.textContent,y=p.length;for(i=0;i<o&&s[i]===p[i];i++);var w=o-i;for(u=1;u<=w&&s[o-u]===p[y-u];u++);return lr=p.slice(i,1<u?1-u:void 0)}function Sa(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Ss(){return!0}function Gt(){return!1}function Ln(i){function s(o,u,p,y,w){this._reactName=o,this._targetInst=p,this.type=u,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var R in i)i.hasOwnProperty(R)&&(o=i[R],this[R]=o?o(y):y[R]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ss:Gt,this.isPropagationStopped=Gt,this}return _(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ss)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ss)},persist:function(){},isPersistent:Ss}),s}var Dr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=Ln(Dr),ws=_({},Dr,{view:0,detail:0}),Eu=Ln(ws),bs,_o,Gn,ba=_({},ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:As,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Gn&&(Gn&&i.type==="mousemove"?(bs=i.screenX-Gn.screenX,_o=i.screenY-Gn.screenY):_o=bs=0,Gn=i),bs)},movementY:function(i){return"movementY"in i?i.movementY:_o}}),Su=Ln(ba),Ta=_({},ba,{dataTransfer:0}),wu=Ln(Ta),Ll=_({},ws,{relatedTarget:0}),Ts=Ln(Ll),bu=_({},Dr,{animationName:0,elapsedTime:0,pseudoElement:0}),vo=Ln(bu),gf=_({},Dr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Tu=Ln(gf),Aa=_({},Dr,{data:0}),Ul=Ln(Aa),Au={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ru(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=jl[i])?!!s[i]:!1}function As(){return Ru}var Iu=_({},ws,{key:function(i){if(i.key){var s=Au[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Sa(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Vl[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:As,charCode:function(i){return i.type==="keypress"?Sa(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Sa(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Pu=Ln(Iu),kr=_({},ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zl=Ln(kr),Cu=_({},ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:As}),Nu=Ln(Cu),Ou=_({},Dr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Eo=Ln(Ou),Hn=_({},ba,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),xu=Ln(Hn),Du=_({},Dr,{newState:0,oldState:0}),Rs=Ln(Du),f=[9,13,27,32],E=Fi&&"CompositionEvent"in window,b=null;Fi&&"documentMode"in document&&(b=document.documentMode);var O=Fi&&"TextEvent"in window&&!b,Y=Fi&&(!E||b&&8<b&&11>=b),ie=" ",Ee=!1;function Pt(i,s){switch(i){case"keyup":return f.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cn(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ot=!1;function wn(i,s){switch(i){case"compositionend":return cn(s);case"keypress":return s.which!==32?null:(Ee=!0,ie);case"textInput":return i=s.data,i===ie&&Ee?null:i;default:return null}}function bn(i,s){if(ot)return i==="compositionend"||!E&&Pt(i,s)?(i=Es(),lr=yo=ci=null,ot=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Y&&s.locale!=="ko"?null:s.data;default:return null}}var Is={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Is[i.type]:s==="textarea"}function Ra(i,s,o,u){xr?li?li.push(u):li=[u]:xr=u,s=wd(s,"onChange"),0<s.length&&(o=new wa("onChange","change",null,o,u),i.push({event:o,listeners:s}))}var Mr=null,Bl=null;function nR(i){uv(i,0)}function ku(i){var s=_a(i);if(Ol(s))return i}function Cy(i,s){if(i==="change")return s}var Ny=!1;if(Fi){var yf;if(Fi){var _f="oninput"in document;if(!_f){var Oy=document.createElement("div");Oy.setAttribute("oninput","return;"),_f=typeof Oy.oninput=="function"}yf=_f}else yf=!1;Ny=yf&&(!document.documentMode||9<document.documentMode)}function xy(){Mr&&(Mr.detachEvent("onpropertychange",Dy),Bl=Mr=null)}function Dy(i){if(i.propertyName==="value"&&ku(Bl)){var s=[];Ra(s,Bl,i,go(i)),vu(nR,s)}}function iR(i,s,o){i==="focusin"?(xy(),Mr=s,Bl=o,Mr.attachEvent("onpropertychange",Dy)):i==="focusout"&&xy()}function rR(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ku(Bl)}function sR(i,s){if(i==="click")return ku(s)}function aR(i,s){if(i==="input"||i==="change")return ku(s)}function oR(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var ui=typeof Object.is=="function"?Object.is:oR;function Fl(i,s){if(ui(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var o=Object.keys(i),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var p=o[u];if(!Ae.call(s,p)||!ui(i[p],s[p]))return!1}return!0}function ky(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function My(i,s){var o=ky(i);i=0;for(var u;o;){if(o.nodeType===3){if(u=i+o.textContent.length,i<=s&&u>=s)return{node:o,offset:s-i};i=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ky(o)}}function Ly(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Ly(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Uy(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=fo(i.document);s instanceof i.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)i=s.contentWindow;else break;s=fo(i.document)}return s}function vf(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var lR=Fi&&"documentMode"in document&&11>=document.documentMode,So=null,Ef=null,Gl=null,Sf=!1;function Vy(i,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Sf||So==null||So!==fo(u)||(u=So,"selectionStart"in u&&vf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Gl&&Fl(Gl,u)||(Gl=u,u=wd(Ef,"onSelect"),0<u.length&&(s=new wa("onSelect","select",null,s,o),i.push({event:s,listeners:u}),s.target=So)))}function Ia(i,s){var o={};return o[i.toLowerCase()]=s.toLowerCase(),o["Webkit"+i]="webkit"+s,o["Moz"+i]="moz"+s,o}var wo={animationend:Ia("Animation","AnimationEnd"),animationiteration:Ia("Animation","AnimationIteration"),animationstart:Ia("Animation","AnimationStart"),transitionrun:Ia("Transition","TransitionRun"),transitionstart:Ia("Transition","TransitionStart"),transitioncancel:Ia("Transition","TransitionCancel"),transitionend:Ia("Transition","TransitionEnd")},wf={},jy={};Fi&&(jy=document.createElement("div").style,"AnimationEvent"in window||(delete wo.animationend.animation,delete wo.animationiteration.animation,delete wo.animationstart.animation),"TransitionEvent"in window||delete wo.transitionend.transition);function Pa(i){if(wf[i])return wf[i];if(!wo[i])return i;var s=wo[i],o;for(o in s)if(s.hasOwnProperty(o)&&o in jy)return wf[i]=s[o];return i}var zy=Pa("animationend"),By=Pa("animationiteration"),Fy=Pa("animationstart"),cR=Pa("transitionrun"),uR=Pa("transitionstart"),dR=Pa("transitioncancel"),Gy=Pa("transitionend"),Hy=new Map,bf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bf.push("scrollEnd");function Gi(i,s){Hy.set(i,s),Bn(s,[i])}var Mu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ti=[],bo=0,Tf=0;function Lu(){for(var i=bo,s=Tf=bo=0;s<i;){var o=Ti[s];Ti[s++]=null;var u=Ti[s];Ti[s++]=null;var p=Ti[s];Ti[s++]=null;var y=Ti[s];if(Ti[s++]=null,u!==null&&p!==null){var w=u.pending;w===null?p.next=p:(p.next=w.next,w.next=p),u.pending=p}y!==0&&$y(o,p,y)}}function Uu(i,s,o,u){Ti[bo++]=i,Ti[bo++]=s,Ti[bo++]=o,Ti[bo++]=u,Tf|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function Af(i,s,o,u){return Uu(i,s,o,u),Vu(i)}function Ca(i,s){return Uu(i,null,null,s),Vu(i)}function $y(i,s,o){i.lanes|=o;var u=i.alternate;u!==null&&(u.lanes|=o);for(var p=!1,y=i.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(p=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,p&&s!==null&&(p=31-Et(o),i=y.hiddenUpdates,u=i[p],u===null?i[p]=[s]:u.push(s),s.lane=o|536870912),y):null}function Vu(i){if(50<dc)throw dc=0,km=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var To={};function hR(i,s,o,u){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(i,s,o,u){return new hR(i,s,o,u)}function Rf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Lr(i,s){var o=i.alternate;return o===null?(o=di(i.tag,s,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=s,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&65011712,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,s=i.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function qy(i,s){i.flags&=65011714;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,s=o.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function ju(i,s,o,u,p,y){var w=0;if(u=i,typeof i=="function")Rf(i)&&(w=1);else if(typeof i=="string")w=yI(i,o,pe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case N:return i=di(31,o,s,p),i.elementType=N,i.lanes=y,i;case A:return Na(o.children,p,y,s);case C:w=8,p|=24;break;case L:return i=di(12,o,s,p|2),i.elementType=L,i.lanes=y,i;case $:return i=di(13,o,s,p),i.elementType=$,i.lanes=y,i;case se:return i=di(19,o,s,p),i.elementType=se,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case U:w=10;break e;case x:w=9;break e;case z:w=11;break e;case D:w=14;break e;case P:w=16,u=null;break e}w=29,o=Error(r(130,i===null?"null":typeof i,"")),u=null}return s=di(w,o,s,p),s.elementType=i,s.type=u,s.lanes=y,s}function Na(i,s,o,u){return i=di(7,i,u,s),i.lanes=o,i}function If(i,s,o){return i=di(6,i,null,s),i.lanes=o,i}function Yy(i){var s=di(18,null,null,0);return s.stateNode=i,s}function Pf(i,s,o){return s=di(4,i.children!==null?i.children:[],i.key,s),s.lanes=o,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Ky=new WeakMap;function Ai(i,s){if(typeof i=="object"&&i!==null){var o=Ky.get(i);return o!==void 0?o:(s={value:i,source:s,stack:ve(s)},Ky.set(i,s),s)}return{value:i,source:s,stack:ve(s)}}var Ao=[],Ro=0,zu=null,Hl=0,Ri=[],Ii=0,Ps=null,cr=1,ur="";function Ur(i,s){Ao[Ro++]=Hl,Ao[Ro++]=zu,zu=i,Hl=s}function Wy(i,s,o){Ri[Ii++]=cr,Ri[Ii++]=ur,Ri[Ii++]=Ps,Ps=i;var u=cr;i=ur;var p=32-Et(u)-1;u&=~(1<<p),o+=1;var y=32-Et(s)+p;if(30<y){var w=p-p%5;y=(u&(1<<w)-1).toString(32),u>>=w,p-=w,cr=1<<32-Et(s)+p|o<<p|u,ur=y+i}else cr=1<<y|o<<p|u,ur=i}function Cf(i){i.return!==null&&(Ur(i,1),Wy(i,1,0))}function Nf(i){for(;i===zu;)zu=Ao[--Ro],Ao[Ro]=null,Hl=Ao[--Ro],Ao[Ro]=null;for(;i===Ps;)Ps=Ri[--Ii],Ri[Ii]=null,ur=Ri[--Ii],Ri[Ii]=null,cr=Ri[--Ii],Ri[Ii]=null}function Qy(i,s){Ri[Ii++]=cr,Ri[Ii++]=ur,Ri[Ii++]=Ps,cr=s.id,ur=s.overflow,Ps=i}var Cn=null,Ht=null,pt=!1,Cs=null,Pi=!1,Of=Error(r(519));function Ns(i){var s=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw $l(Ai(s,i)),Of}function Xy(i){var s=i.stateNode,o=i.type,u=i.memoizedProps;switch(s[Xt]=i,s[Pn]=u,o){case"dialog":ut("cancel",s),ut("close",s);break;case"iframe":case"object":case"embed":ut("load",s);break;case"video":case"audio":for(o=0;o<fc.length;o++)ut(fc[o],s);break;case"source":ut("error",s);break;case"img":case"image":case"link":ut("error",s),ut("load",s);break;case"details":ut("toggle",s);break;case"input":ut("invalid",s),va(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":ut("invalid",s);break;case"textarea":ut("invalid",s),vs(s,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||mv(s.textContent,o)?(u.popover!=null&&(ut("beforetoggle",s),ut("toggle",s)),u.onScroll!=null&&ut("scroll",s),u.onScrollEnd!=null&&ut("scrollend",s),u.onClick!=null&&(s.onclick=Sn),s=!0):s=!1,s||Ns(i,!0)}function Jy(i){for(Cn=i.return;Cn;)switch(Cn.tag){case 5:case 31:case 13:Pi=!1;return;case 27:case 3:Pi=!0;return;default:Cn=Cn.return}}function Io(i){if(i!==Cn)return!1;if(!pt)return Jy(i),pt=!0,!1;var s=i.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||Wm(i.type,i.memoizedProps)),o=!o),o&&Ht&&Ns(i),Jy(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Ht=bv(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Ht=bv(i)}else s===27?(s=Ht,Hs(i.type)?(i=ep,ep=null,Ht=i):Ht=s):Ht=Cn?Ni(i.stateNode.nextSibling):null;return!0}function Oa(){Ht=Cn=null,pt=!1}function xf(){var i=Cs;return i!==null&&(Jn===null?Jn=i:Jn.push.apply(Jn,i),Cs=null),i}function $l(i){Cs===null?Cs=[i]:Cs.push(i)}var Df=j(null),xa=null,Vr=null;function Os(i,s,o){ue(Df,s._currentValue),s._currentValue=o}function jr(i){i._currentValue=Df.current,K(Df)}function kf(i,s,o){for(;i!==null;){var u=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),i===o)break;i=i.return}}function Mf(i,s,o,u){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var y=p.dependencies;if(y!==null){var w=p.child;y=y.firstContext;e:for(;y!==null;){var R=y;y=p;for(var V=0;V<s.length;V++)if(R.context===s[V]){y.lanes|=o,R=y.alternate,R!==null&&(R.lanes|=o),kf(y.return,o,i),u||(w=null);break e}y=R.next}}else if(p.tag===18){if(w=p.return,w===null)throw Error(r(341));w.lanes|=o,y=w.alternate,y!==null&&(y.lanes|=o),kf(w,o,i),w=null}else w=p.child;if(w!==null)w.return=p;else for(w=p;w!==null;){if(w===i){w=null;break}if(p=w.sibling,p!==null){p.return=w.return,w=p;break}w=w.return}p=w}}function Po(i,s,o,u){i=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var w=p.alternate;if(w===null)throw Error(r(387));if(w=w.memoizedProps,w!==null){var R=p.type;ui(p.pendingProps.value,w.value)||(i!==null?i.push(R):i=[R])}}else if(p===nt.current){if(w=p.alternate,w===null)throw Error(r(387));w.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(_c):i=[_c])}p=p.return}i!==null&&Mf(s,i,o,u),s.flags|=262144}function Bu(i){for(i=i.firstContext;i!==null;){if(!ui(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Da(i){xa=i,Vr=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Nn(i){return Zy(xa,i)}function Fu(i,s){return xa===null&&Da(i),Zy(i,s)}function Zy(i,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Vr===null){if(i===null)throw Error(r(308));Vr=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Vr=Vr.next=s;return o}var fR=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(o,u){i.push(u)}};this.abort=function(){s.aborted=!0,i.forEach(function(o){return o()})}},mR=n.unstable_scheduleCallback,pR=n.unstable_NormalPriority,un={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lf(){return{controller:new fR,data:new Map,refCount:0}}function ql(i){i.refCount--,i.refCount===0&&mR(pR,function(){i.controller.abort()})}var Yl=null,Uf=0,Co=0,No=null;function gR(i,s){if(Yl===null){var o=Yl=[];Uf=0,Co=zm(),No={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Uf++,s.then(e_,e_),s}function e_(){if(--Uf===0&&Yl!==null){No!==null&&(No.status="fulfilled");var i=Yl;Yl=null,Co=0,No=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function yR(i,s){var o=[],u={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return i.then(function(){u.status="fulfilled",u.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(u.status="rejected",u.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),u}var t_=ee.S;ee.S=function(i,s){V0=et(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&gR(i,s),t_!==null&&t_(i,s)};var ka=j(null);function Vf(){var i=ka.current;return i!==null?i:jt.pooledCache}function Gu(i,s){s===null?ue(ka,ka.current):ue(ka,s.pool)}function n_(){var i=Vf();return i===null?null:{parent:un._currentValue,pool:i}}var Oo=Error(r(460)),jf=Error(r(474)),Hu=Error(r(542)),$u={then:function(){}};function i_(i){return i=i.status,i==="fulfilled"||i==="rejected"}function r_(i,s,o){switch(o=i[o],o===void 0?i.push(s):o!==s&&(s.then(Sn,Sn),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,a_(i),i;default:if(typeof s.status=="string")s.then(Sn,Sn);else{if(i=jt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(u){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=u}},function(u){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,a_(i),i}throw La=s,Oo}}function Ma(i){try{var s=i._init;return s(i._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(La=o,Oo):o}}var La=null;function s_(){if(La===null)throw Error(r(459));var i=La;return La=null,i}function a_(i){if(i===Oo||i===Hu)throw Error(r(483))}var xo=null,Kl=0;function qu(i){var s=Kl;return Kl+=1,xo===null&&(xo=[]),r_(xo,i,s)}function Wl(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Yu(i,s){throw s.$$typeof===v?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function o_(i){function s(q,F){if(i){var Q=q.deletions;Q===null?(q.deletions=[F],q.flags|=16):Q.push(F)}}function o(q,F){if(!i)return null;for(;F!==null;)s(q,F),F=F.sibling;return null}function u(q){for(var F=new Map;q!==null;)q.key!==null?F.set(q.key,q):F.set(q.index,q),q=q.sibling;return F}function p(q,F){return q=Lr(q,F),q.index=0,q.sibling=null,q}function y(q,F,Q){return q.index=Q,i?(Q=q.alternate,Q!==null?(Q=Q.index,Q<F?(q.flags|=67108866,F):Q):(q.flags|=67108866,F)):(q.flags|=1048576,F)}function w(q){return i&&q.alternate===null&&(q.flags|=67108866),q}function R(q,F,Q,le){return F===null||F.tag!==6?(F=If(Q,q.mode,le),F.return=q,F):(F=p(F,Q),F.return=q,F)}function V(q,F,Q,le){var ke=Q.type;return ke===A?ae(q,F,Q.props.children,le,Q.key):F!==null&&(F.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===P&&Ma(ke)===F.type)?(F=p(F,Q.props),Wl(F,Q),F.return=q,F):(F=ju(Q.type,Q.key,Q.props,null,q.mode,le),Wl(F,Q),F.return=q,F)}function J(q,F,Q,le){return F===null||F.tag!==4||F.stateNode.containerInfo!==Q.containerInfo||F.stateNode.implementation!==Q.implementation?(F=Pf(Q,q.mode,le),F.return=q,F):(F=p(F,Q.children||[]),F.return=q,F)}function ae(q,F,Q,le,ke){return F===null||F.tag!==7?(F=Na(Q,q.mode,le,ke),F.return=q,F):(F=p(F,Q),F.return=q,F)}function de(q,F,Q){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=If(""+F,q.mode,Q),F.return=q,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case T:return Q=ju(F.type,F.key,F.props,null,q.mode,Q),Wl(Q,F),Q.return=q,Q;case I:return F=Pf(F,q.mode,Q),F.return=q,F;case P:return F=Ma(F),de(q,F,Q)}if(tt(F)||G(F))return F=Na(F,q.mode,Q,null),F.return=q,F;if(typeof F.then=="function")return de(q,qu(F),Q);if(F.$$typeof===U)return de(q,Fu(q,F),Q);Yu(q,F)}return null}function Z(q,F,Q,le){var ke=F!==null?F.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return ke!==null?null:R(q,F,""+Q,le);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case T:return Q.key===ke?V(q,F,Q,le):null;case I:return Q.key===ke?J(q,F,Q,le):null;case P:return Q=Ma(Q),Z(q,F,Q,le)}if(tt(Q)||G(Q))return ke!==null?null:ae(q,F,Q,le,null);if(typeof Q.then=="function")return Z(q,F,qu(Q),le);if(Q.$$typeof===U)return Z(q,F,Fu(q,Q),le);Yu(q,Q)}return null}function ne(q,F,Q,le,ke){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return q=q.get(Q)||null,R(F,q,""+le,ke);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case T:return q=q.get(le.key===null?Q:le.key)||null,V(F,q,le,ke);case I:return q=q.get(le.key===null?Q:le.key)||null,J(F,q,le,ke);case P:return le=Ma(le),ne(q,F,Q,le,ke)}if(tt(le)||G(le))return q=q.get(Q)||null,ae(F,q,le,ke,null);if(typeof le.then=="function")return ne(q,F,Q,qu(le),ke);if(le.$$typeof===U)return ne(q,F,Q,Fu(F,le),ke);Yu(F,le)}return null}function Oe(q,F,Q,le){for(var ke=null,wt=null,xe=F,at=F=0,ht=null;xe!==null&&at<Q.length;at++){xe.index>at?(ht=xe,xe=null):ht=xe.sibling;var bt=Z(q,xe,Q[at],le);if(bt===null){xe===null&&(xe=ht);break}i&&xe&&bt.alternate===null&&s(q,xe),F=y(bt,F,at),wt===null?ke=bt:wt.sibling=bt,wt=bt,xe=ht}if(at===Q.length)return o(q,xe),pt&&Ur(q,at),ke;if(xe===null){for(;at<Q.length;at++)xe=de(q,Q[at],le),xe!==null&&(F=y(xe,F,at),wt===null?ke=xe:wt.sibling=xe,wt=xe);return pt&&Ur(q,at),ke}for(xe=u(xe);at<Q.length;at++)ht=ne(xe,q,at,Q[at],le),ht!==null&&(i&&ht.alternate!==null&&xe.delete(ht.key===null?at:ht.key),F=y(ht,F,at),wt===null?ke=ht:wt.sibling=ht,wt=ht);return i&&xe.forEach(function(Ws){return s(q,Ws)}),pt&&Ur(q,at),ke}function Be(q,F,Q,le){if(Q==null)throw Error(r(151));for(var ke=null,wt=null,xe=F,at=F=0,ht=null,bt=Q.next();xe!==null&&!bt.done;at++,bt=Q.next()){xe.index>at?(ht=xe,xe=null):ht=xe.sibling;var Ws=Z(q,xe,bt.value,le);if(Ws===null){xe===null&&(xe=ht);break}i&&xe&&Ws.alternate===null&&s(q,xe),F=y(Ws,F,at),wt===null?ke=Ws:wt.sibling=Ws,wt=Ws,xe=ht}if(bt.done)return o(q,xe),pt&&Ur(q,at),ke;if(xe===null){for(;!bt.done;at++,bt=Q.next())bt=de(q,bt.value,le),bt!==null&&(F=y(bt,F,at),wt===null?ke=bt:wt.sibling=bt,wt=bt);return pt&&Ur(q,at),ke}for(xe=u(xe);!bt.done;at++,bt=Q.next())bt=ne(xe,q,at,bt.value,le),bt!==null&&(i&&bt.alternate!==null&&xe.delete(bt.key===null?at:bt.key),F=y(bt,F,at),wt===null?ke=bt:wt.sibling=bt,wt=bt);return i&&xe.forEach(function(PI){return s(q,PI)}),pt&&Ur(q,at),ke}function Lt(q,F,Q,le){if(typeof Q=="object"&&Q!==null&&Q.type===A&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case T:e:{for(var ke=Q.key;F!==null;){if(F.key===ke){if(ke=Q.type,ke===A){if(F.tag===7){o(q,F.sibling),le=p(F,Q.props.children),le.return=q,q=le;break e}}else if(F.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===P&&Ma(ke)===F.type){o(q,F.sibling),le=p(F,Q.props),Wl(le,Q),le.return=q,q=le;break e}o(q,F);break}else s(q,F);F=F.sibling}Q.type===A?(le=Na(Q.props.children,q.mode,le,Q.key),le.return=q,q=le):(le=ju(Q.type,Q.key,Q.props,null,q.mode,le),Wl(le,Q),le.return=q,q=le)}return w(q);case I:e:{for(ke=Q.key;F!==null;){if(F.key===ke)if(F.tag===4&&F.stateNode.containerInfo===Q.containerInfo&&F.stateNode.implementation===Q.implementation){o(q,F.sibling),le=p(F,Q.children||[]),le.return=q,q=le;break e}else{o(q,F);break}else s(q,F);F=F.sibling}le=Pf(Q,q.mode,le),le.return=q,q=le}return w(q);case P:return Q=Ma(Q),Lt(q,F,Q,le)}if(tt(Q))return Oe(q,F,Q,le);if(G(Q)){if(ke=G(Q),typeof ke!="function")throw Error(r(150));return Q=ke.call(Q),Be(q,F,Q,le)}if(typeof Q.then=="function")return Lt(q,F,qu(Q),le);if(Q.$$typeof===U)return Lt(q,F,Fu(q,Q),le);Yu(q,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,F!==null&&F.tag===6?(o(q,F.sibling),le=p(F,Q),le.return=q,q=le):(o(q,F),le=If(Q,q.mode,le),le.return=q,q=le),w(q)):o(q,F)}return function(q,F,Q,le){try{Kl=0;var ke=Lt(q,F,Q,le);return xo=null,ke}catch(xe){if(xe===Oo||xe===Hu)throw xe;var wt=di(29,xe,null,q.mode);return wt.lanes=le,wt.return=q,wt}finally{}}}var Ua=o_(!0),l_=o_(!1),xs=!1;function zf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Bf(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ds(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ks(i,s,o){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(Tt&2)!==0){var p=u.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),u.pending=s,s=Vu(i),$y(i,null,o),s}return Uu(i,u,s,o),Vu(i)}function Ql(i,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=i.pendingLanes,o|=u,s.lanes=o,hs(i,o)}}function Ff(i,s){var o=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=w:y=y.next=w,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=s:i.next=s,o.lastBaseUpdate=s}var Gf=!1;function Xl(){if(Gf){var i=No;if(i!==null)throw i}}function Jl(i,s,o,u){Gf=!1;var p=i.updateQueue;xs=!1;var y=p.firstBaseUpdate,w=p.lastBaseUpdate,R=p.shared.pending;if(R!==null){p.shared.pending=null;var V=R,J=V.next;V.next=null,w===null?y=J:w.next=J,w=V;var ae=i.alternate;ae!==null&&(ae=ae.updateQueue,R=ae.lastBaseUpdate,R!==w&&(R===null?ae.firstBaseUpdate=J:R.next=J,ae.lastBaseUpdate=V))}if(y!==null){var de=p.baseState;w=0,ae=J=V=null,R=y;do{var Z=R.lane&-536870913,ne=Z!==R.lane;if(ne?(dt&Z)===Z:(u&Z)===Z){Z!==0&&Z===Co&&(Gf=!0),ae!==null&&(ae=ae.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Oe=i,Be=R;Z=s;var Lt=o;switch(Be.tag){case 1:if(Oe=Be.payload,typeof Oe=="function"){de=Oe.call(Lt,de,Z);break e}de=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Be.payload,Z=typeof Oe=="function"?Oe.call(Lt,de,Z):Oe,Z==null)break e;de=_({},de,Z);break e;case 2:xs=!0}}Z=R.callback,Z!==null&&(i.flags|=64,ne&&(i.flags|=8192),ne=p.callbacks,ne===null?p.callbacks=[Z]:ne.push(Z))}else ne={lane:Z,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ae===null?(J=ae=ne,V=de):ae=ae.next=ne,w|=Z;if(R=R.next,R===null){if(R=p.shared.pending,R===null)break;ne=R,R=ne.next,ne.next=null,p.lastBaseUpdate=ne,p.shared.pending=null}}while(!0);ae===null&&(V=de),p.baseState=V,p.firstBaseUpdate=J,p.lastBaseUpdate=ae,y===null&&(p.shared.lanes=0),js|=w,i.lanes=w,i.memoizedState=de}}function c_(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function u_(i,s){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)c_(o[i],s)}var Do=j(null),Ku=j(0);function d_(i,s){i=Kr,ue(Ku,i),ue(Do,s),Kr=i|s.baseLanes}function Hf(){ue(Ku,Kr),ue(Do,Do.current)}function $f(){Kr=Ku.current,K(Do),K(Ku)}var hi=j(null),Ci=null;function Ms(i){var s=i.alternate;ue(sn,sn.current&1),ue(hi,i),Ci===null&&(s===null||Do.current!==null||s.memoizedState!==null)&&(Ci=i)}function qf(i){ue(sn,sn.current),ue(hi,i),Ci===null&&(Ci=i)}function h_(i){i.tag===22?(ue(sn,sn.current),ue(hi,i),Ci===null&&(Ci=i)):Ls()}function Ls(){ue(sn,sn.current),ue(hi,hi.current)}function fi(i){K(hi),Ci===i&&(Ci=null),K(sn)}var sn=j(0);function Wu(i){for(var s=i;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Jm(o)||Zm(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var zr=0,rt=null,kt=null,dn=null,Qu=!1,ko=!1,Va=!1,Xu=0,Zl=0,Mo=null,_R=0;function Zt(){throw Error(r(321))}function Yf(i,s){if(s===null)return!1;for(var o=0;o<s.length&&o<i.length;o++)if(!ui(i[o],s[o]))return!1;return!0}function Kf(i,s,o,u,p,y){return zr=y,rt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ee.H=i===null||i.memoizedState===null?W_:cm,Va=!1,y=o(u,p),Va=!1,ko&&(y=m_(s,o,u,p)),f_(i),y}function f_(i){ee.H=nc;var s=kt!==null&&kt.next!==null;if(zr=0,dn=kt=rt=null,Qu=!1,Zl=0,Mo=null,s)throw Error(r(300));i===null||hn||(i=i.dependencies,i!==null&&Bu(i)&&(hn=!0))}function m_(i,s,o,u){rt=i;var p=0;do{if(ko&&(Mo=null),Zl=0,ko=!1,25<=p)throw Error(r(301));if(p+=1,dn=kt=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}ee.H=Q_,y=s(o,u)}while(ko);return y}function vR(){var i=ee.H,s=i.useState()[0];return s=typeof s.then=="function"?ec(s):s,i=i.useState()[0],(kt!==null?kt.memoizedState:null)!==i&&(rt.flags|=1024),s}function Wf(){var i=Xu!==0;return Xu=0,i}function Qf(i,s,o){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~o}function Xf(i){if(Qu){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Qu=!1}zr=0,dn=kt=rt=null,ko=!1,Zl=Xu=0,Mo=null}function $n(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?rt.memoizedState=dn=i:dn=dn.next=i,dn}function an(){if(kt===null){var i=rt.alternate;i=i!==null?i.memoizedState:null}else i=kt.next;var s=dn===null?rt.memoizedState:dn.next;if(s!==null)dn=s,kt=i;else{if(i===null)throw rt.alternate===null?Error(r(467)):Error(r(310));kt=i,i={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},dn===null?rt.memoizedState=dn=i:dn=dn.next=i}return dn}function Ju(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ec(i){var s=Zl;return Zl+=1,Mo===null&&(Mo=[]),i=r_(Mo,i,s),s=rt,(dn===null?s.memoizedState:dn.next)===null&&(s=s.alternate,ee.H=s===null||s.memoizedState===null?W_:cm),i}function Zu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ec(i);if(i.$$typeof===U)return Nn(i)}throw Error(r(438,String(i)))}function Jf(i){var s=null,o=rt.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=rt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Ju(),rt.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(i),u=0;u<i;u++)o[u]=M;return s.index++,o}function Br(i,s){return typeof s=="function"?s(i):s}function ed(i){var s=an();return Zf(s,kt,i)}function Zf(i,s,o){var u=i.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=o;var p=i.baseQueue,y=u.pending;if(y!==null){if(p!==null){var w=p.next;p.next=y.next,y.next=w}s.baseQueue=p=y,u.pending=null}if(y=i.baseState,p===null)i.memoizedState=y;else{s=p.next;var R=w=null,V=null,J=s,ae=!1;do{var de=J.lane&-536870913;if(de!==J.lane?(dt&de)===de:(zr&de)===de){var Z=J.revertLane;if(Z===0)V!==null&&(V=V.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),de===Co&&(ae=!0);else if((zr&Z)===Z){J=J.next,Z===Co&&(ae=!0);continue}else de={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},V===null?(R=V=de,w=y):V=V.next=de,rt.lanes|=Z,js|=Z;de=J.action,Va&&o(y,de),y=J.hasEagerState?J.eagerState:o(y,de)}else Z={lane:de,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},V===null?(R=V=Z,w=y):V=V.next=Z,rt.lanes|=de,js|=de;J=J.next}while(J!==null&&J!==s);if(V===null?w=y:V.next=R,!ui(y,i.memoizedState)&&(hn=!0,ae&&(o=No,o!==null)))throw o;i.memoizedState=y,i.baseState=w,i.baseQueue=V,u.lastRenderedState=y}return p===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function em(i){var s=an(),o=s.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=i;var u=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var w=p=p.next;do y=i(y,w.action),w=w.next;while(w!==p);ui(y,s.memoizedState)||(hn=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,u]}function p_(i,s,o){var u=rt,p=an(),y=pt;if(y){if(o===void 0)throw Error(r(407));o=o()}else o=s();var w=!ui((kt||p).memoizedState,o);if(w&&(p.memoizedState=o,hn=!0),p=p.queue,im(__.bind(null,u,p,i),[i]),p.getSnapshot!==s||w||dn!==null&&dn.memoizedState.tag&1){if(u.flags|=2048,Lo(9,{destroy:void 0},y_.bind(null,u,p,o,s),null),jt===null)throw Error(r(349));y||(zr&127)!==0||g_(u,s,o)}return o}function g_(i,s,o){i.flags|=16384,i={getSnapshot:s,value:o},s=rt.updateQueue,s===null?(s=Ju(),rt.updateQueue=s,s.stores=[i]):(o=s.stores,o===null?s.stores=[i]:o.push(i))}function y_(i,s,o,u){s.value=o,s.getSnapshot=u,v_(s)&&E_(i)}function __(i,s,o){return o(function(){v_(s)&&E_(i)})}function v_(i){var s=i.getSnapshot;i=i.value;try{var o=s();return!ui(i,o)}catch{return!0}}function E_(i){var s=Ca(i,2);s!==null&&Zn(s,i,2)}function tm(i){var s=$n();if(typeof i=="function"){var o=i;if(i=o(),Va){Fe(!0);try{o()}finally{Fe(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Br,lastRenderedState:i},s}function S_(i,s,o,u){return i.baseState=o,Zf(i,kt,typeof u=="function"?u:Br)}function ER(i,s,o,u,p){if(id(i))throw Error(r(485));if(i=s.action,i!==null){var y={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};ee.T!==null?o(!0):y.isTransition=!1,u(y),o=s.pending,o===null?(y.next=s.pending=y,w_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function w_(i,s){var o=s.action,u=s.payload,p=i.state;if(s.isTransition){var y=ee.T,w={};ee.T=w;try{var R=o(p,u),V=ee.S;V!==null&&V(w,R),b_(i,s,R)}catch(J){nm(i,s,J)}finally{y!==null&&w.types!==null&&(y.types=w.types),ee.T=y}}else try{y=o(p,u),b_(i,s,y)}catch(J){nm(i,s,J)}}function b_(i,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){T_(i,s,u)},function(u){return nm(i,s,u)}):T_(i,s,o)}function T_(i,s,o){s.status="fulfilled",s.value=o,A_(s),i.state=o,s=i.pending,s!==null&&(o=s.next,o===s?i.pending=null:(o=o.next,s.next=o,w_(i,o)))}function nm(i,s,o){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,A_(s),s=s.next;while(s!==u)}i.action=null}function A_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function R_(i,s){return s}function I_(i,s){if(pt){var o=jt.formState;if(o!==null){e:{var u=rt;if(pt){if(Ht){t:{for(var p=Ht,y=Pi;p.nodeType!==8;){if(!y){p=null;break t}if(p=Ni(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){Ht=Ni(p.nextSibling),u=p.data==="F!";break e}}Ns(u)}u=!1}u&&(s=o[0])}}return o=$n(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:R_,lastRenderedState:s},o.queue=u,o=q_.bind(null,rt,u),u.dispatch=o,u=tm(!1),y=lm.bind(null,rt,!1,u.queue),u=$n(),p={state:s,dispatch:null,action:i,pending:null},u.queue=p,o=ER.bind(null,rt,p,y,o),p.dispatch=o,u.memoizedState=i,[s,o,!1]}function P_(i){var s=an();return C_(s,kt,i)}function C_(i,s,o){if(s=Zf(i,s,R_)[0],i=ed(Br)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=ec(s)}catch(w){throw w===Oo?Hu:w}else u=s;s=an();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(rt.flags|=2048,Lo(9,{destroy:void 0},SR.bind(null,p,o),null)),[u,y,i]}function SR(i,s){i.action=s}function N_(i){var s=an(),o=kt;if(o!==null)return C_(s,o,i);an(),s=s.memoizedState,o=an();var u=o.queue.dispatch;return o.memoizedState=i,[s,u,!1]}function Lo(i,s,o,u){return i={tag:i,create:o,deps:u,inst:s,next:null},s=rt.updateQueue,s===null&&(s=Ju(),rt.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=i.next=i:(u=o.next,o.next=i,i.next=u,s.lastEffect=i),i}function O_(){return an().memoizedState}function td(i,s,o,u){var p=$n();rt.flags|=i,p.memoizedState=Lo(1|s,{destroy:void 0},o,u===void 0?null:u)}function nd(i,s,o,u){var p=an();u=u===void 0?null:u;var y=p.memoizedState.inst;kt!==null&&u!==null&&Yf(u,kt.memoizedState.deps)?p.memoizedState=Lo(s,y,o,u):(rt.flags|=i,p.memoizedState=Lo(1|s,y,o,u))}function x_(i,s){td(8390656,8,i,s)}function im(i,s){nd(2048,8,i,s)}function wR(i){rt.flags|=4;var s=rt.updateQueue;if(s===null)s=Ju(),rt.updateQueue=s,s.events=[i];else{var o=s.events;o===null?s.events=[i]:o.push(i)}}function D_(i){var s=an().memoizedState;return wR({ref:s,nextImpl:i}),function(){if((Tt&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}function k_(i,s){return nd(4,2,i,s)}function M_(i,s){return nd(4,4,i,s)}function L_(i,s){if(typeof s=="function"){i=i();var o=s(i);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function U_(i,s,o){o=o!=null?o.concat([i]):null,nd(4,4,L_.bind(null,s,i),o)}function rm(){}function V_(i,s){var o=an();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&Yf(s,u[1])?u[0]:(o.memoizedState=[i,s],i)}function j_(i,s){var o=an();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&Yf(s,u[1]))return u[0];if(u=i(),Va){Fe(!0);try{i()}finally{Fe(!1)}}return o.memoizedState=[u,s],u}function sm(i,s,o){return o===void 0||(zr&1073741824)!==0&&(dt&261930)===0?i.memoizedState=s:(i.memoizedState=o,i=z0(),rt.lanes|=i,js|=i,o)}function z_(i,s,o,u){return ui(o,s)?o:Do.current!==null?(i=sm(i,o,u),ui(i,s)||(hn=!0),i):(zr&42)===0||(zr&1073741824)!==0&&(dt&261930)===0?(hn=!0,i.memoizedState=o):(i=z0(),rt.lanes|=i,js|=i,s)}function B_(i,s,o,u,p){var y=he.p;he.p=y!==0&&8>y?y:8;var w=ee.T,R={};ee.T=R,lm(i,!1,s,o);try{var V=p(),J=ee.S;if(J!==null&&J(R,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var ae=yR(V,u);tc(i,s,ae,gi(i))}else tc(i,s,u,gi(i))}catch(de){tc(i,s,{then:function(){},status:"rejected",reason:de},gi())}finally{he.p=y,w!==null&&R.types!==null&&(w.types=R.types),ee.T=w}}function bR(){}function am(i,s,o,u){if(i.tag!==5)throw Error(r(476));var p=F_(i).queue;B_(i,p,s,Ie,o===null?bR:function(){return G_(i),o(u)})}function F_(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Br,lastRenderedState:Ie},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Br,lastRenderedState:o},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function G_(i){var s=F_(i);s.next===null&&(s=i.alternate.memoizedState),tc(i,s.next.queue,{},gi())}function om(){return Nn(_c)}function H_(){return an().memoizedState}function $_(){return an().memoizedState}function TR(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var o=gi();i=Ds(o);var u=ks(s,i,o);u!==null&&(Zn(u,s,o),Ql(u,s,o)),s={cache:Lf()},i.payload=s;return}s=s.return}}function AR(i,s,o){var u=gi();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},id(i)?Y_(s,o):(o=Af(i,s,o,u),o!==null&&(Zn(o,i,u),K_(o,s,u)))}function q_(i,s,o){var u=gi();tc(i,s,o,u)}function tc(i,s,o,u){var p={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(id(i))Y_(s,p);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var w=s.lastRenderedState,R=y(w,o);if(p.hasEagerState=!0,p.eagerState=R,ui(R,w))return Uu(i,s,p,0),jt===null&&Lu(),!1}catch{}finally{}if(o=Af(i,s,p,u),o!==null)return Zn(o,i,u),K_(o,s,u),!0}return!1}function lm(i,s,o,u){if(u={lane:2,revertLane:zm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},id(i)){if(s)throw Error(r(479))}else s=Af(i,o,u,2),s!==null&&Zn(s,i,2)}function id(i){var s=i.alternate;return i===rt||s!==null&&s===rt}function Y_(i,s){ko=Qu=!0;var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}function K_(i,s,o){if((o&4194048)!==0){var u=s.lanes;u&=i.pendingLanes,o|=u,s.lanes=o,hs(i,o)}}var nc={readContext:Nn,use:Zu,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt,useHostTransitionStatus:Zt,useFormState:Zt,useActionState:Zt,useOptimistic:Zt,useMemoCache:Zt,useCacheRefresh:Zt};nc.useEffectEvent=Zt;var W_={readContext:Nn,use:Zu,useCallback:function(i,s){return $n().memoizedState=[i,s===void 0?null:s],i},useContext:Nn,useEffect:x_,useImperativeHandle:function(i,s,o){o=o!=null?o.concat([i]):null,td(4194308,4,L_.bind(null,s,i),o)},useLayoutEffect:function(i,s){return td(4194308,4,i,s)},useInsertionEffect:function(i,s){td(4,2,i,s)},useMemo:function(i,s){var o=$n();s=s===void 0?null:s;var u=i();if(Va){Fe(!0);try{i()}finally{Fe(!1)}}return o.memoizedState=[u,s],u},useReducer:function(i,s,o){var u=$n();if(o!==void 0){var p=o(s);if(Va){Fe(!0);try{o(s)}finally{Fe(!1)}}}else p=s;return u.memoizedState=u.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},u.queue=i,i=i.dispatch=AR.bind(null,rt,i),[u.memoizedState,i]},useRef:function(i){var s=$n();return i={current:i},s.memoizedState=i},useState:function(i){i=tm(i);var s=i.queue,o=q_.bind(null,rt,s);return s.dispatch=o,[i.memoizedState,o]},useDebugValue:rm,useDeferredValue:function(i,s){var o=$n();return sm(o,i,s)},useTransition:function(){var i=tm(!1);return i=B_.bind(null,rt,i.queue,!0,!1),$n().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,o){var u=rt,p=$n();if(pt){if(o===void 0)throw Error(r(407));o=o()}else{if(o=s(),jt===null)throw Error(r(349));(dt&127)!==0||g_(u,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,x_(__.bind(null,u,y,i),[i]),u.flags|=2048,Lo(9,{destroy:void 0},y_.bind(null,u,y,o,s),null),o},useId:function(){var i=$n(),s=jt.identifierPrefix;if(pt){var o=ur,u=cr;o=(u&~(1<<32-Et(u)-1)).toString(32)+o,s="_"+s+"R_"+o,o=Xu++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=_R++,s="_"+s+"r_"+o.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:om,useFormState:I_,useActionState:I_,useOptimistic:function(i){var s=$n();s.memoizedState=s.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=lm.bind(null,rt,!0,o),o.dispatch=s,[i,s]},useMemoCache:Jf,useCacheRefresh:function(){return $n().memoizedState=TR.bind(null,rt)},useEffectEvent:function(i){var s=$n(),o={impl:i};return s.memoizedState=o,function(){if((Tt&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},cm={readContext:Nn,use:Zu,useCallback:V_,useContext:Nn,useEffect:im,useImperativeHandle:U_,useInsertionEffect:k_,useLayoutEffect:M_,useMemo:j_,useReducer:ed,useRef:O_,useState:function(){return ed(Br)},useDebugValue:rm,useDeferredValue:function(i,s){var o=an();return z_(o,kt.memoizedState,i,s)},useTransition:function(){var i=ed(Br)[0],s=an().memoizedState;return[typeof i=="boolean"?i:ec(i),s]},useSyncExternalStore:p_,useId:H_,useHostTransitionStatus:om,useFormState:P_,useActionState:P_,useOptimistic:function(i,s){var o=an();return S_(o,kt,i,s)},useMemoCache:Jf,useCacheRefresh:$_};cm.useEffectEvent=D_;var Q_={readContext:Nn,use:Zu,useCallback:V_,useContext:Nn,useEffect:im,useImperativeHandle:U_,useInsertionEffect:k_,useLayoutEffect:M_,useMemo:j_,useReducer:em,useRef:O_,useState:function(){return em(Br)},useDebugValue:rm,useDeferredValue:function(i,s){var o=an();return kt===null?sm(o,i,s):z_(o,kt.memoizedState,i,s)},useTransition:function(){var i=em(Br)[0],s=an().memoizedState;return[typeof i=="boolean"?i:ec(i),s]},useSyncExternalStore:p_,useId:H_,useHostTransitionStatus:om,useFormState:N_,useActionState:N_,useOptimistic:function(i,s){var o=an();return kt!==null?S_(o,kt,i,s):(o.baseState=i,[i,o.queue.dispatch])},useMemoCache:Jf,useCacheRefresh:$_};Q_.useEffectEvent=D_;function um(i,s,o,u){s=i.memoizedState,o=o(u,s),o=o==null?s:_({},s,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var dm={enqueueSetState:function(i,s,o){i=i._reactInternals;var u=gi(),p=Ds(u);p.payload=s,o!=null&&(p.callback=o),s=ks(i,p,u),s!==null&&(Zn(s,i,u),Ql(s,i,u))},enqueueReplaceState:function(i,s,o){i=i._reactInternals;var u=gi(),p=Ds(u);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=ks(i,p,u),s!==null&&(Zn(s,i,u),Ql(s,i,u))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var o=gi(),u=Ds(o);u.tag=2,s!=null&&(u.callback=s),s=ks(i,u,o),s!==null&&(Zn(s,i,o),Ql(s,i,o))}};function X_(i,s,o,u,p,y,w){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,y,w):s.prototype&&s.prototype.isPureReactComponent?!Fl(o,u)||!Fl(p,y):!0}function J_(i,s,o,u){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==i&&dm.enqueueReplaceState(s,s.state,null)}function ja(i,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(i=i.defaultProps){o===s&&(o=_({},o));for(var p in i)o[p]===void 0&&(o[p]=i[p])}return o}function Z_(i){Mu(i)}function e0(i){console.error(i)}function t0(i){Mu(i)}function rd(i,s){try{var o=i.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function n0(i,s,o){try{var u=i.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function hm(i,s,o){return o=Ds(o),o.tag=3,o.payload={element:null},o.callback=function(){rd(i,s)},o}function i0(i){return i=Ds(i),i.tag=3,i}function r0(i,s,o,u){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=u.value;i.payload=function(){return p(y)},i.callback=function(){n0(s,o,u)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(i.callback=function(){n0(s,o,u),typeof p!="function"&&(zs===null?zs=new Set([this]):zs.add(this));var R=u.stack;this.componentDidCatch(u.value,{componentStack:R!==null?R:""})})}function RR(i,s,o,u,p){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&Po(s,o,p,!0),o=hi.current,o!==null){switch(o.tag){case 31:case 13:return Ci===null?gd():o.alternate===null&&en===0&&(en=3),o.flags&=-257,o.flags|=65536,o.lanes=p,u===$u?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),Um(i,u,p)),!1;case 22:return o.flags|=65536,u===$u?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),Um(i,u,p)),!1}throw Error(r(435,o.tag))}return Um(i,u,p),gd(),!1}if(pt)return s=hi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,u!==Of&&(i=Error(r(422),{cause:u}),$l(Ai(i,o)))):(u!==Of&&(s=Error(r(423),{cause:u}),$l(Ai(s,o))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,u=Ai(u,o),p=hm(i.stateNode,u,p),Ff(i,p),en!==4&&(en=2)),!1;var y=Error(r(520),{cause:u});if(y=Ai(y,o),uc===null?uc=[y]:uc.push(y),en!==4&&(en=2),s===null)return!0;u=Ai(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,i=p&-p,o.lanes|=i,i=hm(o.stateNode,u,i),Ff(o,i),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(zs===null||!zs.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=i0(p),r0(p,i,o,u),Ff(o,p),!1}o=o.return}while(o!==null);return!1}var fm=Error(r(461)),hn=!1;function On(i,s,o,u){s.child=i===null?l_(s,null,o,u):Ua(s,i.child,o,u)}function s0(i,s,o,u,p){o=o.render;var y=s.ref;if("ref"in u){var w={};for(var R in u)R!=="ref"&&(w[R]=u[R])}else w=u;return Da(s),u=Kf(i,s,o,w,y,p),R=Wf(),i!==null&&!hn?(Qf(i,s,p),Fr(i,s,p)):(pt&&R&&Cf(s),s.flags|=1,On(i,s,u,p),s.child)}function a0(i,s,o,u,p){if(i===null){var y=o.type;return typeof y=="function"&&!Rf(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,o0(i,s,y,u,p)):(i=ju(o.type,null,u,s,s.mode,p),i.ref=s.ref,i.return=s,s.child=i)}if(y=i.child,!Sm(i,p)){var w=y.memoizedProps;if(o=o.compare,o=o!==null?o:Fl,o(w,u)&&i.ref===s.ref)return Fr(i,s,p)}return s.flags|=1,i=Lr(y,u),i.ref=s.ref,i.return=s,s.child=i}function o0(i,s,o,u,p){if(i!==null){var y=i.memoizedProps;if(Fl(y,u)&&i.ref===s.ref)if(hn=!1,s.pendingProps=u=y,Sm(i,p))(i.flags&131072)!==0&&(hn=!0);else return s.lanes=i.lanes,Fr(i,s,p)}return mm(i,s,o,u,p)}function l0(i,s,o,u){var p=u.children,y=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,i!==null){for(u=s.child=i.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~y}else u=0,s.child=null;return c0(i,s,y,o,u)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Gu(s,y!==null?y.cachePool:null),y!==null?d_(s,y):Hf(),h_(s);else return u=s.lanes=536870912,c0(i,s,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(Gu(s,y.cachePool),d_(s,y),Ls(),s.memoizedState=null):(i!==null&&Gu(s,null),Hf(),Ls());return On(i,s,p,o),s.child}function ic(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function c0(i,s,o,u,p){var y=Vf();return y=y===null?null:{parent:un._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},i!==null&&Gu(s,null),Hf(),h_(s),i!==null&&Po(i,s,u,!0),s.childLanes=p,null}function sd(i,s){return s=od({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function u0(i,s,o){return Ua(s,i.child,null,o),i=sd(s,s.pendingProps),i.flags|=2,fi(s),s.memoizedState=null,i}function IR(i,s,o){var u=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(pt){if(u.mode==="hidden")return i=sd(s,u),s.lanes=536870912,ic(null,i);if(qf(s),(i=Ht)?(i=wv(i,Pi),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Ps!==null?{id:cr,overflow:ur}:null,retryLane:536870912,hydrationErrors:null},o=Yy(i),o.return=s,s.child=o,Cn=s,Ht=null)):i=null,i===null)throw Ns(s);return s.lanes=536870912,null}return sd(s,u)}var y=i.memoizedState;if(y!==null){var w=y.dehydrated;if(qf(s),p)if(s.flags&256)s.flags&=-257,s=u0(i,s,o);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(r(558));else if(hn||Po(i,s,o,!1),p=(o&i.childLanes)!==0,hn||p){if(u=jt,u!==null&&(w=fs(u,o),w!==0&&w!==y.retryLane))throw y.retryLane=w,Ca(i,w),Zn(u,i,w),fm;gd(),s=u0(i,s,o)}else i=y.treeContext,Ht=Ni(w.nextSibling),Cn=s,pt=!0,Cs=null,Pi=!1,i!==null&&Qy(s,i),s=sd(s,u),s.flags|=4096;return s}return i=Lr(i.child,{mode:u.mode,children:u.children}),i.ref=s.ref,s.child=i,i.return=s,i}function ad(i,s){var o=s.ref;if(o===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(i===null||i.ref!==o)&&(s.flags|=4194816)}}function mm(i,s,o,u,p){return Da(s),o=Kf(i,s,o,u,void 0,p),u=Wf(),i!==null&&!hn?(Qf(i,s,p),Fr(i,s,p)):(pt&&u&&Cf(s),s.flags|=1,On(i,s,o,p),s.child)}function d0(i,s,o,u,p,y){return Da(s),s.updateQueue=null,o=m_(s,u,o,p),f_(i),u=Wf(),i!==null&&!hn?(Qf(i,s,y),Fr(i,s,y)):(pt&&u&&Cf(s),s.flags|=1,On(i,s,o,y),s.child)}function h0(i,s,o,u,p){if(Da(s),s.stateNode===null){var y=To,w=o.contextType;typeof w=="object"&&w!==null&&(y=Nn(w)),y=new o(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=dm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},zf(s),w=o.contextType,y.context=typeof w=="object"&&w!==null?Nn(w):To,y.state=s.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(um(s,o,w,u),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&dm.enqueueReplaceState(y,y.state,null),Jl(s,u,y,p),Xl(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(i===null){y=s.stateNode;var R=s.memoizedProps,V=ja(o,R);y.props=V;var J=y.context,ae=o.contextType;w=To,typeof ae=="object"&&ae!==null&&(w=Nn(ae));var de=o.getDerivedStateFromProps;ae=typeof de=="function"||typeof y.getSnapshotBeforeUpdate=="function",R=s.pendingProps!==R,ae||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(R||J!==w)&&J_(s,y,u,w),xs=!1;var Z=s.memoizedState;y.state=Z,Jl(s,u,y,p),Xl(),J=s.memoizedState,R||Z!==J||xs?(typeof de=="function"&&(um(s,o,de,u),J=s.memoizedState),(V=xs||X_(s,o,V,u,Z,J,w))?(ae||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=J),y.props=u,y.state=J,y.context=w,u=V):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,Bf(i,s),w=s.memoizedProps,ae=ja(o,w),y.props=ae,de=s.pendingProps,Z=y.context,J=o.contextType,V=To,typeof J=="object"&&J!==null&&(V=Nn(J)),R=o.getDerivedStateFromProps,(J=typeof R=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==de||Z!==V)&&J_(s,y,u,V),xs=!1,Z=s.memoizedState,y.state=Z,Jl(s,u,y,p),Xl();var ne=s.memoizedState;w!==de||Z!==ne||xs||i!==null&&i.dependencies!==null&&Bu(i.dependencies)?(typeof R=="function"&&(um(s,o,R,u),ne=s.memoizedState),(ae=xs||X_(s,o,ae,u,Z,ne,V)||i!==null&&i.dependencies!==null&&Bu(i.dependencies))?(J||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,ne,V),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,ne,V)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=ne),y.props=u,y.state=ne,y.context=V,u=ae):(typeof y.componentDidUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=1024),u=!1)}return y=u,ad(i,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,i!==null&&u?(s.child=Ua(s,i.child,null,p),s.child=Ua(s,null,o,p)):On(i,s,o,p),s.memoizedState=y.state,i=s.child):i=Fr(i,s,p),i}function f0(i,s,o,u){return Oa(),s.flags|=256,On(i,s,o,u),s.child}var pm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function gm(i){return{baseLanes:i,cachePool:n_()}}function ym(i,s,o){return i=i!==null?i.childLanes&~o:0,s&&(i|=pi),i}function m0(i,s,o){var u=s.pendingProps,p=!1,y=(s.flags&128)!==0,w;if((w=y)||(w=i!==null&&i.memoizedState===null?!1:(sn.current&2)!==0),w&&(p=!0,s.flags&=-129),w=(s.flags&32)!==0,s.flags&=-33,i===null){if(pt){if(p?Ms(s):Ls(),(i=Ht)?(i=wv(i,Pi),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Ps!==null?{id:cr,overflow:ur}:null,retryLane:536870912,hydrationErrors:null},o=Yy(i),o.return=s,s.child=o,Cn=s,Ht=null)):i=null,i===null)throw Ns(s);return Zm(i)?s.lanes=32:s.lanes=536870912,null}var R=u.children;return u=u.fallback,p?(Ls(),p=s.mode,R=od({mode:"hidden",children:R},p),u=Na(u,p,o,null),R.return=s,u.return=s,R.sibling=u,s.child=R,u=s.child,u.memoizedState=gm(o),u.childLanes=ym(i,w,o),s.memoizedState=pm,ic(null,u)):(Ms(s),_m(s,R))}var V=i.memoizedState;if(V!==null&&(R=V.dehydrated,R!==null)){if(y)s.flags&256?(Ms(s),s.flags&=-257,s=vm(i,s,o)):s.memoizedState!==null?(Ls(),s.child=i.child,s.flags|=128,s=null):(Ls(),R=u.fallback,p=s.mode,u=od({mode:"visible",children:u.children},p),R=Na(R,p,o,null),R.flags|=2,u.return=s,R.return=s,u.sibling=R,s.child=u,Ua(s,i.child,null,o),u=s.child,u.memoizedState=gm(o),u.childLanes=ym(i,w,o),s.memoizedState=pm,s=ic(null,u));else if(Ms(s),Zm(R)){if(w=R.nextSibling&&R.nextSibling.dataset,w)var J=w.dgst;w=J,u=Error(r(419)),u.stack="",u.digest=w,$l({value:u,source:null,stack:null}),s=vm(i,s,o)}else if(hn||Po(i,s,o,!1),w=(o&i.childLanes)!==0,hn||w){if(w=jt,w!==null&&(u=fs(w,o),u!==0&&u!==V.retryLane))throw V.retryLane=u,Ca(i,u),Zn(w,i,u),fm;Jm(R)||gd(),s=vm(i,s,o)}else Jm(R)?(s.flags|=192,s.child=i.child,s=null):(i=V.treeContext,Ht=Ni(R.nextSibling),Cn=s,pt=!0,Cs=null,Pi=!1,i!==null&&Qy(s,i),s=_m(s,u.children),s.flags|=4096);return s}return p?(Ls(),R=u.fallback,p=s.mode,V=i.child,J=V.sibling,u=Lr(V,{mode:"hidden",children:u.children}),u.subtreeFlags=V.subtreeFlags&65011712,J!==null?R=Lr(J,R):(R=Na(R,p,o,null),R.flags|=2),R.return=s,u.return=s,u.sibling=R,s.child=u,ic(null,u),u=s.child,R=i.child.memoizedState,R===null?R=gm(o):(p=R.cachePool,p!==null?(V=un._currentValue,p=p.parent!==V?{parent:V,pool:V}:p):p=n_(),R={baseLanes:R.baseLanes|o,cachePool:p}),u.memoizedState=R,u.childLanes=ym(i,w,o),s.memoizedState=pm,ic(i.child,u)):(Ms(s),o=i.child,i=o.sibling,o=Lr(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,i!==null&&(w=s.deletions,w===null?(s.deletions=[i],s.flags|=16):w.push(i)),s.child=o,s.memoizedState=null,o)}function _m(i,s){return s=od({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function od(i,s){return i=di(22,i,null,s),i.lanes=0,i}function vm(i,s,o){return Ua(s,i.child,null,o),i=_m(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function p0(i,s,o){i.lanes|=s;var u=i.alternate;u!==null&&(u.lanes|=s),kf(i.return,s,o)}function Em(i,s,o,u,p,y){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:p,treeForkCount:y}:(w.isBackwards=s,w.rendering=null,w.renderingStartTime=0,w.last=u,w.tail=o,w.tailMode=p,w.treeForkCount=y)}function g0(i,s,o){var u=s.pendingProps,p=u.revealOrder,y=u.tail;u=u.children;var w=sn.current,R=(w&2)!==0;if(R?(w=w&1|2,s.flags|=128):w&=1,ue(sn,w),On(i,s,u,o),u=pt?Hl:0,!R&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&p0(i,o,s);else if(i.tag===19)p0(i,o,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)i=o.alternate,i!==null&&Wu(i)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Em(s,!1,p,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(i=p.alternate,i!==null&&Wu(i)===null){s.child=p;break}i=p.sibling,p.sibling=o,o=p,p=i}Em(s,!0,o,null,y,u);break;case"together":Em(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function Fr(i,s,o){if(i!==null&&(s.dependencies=i.dependencies),js|=s.lanes,(o&s.childLanes)===0)if(i!==null){if(Po(i,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,o=Lr(i,i.pendingProps),s.child=o,o.return=s;i.sibling!==null;)i=i.sibling,o=o.sibling=Lr(i,i.pendingProps),o.return=s;o.sibling=null}return s.child}function Sm(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Bu(i)))}function PR(i,s,o){switch(s.tag){case 3:We(s,s.stateNode.containerInfo),Os(s,un,i.memoizedState.cache),Oa();break;case 27:case 5:Ze(s);break;case 4:We(s,s.stateNode.containerInfo);break;case 10:Os(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,qf(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(Ms(s),s.flags|=128,null):(o&s.child.childLanes)!==0?m0(i,s,o):(Ms(s),i=Fr(i,s,o),i!==null?i.sibling:null);Ms(s);break;case 19:var p=(i.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(Po(i,s,o,!1),u=(o&s.childLanes)!==0),p){if(u)return g0(i,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ue(sn,sn.current),u)break;return null;case 22:return s.lanes=0,l0(i,s,o,s.pendingProps);case 24:Os(s,un,i.memoizedState.cache)}return Fr(i,s,o)}function y0(i,s,o){if(i!==null)if(i.memoizedProps!==s.pendingProps)hn=!0;else{if(!Sm(i,o)&&(s.flags&128)===0)return hn=!1,PR(i,s,o);hn=(i.flags&131072)!==0}else hn=!1,pt&&(s.flags&1048576)!==0&&Wy(s,Hl,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(i=Ma(s.elementType),s.type=i,typeof i=="function")Rf(i)?(u=ja(i,u),s.tag=1,s=h0(null,s,i,u,o)):(s.tag=0,s=mm(null,s,i,u,o));else{if(i!=null){var p=i.$$typeof;if(p===z){s.tag=11,s=s0(null,s,i,u,o);break e}else if(p===D){s.tag=14,s=a0(null,s,i,u,o);break e}}throw s=Ve(i)||i,Error(r(306,s,""))}}return s;case 0:return mm(i,s,s.type,s.pendingProps,o);case 1:return u=s.type,p=ja(u,s.pendingProps),h0(i,s,u,p,o);case 3:e:{if(We(s,s.stateNode.containerInfo),i===null)throw Error(r(387));u=s.pendingProps;var y=s.memoizedState;p=y.element,Bf(i,s),Jl(s,u,null,o);var w=s.memoizedState;if(u=w.cache,Os(s,un,u),u!==y.cache&&Mf(s,[un],o,!0),Xl(),u=w.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:w.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=f0(i,s,u,o);break e}else if(u!==p){p=Ai(Error(r(424)),s),$l(p),s=f0(i,s,u,o);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Ht=Ni(i.firstChild),Cn=s,pt=!0,Cs=null,Pi=!0,o=l_(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Oa(),u===p){s=Fr(i,s,o);break e}On(i,s,u,o)}s=s.child}return s;case 26:return ad(i,s),i===null?(o=Pv(s.type,null,s.pendingProps,null))?s.memoizedState=o:pt||(o=s.type,i=s.pendingProps,u=bd(je.current).createElement(o),u[Xt]=s,u[Pn]=i,xn(u,o,i),rn(u),s.stateNode=u):s.memoizedState=Pv(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Ze(s),i===null&&pt&&(u=s.stateNode=Av(s.type,s.pendingProps,je.current),Cn=s,Pi=!0,p=Ht,Hs(s.type)?(ep=p,Ht=Ni(u.firstChild)):Ht=p),On(i,s,s.pendingProps.children,o),ad(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&pt&&((p=u=Ht)&&(u=rI(u,s.type,s.pendingProps,Pi),u!==null?(s.stateNode=u,Cn=s,Ht=Ni(u.firstChild),Pi=!1,p=!0):p=!1),p||Ns(s)),Ze(s),p=s.type,y=s.pendingProps,w=i!==null?i.memoizedProps:null,u=y.children,Wm(p,y)?u=null:w!==null&&Wm(p,w)&&(s.flags|=32),s.memoizedState!==null&&(p=Kf(i,s,vR,null,null,o),_c._currentValue=p),ad(i,s),On(i,s,u,o),s.child;case 6:return i===null&&pt&&((i=o=Ht)&&(o=sI(o,s.pendingProps,Pi),o!==null?(s.stateNode=o,Cn=s,Ht=null,i=!0):i=!1),i||Ns(s)),null;case 13:return m0(i,s,o);case 4:return We(s,s.stateNode.containerInfo),u=s.pendingProps,i===null?s.child=Ua(s,null,u,o):On(i,s,u,o),s.child;case 11:return s0(i,s,s.type,s.pendingProps,o);case 7:return On(i,s,s.pendingProps,o),s.child;case 8:return On(i,s,s.pendingProps.children,o),s.child;case 12:return On(i,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,Os(s,s.type,u.value),On(i,s,u.children,o),s.child;case 9:return p=s.type._context,u=s.pendingProps.children,Da(s),p=Nn(p),u=u(p),s.flags|=1,On(i,s,u,o),s.child;case 14:return a0(i,s,s.type,s.pendingProps,o);case 15:return o0(i,s,s.type,s.pendingProps,o);case 19:return g0(i,s,o);case 31:return IR(i,s,o);case 22:return l0(i,s,o,s.pendingProps);case 24:return Da(s),u=Nn(un),i===null?(p=Vf(),p===null&&(p=jt,y=Lf(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:u,cache:p},zf(s),Os(s,un,p)):((i.lanes&o)!==0&&(Bf(i,s),Jl(s,null,null,o),Xl()),p=i.memoizedState,y=s.memoizedState,p.parent!==u?(p={parent:u,cache:u},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),Os(s,un,u)):(u=y.cache,Os(s,un,u),u!==p.cache&&Mf(s,[un],o,!0))),On(i,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Gr(i){i.flags|=4}function wm(i,s,o,u,p){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(p&335544128)===p)if(i.stateNode.complete)i.flags|=8192;else if(H0())i.flags|=8192;else throw La=$u,jf}else i.flags&=-16777217}function _0(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Dv(s))if(H0())i.flags|=8192;else throw La=$u,jf}function ld(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Tl():536870912,i.lanes|=s,zo|=s)}function rc(i,s){if(!pt)switch(i.tailMode){case"hidden":s=i.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function $t(i){var s=i.alternate!==null&&i.alternate.child===i.child,o=0,u=0;if(s)for(var p=i.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=u,i.childLanes=o,s}function CR(i,s,o){var u=s.pendingProps;switch(Nf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(s),null;case 1:return $t(s),null;case 3:return o=s.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),jr(un),Ke(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Io(s)?Gr(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,xf())),$t(s),null;case 26:var p=s.type,y=s.memoizedState;return i===null?(Gr(s),y!==null?($t(s),_0(s,y)):($t(s),wm(s,p,null,u,o))):y?y!==i.memoizedState?(Gr(s),$t(s),_0(s,y)):($t(s),s.flags&=-16777217):(i=i.memoizedProps,i!==u&&Gr(s),$t(s),wm(s,p,i,u,o)),null;case 27:if(Vt(s),o=je.current,p=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==u&&Gr(s);else{if(!u){if(s.stateNode===null)throw Error(r(166));return $t(s),null}i=pe.current,Io(s)?Xy(s):(i=Av(p,u,o),s.stateNode=i,Gr(s))}return $t(s),null;case 5:if(Vt(s),p=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==u&&Gr(s);else{if(!u){if(s.stateNode===null)throw Error(r(166));return $t(s),null}if(y=pe.current,Io(s))Xy(s);else{var w=bd(je.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?w.createElement("select",{is:u.is}):w.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?w.createElement(p,{is:u.is}):w.createElement(p)}}y[Xt]=s,y[Pn]=u;e:for(w=s.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===s)break e;for(;w.sibling===null;){if(w.return===null||w.return===s)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}s.stateNode=y;e:switch(xn(y,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Gr(s)}}return $t(s),wm(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,o),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==u&&Gr(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(r(166));if(i=je.current,Io(s)){if(i=s.stateNode,o=s.memoizedProps,u=null,p=Cn,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}i[Xt]=s,i=!!(i.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||mv(i.nodeValue,o)),i||Ns(s,!0)}else i=bd(i).createTextNode(u),i[Xt]=s,s.stateNode=i}return $t(s),null;case 31:if(o=s.memoizedState,i===null||i.memoizedState!==null){if(u=Io(s),o!==null){if(i===null){if(!u)throw Error(r(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[Xt]=s}else Oa(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;$t(s),i=!1}else o=xf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=o),i=!0;if(!i)return s.flags&256?(fi(s),s):(fi(s),null);if((s.flags&128)!==0)throw Error(r(558))}return $t(s),null;case 13:if(u=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Io(s),u!==null&&u.dehydrated!==null){if(i===null){if(!p)throw Error(r(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Xt]=s}else Oa(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;$t(s),p=!1}else p=xf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(fi(s),s):(fi(s),null)}return fi(s),(s.flags&128)!==0?(s.lanes=o,s):(o=u!==null,i=i!==null&&i.memoizedState!==null,o&&(u=s.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==p&&(u.flags|=2048)),o!==i&&o&&(s.child.flags|=8192),ld(s,s.updateQueue),$t(s),null);case 4:return Ke(),i===null&&Hm(s.stateNode.containerInfo),$t(s),null;case 10:return jr(s.type),$t(s),null;case 19:if(K(sn),u=s.memoizedState,u===null)return $t(s),null;if(p=(s.flags&128)!==0,y=u.rendering,y===null)if(p)rc(u,!1);else{if(en!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(y=Wu(i),y!==null){for(s.flags|=128,rc(u,!1),i=y.updateQueue,s.updateQueue=i,ld(s,i),s.subtreeFlags=0,i=o,o=s.child;o!==null;)qy(o,i),o=o.sibling;return ue(sn,sn.current&1|2),pt&&Ur(s,u.treeForkCount),s.child}i=i.sibling}u.tail!==null&&et()>fd&&(s.flags|=128,p=!0,rc(u,!1),s.lanes=4194304)}else{if(!p)if(i=Wu(y),i!==null){if(s.flags|=128,p=!0,i=i.updateQueue,s.updateQueue=i,ld(s,i),rc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!pt)return $t(s),null}else 2*et()-u.renderingStartTime>fd&&o!==536870912&&(s.flags|=128,p=!0,rc(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(i=u.last,i!==null?i.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(i=u.tail,u.rendering=i,u.tail=i.sibling,u.renderingStartTime=et(),i.sibling=null,o=sn.current,ue(sn,p?o&1|2:o&1),pt&&Ur(s,u.treeForkCount),i):($t(s),null);case 22:case 23:return fi(s),$f(),u=s.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&($t(s),s.subtreeFlags&6&&(s.flags|=8192)):$t(s),o=s.updateQueue,o!==null&&ld(s,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),i!==null&&K(ka),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),jr(un),$t(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function NR(i,s){switch(Nf(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return jr(un),Ke(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Vt(s),null;case 31:if(s.memoizedState!==null){if(fi(s),s.alternate===null)throw Error(r(340));Oa()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(fi(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Oa()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return K(sn),null;case 4:return Ke(),null;case 10:return jr(s.type),null;case 22:case 23:return fi(s),$f(),i!==null&&K(ka),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return jr(un),null;case 25:return null;default:return null}}function v0(i,s){switch(Nf(s),s.tag){case 3:jr(un),Ke();break;case 26:case 27:case 5:Vt(s);break;case 4:Ke();break;case 31:s.memoizedState!==null&&fi(s);break;case 13:fi(s);break;case 19:K(sn);break;case 10:jr(s.type);break;case 22:case 23:fi(s),$f(),i!==null&&K(ka);break;case 24:jr(un)}}function sc(i,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var p=u.next;o=p;do{if((o.tag&i)===i){u=void 0;var y=o.create,w=o.inst;u=y(),w.destroy=u}o=o.next}while(o!==p)}}catch(R){Ot(s,s.return,R)}}function Us(i,s,o){try{var u=s.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&i)===i){var w=u.inst,R=w.destroy;if(R!==void 0){w.destroy=void 0,p=s;var V=o,J=R;try{J()}catch(ae){Ot(p,V,ae)}}}u=u.next}while(u!==y)}}catch(ae){Ot(s,s.return,ae)}}function E0(i){var s=i.updateQueue;if(s!==null){var o=i.stateNode;try{u_(s,o)}catch(u){Ot(i,i.return,u)}}}function S0(i,s,o){o.props=ja(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(u){Ot(i,s,u)}}function ac(i,s){try{var o=i.ref;if(o!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof o=="function"?i.refCleanup=o(u):o.current=u}}catch(p){Ot(i,s,p)}}function dr(i,s){var o=i.ref,u=i.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(p){Ot(i,s,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){Ot(i,s,p)}else o.current=null}function w0(i){var s=i.type,o=i.memoizedProps,u=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(p){Ot(i,i.return,p)}}function bm(i,s,o){try{var u=i.stateNode;JR(u,i.type,o,s),u[Pn]=s}catch(p){Ot(i,i.return,p)}}function b0(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Hs(i.type)||i.tag===4}function Tm(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||b0(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Hs(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Am(i,s,o){var u=i.tag;if(u===5||u===6)i=i.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(i,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(i),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Sn));else if(u!==4&&(u===27&&Hs(i.type)&&(o=i.stateNode,s=null),i=i.child,i!==null))for(Am(i,s,o),i=i.sibling;i!==null;)Am(i,s,o),i=i.sibling}function cd(i,s,o){var u=i.tag;if(u===5||u===6)i=i.stateNode,s?o.insertBefore(i,s):o.appendChild(i);else if(u!==4&&(u===27&&Hs(i.type)&&(o=i.stateNode),i=i.child,i!==null))for(cd(i,s,o),i=i.sibling;i!==null;)cd(i,s,o),i=i.sibling}function T0(i){var s=i.stateNode,o=i.memoizedProps;try{for(var u=i.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);xn(s,u,o),s[Xt]=i,s[Pn]=o}catch(y){Ot(i,i.return,y)}}var Hr=!1,fn=!1,Rm=!1,A0=typeof WeakSet=="function"?WeakSet:Set,Tn=null;function OR(i,s){if(i=i.containerInfo,Ym=Nd,i=Uy(i),vf(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var p=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var w=0,R=-1,V=-1,J=0,ae=0,de=i,Z=null;t:for(;;){for(var ne;de!==o||p!==0&&de.nodeType!==3||(R=w+p),de!==y||u!==0&&de.nodeType!==3||(V=w+u),de.nodeType===3&&(w+=de.nodeValue.length),(ne=de.firstChild)!==null;)Z=de,de=ne;for(;;){if(de===i)break t;if(Z===o&&++J===p&&(R=w),Z===y&&++ae===u&&(V=w),(ne=de.nextSibling)!==null)break;de=Z,Z=de.parentNode}de=ne}o=R===-1||V===-1?null:{start:R,end:V}}else o=null}o=o||{start:0,end:0}}else o=null;for(Km={focusedElem:i,selectionRange:o},Nd=!1,Tn=s;Tn!==null;)if(s=Tn,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,Tn=i;else for(;Tn!==null;){switch(s=Tn,y=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(o=0;o<i.length;o++)p=i[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var Oe=ja(o.type,p);i=u.getSnapshotBeforeUpdate(Oe,y),u.__reactInternalSnapshotBeforeUpdate=i}catch(Be){Ot(o,o.return,Be)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,o=i.nodeType,o===9)Xm(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Xm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,Tn=i;break}Tn=s.return}}function R0(i,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:qr(i,o),u&4&&sc(5,o);break;case 1:if(qr(i,o),u&4)if(i=o.stateNode,s===null)try{i.componentDidMount()}catch(w){Ot(o,o.return,w)}else{var p=ja(o.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(p,s,i.__reactInternalSnapshotBeforeUpdate)}catch(w){Ot(o,o.return,w)}}u&64&&E0(o),u&512&&ac(o,o.return);break;case 3:if(qr(i,o),u&64&&(i=o.updateQueue,i!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{u_(i,s)}catch(w){Ot(o,o.return,w)}}break;case 27:s===null&&u&4&&T0(o);case 26:case 5:qr(i,o),s===null&&u&4&&w0(o),u&512&&ac(o,o.return);break;case 12:qr(i,o);break;case 31:qr(i,o),u&4&&C0(i,o);break;case 13:qr(i,o),u&4&&N0(i,o),u&64&&(i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(o=zR.bind(null,o),aI(i,o))));break;case 22:if(u=o.memoizedState!==null||Hr,!u){s=s!==null&&s.memoizedState!==null||fn,p=Hr;var y=fn;Hr=u,(fn=s)&&!y?Yr(i,o,(o.subtreeFlags&8772)!==0):qr(i,o),Hr=p,fn=y}break;case 30:break;default:qr(i,o)}}function I0(i){var s=i.alternate;s!==null&&(i.alternate=null,I0(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&ya(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var qt=null,Wn=!1;function $r(i,s,o){for(o=o.child;o!==null;)P0(i,s,o),o=o.sibling}function P0(i,s,o){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(It,o)}catch{}switch(o.tag){case 26:fn||dr(o,s),$r(i,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:fn||dr(o,s);var u=qt,p=Wn;Hs(o.type)&&(qt=o.stateNode,Wn=!1),$r(i,s,o),pc(o.stateNode),qt=u,Wn=p;break;case 5:fn||dr(o,s);case 6:if(u=qt,p=Wn,qt=null,$r(i,s,o),qt=u,Wn=p,qt!==null)if(Wn)try{(qt.nodeType===9?qt.body:qt.nodeName==="HTML"?qt.ownerDocument.body:qt).removeChild(o.stateNode)}catch(y){Ot(o,s,y)}else try{qt.removeChild(o.stateNode)}catch(y){Ot(o,s,y)}break;case 18:qt!==null&&(Wn?(i=qt,Ev(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,o.stateNode),Ko(i)):Ev(qt,o.stateNode));break;case 4:u=qt,p=Wn,qt=o.stateNode.containerInfo,Wn=!0,$r(i,s,o),qt=u,Wn=p;break;case 0:case 11:case 14:case 15:Us(2,o,s),fn||Us(4,o,s),$r(i,s,o);break;case 1:fn||(dr(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&S0(o,s,u)),$r(i,s,o);break;case 21:$r(i,s,o);break;case 22:fn=(u=fn)||o.memoizedState!==null,$r(i,s,o),fn=u;break;default:$r(i,s,o)}}function C0(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Ko(i)}catch(o){Ot(s,s.return,o)}}}function N0(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Ko(i)}catch(o){Ot(s,s.return,o)}}function xR(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new A0),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new A0),s;default:throw Error(r(435,i.tag))}}function ud(i,s){var o=xR(i);s.forEach(function(u){if(!o.has(u)){o.add(u);var p=BR.bind(null,i,u);u.then(p,p)}})}function Qn(i,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var p=o[u],y=i,w=s,R=w;e:for(;R!==null;){switch(R.tag){case 27:if(Hs(R.type)){qt=R.stateNode,Wn=!1;break e}break;case 5:qt=R.stateNode,Wn=!1;break e;case 3:case 4:qt=R.stateNode.containerInfo,Wn=!0;break e}R=R.return}if(qt===null)throw Error(r(160));P0(y,w,p),qt=null,Wn=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)O0(s,i),s=s.sibling}var Hi=null;function O0(i,s){var o=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Qn(s,i),Xn(i),u&4&&(Us(3,i,i.return),sc(3,i),Us(5,i,i.return));break;case 1:Qn(s,i),Xn(i),u&512&&(fn||o===null||dr(o,o.return)),u&64&&Hr&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var p=Hi;if(Qn(s,i),Xn(i),u&512&&(fn||o===null||dr(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=i.memoizedState,o===null)if(u===null)if(i.stateNode===null){e:{u=i.type,o=i.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Pr]||y[Xt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(u),p.head.insertBefore(y,p.querySelector("head > title"))),xn(y,u,o),y[Xt]=i,rn(y),u=y;break e;case"link":var w=Ov("link","href",p).get(u+(o.href||""));if(w){for(var R=0;R<w.length;R++)if(y=w[R],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(R,1);break t}}y=p.createElement(u),xn(y,u,o),p.head.appendChild(y);break;case"meta":if(w=Ov("meta","content",p).get(u+(o.content||""))){for(R=0;R<w.length;R++)if(y=w[R],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(R,1);break t}}y=p.createElement(u),xn(y,u,o),p.head.appendChild(y);break;default:throw Error(r(468,u))}y[Xt]=i,rn(y),u=y}i.stateNode=u}else xv(p,i.type,i.stateNode);else i.stateNode=Nv(p,u,i.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?xv(p,i.type,i.stateNode):Nv(p,u,i.memoizedProps)):u===null&&i.stateNode!==null&&bm(i,i.memoizedProps,o.memoizedProps)}break;case 27:Qn(s,i),Xn(i),u&512&&(fn||o===null||dr(o,o.return)),o!==null&&u&4&&bm(i,i.memoizedProps,o.memoizedProps);break;case 5:if(Qn(s,i),Xn(i),u&512&&(fn||o===null||dr(o,o.return)),i.flags&32){p=i.stateNode;try{bi(p,"")}catch(Oe){Ot(i,i.return,Oe)}}u&4&&i.stateNode!=null&&(p=i.memoizedProps,bm(i,p,o!==null?o.memoizedProps:p)),u&1024&&(Rm=!0);break;case 6:if(Qn(s,i),Xn(i),u&4){if(i.stateNode===null)throw Error(r(162));u=i.memoizedProps,o=i.stateNode;try{o.nodeValue=u}catch(Oe){Ot(i,i.return,Oe)}}break;case 3:if(Rd=null,p=Hi,Hi=Td(s.containerInfo),Qn(s,i),Hi=p,Xn(i),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Ko(s.containerInfo)}catch(Oe){Ot(i,i.return,Oe)}Rm&&(Rm=!1,x0(i));break;case 4:u=Hi,Hi=Td(i.stateNode.containerInfo),Qn(s,i),Xn(i),Hi=u;break;case 12:Qn(s,i),Xn(i);break;case 31:Qn(s,i),Xn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,ud(i,u)));break;case 13:Qn(s,i),Xn(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(hd=et()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,ud(i,u)));break;case 22:p=i.memoizedState!==null;var V=o!==null&&o.memoizedState!==null,J=Hr,ae=fn;if(Hr=J||p,fn=ae||V,Qn(s,i),fn=ae,Hr=J,Xn(i),u&8192)e:for(s=i.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||V||Hr||fn||za(i)),o=null,s=i;;){if(s.tag===5||s.tag===26){if(o===null){V=o=s;try{if(y=V.stateNode,p)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{R=V.stateNode;var de=V.memoizedProps.style,Z=de!=null&&de.hasOwnProperty("display")?de.display:null;R.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(Oe){Ot(V,V.return,Oe)}}}else if(s.tag===6){if(o===null){V=s;try{V.stateNode.nodeValue=p?"":V.memoizedProps}catch(Oe){Ot(V,V.return,Oe)}}}else if(s.tag===18){if(o===null){V=s;try{var ne=V.stateNode;p?Sv(ne,!0):Sv(V.stateNode,!1)}catch(Oe){Ot(V,V.return,Oe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=i.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,ud(i,o))));break;case 19:Qn(s,i),Xn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,ud(i,u)));break;case 30:break;case 21:break;default:Qn(s,i),Xn(i)}}function Xn(i){var s=i.flags;if(s&2){try{for(var o,u=i.return;u!==null;){if(b0(u)){o=u;break}u=u.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var p=o.stateNode,y=Tm(i);cd(i,y,p);break;case 5:var w=o.stateNode;o.flags&32&&(bi(w,""),o.flags&=-33);var R=Tm(i);cd(i,R,w);break;case 3:case 4:var V=o.stateNode.containerInfo,J=Tm(i);Am(i,J,V);break;default:throw Error(r(161))}}catch(ae){Ot(i,i.return,ae)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function x0(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;x0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function qr(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)R0(i,s.alternate,s),s=s.sibling}function za(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Us(4,s,s.return),za(s);break;case 1:dr(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&S0(s,s.return,o),za(s);break;case 27:pc(s.stateNode);case 26:case 5:dr(s,s.return),za(s);break;case 22:s.memoizedState===null&&za(s);break;case 30:za(s);break;default:za(s)}i=i.sibling}}function Yr(i,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,p=i,y=s,w=y.flags;switch(y.tag){case 0:case 11:case 15:Yr(p,y,o),sc(4,y);break;case 1:if(Yr(p,y,o),u=y,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(J){Ot(u,u.return,J)}if(u=y,p=u.updateQueue,p!==null){var R=u.stateNode;try{var V=p.shared.hiddenCallbacks;if(V!==null)for(p.shared.hiddenCallbacks=null,p=0;p<V.length;p++)c_(V[p],R)}catch(J){Ot(u,u.return,J)}}o&&w&64&&E0(y),ac(y,y.return);break;case 27:T0(y);case 26:case 5:Yr(p,y,o),o&&u===null&&w&4&&w0(y),ac(y,y.return);break;case 12:Yr(p,y,o);break;case 31:Yr(p,y,o),o&&w&4&&C0(p,y);break;case 13:Yr(p,y,o),o&&w&4&&N0(p,y);break;case 22:y.memoizedState===null&&Yr(p,y,o),ac(y,y.return);break;case 30:break;default:Yr(p,y,o)}s=s.sibling}}function Im(i,s){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&ql(o))}function Pm(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ql(i))}function $i(i,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)D0(i,s,o,u),s=s.sibling}function D0(i,s,o,u){var p=s.flags;switch(s.tag){case 0:case 11:case 15:$i(i,s,o,u),p&2048&&sc(9,s);break;case 1:$i(i,s,o,u);break;case 3:$i(i,s,o,u),p&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ql(i)));break;case 12:if(p&2048){$i(i,s,o,u),i=s.stateNode;try{var y=s.memoizedProps,w=y.id,R=y.onPostCommit;typeof R=="function"&&R(w,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(V){Ot(s,s.return,V)}}else $i(i,s,o,u);break;case 31:$i(i,s,o,u);break;case 13:$i(i,s,o,u);break;case 23:break;case 22:y=s.stateNode,w=s.alternate,s.memoizedState!==null?y._visibility&2?$i(i,s,o,u):oc(i,s):y._visibility&2?$i(i,s,o,u):(y._visibility|=2,Uo(i,s,o,u,(s.subtreeFlags&10256)!==0||!1)),p&2048&&Im(w,s);break;case 24:$i(i,s,o,u),p&2048&&Pm(s.alternate,s);break;default:$i(i,s,o,u)}}function Uo(i,s,o,u,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=i,w=s,R=o,V=u,J=w.flags;switch(w.tag){case 0:case 11:case 15:Uo(y,w,R,V,p),sc(8,w);break;case 23:break;case 22:var ae=w.stateNode;w.memoizedState!==null?ae._visibility&2?Uo(y,w,R,V,p):oc(y,w):(ae._visibility|=2,Uo(y,w,R,V,p)),p&&J&2048&&Im(w.alternate,w);break;case 24:Uo(y,w,R,V,p),p&&J&2048&&Pm(w.alternate,w);break;default:Uo(y,w,R,V,p)}s=s.sibling}}function oc(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=i,u=s,p=u.flags;switch(u.tag){case 22:oc(o,u),p&2048&&Im(u.alternate,u);break;case 24:oc(o,u),p&2048&&Pm(u.alternate,u);break;default:oc(o,u)}s=s.sibling}}var lc=8192;function Vo(i,s,o){if(i.subtreeFlags&lc)for(i=i.child;i!==null;)k0(i,s,o),i=i.sibling}function k0(i,s,o){switch(i.tag){case 26:Vo(i,s,o),i.flags&lc&&i.memoizedState!==null&&_I(o,Hi,i.memoizedState,i.memoizedProps);break;case 5:Vo(i,s,o);break;case 3:case 4:var u=Hi;Hi=Td(i.stateNode.containerInfo),Vo(i,s,o),Hi=u;break;case 22:i.memoizedState===null&&(u=i.alternate,u!==null&&u.memoizedState!==null?(u=lc,lc=16777216,Vo(i,s,o),lc=u):Vo(i,s,o));break;default:Vo(i,s,o)}}function M0(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function cc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];Tn=u,U0(u,i)}M0(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)L0(i),i=i.sibling}function L0(i){switch(i.tag){case 0:case 11:case 15:cc(i),i.flags&2048&&Us(9,i,i.return);break;case 3:cc(i);break;case 12:cc(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,dd(i)):cc(i);break;default:cc(i)}}function dd(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];Tn=u,U0(u,i)}M0(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Us(8,s,s.return),dd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,dd(s));break;default:dd(s)}i=i.sibling}}function U0(i,s){for(;Tn!==null;){var o=Tn;switch(o.tag){case 0:case 11:case 15:Us(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:ql(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Tn=u;else e:for(o=i;Tn!==null;){u=Tn;var p=u.sibling,y=u.return;if(I0(u),u===o){Tn=null;break e}if(p!==null){p.return=y,Tn=p;break e}Tn=y}}}var DR={getCacheForType:function(i){var s=Nn(un),o=s.data.get(i);return o===void 0&&(o=i(),s.data.set(i,o)),o},cacheSignal:function(){return Nn(un).controller.signal}},kR=typeof WeakMap=="function"?WeakMap:Map,Tt=0,jt=null,ct=null,dt=0,Nt=0,mi=null,Vs=!1,jo=!1,Cm=!1,Kr=0,en=0,js=0,Ba=0,Nm=0,pi=0,zo=0,uc=null,Jn=null,Om=!1,hd=0,V0=0,fd=1/0,md=null,zs=null,_n=0,Bs=null,Bo=null,Wr=0,xm=0,Dm=null,j0=null,dc=0,km=null;function gi(){return(Tt&2)!==0&&dt!==0?dt&-dt:ee.T!==null?zm():Ir()}function z0(){if(pi===0)if((dt&536870912)===0||pt){var i=tr;tr<<=1,(tr&3932160)===0&&(tr=262144),pi=i}else pi=536870912;return i=hi.current,i!==null&&(i.flags|=32),pi}function Zn(i,s,o){(i===jt&&(Nt===2||Nt===9)||i.cancelPendingCommit!==null)&&(Fo(i,0),Fs(i,dt,pi,!1)),ds(i,o),((Tt&2)===0||i!==jt)&&(i===jt&&((Tt&2)===0&&(Ba|=o),en===4&&Fs(i,dt,pi,!1)),hr(i))}function B0(i,s,o){if((Tt&6)!==0)throw Error(r(327));var u=!o&&(s&127)===0&&(s&i.expiredLanes)===0||us(i,s),p=u?UR(i,s):Lm(i,s,!0),y=u;do{if(p===0){jo&&!u&&Fs(i,s,0,!1);break}else{if(o=i.current.alternate,y&&!MR(o)){p=Lm(i,s,!1),y=!1;continue}if(p===2){if(y=s,i.errorRecoveryDisabledLanes&y)var w=0;else w=i.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){s=w;e:{var R=i;p=uc;var V=R.current.memoizedState.isDehydrated;if(V&&(Fo(R,w).flags|=256),w=Lm(R,w,!1),w!==2){if(Cm&&!V){R.errorRecoveryDisabledLanes|=y,Ba|=y,p=4;break e}y=Jn,Jn=p,y!==null&&(Jn===null?Jn=y:Jn.push.apply(Jn,y))}p=w}if(y=!1,p!==2)continue}}if(p===1){Fo(i,0),Fs(i,s,0,!0);break}e:{switch(u=i,y=p,y){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:Fs(u,s,pi,!Vs);break e;case 2:Jn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(p=hd+300-et(),10<p)){if(Fs(u,s,pi,!Vs),Si(u,0,!0)!==0)break e;Wr=s,u.timeoutHandle=_v(F0.bind(null,u,o,Jn,md,Om,s,pi,Ba,zo,Vs,y,"Throttled",-0,0),p);break e}F0(u,o,Jn,md,Om,s,pi,Ba,zo,Vs,y,null,-0,0)}}break}while(!0);hr(i)}function F0(i,s,o,u,p,y,w,R,V,J,ae,de,Z,ne){if(i.timeoutHandle=-1,de=s.subtreeFlags,de&8192||(de&16785408)===16785408){de={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Sn},k0(s,y,de);var Oe=(y&62914560)===y?hd-et():(y&4194048)===y?V0-et():0;if(Oe=vI(de,Oe),Oe!==null){Wr=y,i.cancelPendingCommit=Oe(Q0.bind(null,i,s,y,o,u,p,w,R,V,ae,de,null,Z,ne)),Fs(i,y,w,!J);return}}Q0(i,s,y,o,u,p,w,R,V)}function MR(i){for(var s=i;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var p=o[u],y=p.getSnapshot;p=p.value;try{if(!ui(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Fs(i,s,o,u){s&=~Nm,s&=~Ba,i.suspendedLanes|=s,i.pingedLanes&=~s,u&&(i.warmLanes|=s),u=i.expirationTimes;for(var p=s;0<p;){var y=31-Et(p),w=1<<y;u[y]=-1,p&=~w}o!==0&&Al(i,o,s)}function pd(){return(Tt&6)===0?(hc(0),!1):!0}function Mm(){if(ct!==null){if(Nt===0)var i=ct.return;else i=ct,Vr=xa=null,Xf(i),xo=null,Kl=0,i=ct;for(;i!==null;)v0(i.alternate,i),i=i.return;ct=null}}function Fo(i,s){var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,tI(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),Wr=0,Mm(),jt=i,ct=o=Lr(i.current,null),dt=s,Nt=0,mi=null,Vs=!1,jo=us(i,s),Cm=!1,zo=pi=Nm=Ba=js=en=0,Jn=uc=null,Om=!1,(s&8)!==0&&(s|=s&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=s;0<u;){var p=31-Et(u),y=1<<p;s|=i[p],u&=~y}return Kr=s,Lu(),o}function G0(i,s){rt=null,ee.H=nc,s===Oo||s===Hu?(s=s_(),Nt=3):s===jf?(s=s_(),Nt=4):Nt=s===fm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,mi=s,ct===null&&(en=1,rd(i,Ai(s,i.current)))}function H0(){var i=hi.current;return i===null?!0:(dt&4194048)===dt?Ci===null:(dt&62914560)===dt||(dt&536870912)!==0?i===Ci:!1}function $0(){var i=ee.H;return ee.H=nc,i===null?nc:i}function q0(){var i=ee.A;return ee.A=DR,i}function gd(){en=4,Vs||(dt&4194048)!==dt&&hi.current!==null||(jo=!0),(js&134217727)===0&&(Ba&134217727)===0||jt===null||Fs(jt,dt,pi,!1)}function Lm(i,s,o){var u=Tt;Tt|=2;var p=$0(),y=q0();(jt!==i||dt!==s)&&(md=null,Fo(i,s)),s=!1;var w=en;e:do try{if(Nt!==0&&ct!==null){var R=ct,V=mi;switch(Nt){case 8:Mm(),w=6;break e;case 3:case 2:case 9:case 6:hi.current===null&&(s=!0);var J=Nt;if(Nt=0,mi=null,Go(i,R,V,J),o&&jo){w=0;break e}break;default:J=Nt,Nt=0,mi=null,Go(i,R,V,J)}}LR(),w=en;break}catch(ae){G0(i,ae)}while(!0);return s&&i.shellSuspendCounter++,Vr=xa=null,Tt=u,ee.H=p,ee.A=y,ct===null&&(jt=null,dt=0,Lu()),w}function LR(){for(;ct!==null;)Y0(ct)}function UR(i,s){var o=Tt;Tt|=2;var u=$0(),p=q0();jt!==i||dt!==s?(md=null,fd=et()+500,Fo(i,s)):jo=us(i,s);e:do try{if(Nt!==0&&ct!==null){s=ct;var y=mi;t:switch(Nt){case 1:Nt=0,mi=null,Go(i,s,y,1);break;case 2:case 9:if(i_(y)){Nt=0,mi=null,K0(s);break}s=function(){Nt!==2&&Nt!==9||jt!==i||(Nt=7),hr(i)},y.then(s,s);break e;case 3:Nt=7;break e;case 4:Nt=5;break e;case 7:i_(y)?(Nt=0,mi=null,K0(s)):(Nt=0,mi=null,Go(i,s,y,7));break;case 5:var w=null;switch(ct.tag){case 26:w=ct.memoizedState;case 5:case 27:var R=ct;if(w?Dv(w):R.stateNode.complete){Nt=0,mi=null;var V=R.sibling;if(V!==null)ct=V;else{var J=R.return;J!==null?(ct=J,yd(J)):ct=null}break t}}Nt=0,mi=null,Go(i,s,y,5);break;case 6:Nt=0,mi=null,Go(i,s,y,6);break;case 8:Mm(),en=6;break e;default:throw Error(r(462))}}VR();break}catch(ae){G0(i,ae)}while(!0);return Vr=xa=null,ee.H=u,ee.A=p,Tt=o,ct!==null?0:(jt=null,dt=0,Lu(),en)}function VR(){for(;ct!==null&&!it();)Y0(ct)}function Y0(i){var s=y0(i.alternate,i,Kr);i.memoizedProps=i.pendingProps,s===null?yd(i):ct=s}function K0(i){var s=i,o=s.alternate;switch(s.tag){case 15:case 0:s=d0(o,s,s.pendingProps,s.type,void 0,dt);break;case 11:s=d0(o,s,s.pendingProps,s.type.render,s.ref,dt);break;case 5:Xf(s);default:v0(o,s),s=ct=qy(s,Kr),s=y0(o,s,Kr)}i.memoizedProps=i.pendingProps,s===null?yd(i):ct=s}function Go(i,s,o,u){Vr=xa=null,Xf(s),xo=null,Kl=0;var p=s.return;try{if(RR(i,p,s,o,dt)){en=1,rd(i,Ai(o,i.current)),ct=null;return}}catch(y){if(p!==null)throw ct=p,y;en=1,rd(i,Ai(o,i.current)),ct=null;return}s.flags&32768?(pt||u===1?i=!0:jo||(dt&536870912)!==0?i=!1:(Vs=i=!0,(u===2||u===9||u===3||u===6)&&(u=hi.current,u!==null&&u.tag===13&&(u.flags|=16384))),W0(s,i)):yd(s)}function yd(i){var s=i;do{if((s.flags&32768)!==0){W0(s,Vs);return}i=s.return;var o=CR(s.alternate,s,Kr);if(o!==null){ct=o;return}if(s=s.sibling,s!==null){ct=s;return}ct=s=i}while(s!==null);en===0&&(en=5)}function W0(i,s){do{var o=NR(i.alternate,i);if(o!==null){o.flags&=32767,ct=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(i=i.sibling,i!==null)){ct=i;return}ct=i=o}while(i!==null);en=6,ct=null}function Q0(i,s,o,u,p,y,w,R,V){i.cancelPendingCommit=null;do _d();while(_n!==0);if((Tt&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(y=s.lanes|s.childLanes,y|=Tf,In(i,o,y,w,R,V),i===jt&&(ct=jt=null,dt=0),Bo=s,Bs=i,Wr=o,xm=y,Dm=p,j0=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,FR(ge,function(){return tv(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=ee.T,ee.T=null,p=he.p,he.p=2,w=Tt,Tt|=4;try{OR(i,s,o)}finally{Tt=w,he.p=p,ee.T=u}}_n=1,X0(),J0(),Z0()}}function X0(){if(_n===1){_n=0;var i=Bs,s=Bo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=ee.T,ee.T=null;var u=he.p;he.p=2;var p=Tt;Tt|=4;try{O0(s,i);var y=Km,w=Uy(i.containerInfo),R=y.focusedElem,V=y.selectionRange;if(w!==R&&R&&R.ownerDocument&&Ly(R.ownerDocument.documentElement,R)){if(V!==null&&vf(R)){var J=V.start,ae=V.end;if(ae===void 0&&(ae=J),"selectionStart"in R)R.selectionStart=J,R.selectionEnd=Math.min(ae,R.value.length);else{var de=R.ownerDocument||document,Z=de&&de.defaultView||window;if(Z.getSelection){var ne=Z.getSelection(),Oe=R.textContent.length,Be=Math.min(V.start,Oe),Lt=V.end===void 0?Be:Math.min(V.end,Oe);!ne.extend&&Be>Lt&&(w=Lt,Lt=Be,Be=w);var q=My(R,Be),F=My(R,Lt);if(q&&F&&(ne.rangeCount!==1||ne.anchorNode!==q.node||ne.anchorOffset!==q.offset||ne.focusNode!==F.node||ne.focusOffset!==F.offset)){var Q=de.createRange();Q.setStart(q.node,q.offset),ne.removeAllRanges(),Be>Lt?(ne.addRange(Q),ne.extend(F.node,F.offset)):(Q.setEnd(F.node,F.offset),ne.addRange(Q))}}}}for(de=[],ne=R;ne=ne.parentNode;)ne.nodeType===1&&de.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<de.length;R++){var le=de[R];le.element.scrollLeft=le.left,le.element.scrollTop=le.top}}Nd=!!Ym,Km=Ym=null}finally{Tt=p,he.p=u,ee.T=o}}i.current=s,_n=2}}function J0(){if(_n===2){_n=0;var i=Bs,s=Bo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=ee.T,ee.T=null;var u=he.p;he.p=2;var p=Tt;Tt|=4;try{R0(i,s.alternate,s)}finally{Tt=p,he.p=u,ee.T=o}}_n=3}}function Z0(){if(_n===4||_n===3){_n=0,Rt();var i=Bs,s=Bo,o=Wr,u=j0;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?_n=5:(_n=0,Bo=Bs=null,ev(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(zs=null),Il(o),s=s.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(It,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=ee.T,p=he.p,he.p=2,ee.T=null;try{for(var y=i.onRecoverableError,w=0;w<u.length;w++){var R=u[w];y(R.value,{componentStack:R.stack})}}finally{ee.T=s,he.p=p}}(Wr&3)!==0&&_d(),hr(i),p=i.pendingLanes,(o&261930)!==0&&(p&42)!==0?i===km?dc++:(dc=0,km=i):dc=0,hc(0)}}function ev(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,ql(s)))}function _d(){return X0(),J0(),Z0(),tv()}function tv(){if(_n!==5)return!1;var i=Bs,s=xm;xm=0;var o=Il(Wr),u=ee.T,p=he.p;try{he.p=32>o?32:o,ee.T=null,o=Dm,Dm=null;var y=Bs,w=Wr;if(_n=0,Bo=Bs=null,Wr=0,(Tt&6)!==0)throw Error(r(331));var R=Tt;if(Tt|=4,L0(y.current),D0(y,y.current,w,o),Tt=R,hc(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(It,y)}catch{}return!0}finally{he.p=p,ee.T=u,ev(i,s)}}function nv(i,s,o){s=Ai(o,s),s=hm(i.stateNode,s,2),i=ks(i,s,2),i!==null&&(ds(i,2),hr(i))}function Ot(i,s,o){if(i.tag===3)nv(i,i,o);else for(;s!==null;){if(s.tag===3){nv(s,i,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(zs===null||!zs.has(u))){i=Ai(o,i),o=i0(2),u=ks(s,o,2),u!==null&&(r0(o,u,s,i),ds(u,2),hr(u));break}}s=s.return}}function Um(i,s,o){var u=i.pingCache;if(u===null){u=i.pingCache=new kR;var p=new Set;u.set(s,p)}else p=u.get(s),p===void 0&&(p=new Set,u.set(s,p));p.has(o)||(Cm=!0,p.add(o),i=jR.bind(null,i,s,o),s.then(i,i))}function jR(i,s,o){var u=i.pingCache;u!==null&&u.delete(s),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,jt===i&&(dt&o)===o&&(en===4||en===3&&(dt&62914560)===dt&&300>et()-hd?(Tt&2)===0&&Fo(i,0):Nm|=o,zo===dt&&(zo=0)),hr(i)}function iv(i,s){s===0&&(s=Tl()),i=Ca(i,s),i!==null&&(ds(i,s),hr(i))}function zR(i){var s=i.memoizedState,o=0;s!==null&&(o=s.retryLane),iv(i,o)}function BR(i,s){var o=0;switch(i.tag){case 31:case 13:var u=i.stateNode,p=i.memoizedState;p!==null&&(o=p.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(s),iv(i,o)}function FR(i,s){return Se(i,s)}var vd=null,Ho=null,Vm=!1,Ed=!1,jm=!1,Gs=0;function hr(i){i!==Ho&&i.next===null&&(Ho===null?vd=Ho=i:Ho=Ho.next=i),Ed=!0,Vm||(Vm=!0,HR())}function hc(i,s){if(!jm&&Ed){jm=!0;do for(var o=!1,u=vd;u!==null;){if(i!==0){var p=u.pendingLanes;if(p===0)var y=0;else{var w=u.suspendedLanes,R=u.pingedLanes;y=(1<<31-Et(42|i)+1)-1,y&=p&~(w&~R),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,ov(u,y))}else y=dt,y=Si(u,u===jt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||us(u,y)||(o=!0,ov(u,y));u=u.next}while(o);jm=!1}}function GR(){rv()}function rv(){Ed=Vm=!1;var i=0;Gs!==0&&eI()&&(i=Gs);for(var s=et(),o=null,u=vd;u!==null;){var p=u.next,y=sv(u,s);y===0?(u.next=null,o===null?vd=p:o.next=p,p===null&&(Ho=o)):(o=u,(i!==0||(y&3)!==0)&&(Ed=!0)),u=p}_n!==0&&_n!==5||hc(i),Gs!==0&&(Gs=0)}function sv(i,s){for(var o=i.suspendedLanes,u=i.pingedLanes,p=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var w=31-Et(y),R=1<<w,V=p[w];V===-1?((R&o)===0||(R&u)!==0)&&(p[w]=co(R,s)):V<=s&&(i.expiredLanes|=R),y&=~R}if(s=jt,o=dt,o=Si(i,i===s?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,o===0||i===s&&(Nt===2||Nt===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&ze(u),i.callbackNode=null,i.callbackPriority=0;if((o&3)===0||us(i,o)){if(s=o&-o,s===i.callbackPriority)return s;switch(u!==null&&ze(u),Il(o)){case 2:case 8:o=me;break;case 32:o=ge;break;case 268435456:o=ye;break;default:o=ge}return u=av.bind(null,i),o=Se(o,u),i.callbackPriority=s,i.callbackNode=o,s}return u!==null&&u!==null&&ze(u),i.callbackPriority=2,i.callbackNode=null,2}function av(i,s){if(_n!==0&&_n!==5)return i.callbackNode=null,i.callbackPriority=0,null;var o=i.callbackNode;if(_d()&&i.callbackNode!==o)return null;var u=dt;return u=Si(i,i===jt?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:(B0(i,u,s),sv(i,et()),i.callbackNode!=null&&i.callbackNode===o?av.bind(null,i):null)}function ov(i,s){if(_d())return null;B0(i,s,!0)}function HR(){nI(function(){(Tt&6)!==0?Se(_e,GR):rv()})}function zm(){if(Gs===0){var i=Co;i===0&&(i=ji,ji<<=1,(ji&261888)===0&&(ji=256)),Gs=i}return Gs}function lv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ar(""+i)}function cv(i,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,i.id&&o.setAttribute("form",i.id),s.parentNode.insertBefore(o,s),i=new FormData(i),o.parentNode.removeChild(o),i}function $R(i,s,o,u,p){if(s==="submit"&&o&&o.stateNode===p){var y=lv((p[Pn]||null).action),w=u.submitter;w&&(s=(s=w[Pn]||null)?lv(s.formAction):w.getAttribute("formAction"),s!==null&&(y=s,w=null));var R=new wa("action","action",null,u,p);i.push({event:R,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Gs!==0){var V=w?cv(p,w):new FormData(p);am(o,{pending:!0,data:V,method:p.method,action:y},null,V)}}else typeof y=="function"&&(R.preventDefault(),V=w?cv(p,w):new FormData(p),am(o,{pending:!0,data:V,method:p.method,action:y},y,V))},currentTarget:p}]})}}for(var Bm=0;Bm<bf.length;Bm++){var Fm=bf[Bm],qR=Fm.toLowerCase(),YR=Fm[0].toUpperCase()+Fm.slice(1);Gi(qR,"on"+YR)}Gi(zy,"onAnimationEnd"),Gi(By,"onAnimationIteration"),Gi(Fy,"onAnimationStart"),Gi("dblclick","onDoubleClick"),Gi("focusin","onFocus"),Gi("focusout","onBlur"),Gi(cR,"onTransitionRun"),Gi(uR,"onTransitionStart"),Gi(dR,"onTransitionCancel"),Gi(Gy,"onTransitionEnd"),sr("onMouseEnter",["mouseout","mouseover"]),sr("onMouseLeave",["mouseout","mouseover"]),sr("onPointerEnter",["pointerout","pointerover"]),sr("onPointerLeave",["pointerout","pointerover"]),Bn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Bn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Bn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Bn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Bn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Bn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fc));function uv(i,s){s=(s&4)!==0;for(var o=0;o<i.length;o++){var u=i[o],p=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var w=u.length-1;0<=w;w--){var R=u[w],V=R.instance,J=R.currentTarget;if(R=R.listener,V!==y&&p.isPropagationStopped())break e;y=R,p.currentTarget=J;try{y(p)}catch(ae){Mu(ae)}p.currentTarget=null,y=V}else for(w=0;w<u.length;w++){if(R=u[w],V=R.instance,J=R.currentTarget,R=R.listener,V!==y&&p.isPropagationStopped())break e;y=R,p.currentTarget=J;try{y(p)}catch(ae){Mu(ae)}p.currentTarget=null,y=V}}}}function ut(i,s){var o=s[ms];o===void 0&&(o=s[ms]=new Set);var u=i+"__bubble";o.has(u)||(dv(s,i,2,!1),o.add(u))}function Gm(i,s,o){var u=0;s&&(u|=4),dv(o,i,u,s)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function Hm(i){if(!i[Sd]){i[Sd]=!0,uo.forEach(function(o){o!=="selectionchange"&&(KR.has(o)||Gm(o,!1,i),Gm(o,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Sd]||(s[Sd]=!0,Gm("selectionchange",!1,s))}}function dv(i,s,o,u){switch(zv(s)){case 2:var p=wI;break;case 8:p=bI;break;default:p=sp}o=p.bind(null,s,o,i),p=void 0,!Ml||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),u?p!==void 0?i.addEventListener(s,o,{capture:!0,passive:p}):i.addEventListener(s,o,!0):p!==void 0?i.addEventListener(s,o,{passive:p}):i.addEventListener(s,o,!1)}function $m(i,s,o,u,p){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var R=u.stateNode.containerInfo;if(R===p)break;if(w===4)for(w=u.return;w!==null;){var V=w.tag;if((V===3||V===4)&&w.stateNode.containerInfo===p)return;w=w.return}for(;R!==null;){if(w=Cr(R),w===null)return;if(V=w.tag,V===5||V===6||V===26||V===27){u=y=w;continue e}R=R.parentNode}}u=u.return}vu(function(){var J=y,ae=go(o),de=[];e:{var Z=Hy.get(i);if(Z!==void 0){var ne=wa,Oe=i;switch(i){case"keypress":if(Sa(o)===0)break e;case"keydown":case"keyup":ne=Pu;break;case"focusin":Oe="focus",ne=Ts;break;case"focusout":Oe="blur",ne=Ts;break;case"beforeblur":case"afterblur":ne=Ts;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Su;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=wu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=Nu;break;case zy:case By:case Fy:ne=vo;break;case Gy:ne=Eo;break;case"scroll":case"scrollend":ne=Eu;break;case"wheel":ne=xu;break;case"copy":case"cut":case"paste":ne=Tu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=zl;break;case"toggle":case"beforetoggle":ne=Rs}var Be=(s&4)!==0,Lt=!Be&&(i==="scroll"||i==="scrollend"),q=Be?Z!==null?Z+"Capture":null:Z;Be=[];for(var F=J,Q;F!==null;){var le=F;if(Q=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||Q===null||q===null||(le=Yn(F,q),le!=null&&Be.push(mc(F,le,Q))),Lt)break;F=F.return}0<Be.length&&(Z=new ne(Z,Oe,null,o,ae),de.push({event:Z,listeners:Be}))}}if((s&7)===0){e:{if(Z=i==="mouseover"||i==="pointerover",ne=i==="mouseout"||i==="pointerout",Z&&o!==po&&(Oe=o.relatedTarget||o.fromElement)&&(Cr(Oe)||Oe[ir]))break e;if((ne||Z)&&(Z=ae.window===ae?ae:(Z=ae.ownerDocument)?Z.defaultView||Z.parentWindow:window,ne?(Oe=o.relatedTarget||o.toElement,ne=J,Oe=Oe?Cr(Oe):null,Oe!==null&&(Lt=l(Oe),Be=Oe.tag,Oe!==Lt||Be!==5&&Be!==27&&Be!==6)&&(Oe=null)):(ne=null,Oe=J),ne!==Oe)){if(Be=Su,le="onMouseLeave",q="onMouseEnter",F="mouse",(i==="pointerout"||i==="pointerover")&&(Be=zl,le="onPointerLeave",q="onPointerEnter",F="pointer"),Lt=ne==null?Z:_a(ne),Q=Oe==null?Z:_a(Oe),Z=new Be(le,F+"leave",ne,o,ae),Z.target=Lt,Z.relatedTarget=Q,le=null,Cr(ae)===J&&(Be=new Be(q,F+"enter",Oe,o,ae),Be.target=Q,Be.relatedTarget=Lt,le=Be),Lt=le,ne&&Oe)t:{for(Be=WR,q=ne,F=Oe,Q=0,le=q;le;le=Be(le))Q++;le=0;for(var ke=F;ke;ke=Be(ke))le++;for(;0<Q-le;)q=Be(q),Q--;for(;0<le-Q;)F=Be(F),le--;for(;Q--;){if(q===F||F!==null&&q===F.alternate){Be=q;break t}q=Be(q),F=Be(F)}Be=null}else Be=null;ne!==null&&hv(de,Z,ne,Be,!1),Oe!==null&&Lt!==null&&hv(de,Lt,Oe,Be,!0)}}e:{if(Z=J?_a(J):window,ne=Z.nodeName&&Z.nodeName.toLowerCase(),ne==="select"||ne==="input"&&Z.type==="file")var wt=Cy;else if(Kn(Z))if(Ny)wt=aR;else{wt=rR;var xe=iR}else ne=Z.nodeName,!ne||ne.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?J&&Dl(J.elementType)&&(wt=Cy):wt=sR;if(wt&&(wt=wt(i,J))){Ra(de,wt,o,ae);break e}xe&&xe(i,Z,J),i==="focusout"&&J&&Z.type==="number"&&J.memoizedProps.value!=null&&mo(Z,"number",Z.value)}switch(xe=J?_a(J):window,i){case"focusin":(Kn(xe)||xe.contentEditable==="true")&&(So=xe,Ef=J,Gl=null);break;case"focusout":Gl=Ef=So=null;break;case"mousedown":Sf=!0;break;case"contextmenu":case"mouseup":case"dragend":Sf=!1,Vy(de,o,ae);break;case"selectionchange":if(lR)break;case"keydown":case"keyup":Vy(de,o,ae)}var at;if(E)e:{switch(i){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else ot?Pt(i,o)&&(ht="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(ht="onCompositionStart");ht&&(Y&&o.locale!=="ko"&&(ot||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&ot&&(at=Es()):(ci=ae,yo="value"in ci?ci.value:ci.textContent,ot=!0)),xe=wd(J,ht),0<xe.length&&(ht=new Ul(ht,i,null,o,ae),de.push({event:ht,listeners:xe}),at?ht.data=at:(at=cn(o),at!==null&&(ht.data=at)))),(at=O?wn(i,o):bn(i,o))&&(ht=wd(J,"onBeforeInput"),0<ht.length&&(xe=new Ul("onBeforeInput","beforeinput",null,o,ae),de.push({event:xe,listeners:ht}),xe.data=at)),$R(de,i,J,o,ae)}uv(de,s)})}function mc(i,s,o){return{instance:i,listener:s,currentTarget:o}}function wd(i,s){for(var o=s+"Capture",u=[];i!==null;){var p=i,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Yn(i,o),p!=null&&u.unshift(mc(i,p,y)),p=Yn(i,s),p!=null&&u.push(mc(i,p,y))),i.tag===3)return u;i=i.return}return[]}function WR(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function hv(i,s,o,u,p){for(var y=s._reactName,w=[];o!==null&&o!==u;){var R=o,V=R.alternate,J=R.stateNode;if(R=R.tag,V!==null&&V===u)break;R!==5&&R!==26&&R!==27||J===null||(V=J,p?(J=Yn(o,y),J!=null&&w.unshift(mc(o,J,V))):p||(J=Yn(o,y),J!=null&&w.push(mc(o,J,V)))),o=o.return}w.length!==0&&i.push({event:s,listeners:w})}var QR=/\r\n?/g,XR=/\u0000|\uFFFD/g;function fv(i){return(typeof i=="string"?i:""+i).replace(QR,`
`).replace(XR,"")}function mv(i,s){return s=fv(s),fv(i)===s}function Mt(i,s,o,u,p,y){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||bi(i,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&bi(i,""+u);break;case"className":ys(i,"class",u);break;case"tabIndex":ys(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":ys(i,o,u);break;case"style":yu(i,u,y);break;case"data":if(s!=="object"){ys(i,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){i.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(o);break}u=ar(""+u),i.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&Mt(i,s,"name",p.name,p,null),Mt(i,s,"formEncType",p.formEncType,p,null),Mt(i,s,"formMethod",p.formMethod,p,null),Mt(i,s,"formTarget",p.formTarget,p,null)):(Mt(i,s,"encType",p.encType,p,null),Mt(i,s,"method",p.method,p,null),Mt(i,s,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(o);break}u=ar(""+u),i.setAttribute(o,u);break;case"onClick":u!=null&&(i.onclick=Sn);break;case"onScroll":u!=null&&ut("scroll",i);break;case"onScrollEnd":u!=null&&ut("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}o=ar(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(o,""+u):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":u===!0?i.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(o,u):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(o,u):i.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(o):i.setAttribute(o,u);break;case"popover":ut("beforetoggle",i),ut("toggle",i),gs(i,"popover",u);break;case"xlinkActuate":wi(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":wi(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":wi(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":wi(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":wi(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":wi(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":wi(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":wi(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":wi(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":gs(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=mf.get(o)||o,gs(i,o,u))}}function qm(i,s,o,u,p,y){switch(o){case"style":yu(i,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"children":typeof u=="string"?bi(i,u):(typeof u=="number"||typeof u=="bigint")&&bi(i,""+u);break;case"onScroll":u!=null&&ut("scroll",i);break;case"onScrollEnd":u!=null&&ut("scrollend",i);break;case"onClick":u!=null&&(i.onclick=Sn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ps.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=i[Pn]||null,y=y!=null?y[o]:null,typeof y=="function"&&i.removeEventListener(s,y,p),typeof u=="function")){typeof y!="function"&&y!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(s,u,p);break e}o in i?i[o]=u:u===!0?i.setAttribute(o,""):gs(i,o,u)}}}function xn(i,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ut("error",i),ut("load",i);var u=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var w=o[y];if(w!=null)switch(y){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Mt(i,s,y,w,o,null)}}p&&Mt(i,s,"srcSet",o.srcSet,o,null),u&&Mt(i,s,"src",o.src,o,null);return;case"input":ut("invalid",i);var R=y=w=p=null,V=null,J=null;for(u in o)if(o.hasOwnProperty(u)){var ae=o[u];if(ae!=null)switch(u){case"name":p=ae;break;case"type":w=ae;break;case"checked":V=ae;break;case"defaultChecked":J=ae;break;case"value":y=ae;break;case"defaultValue":R=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(137,s));break;default:Mt(i,s,u,ae,o,null)}}va(i,y,R,V,J,w,p,!1);return;case"select":ut("invalid",i),u=w=y=null;for(p in o)if(o.hasOwnProperty(p)&&(R=o[p],R!=null))switch(p){case"value":y=R;break;case"defaultValue":w=R;break;case"multiple":u=R;default:Mt(i,s,p,R,o,null)}s=y,o=w,i.multiple=!!u,s!=null?St(i,!!u,s,!1):o!=null&&St(i,!!u,o,!0);return;case"textarea":ut("invalid",i),y=p=u=null;for(w in o)if(o.hasOwnProperty(w)&&(R=o[w],R!=null))switch(w){case"value":u=R;break;case"defaultValue":p=R;break;case"children":y=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(r(91));break;default:Mt(i,s,w,R,o,null)}vs(i,u,p,y);return;case"option":for(V in o)if(o.hasOwnProperty(V)&&(u=o[V],u!=null))switch(V){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Mt(i,s,V,u,o,null)}return;case"dialog":ut("beforetoggle",i),ut("toggle",i),ut("cancel",i),ut("close",i);break;case"iframe":case"object":ut("load",i);break;case"video":case"audio":for(u=0;u<fc.length;u++)ut(fc[u],i);break;case"image":ut("error",i),ut("load",i);break;case"details":ut("toggle",i);break;case"embed":case"source":case"link":ut("error",i),ut("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in o)if(o.hasOwnProperty(J)&&(u=o[J],u!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Mt(i,s,J,u,o,null)}return;default:if(Dl(s)){for(ae in o)o.hasOwnProperty(ae)&&(u=o[ae],u!==void 0&&qm(i,s,ae,u,o,void 0));return}}for(R in o)o.hasOwnProperty(R)&&(u=o[R],u!=null&&Mt(i,s,R,u,o,null))}function JR(i,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,w=null,R=null,V=null,J=null,ae=null;for(ne in o){var de=o[ne];if(o.hasOwnProperty(ne)&&de!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":V=de;default:u.hasOwnProperty(ne)||Mt(i,s,ne,null,u,de)}}for(var Z in u){var ne=u[Z];if(de=o[Z],u.hasOwnProperty(Z)&&(ne!=null||de!=null))switch(Z){case"type":y=ne;break;case"name":p=ne;break;case"checked":J=ne;break;case"defaultChecked":ae=ne;break;case"value":w=ne;break;case"defaultValue":R=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(r(137,s));break;default:ne!==de&&Mt(i,s,Z,ne,u,de)}}_s(i,w,R,V,J,ae,y,p);return;case"select":ne=w=R=Z=null;for(y in o)if(V=o[y],o.hasOwnProperty(y)&&V!=null)switch(y){case"value":break;case"multiple":ne=V;default:u.hasOwnProperty(y)||Mt(i,s,y,null,u,V)}for(p in u)if(y=u[p],V=o[p],u.hasOwnProperty(p)&&(y!=null||V!=null))switch(p){case"value":Z=y;break;case"defaultValue":R=y;break;case"multiple":w=y;default:y!==V&&Mt(i,s,p,y,u,V)}s=R,o=w,u=ne,Z!=null?St(i,!!o,Z,!1):!!u!=!!o&&(s!=null?St(i,!!o,s,!0):St(i,!!o,o?[]:"",!1));return;case"textarea":ne=Z=null;for(R in o)if(p=o[R],o.hasOwnProperty(R)&&p!=null&&!u.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:Mt(i,s,R,null,u,p)}for(w in u)if(p=u[w],y=o[w],u.hasOwnProperty(w)&&(p!=null||y!=null))switch(w){case"value":Z=p;break;case"defaultValue":ne=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==y&&Mt(i,s,w,p,u,y)}Ea(i,Z,ne);return;case"option":for(var Oe in o)if(Z=o[Oe],o.hasOwnProperty(Oe)&&Z!=null&&!u.hasOwnProperty(Oe))switch(Oe){case"selected":i.selected=!1;break;default:Mt(i,s,Oe,null,u,Z)}for(V in u)if(Z=u[V],ne=o[V],u.hasOwnProperty(V)&&Z!==ne&&(Z!=null||ne!=null))switch(V){case"selected":i.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:Mt(i,s,V,Z,u,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in o)Z=o[Be],o.hasOwnProperty(Be)&&Z!=null&&!u.hasOwnProperty(Be)&&Mt(i,s,Be,null,u,Z);for(J in u)if(Z=u[J],ne=o[J],u.hasOwnProperty(J)&&Z!==ne&&(Z!=null||ne!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,s));break;default:Mt(i,s,J,Z,u,ne)}return;default:if(Dl(s)){for(var Lt in o)Z=o[Lt],o.hasOwnProperty(Lt)&&Z!==void 0&&!u.hasOwnProperty(Lt)&&qm(i,s,Lt,void 0,u,Z);for(ae in u)Z=u[ae],ne=o[ae],!u.hasOwnProperty(ae)||Z===ne||Z===void 0&&ne===void 0||qm(i,s,ae,Z,u,ne);return}}for(var q in o)Z=o[q],o.hasOwnProperty(q)&&Z!=null&&!u.hasOwnProperty(q)&&Mt(i,s,q,null,u,Z);for(de in u)Z=u[de],ne=o[de],!u.hasOwnProperty(de)||Z===ne||Z==null&&ne==null||Mt(i,s,de,Z,u,ne)}function pv(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ZR(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var p=o[u],y=p.transferSize,w=p.initiatorType,R=p.duration;if(y&&R&&pv(w)){for(w=0,R=p.responseEnd,u+=1;u<o.length;u++){var V=o[u],J=V.startTime;if(J>R)break;var ae=V.transferSize,de=V.initiatorType;ae&&pv(de)&&(V=V.responseEnd,w+=ae*(V<R?1:(R-J)/(V-J)))}if(--u,s+=8*(y+w)/(p.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Ym=null,Km=null;function bd(i){return i.nodeType===9?i:i.ownerDocument}function gv(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yv(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Wm(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Qm=null;function eI(){var i=window.event;return i&&i.type==="popstate"?i===Qm?!1:(Qm=i,!0):(Qm=null,!1)}var _v=typeof setTimeout=="function"?setTimeout:void 0,tI=typeof clearTimeout=="function"?clearTimeout:void 0,vv=typeof Promise=="function"?Promise:void 0,nI=typeof queueMicrotask=="function"?queueMicrotask:typeof vv<"u"?function(i){return vv.resolve(null).then(i).catch(iI)}:_v;function iI(i){setTimeout(function(){throw i})}function Hs(i){return i==="head"}function Ev(i,s){var o=s,u=0;do{var p=o.nextSibling;if(i.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(u===0){i.removeChild(p),Ko(s);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")pc(i.ownerDocument.documentElement);else if(o==="head"){o=i.ownerDocument.head,pc(o);for(var y=o.firstChild;y;){var w=y.nextSibling,R=y.nodeName;y[Pr]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=w}}else o==="body"&&pc(i.ownerDocument.body);o=p}while(o);Ko(s)}function Sv(i,s){var o=i;i=0;do{var u=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(i===0)break;i--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||i++;o=u}while(o)}function Xm(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Xm(o),ya(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function rI(i,s,o,u){for(;i.nodeType===1;){var p=o;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[Pr])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=Ni(i.nextSibling),i===null)break}return null}function sI(i,s,o){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Ni(i.nextSibling),i===null))return null;return i}function wv(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=Ni(i.nextSibling),i===null))return null;return i}function Jm(i){return i.data==="$?"||i.data==="$~"}function Zm(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function aI(i,s){var o=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||o.readyState!=="loading")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function Ni(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var ep=null;function bv(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"||o==="/&"){if(s===0)return Ni(i.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}i=i.nextSibling}return null}function Tv(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return i;s--}else o!=="/$"&&o!=="/&"||s++}i=i.previousSibling}return null}function Av(i,s,o){switch(s=bd(o),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function pc(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);ya(i)}var Oi=new Map,Rv=new Set;function Td(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Qr=he.d;he.d={f:oI,r:lI,D:cI,C:uI,L:dI,m:hI,X:mI,S:fI,M:pI};function oI(){var i=Qr.f(),s=pd();return i||s}function lI(i){var s=Nr(i);s!==null&&s.tag===5&&s.type==="form"?G_(s):Qr.r(i)}var $o=typeof document>"u"?null:document;function Iv(i,s,o){var u=$o;if(u&&typeof s=="string"&&s){var p=Jt(s);p='link[rel="'+i+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),Rv.has(p)||(Rv.add(p),i={rel:i,crossOrigin:o,href:s},u.querySelector(p)===null&&(s=u.createElement("link"),xn(s,"link",i),rn(s),u.head.appendChild(s)))}}function cI(i){Qr.D(i),Iv("dns-prefetch",i,null)}function uI(i,s){Qr.C(i,s),Iv("preconnect",i,s)}function dI(i,s,o){Qr.L(i,s,o);var u=$o;if(u&&i&&s){var p='link[rel="preload"][as="'+Jt(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+Jt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+Jt(o.imageSizes)+'"]')):p+='[href="'+Jt(i)+'"]';var y=p;switch(s){case"style":y=qo(i);break;case"script":y=Yo(i)}Oi.has(y)||(i=_({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:i,as:s},o),Oi.set(y,i),u.querySelector(p)!==null||s==="style"&&u.querySelector(gc(y))||s==="script"&&u.querySelector(yc(y))||(s=u.createElement("link"),xn(s,"link",i),rn(s),u.head.appendChild(s)))}}function hI(i,s){Qr.m(i,s);var o=$o;if(o&&i){var u=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+Jt(u)+'"][href="'+Jt(i)+'"]',y=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Yo(i)}if(!Oi.has(y)&&(i=_({rel:"modulepreload",href:i},s),Oi.set(y,i),o.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(yc(y)))return}u=o.createElement("link"),xn(u,"link",i),rn(u),o.head.appendChild(u)}}}function fI(i,s,o){Qr.S(i,s,o);var u=$o;if(u&&i){var p=Bi(u).hoistableStyles,y=qo(i);s=s||"default";var w=p.get(y);if(!w){var R={loading:0,preload:null};if(w=u.querySelector(gc(y)))R.loading=5;else{i=_({rel:"stylesheet",href:i,"data-precedence":s},o),(o=Oi.get(y))&&tp(i,o);var V=w=u.createElement("link");rn(V),xn(V,"link",i),V._p=new Promise(function(J,ae){V.onload=J,V.onerror=ae}),V.addEventListener("load",function(){R.loading|=1}),V.addEventListener("error",function(){R.loading|=2}),R.loading|=4,Ad(w,s,u)}w={type:"stylesheet",instance:w,count:1,state:R},p.set(y,w)}}}function mI(i,s){Qr.X(i,s);var o=$o;if(o&&i){var u=Bi(o).hoistableScripts,p=Yo(i),y=u.get(p);y||(y=o.querySelector(yc(p)),y||(i=_({src:i,async:!0},s),(s=Oi.get(p))&&np(i,s),y=o.createElement("script"),rn(y),xn(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function pI(i,s){Qr.M(i,s);var o=$o;if(o&&i){var u=Bi(o).hoistableScripts,p=Yo(i),y=u.get(p);y||(y=o.querySelector(yc(p)),y||(i=_({src:i,async:!0,type:"module"},s),(s=Oi.get(p))&&np(i,s),y=o.createElement("script"),rn(y),xn(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function Pv(i,s,o,u){var p=(p=je.current)?Td(p):null;if(!p)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=qo(o.href),o=Bi(p).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=qo(o.href);var y=Bi(p).hoistableStyles,w=y.get(i);if(w||(p=p.ownerDocument||p,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,w),(y=p.querySelector(gc(i)))&&!y._p&&(w.instance=y,w.state.loading=5),Oi.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Oi.set(i,o),y||gI(p,i,o,w.state))),s&&u===null)throw Error(r(528,""));return w}if(s&&u!==null)throw Error(r(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Yo(o),o=Bi(p).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function qo(i){return'href="'+Jt(i)+'"'}function gc(i){return'link[rel="stylesheet"]['+i+"]"}function Cv(i){return _({},i,{"data-precedence":i.precedence,precedence:null})}function gI(i,s,o,u){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=i.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),xn(s,"link",o),rn(s),i.head.appendChild(s))}function Yo(i){return'[src="'+Jt(i)+'"]'}function yc(i){return"script[async]"+i}function Nv(i,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=i.querySelector('style[data-href~="'+Jt(o.href)+'"]');if(u)return s.instance=u,rn(u),u;var p=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),rn(u),xn(u,"style",p),Ad(u,o.precedence,i),s.instance=u;case"stylesheet":p=qo(o.href);var y=i.querySelector(gc(p));if(y)return s.state.loading|=4,s.instance=y,rn(y),y;u=Cv(o),(p=Oi.get(p))&&tp(u,p),y=(i.ownerDocument||i).createElement("link"),rn(y);var w=y;return w._p=new Promise(function(R,V){w.onload=R,w.onerror=V}),xn(y,"link",u),s.state.loading|=4,Ad(y,o.precedence,i),s.instance=y;case"script":return y=Yo(o.src),(p=i.querySelector(yc(y)))?(s.instance=p,rn(p),p):(u=o,(p=Oi.get(y))&&(u=_({},o),np(u,p)),i=i.ownerDocument||i,p=i.createElement("script"),rn(p),xn(p,"link",u),i.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Ad(u,o.precedence,i));return s.instance}function Ad(i,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,y=p,w=0;w<u.length;w++){var R=u[w];if(R.dataset.precedence===s)y=R;else if(y!==p)break}y?y.parentNode.insertBefore(i,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(i,s.firstChild))}function tp(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function np(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Rd=null;function Ov(i,s,o){if(Rd===null){var u=new Map,p=Rd=new Map;p.set(o,u)}else p=Rd,u=p.get(o),u||(u=new Map,p.set(o,u));if(u.has(i))return u;for(u.set(i,null),o=o.getElementsByTagName(i),p=0;p<o.length;p++){var y=o[p];if(!(y[Pr]||y[Xt]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(s)||"";w=i+w;var R=u.get(w);R?R.push(y):u.set(w,[y])}}return u}function xv(i,s,o){i=i.ownerDocument||i,i.head.insertBefore(o,s==="title"?i.querySelector("head > title"):null)}function yI(i,s,o){if(o===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Dv(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function _I(i,s,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=qo(u.href),y=s.querySelector(gc(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=Id.bind(i),s.then(i,i)),o.state.loading|=4,o.instance=y,rn(y);return}y=s.ownerDocument||s,u=Cv(u),(p=Oi.get(p))&&tp(u,p),y=y.createElement("link"),rn(y);var w=y;w._p=new Promise(function(R,V){w.onload=R,w.onerror=V}),xn(y,"link",u),o.instance=y}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(i.count++,o=Id.bind(i),s.addEventListener("load",o),s.addEventListener("error",o))}}var ip=0;function vI(i,s){return i.stylesheets&&i.count===0&&Cd(i,i.stylesheets),0<i.count||0<i.imgCount?function(o){var u=setTimeout(function(){if(i.stylesheets&&Cd(i,i.stylesheets),i.unsuspend){var y=i.unsuspend;i.unsuspend=null,y()}},6e4+s);0<i.imgBytes&&ip===0&&(ip=62500*ZR());var p=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Cd(i,i.stylesheets),i.unsuspend)){var y=i.unsuspend;i.unsuspend=null,y()}},(i.imgBytes>ip?50:800)+s);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function Id(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Pd=null;function Cd(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Pd=new Map,s.forEach(EI,i),Pd=null,Id.call(i))}function EI(i,s){if(!(s.state.loading&4)){var o=Pd.get(i);if(o)var u=o.get(null);else{o=new Map,Pd.set(i,o);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var w=p[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),u=w)}u&&o.set(null,u)}p=s.instance,w=p.getAttribute("data-precedence"),y=o.get(w)||u,y===u&&o.set(null,p),o.set(w,p),this.count++,u=Id.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),y?y.parentNode.insertBefore(p,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),s.state.loading|=4}}var _c={$$typeof:U,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function SI(i,s,o,u,p,y,w,R,V){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Rr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rr(0),this.hiddenUpdates=Rr(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function kv(i,s,o,u,p,y,w,R,V,J,ae,de){return i=new SI(i,s,o,w,V,J,ae,de,R),s=1,y===!0&&(s|=24),y=di(3,null,null,s),i.current=y,y.stateNode=i,s=Lf(),s.refCount++,i.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:s},zf(y),i}function Mv(i){return i?(i=To,i):To}function Lv(i,s,o,u,p,y){p=Mv(p),u.context===null?u.context=p:u.pendingContext=p,u=Ds(s),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=ks(i,u,s),o!==null&&(Zn(o,i,s),Ql(o,i,s))}function Uv(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<s?o:s}}function rp(i,s){Uv(i,s),(i=i.alternate)&&Uv(i,s)}function Vv(i){if(i.tag===13||i.tag===31){var s=Ca(i,67108864);s!==null&&Zn(s,i,67108864),rp(i,67108864)}}function jv(i){if(i.tag===13||i.tag===31){var s=gi();s=Rl(s);var o=Ca(i,s);o!==null&&Zn(o,i,s),rp(i,s)}}var Nd=!0;function wI(i,s,o,u){var p=ee.T;ee.T=null;var y=he.p;try{he.p=2,sp(i,s,o,u)}finally{he.p=y,ee.T=p}}function bI(i,s,o,u){var p=ee.T;ee.T=null;var y=he.p;try{he.p=8,sp(i,s,o,u)}finally{he.p=y,ee.T=p}}function sp(i,s,o,u){if(Nd){var p=ap(u);if(p===null)$m(i,s,u,Od,o),Bv(i,u);else if(AI(p,i,s,o,u))u.stopPropagation();else if(Bv(i,u),s&4&&-1<TI.indexOf(i)){for(;p!==null;){var y=Nr(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=zi(y.pendingLanes);if(w!==0){var R=y;for(R.pendingLanes|=2,R.entangledLanes|=2;w;){var V=1<<31-Et(w);R.entanglements[1]|=V,w&=~V}hr(y),(Tt&6)===0&&(fd=et()+500,hc(0))}}break;case 31:case 13:R=Ca(y,2),R!==null&&Zn(R,y,2),pd(),rp(y,2)}if(y=ap(u),y===null&&$m(i,s,u,Od,o),y===p)break;p=y}p!==null&&u.stopPropagation()}else $m(i,s,u,null,o)}}function ap(i){return i=go(i),op(i)}var Od=null;function op(i){if(Od=null,i=Cr(i),i!==null){var s=l(i);if(s===null)i=null;else{var o=s.tag;if(o===13){if(i=c(s),i!==null)return i;i=null}else if(o===31){if(i=d(s),i!==null)return i;i=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Od=i,null}function zv(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(we()){case _e:return 2;case me:return 8;case ge:case re:return 32;case ye:return 268435456;default:return 32}default:return 32}}var lp=!1,$s=null,qs=null,Ys=null,vc=new Map,Ec=new Map,Ks=[],TI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bv(i,s){switch(i){case"focusin":case"focusout":$s=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":vc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(s.pointerId)}}function Sc(i,s,o,u,p,y){return i===null||i.nativeEvent!==y?(i={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[p]},s!==null&&(s=Nr(s),s!==null&&Vv(s)),i):(i.eventSystemFlags|=u,s=i.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),i)}function AI(i,s,o,u,p){switch(s){case"focusin":return $s=Sc($s,i,s,o,u,p),!0;case"dragenter":return qs=Sc(qs,i,s,o,u,p),!0;case"mouseover":return Ys=Sc(Ys,i,s,o,u,p),!0;case"pointerover":var y=p.pointerId;return vc.set(y,Sc(vc.get(y)||null,i,s,o,u,p)),!0;case"gotpointercapture":return y=p.pointerId,Ec.set(y,Sc(Ec.get(y)||null,i,s,o,u,p)),!0}return!1}function Fv(i){var s=Cr(i.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){i.blockedOn=s,fu(i.priority,function(){jv(o)});return}}else if(s===31){if(s=d(o),s!==null){i.blockedOn=s,fu(i.priority,function(){jv(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function xd(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var o=ap(i.nativeEvent);if(o===null){o=i.nativeEvent;var u=new o.constructor(o.type,o);po=u,o.target.dispatchEvent(u),po=null}else return s=Nr(o),s!==null&&Vv(s),i.blockedOn=o,!1;s.shift()}return!0}function Gv(i,s,o){xd(i)&&o.delete(s)}function RI(){lp=!1,$s!==null&&xd($s)&&($s=null),qs!==null&&xd(qs)&&(qs=null),Ys!==null&&xd(Ys)&&(Ys=null),vc.forEach(Gv),Ec.forEach(Gv)}function Dd(i,s){i.blockedOn===s&&(i.blockedOn=null,lp||(lp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,RI)))}var kd=null;function Hv(i){kd!==i&&(kd=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){kd===i&&(kd=null);for(var s=0;s<i.length;s+=3){var o=i[s],u=i[s+1],p=i[s+2];if(typeof u!="function"){if(op(u||o)===null)continue;break}var y=Nr(o);y!==null&&(i.splice(s,3),s-=3,am(y,{pending:!0,data:p,method:o.method,action:u},u,p))}}))}function Ko(i){function s(V){return Dd(V,i)}$s!==null&&Dd($s,i),qs!==null&&Dd(qs,i),Ys!==null&&Dd(Ys,i),vc.forEach(s),Ec.forEach(s);for(var o=0;o<Ks.length;o++){var u=Ks[o];u.blockedOn===i&&(u.blockedOn=null)}for(;0<Ks.length&&(o=Ks[0],o.blockedOn===null);)Fv(o),o.blockedOn===null&&Ks.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var p=o[u],y=o[u+1],w=p[Pn]||null;if(typeof y=="function")w||Hv(o);else if(w){var R=null;if(y&&y.hasAttribute("formAction")){if(p=y,w=y[Pn]||null)R=w.formAction;else if(op(p)!==null)continue}else R=w.action;typeof R=="function"?o[u+1]=R:(o.splice(u,3),u-=3),Hv(o)}}}function $v(){function i(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return p=w})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function cp(i){this._internalRoot=i}Md.prototype.render=cp.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var o=s.current,u=gi();Lv(o,u,i,s,null,null)},Md.prototype.unmount=cp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Lv(i.current,2,null,i,null,null),pd(),s[ir]=null}};function Md(i){this._internalRoot=i}Md.prototype.unstable_scheduleHydration=function(i){if(i){var s=Ir();i={blockedOn:null,target:i,priority:s};for(var o=0;o<Ks.length&&s!==0&&s<Ks[o].priority;o++);Ks.splice(o,0,i),o===0&&Fv(i)}};var qv=e.version;if(qv!=="19.2.3")throw Error(r(527,qv,"19.2.3"));he.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=m(s),i=i!==null?g(i):null,i=i===null?null:i.stateNode,i};var II={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ld=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ld.isDisabled&&Ld.supportsFiber)try{It=Ld.inject(II),_t=Ld}catch{}}return bc.createRoot=function(i,s){if(!a(i))throw Error(r(299));var o=!1,u="",p=Z_,y=e0,w=t0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(w=s.onRecoverableError)),s=kv(i,1,!1,null,null,o,u,null,p,y,w,$v),i[ir]=s.current,Hm(i),new cp(s)},bc.hydrateRoot=function(i,s,o){if(!a(i))throw Error(r(299));var u=!1,p="",y=Z_,w=e0,R=t0,V=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.formState!==void 0&&(V=o.formState)),s=kv(i,1,!0,s,o??null,u,p,V,y,w,R,$v),s.context=Mv(null),o=s.current,u=gi(),u=Rl(u),p=Ds(u),p.callback=null,ks(o,p,u),o=u,s.current.lanes=o,ds(s,o),hr(s),i[ir]=s.current,Hm(i),new Md(s)},bc.version="19.2.3",bc}var iE;function jI(){if(iE)return hp.exports;iE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),hp.exports=VI(),hp.exports}var zI=jI();const BI=Ew(zI),FI="modulepreload",GI=function(n){return"/games/yo-nunca/play/"+n},rE={},Yt=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=c(t.map(m=>{if(m=GI(m),m in rE)return;rE[m]=!0;const g=m.endsWith(".css"),_=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${_}`))return;const v=document.createElement("link");if(v.rel=g?"stylesheet":FI,g||(v.as="script"),v.crossOrigin="",v.href=m,h&&v.setAttribute("nonce",h),document.head.appendChild(v),g)return new Promise((T,I)=>{v.addEventListener("load",T),v.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return a.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},tl={log:console.log.bind(console),info:console.info.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),debug:console.debug?console.debug.bind(console):console.log.bind(console)},ww=typeof import.meta<"u"&&!0;let Fa=ww?"error":"debug";function HI(n){try{if(n==null)return n;let t=(typeof n=="string"?n:JSON.stringify(n)).replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"**@**");return t=t.replace(/ca-app-pub-\d+\/\d+/g,"ca-app-pub-**/**"),t=t.replace(/[A-Za-z0-9_-]{24,}/g,"***"),t=t.replace(/https?:\/\/[\w.-]+(?:\/[\w\d#?&%=._-]*)?/gi,"<redacted-url>"),t}catch{return n}}function nl(n){return n.map(HI)}const X={setLevel(n){Fa=n},debug:(...n)=>{Fa==="debug"&&tl.debug(...nl(n))},info:(...n)=>{(Fa==="debug"||Fa==="info")&&tl.info(...nl(n))},warn:(...n)=>{Fa!=="none"&&Fa!=="error"&&tl.warn(...nl(n))},error:(...n)=>{Fa!=="none"&&tl.error(...nl(n))}},Kd=[],$I=50,Dc=[],qI=(n,e)=>{try{const t=e.map(a=>a instanceof Error?`${a.message}
${a.stack}`:typeof a=="object"?JSON.stringify(a):String(a)).join(" "),r=`${new Date().toLocaleTimeString()} [${n.toUpperCase()}] ${t}`;Dc.unshift(r),Dc.length>$I&&Dc.pop(),Kd.forEach(a=>a(r))}catch{}},sE={addListener:n=>{Kd.push(n),Dc.forEach(e=>n(e))},removeListener:n=>{const e=Kd.indexOf(n);e>-1&&Kd.splice(e,1)},getHistory:()=>[...Dc]},Uh=(n,e)=>(...t)=>{e(...t),qI(n,t)};X.debug=Uh("debug",X.debug);X.info=Uh("info",X.info);X.warn=Uh("warn",X.warn);X.error=Uh("error",X.error);function YI(){ww&&(console.log=()=>{},console.info=()=>{},console.debug=(...n)=>{},console.warn=(...n)=>tl.warn(...nl(n)),console.error=(...n)=>tl.error(...nl(n)))}const KI=()=>{};var aE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},WI=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],c=n[t++],d=n[t++],h=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const l=n[t++],c=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},Tw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const l=n[a],c=a+1<n.length,d=c?n[a+1]:0,h=a+2<n.length,m=h?n[a+2]:0,g=l>>2,_=(l&3)<<4|d>>4;let v=(d&15)<<2|m>>6,T=m&63;h||(T=64,c||(v=64)),r.push(t[g],t[_],t[v],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(bw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):WI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],d=a<n.length?t[n.charAt(a)]:0;++a;const m=a<n.length?t[n.charAt(a)]:64;++a;const _=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||d==null||m==null||_==null)throw new QI;const v=l<<2|d>>4;if(r.push(v),m!==64){const T=d<<4&240|m>>2;if(r.push(T),_!==64){const I=m<<6&192|_;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class QI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XI=function(n){const e=bw(n);return Tw.encodeByteArray(e,!0)},Aw=function(n){return XI(n).replace(/\./g,"")},Rw=function(n){try{return Tw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=()=>JI().__FIREBASE_DEFAULTS__,eP=()=>{if(typeof process>"u"||typeof aE>"u")return;const n=aE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},tP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Rw(n[1]);return e&&JSON.parse(e)},Vh=()=>{try{return KI()||ZI()||eP()||tP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Iw=n=>{var e,t;return(t=(e=Vh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},nP=n=>{const e=Iw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Pw=()=>{var n;return(n=Vh())===null||n===void 0?void 0:n.config},Cw=n=>{var e;return(e=Vh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Eg(n){return(await fetch(n,{credentials:"include"})).ok}const kc={};function rP(){const n={prod:[],emulator:[]};for(const e of Object.keys(kc))kc[e]?n.emulator.push(e):n.prod.push(e);return n}function sP(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let oE=!1;function Nw(n,e){if(typeof window>"u"||typeof document>"u"||!io(window.location.host)||kc[n]===e||kc[n]||oE)return;kc[n]=e;function t(v){return`__firebase__banner__${v}`}const r="__firebase__banner",l=rP().prod.length>0;function c(){const v=document.getElementById(r);v&&v.remove()}function d(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,T){v.setAttribute("width","24"),v.setAttribute("id",T),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function m(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{oE=!0,c()},v}function g(v,T){v.setAttribute("id",T),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function _(){const v=sP(r),T=t("text"),I=document.getElementById(T)||document.createElement("span"),A=t("learnmore"),C=document.getElementById(A)||document.createElement("a"),L=t("preprendIcon"),x=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const U=v.element;d(U),g(C,A);const z=m();h(x,L),U.append(x,I,C,z),document.body.appendChild(U)}l?(I.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zn())}function oP(){var n;const e=(n=Vh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ow(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function cP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function uP(){const n=zn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function dP(){return!oP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xw(){try{return typeof indexedDB=="object"}catch{return!1}}function Dw(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}function hP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP="FirebaseError";class Vi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=fP,Object.setPrototypeOf(this,Vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ro.prototype.create)}}class ro{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?mP(l,r):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new Vi(a,d,r)}}function mP(n,e){return n.replace(pP,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const pP=/\{\$([^}]+)}/g;function gP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ra(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=n[a],c=e[a];if(lE(l)&&lE(c)){if(!ra(l,c))return!1}else if(l!==c)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function lE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yP(n,e){const t=new _P(n,e);return t.subscribe.bind(t)}class _P{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");vP(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=gp),a.error===void 0&&(a.error=gp),a.complete===void 0&&(a.complete=gp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vP(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function gp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP=1e3,SP=2,wP=14400*1e3,bP=.5;function cE(n,e=EP,t=SP){const r=e*Math.pow(t,n),a=Math.round(bP*r*(Math.random()-.5)*2);return Math.min(wP,r+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(n){return n&&n._delegate?n._delegate:n}class Ui{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new iP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RP(e))try{this.getOrInitializeService({instanceIdentifier:$a})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=$a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$a){return this.instances.has(e)}getOptions(e=$a){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);r===d&&c.resolve(a)}return a}onInit(e,t){var r;const a=this.normalizeInstanceIdentifier(t),l=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;l.add(e),this.onInitCallbacks.set(a,l);const c=this.instances.get(a);return c&&e(c,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:AP(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$a){return this.component?this.component.multipleInstances?e:$a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function AP(n){return n===$a?void 0:n}function RP(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new TP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ft||(ft={}));const PP={debug:ft.DEBUG,verbose:ft.VERBOSE,info:ft.INFO,warn:ft.WARN,error:ft.ERROR,silent:ft.SILENT},CP=ft.INFO,NP={[ft.DEBUG]:"log",[ft.VERBOSE]:"log",[ft.INFO]:"info",[ft.WARN]:"warn",[ft.ERROR]:"error"},OP=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=NP[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jh{constructor(e){this.name=e,this._logLevel=CP,this._logHandler=OP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ft))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ft.DEBUG,...e),this._logHandler(this,ft.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ft.VERBOSE,...e),this._logHandler(this,ft.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ft.INFO,...e),this._logHandler(this,ft.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ft.WARN,...e),this._logHandler(this,ft.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ft.ERROR,...e),this._logHandler(this,ft.ERROR,...e)}}const xP=(n,e)=>e.some(t=>n instanceof t);let uE,dE;function DP(){return uE||(uE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kP(){return dE||(dE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kw=new WeakMap,Dp=new WeakMap,Mw=new WeakMap,yp=new WeakMap,Sg=new WeakMap;function MP(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(Zs(n.result)),a()},c=()=>{r(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&kw.set(t,n)}).catch(()=>{}),Sg.set(e,n),e}function LP(n){if(Dp.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Dp.set(n,e)}let kp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Dp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Mw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function UP(n){kp=n(kp)}function VP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(_p(this),e,...t);return Mw.set(r,e.sort?e.sort():[e]),Zs(r)}:kP().includes(n)?function(...e){return n.apply(_p(this),e),Zs(kw.get(this))}:function(...e){return Zs(n.apply(_p(this),e))}}function jP(n){return typeof n=="function"?VP(n):(n instanceof IDBTransaction&&LP(n),xP(n,DP())?new Proxy(n,kp):n)}function Zs(n){if(n instanceof IDBRequest)return MP(n);if(yp.has(n))return yp.get(n);const e=jP(n);return e!==n&&(yp.set(n,e),Sg.set(e,n)),e}const _p=n=>Sg.get(n);function Lw(n,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const c=indexedDB.open(n,e),d=Zs(c);return r&&c.addEventListener("upgradeneeded",h=>{r(Zs(c.result),h.oldVersion,h.newVersion,Zs(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{l&&h.addEventListener("close",()=>l()),a&&h.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const zP=["get","getKey","getAll","getAllKeys","count"],BP=["put","add","delete","clear"],vp=new Map;function hE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(vp.get(e))return vp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=BP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||zP.includes(t)))return;const l=async function(c,...d){const h=this.transaction(c,a?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),a&&h.done]))[0]};return vp.set(e,l),l}UP(n=>({...n,get:(e,t,r)=>hE(e,t)||n.get(e,t,r),has:(e,t)=>!!hE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(GP(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function GP(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mp="@firebase/app",fE="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=new jh("@firebase/app"),HP="@firebase/app-compat",$P="@firebase/analytics-compat",qP="@firebase/analytics",YP="@firebase/app-check-compat",KP="@firebase/app-check",WP="@firebase/auth",QP="@firebase/auth-compat",XP="@firebase/database",JP="@firebase/data-connect",ZP="@firebase/database-compat",eC="@firebase/functions",tC="@firebase/functions-compat",nC="@firebase/installations",iC="@firebase/installations-compat",rC="@firebase/messaging",sC="@firebase/messaging-compat",aC="@firebase/performance",oC="@firebase/performance-compat",lC="@firebase/remote-config",cC="@firebase/remote-config-compat",uC="@firebase/storage",dC="@firebase/storage-compat",hC="@firebase/firestore",fC="@firebase/ai",mC="@firebase/firestore-compat",pC="firebase",gC="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="[DEFAULT]",yC={[Mp]:"fire-core",[HP]:"fire-core-compat",[qP]:"fire-analytics",[$P]:"fire-analytics-compat",[KP]:"fire-app-check",[YP]:"fire-app-check-compat",[WP]:"fire-auth",[QP]:"fire-auth-compat",[XP]:"fire-rtdb",[JP]:"fire-data-connect",[ZP]:"fire-rtdb-compat",[eC]:"fire-fn",[tC]:"fire-fn-compat",[nC]:"fire-iid",[iC]:"fire-iid-compat",[rC]:"fire-fcm",[sC]:"fire-fcm-compat",[aC]:"fire-perf",[oC]:"fire-perf-compat",[lC]:"fire-rc",[cC]:"fire-rc-compat",[uC]:"fire-gcs",[dC]:"fire-gcs-compat",[hC]:"fire-fst",[mC]:"fire-fst-compat",[fC]:"fire-vertex","fire-js":"fire-js",[pC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=new Map,_C=new Map,Up=new Map;function mE(n,e){try{n.container.addComponent(e)}catch(t){rs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Xi(n){const e=n.name;if(Up.has(e))return rs.debug(`There were multiple attempts to register component ${e}.`),!1;Up.set(e,n);for(const t of ch.values())mE(t,n);for(const t of _C.values())mE(t,n);return!0}function ma(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Mi(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ea=new ro("app","Firebase",vC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ea.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=gC;function Uw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Lp,automaticDataCollectionEnabled:!0},e),a=r.name;if(typeof a!="string"||!a)throw ea.create("bad-app-name",{appName:String(a)});if(t||(t=Pw()),!t)throw ea.create("no-options");const l=ch.get(a);if(l){if(ra(t,l.options)&&ra(r,l.config))return l;throw ea.create("duplicate-app",{appName:a})}const c=new IP(a);for(const h of Up.values())c.addComponent(h);const d=new EC(t,r,c);return ch.set(a,d),d}function wg(n=Lp){const e=ch.get(n);if(!e&&n===Lp&&Pw())return Uw();if(!e)throw ea.create("no-app",{appName:n});return e}function ri(n,e,t){var r;let a=(r=yC[n])!==null&&r!==void 0?r:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),c=e.match(/\s|\//);if(l||c){const d=[`Unable to register library "${a}" with version "${e}":`];l&&d.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rs.warn(d.join(" "));return}Xi(new Ui(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC="firebase-heartbeat-database",wC=1,Fc="firebase-heartbeat-store";let Ep=null;function Vw(){return Ep||(Ep=Lw(SC,wC,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fc)}catch(t){console.warn(t)}}}}).catch(n=>{throw ea.create("idb-open",{originalErrorMessage:n.message})})),Ep}async function bC(n){try{const t=(await Vw()).transaction(Fc),r=await t.objectStore(Fc).get(jw(n));return await t.done,r}catch(e){if(e instanceof Vi)rs.warn(e.message);else{const t=ea.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rs.warn(t.message)}}}async function pE(n,e){try{const r=(await Vw()).transaction(Fc,"readwrite");await r.objectStore(Fc).put(e,jw(n)),await r.done}catch(t){if(t instanceof Vi)rs.warn(t.message);else{const r=ea.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});rs.warn(r.message)}}}function jw(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=1024,AC=30;class RC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new PC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=gE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>AC){const c=CC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){rs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=gE(),{heartbeatsToSend:r,unsentEntries:a}=IC(this._heartbeatsCache.heartbeats),l=Aw(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return rs.warn(t),""}}}function gE(){return new Date().toISOString().substring(0,10)}function IC(n,e=TC){const t=[];let r=n.slice();for(const a of n){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),yE(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),yE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class PC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xw()?Dw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await bC(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return pE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return pE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function yE(n){return Aw(JSON.stringify({version:2,heartbeats:n})).length}function CC(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(n){Xi(new Ui("platform-logger",e=>new FP(e),"PRIVATE")),Xi(new Ui("heartbeat",e=>new RC(e),"PRIVATE")),ri(Mp,fE,n),ri(Mp,fE,"esm2017"),ri("fire-js","")}NC("");var _E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ta,zw;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,P){function N(){}N.prototype=P.prototype,D.D=P.prototype,D.prototype=new N,D.prototype.constructor=D,D.C=function(M,B,G){for(var k=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)k[Ve-2]=arguments[Ve];return P.prototype[B].apply(M,k)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(D,P,N){N||(N=0);var M=Array(16);if(typeof P=="string")for(var B=0;16>B;++B)M[B]=P.charCodeAt(N++)|P.charCodeAt(N++)<<8|P.charCodeAt(N++)<<16|P.charCodeAt(N++)<<24;else for(B=0;16>B;++B)M[B]=P[N++]|P[N++]<<8|P[N++]<<16|P[N++]<<24;P=D.g[0],N=D.g[1],B=D.g[2];var G=D.g[3],k=P+(G^N&(B^G))+M[0]+3614090360&4294967295;P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[1]+3905402710&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[2]+606105819&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[3]+3250441966&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(G^N&(B^G))+M[4]+4118548399&4294967295,P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[5]+1200080426&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[6]+2821735955&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[7]+4249261313&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(G^N&(B^G))+M[8]+1770035416&4294967295,P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[9]+2336552879&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[10]+4294925233&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[11]+2304563134&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(G^N&(B^G))+M[12]+1804603682&4294967295,P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[13]+4254626195&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[14]+2792965006&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[15]+1236535329&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(B^G&(N^B))+M[1]+4129170786&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[6]+3225465664&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[11]+643717713&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[0]+3921069994&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(B^G&(N^B))+M[5]+3593408605&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[10]+38016083&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[15]+3634488961&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[4]+3889429448&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(B^G&(N^B))+M[9]+568446438&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[14]+3275163606&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[3]+4107603335&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[8]+1163531501&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(B^G&(N^B))+M[13]+2850285829&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[2]+4243563512&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[7]+1735328473&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[12]+2368359562&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(N^B^G)+M[5]+4294588738&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[8]+2272392833&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[11]+1839030562&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[14]+4259657740&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(N^B^G)+M[1]+2763975236&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[4]+1272893353&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[7]+4139469664&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[10]+3200236656&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(N^B^G)+M[13]+681279174&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[0]+3936430074&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[3]+3572445317&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[6]+76029189&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(N^B^G)+M[9]+3654602809&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[12]+3873151461&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[15]+530742520&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[2]+3299628645&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(B^(N|~G))+M[0]+4096336452&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[7]+1126891415&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[14]+2878612391&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[5]+4237533241&4294967295,N=B+(k<<21&4294967295|k>>>11),k=P+(B^(N|~G))+M[12]+1700485571&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[3]+2399980690&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[10]+4293915773&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[1]+2240044497&4294967295,N=B+(k<<21&4294967295|k>>>11),k=P+(B^(N|~G))+M[8]+1873313359&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[15]+4264355552&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[6]+2734768916&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[13]+1309151649&4294967295,N=B+(k<<21&4294967295|k>>>11),k=P+(B^(N|~G))+M[4]+4149444226&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[11]+3174756917&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[2]+718787259&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[9]+3951481745&4294967295,D.g[0]=D.g[0]+P&4294967295,D.g[1]=D.g[1]+(B+(k<<21&4294967295|k>>>11))&4294967295,D.g[2]=D.g[2]+B&4294967295,D.g[3]=D.g[3]+G&4294967295}r.prototype.u=function(D,P){P===void 0&&(P=D.length);for(var N=P-this.blockSize,M=this.B,B=this.h,G=0;G<P;){if(B==0)for(;G<=N;)a(this,D,G),G+=this.blockSize;if(typeof D=="string"){for(;G<P;)if(M[B++]=D.charCodeAt(G++),B==this.blockSize){a(this,M),B=0;break}}else for(;G<P;)if(M[B++]=D[G++],B==this.blockSize){a(this,M),B=0;break}}this.h=B,this.o+=P},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var P=1;P<D.length-8;++P)D[P]=0;var N=8*this.o;for(P=D.length-8;P<D.length;++P)D[P]=N&255,N/=256;for(this.u(D),D=Array(16),P=N=0;4>P;++P)for(var M=0;32>M;M+=8)D[N++]=this.g[P]>>>M&255;return D};function l(D,P){var N=d;return Object.prototype.hasOwnProperty.call(N,D)?N[D]:N[D]=P(D)}function c(D,P){this.h=P;for(var N=[],M=!0,B=D.length-1;0<=B;B--){var G=D[B]|0;M&&G==P||(N[B]=G,M=!1)}this.g=N}var d={};function h(D){return-128<=D&&128>D?l(D,function(P){return new c([P|0],0>P?-1:0)}):new c([D|0],0>D?-1:0)}function m(D){if(isNaN(D)||!isFinite(D))return _;if(0>D)return C(m(-D));for(var P=[],N=1,M=0;D>=N;M++)P[M]=D/N|0,N*=4294967296;return new c(P,0)}function g(D,P){if(D.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(D.charAt(0)=="-")return C(g(D.substring(1),P));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=m(Math.pow(P,8)),M=_,B=0;B<D.length;B+=8){var G=Math.min(8,D.length-B),k=parseInt(D.substring(B,B+G),P);8>G?(G=m(Math.pow(P,G)),M=M.j(G).add(m(k))):(M=M.j(N),M=M.add(m(k)))}return M}var _=h(0),v=h(1),T=h(16777216);n=c.prototype,n.m=function(){if(A(this))return-C(this).m();for(var D=0,P=1,N=0;N<this.g.length;N++){var M=this.i(N);D+=(0<=M?M:4294967296+M)*P,P*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(I(this))return"0";if(A(this))return"-"+C(this).toString(D);for(var P=m(Math.pow(D,6)),N=this,M="";;){var B=z(N,P).g;N=L(N,B.j(P));var G=((0<N.g.length?N.g[0]:N.h)>>>0).toString(D);if(N=B,I(N))return G+M;for(;6>G.length;)G="0"+G;M=G+M}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function I(D){if(D.h!=0)return!1;for(var P=0;P<D.g.length;P++)if(D.g[P]!=0)return!1;return!0}function A(D){return D.h==-1}n.l=function(D){return D=L(this,D),A(D)?-1:I(D)?0:1};function C(D){for(var P=D.g.length,N=[],M=0;M<P;M++)N[M]=~D.g[M];return new c(N,~D.h).add(v)}n.abs=function(){return A(this)?C(this):this},n.add=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0,B=0;B<=P;B++){var G=M+(this.i(B)&65535)+(D.i(B)&65535),k=(G>>>16)+(this.i(B)>>>16)+(D.i(B)>>>16);M=k>>>16,G&=65535,k&=65535,N[B]=k<<16|G}return new c(N,N[N.length-1]&-2147483648?-1:0)};function L(D,P){return D.add(C(P))}n.j=function(D){if(I(this)||I(D))return _;if(A(this))return A(D)?C(this).j(C(D)):C(C(this).j(D));if(A(D))return C(this.j(C(D)));if(0>this.l(T)&&0>D.l(T))return m(this.m()*D.m());for(var P=this.g.length+D.g.length,N=[],M=0;M<2*P;M++)N[M]=0;for(M=0;M<this.g.length;M++)for(var B=0;B<D.g.length;B++){var G=this.i(M)>>>16,k=this.i(M)&65535,Ve=D.i(B)>>>16,tt=D.i(B)&65535;N[2*M+2*B]+=k*tt,x(N,2*M+2*B),N[2*M+2*B+1]+=G*tt,x(N,2*M+2*B+1),N[2*M+2*B+1]+=k*Ve,x(N,2*M+2*B+1),N[2*M+2*B+2]+=G*Ve,x(N,2*M+2*B+2)}for(M=0;M<P;M++)N[M]=N[2*M+1]<<16|N[2*M];for(M=P;M<2*P;M++)N[M]=0;return new c(N,0)};function x(D,P){for(;(D[P]&65535)!=D[P];)D[P+1]+=D[P]>>>16,D[P]&=65535,P++}function U(D,P){this.g=D,this.h=P}function z(D,P){if(I(P))throw Error("division by zero");if(I(D))return new U(_,_);if(A(D))return P=z(C(D),P),new U(C(P.g),C(P.h));if(A(P))return P=z(D,C(P)),new U(C(P.g),P.h);if(30<D.g.length){if(A(D)||A(P))throw Error("slowDivide_ only works with positive integers.");for(var N=v,M=P;0>=M.l(D);)N=$(N),M=$(M);var B=se(N,1),G=se(M,1);for(M=se(M,2),N=se(N,2);!I(M);){var k=G.add(M);0>=k.l(D)&&(B=B.add(N),G=k),M=se(M,1),N=se(N,1)}return P=L(D,B.j(P)),new U(B,P)}for(B=_;0<=D.l(P);){for(N=Math.max(1,Math.floor(D.m()/P.m())),M=Math.ceil(Math.log(N)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),G=m(N),k=G.j(P);A(k)||0<k.l(D);)N-=M,G=m(N),k=G.j(P);I(G)&&(G=v),B=B.add(G),D=L(D,k)}return new U(B,D)}n.A=function(D){return z(this,D).h},n.and=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0;M<P;M++)N[M]=this.i(M)&D.i(M);return new c(N,this.h&D.h)},n.or=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0;M<P;M++)N[M]=this.i(M)|D.i(M);return new c(N,this.h|D.h)},n.xor=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0;M<P;M++)N[M]=this.i(M)^D.i(M);return new c(N,this.h^D.h)};function $(D){for(var P=D.g.length+1,N=[],M=0;M<P;M++)N[M]=D.i(M)<<1|D.i(M-1)>>>31;return new c(N,D.h)}function se(D,P){var N=P>>5;P%=32;for(var M=D.g.length-N,B=[],G=0;G<M;G++)B[G]=0<P?D.i(G+N)>>>P|D.i(G+N+1)<<32-P:D.i(G+N);return new c(B,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,zw=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=g,ta=c}).apply(typeof _E<"u"?_E:typeof self<"u"?self:typeof window<"u"?window:{});var Ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bw,Pc,Fw,Wd,Vp,Gw,Hw,$w;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,E,b){return f==Array.prototype||f==Object.prototype||(f[E]=b.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ud=="object"&&Ud];for(var E=0;E<f.length;++E){var b=f[E];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=t(this);function a(f,E){if(E)e:{var b=r;f=f.split(".");for(var O=0;O<f.length-1;O++){var Y=f[O];if(!(Y in b))break e;b=b[Y]}f=f[f.length-1],O=b[f],E=E(O),E!=O&&E!=null&&e(b,f,{configurable:!0,writable:!0,value:E})}}function l(f,E){f instanceof String&&(f+="");var b=0,O=!1,Y={next:function(){if(!O&&b<f.length){var ie=b++;return{value:E(ie,f[ie]),done:!1}}return O=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}a("Array.prototype.values",function(f){return f||function(){return l(this,function(E,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},d=this||self;function h(f){var E=typeof f;return E=E!="object"?E:f?Array.isArray(f)?"array":E:"null",E=="array"||E=="object"&&typeof f.length=="number"}function m(f){var E=typeof f;return E=="object"&&f!=null||E=="function"}function g(f,E,b){return f.call.apply(f.bind,arguments)}function _(f,E,b){if(!f)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,O),f.apply(E,Y)}}return function(){return f.apply(E,arguments)}}function v(f,E,b){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:_,v.apply(null,arguments)}function T(f,E){var b=Array.prototype.slice.call(arguments,1);return function(){var O=b.slice();return O.push.apply(O,arguments),f.apply(this,O)}}function I(f,E){function b(){}b.prototype=E.prototype,f.aa=E.prototype,f.prototype=new b,f.prototype.constructor=f,f.Qb=function(O,Y,ie){for(var Ee=Array(arguments.length-2),Pt=2;Pt<arguments.length;Pt++)Ee[Pt-2]=arguments[Pt];return E.prototype[Y].apply(O,Ee)}}function A(f){const E=f.length;if(0<E){const b=Array(E);for(let O=0;O<E;O++)b[O]=f[O];return b}return[]}function C(f,E){for(let b=1;b<arguments.length;b++){const O=arguments[b];if(h(O)){const Y=f.length||0,ie=O.length||0;f.length=Y+ie;for(let Ee=0;Ee<ie;Ee++)f[Y+Ee]=O[Ee]}else f.push(O)}}class L{constructor(E,b){this.i=E,this.j=b,this.h=0,this.g=null}get(){let E;return 0<this.h?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function x(f){return/^[\s\xa0]*$/.test(f)}function U(){var f=d.navigator;return f&&(f=f.userAgent)?f:""}function z(f){return z[" "](f),f}z[" "]=function(){};var $=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function se(f,E,b){for(const O in f)E.call(b,f[O],O,f)}function D(f,E){for(const b in f)E.call(void 0,f[b],b,f)}function P(f){const E={};for(const b in f)E[b]=f[b];return E}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(f,E){let b,O;for(let Y=1;Y<arguments.length;Y++){O=arguments[Y];for(b in O)f[b]=O[b];for(let ie=0;ie<N.length;ie++)b=N[ie],Object.prototype.hasOwnProperty.call(O,b)&&(f[b]=O[b])}}function B(f){var E=1;f=f.split(":");const b=[];for(;0<E&&f.length;)b.push(f.shift()),E--;return f.length&&b.push(f.join(":")),b}function G(f){d.setTimeout(()=>{throw f},0)}function k(){var f=Le;let E=null;return f.g&&(E=f.g,f.g=f.g.next,f.g||(f.h=null),E.next=null),E}class Ve{constructor(){this.h=this.g=null}add(E,b){const O=tt.get();O.set(E,b),this.h?this.h.next=O:this.g=O,this.h=O}}var tt=new L(()=>new ee,f=>f.reset());class ee{constructor(){this.next=this.g=this.h=null}set(E,b){this.h=E,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let he,Ie=!1,Le=new Ve,Ge=()=>{const f=d.Promise.resolve(void 0);he=()=>{f.then(j)}};var j=()=>{for(var f;f=k();){try{f.h.call(f.g)}catch(b){G(b)}var E=tt;E.j(f),100>E.h&&(E.h++,f.next=E.g,E.g=f)}Ie=!1};function K(){this.s=this.s,this.C=this.C}K.prototype.s=!1,K.prototype.ma=function(){this.s||(this.s=!0,this.N())},K.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(f,E){this.type=f,this.g=this.target=E,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var pe=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var f=!1,E=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const b=()=>{};d.addEventListener("test",b,E),d.removeEventListener("test",b,E)}catch{}return f})();function Pe(f,E){if(ue.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var b=this.type=f.type,O=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=E,E=f.relatedTarget){if($){e:{try{z(E.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(E=null)}}else b=="mouseover"?E=f.fromElement:b=="mouseout"&&(E=f.toElement);this.relatedTarget=E,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:je[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Pe.aa.h.call(this)}}I(Pe,ue);var je={2:"touch",3:"pen",4:"mouse"};Pe.prototype.h=function(){Pe.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var nt="closure_listenable_"+(1e6*Math.random()|0),We=0;function Ke(f,E,b,O,Y){this.listener=f,this.proxy=null,this.src=E,this.type=b,this.capture=!!O,this.ha=Y,this.key=++We,this.da=this.fa=!1}function Ze(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Vt(f){this.src=f,this.g={},this.h=0}Vt.prototype.add=function(f,E,b,O,Y){var ie=f.toString();f=this.g[ie],f||(f=this.g[ie]=[],this.h++);var Ee=Rn(f,E,O,Y);return-1<Ee?(E=f[Ee],b||(E.fa=!1)):(E=new Ke(E,this.src,ie,!!O,Y),E.fa=b,f.push(E)),E};function Wt(f,E){var b=E.type;if(b in f.g){var O=f.g[b],Y=Array.prototype.indexOf.call(O,E,void 0),ie;(ie=0<=Y)&&Array.prototype.splice.call(O,Y,1),ie&&(Ze(E),f.g[b].length==0&&(delete f.g[b],f.h--))}}function Rn(f,E,b,O){for(var Y=0;Y<f.length;++Y){var ie=f[Y];if(!ie.da&&ie.listener==E&&ie.capture==!!b&&ie.ha==O)return Y}return-1}var yn="closure_lm_"+(1e6*Math.random()|0),Te={};function oe(f,E,b,O,Y){if(Array.isArray(E)){for(var ie=0;ie<E.length;ie++)oe(f,E[ie],b,O,Y);return null}return b=we(b),f&&f[nt]?f.K(E,b,m(O)?!!O.capture:!1,Y):Ue(f,E,b,!1,O,Y)}function Ue(f,E,b,O,Y,ie){if(!E)throw Error("Invalid event type");var Ee=m(Y)?!!Y.capture:!!Y,Pt=Rt(f);if(Pt||(f[yn]=Pt=new Vt(f)),b=Pt.add(E,b,O,Ee,ie),b.proxy)return b;if(O=ve(),b.proxy=O,O.src=f,O.listener=b,f.addEventListener)pe||(Y=Ee),Y===void 0&&(Y=!1),f.addEventListener(E.toString(),O,Y);else if(f.attachEvent)f.attachEvent(ze(E.toString()),O);else if(f.addListener&&f.removeListener)f.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return b}function ve(){function f(b){return E.call(f.src,f.listener,b)}const E=it;return f}function Ae(f,E,b,O,Y){if(Array.isArray(E))for(var ie=0;ie<E.length;ie++)Ae(f,E[ie],b,O,Y);else O=m(O)?!!O.capture:!!O,b=we(b),f&&f[nt]?(f=f.i,E=String(E).toString(),E in f.g&&(ie=f.g[E],b=Rn(ie,b,O,Y),-1<b&&(Ze(ie[b]),Array.prototype.splice.call(ie,b,1),ie.length==0&&(delete f.g[E],f.h--)))):f&&(f=Rt(f))&&(E=f.g[E.toString()],f=-1,E&&(f=Rn(E,b,O,Y)),(b=-1<f?E[f]:null)&&Se(b))}function Se(f){if(typeof f!="number"&&f&&!f.da){var E=f.src;if(E&&E[nt])Wt(E.i,f);else{var b=f.type,O=f.proxy;E.removeEventListener?E.removeEventListener(b,O,f.capture):E.detachEvent?E.detachEvent(ze(b),O):E.addListener&&E.removeListener&&E.removeListener(O),(b=Rt(E))?(Wt(b,f),b.h==0&&(b.src=null,E[yn]=null)):Ze(f)}}}function ze(f){return f in Te?Te[f]:Te[f]="on"+f}function it(f,E){if(f.da)f=!0;else{E=new Pe(E,this);var b=f.listener,O=f.ha||f.src;f.fa&&Se(f),f=b.call(O,E)}return f}function Rt(f){return f=f[yn],f instanceof Vt?f:null}var et="__closure_events_fn_"+(1e9*Math.random()>>>0);function we(f){return typeof f=="function"?f:(f[et]||(f[et]=function(E){return f.handleEvent(E)}),f[et])}function _e(){K.call(this),this.i=new Vt(this),this.M=this,this.F=null}I(_e,K),_e.prototype[nt]=!0,_e.prototype.removeEventListener=function(f,E,b,O){Ae(this,f,E,b,O)};function me(f,E){var b,O=f.F;if(O)for(b=[];O;O=O.F)b.push(O);if(f=f.M,O=E.type||E,typeof E=="string")E=new ue(E,f);else if(E instanceof ue)E.target=E.target||f;else{var Y=E;E=new ue(O,f),M(E,Y)}if(Y=!0,b)for(var ie=b.length-1;0<=ie;ie--){var Ee=E.g=b[ie];Y=ge(Ee,O,!0,E)&&Y}if(Ee=E.g=f,Y=ge(Ee,O,!0,E)&&Y,Y=ge(Ee,O,!1,E)&&Y,b)for(ie=0;ie<b.length;ie++)Ee=E.g=b[ie],Y=ge(Ee,O,!1,E)&&Y}_e.prototype.N=function(){if(_e.aa.N.call(this),this.i){var f=this.i,E;for(E in f.g){for(var b=f.g[E],O=0;O<b.length;O++)Ze(b[O]);delete f.g[E],f.h--}}this.F=null},_e.prototype.K=function(f,E,b,O){return this.i.add(String(f),E,!1,b,O)},_e.prototype.L=function(f,E,b,O){return this.i.add(String(f),E,!0,b,O)};function ge(f,E,b,O){if(E=f.i.g[String(E)],!E)return!0;E=E.concat();for(var Y=!0,ie=0;ie<E.length;++ie){var Ee=E[ie];if(Ee&&!Ee.da&&Ee.capture==b){var Pt=Ee.listener,cn=Ee.ha||Ee.src;Ee.fa&&Wt(f.i,Ee),Y=Pt.call(cn,O)!==!1&&Y}}return Y&&!O.defaultPrevented}function re(f,E,b){if(typeof f=="function")b&&(f=v(f,b));else if(f&&typeof f.handleEvent=="function")f=v(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(E)?-1:d.setTimeout(f,E||0)}function ye(f){f.g=re(()=>{f.g=null,f.i&&(f.i=!1,ye(f))},f.l);const E=f.h;f.h=null,f.m.apply(null,E)}class $e extends K{constructor(E,b){super(),this.m=E,this.l=b,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qe(f){K.call(this),this.h=f,this.g={}}I(qe,K);var It=[];function _t(f){se(f.g,function(E,b){this.g.hasOwnProperty(b)&&Se(E)},f),f.g={}}qe.prototype.N=function(){qe.aa.N.call(this),_t(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fe=d.JSON.stringify,Et=d.JSON.parse,ai=class{stringify(f){return d.JSON.stringify(f,void 0)}parse(f){return d.JSON.parse(f,void 0)}};function Ei(){}Ei.prototype.h=null;function oi(f){return f.h||(f.h=f.i())}function ji(){}var tr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function cs(){ue.call(this,"d")}I(cs,ue);function zi(){ue.call(this,"c")}I(zi,ue);var Si={},us=null;function co(){return us=us||new _e}Si.La="serverreachability";function Tl(f){ue.call(this,Si.La,f)}I(Tl,ue);function Rr(f){const E=co();me(E,new Tl(E))}Si.STAT_EVENT="statevent";function ds(f,E){ue.call(this,Si.STAT_EVENT,f),this.stat=E}I(ds,ue);function In(f){const E=co();me(E,new ds(E,f))}Si.Ma="timingevent";function Al(f,E){ue.call(this,Si.Ma,f),this.size=E}I(Al,ue);function hs(f,E){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){f()},E)}function fs(){this.g=!0}fs.prototype.xa=function(){this.g=!1};function Rl(f,E,b,O,Y,ie){f.info(function(){if(f.g)if(ie)for(var Ee="",Pt=ie.split("&"),cn=0;cn<Pt.length;cn++){var ot=Pt[cn].split("=");if(1<ot.length){var wn=ot[0];ot=ot[1];var bn=wn.split("_");Ee=2<=bn.length&&bn[1]=="type"?Ee+(wn+"="+ot+"&"):Ee+(wn+"=redacted&")}}else Ee=null;else Ee=ie;return"XMLHTTP REQ ("+O+") [attempt "+Y+"]: "+E+`
`+b+`
`+Ee})}function Il(f,E,b,O,Y,ie,Ee){f.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+Y+"]: "+E+`
`+b+`
`+ie+" "+Ee})}function Ir(f,E,b,O){f.info(function(){return"XMLHTTP TEXT ("+E+"): "+nr(f,b)+(O?" "+O:"")})}function fu(f,E){f.info(function(){return"TIMEOUT: "+E})}fs.prototype.info=function(){};function nr(f,E){if(!f.g)return E;if(!E)return null;try{var b=JSON.parse(E);if(b){for(f=0;f<b.length;f++)if(Array.isArray(b[f])){var O=b[f];if(!(2>O.length)){var Y=O[1];if(Array.isArray(Y)&&!(1>Y.length)){var ie=Y[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var Ee=1;Ee<Y.length;Ee++)Y[Ee]=""}}}}return Fe(b)}catch{return E}}var Xt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ir;function ms(){}I(ms,Ei),ms.prototype.g=function(){return new XMLHttpRequest},ms.prototype.i=function(){return{}},ir=new ms;function rr(f,E,b,O){this.j=f,this.i=E,this.l=b,this.R=O||1,this.U=new qe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new mu}function mu(){this.i=null,this.g="",this.h=!1}var Pl={},Pr={};function ya(f,E,b){f.L=1,f.v=Ea(Jt(E)),f.m=b,f.P=!0,Cr(f,null)}function Cr(f,E){f.F=Date.now(),Bi(f),f.A=Jt(f.v);var b=f.A,O=f.R;Array.isArray(O)||(O=[String(O)]),xr(b.i,"t",O),f.C=0,b=f.j.J,f.h=new mu,f.g=Nu(f.j,b?E:null,!f.m),0<f.O&&(f.M=new $e(v(f.Y,f,f.g),f.O)),E=f.U,b=f.g,O=f.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(It[0]=Y.toString()),Y=It);for(var ie=0;ie<Y.length;ie++){var Ee=oe(b,Y[ie],O||E.handleEvent,!1,E.h||E);if(!Ee)break;E.g[Ee.key]=Ee}E=f.H?P(f.H):{},f.m?(f.u||(f.u="POST"),E["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,E)):(f.u="GET",f.g.ea(f.A,f.u,null,E)),Rr(),Rl(f.i,f.u,f.A,f.l,f.R,f.m)}rr.prototype.ca=function(f){f=f.target;const E=this.M;E&&Gn(f)==3?E.j():this.Y(f)},rr.prototype.Y=function(f){try{if(f==this.g)e:{const bn=Gn(this.g);var E=this.g.Ba();const Is=this.g.Z();if(!(3>bn)&&(bn!=3||this.g&&(this.h.h||this.g.oa()||ba(this.g)))){this.J||bn!=4||E==7||(E==8||0>=Is?Rr(3):Rr(2)),uo(this);var b=this.g.Z();this.X=b;t:if(Nr(this)){var O=ba(this.g);f="";var Y=O.length,ie=Gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Bn(this),ps(this);var Ee="";break t}this.h.i=new d.TextDecoder}for(E=0;E<Y;E++)this.h.h=!0,f+=this.h.i.decode(O[E],{stream:!(ie&&E==Y-1)});O.length=0,this.h.g+=f,this.C=0,Ee=this.h.g}else Ee=this.g.oa();if(this.o=b==200,Il(this.i,this.u,this.A,this.l,this.R,bn,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Pt,cn=this.g;if((Pt=cn.g?cn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(Pt)){var ot=Pt;break t}}ot=null}if(b=ot)Ir(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,sr(this,b);else{this.o=!1,this.s=3,In(12),Bn(this),ps(this);break e}}if(this.P){b=!0;let Kn;for(;!this.J&&this.C<Ee.length;)if(Kn=_a(this,Ee),Kn==Pr){bn==4&&(this.s=4,In(14),b=!1),Ir(this.i,this.l,null,"[Incomplete Response]");break}else if(Kn==Pl){this.s=4,In(15),Ir(this.i,this.l,Ee,"[Invalid Chunk]"),b=!1;break}else Ir(this.i,this.l,Kn,null),sr(this,Kn);if(Nr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bn!=4||Ee.length!=0||this.h.h||(this.s=1,In(16),b=!1),this.o=this.o&&b,!b)Ir(this.i,this.l,Ee,"[Invalid Chunked Response]"),Bn(this),ps(this);else if(0<Ee.length&&!this.W){this.W=!0;var wn=this.j;wn.g==this&&wn.ba&&!wn.M&&(wn.j.info("Great, no buffering proxy detected. Bytes received: "+Ee.length),jl(wn),wn.M=!0,In(11))}}else Ir(this.i,this.l,Ee,null),sr(this,Ee);bn==4&&Bn(this),this.o&&!this.J&&(bn==4?Iu(this.j,this):(this.o=!1,Bi(this)))}else Su(this.g),b==400&&0<Ee.indexOf("Unknown SID")?(this.s=3,In(12)):(this.s=0,In(13)),Bn(this),ps(this)}}}catch{}finally{}};function Nr(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function _a(f,E){var b=f.C,O=E.indexOf(`
`,b);return O==-1?Pr:(b=Number(E.substring(b,O)),isNaN(b)?Pl:(O+=1,O+b>E.length?Pr:(E=E.slice(O,O+b),f.C=O+b,E)))}rr.prototype.cancel=function(){this.J=!0,Bn(this)};function Bi(f){f.S=Date.now()+f.I,rn(f,f.I)}function rn(f,E){if(f.B!=null)throw Error("WatchDog timer not null");f.B=hs(v(f.ba,f),E)}function uo(f){f.B&&(d.clearTimeout(f.B),f.B=null)}rr.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(fu(this.i,this.A),this.L!=2&&(Rr(),In(17)),Bn(this),this.s=2,ps(this)):rn(this,this.S-f)};function ps(f){f.j.G==0||f.J||Iu(f.j,f)}function Bn(f){uo(f);var E=f.M;E&&typeof E.ma=="function"&&E.ma(),f.M=null,_t(f.U),f.g&&(E=f.g,f.g=null,E.abort(),E.ma())}function sr(f,E){try{var b=f.j;if(b.G!=0&&(b.g==f||gs(b.h,f))){if(!f.K&&gs(b.h,f)&&b.G==3){try{var O=b.Da.g.parse(E)}catch{O=null}if(Array.isArray(O)&&O.length==3){var Y=O;if(Y[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<f.F)As(b),Ts(b);else break e;Vl(b),In(18)}}else b.za=Y[1],0<b.za-b.T&&37500>Y[2]&&b.F&&b.v==0&&!b.C&&(b.C=hs(v(b.Za,b),6e3));if(1>=pu(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else kr(b,11)}else if((f.K||b.g==f)&&As(b),!x(E))for(Y=b.Da.g.parse(E),E=0;E<Y.length;E++){let ot=Y[E];if(b.T=ot[0],ot=ot[1],b.G==2)if(ot[0]=="c"){b.K=ot[1],b.ia=ot[2];const wn=ot[3];wn!=null&&(b.la=wn,b.j.info("VER="+b.la));const bn=ot[4];bn!=null&&(b.Aa=bn,b.j.info("SVER="+b.Aa));const Is=ot[5];Is!=null&&typeof Is=="number"&&0<Is&&(O=1.5*Is,b.L=O,b.j.info("backChannelRequestTimeoutMs_="+O)),O=b;const Kn=f.g;if(Kn){const Ra=Kn.g?Kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ra){var ie=O.h;ie.g||Ra.indexOf("spdy")==-1&&Ra.indexOf("quic")==-1&&Ra.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(ys(ie,ie.h),ie.h=null))}if(O.D){const Mr=Kn.g?Kn.g.getResponseHeader("X-HTTP-Session-Id"):null;Mr&&(O.ya=Mr,St(O.I,O.D,Mr))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-f.F,b.j.info("Handshake RTT: "+b.R+"ms")),O=b;var Ee=f;if(O.qa=Cu(O,O.J?O.ia:null,O.W),Ee.K){wi(O.h,Ee);var Pt=Ee,cn=O.L;cn&&(Pt.I=cn),Pt.B&&(uo(Pt),Bi(Pt)),O.g=Ee}else Au(O);0<b.i.length&&vo(b)}else ot[0]!="stop"&&ot[0]!="close"||kr(b,7);else b.G==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?kr(b,7):Ll(b):ot[0]!="noop"&&b.l&&b.l.ta(ot),b.v=0)}}Rr(4)}catch{}}var df=class{constructor(f,E){this.g=f,this.map=E}};function Cl(f){this.l=f||10,d.PerformanceNavigationTiming?(f=d.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Nl(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function pu(f){return f.h?1:f.g?f.g.size:0}function gs(f,E){return f.h?f.h==E:f.g?f.g.has(E):!1}function ys(f,E){f.g?f.g.add(E):f.h=E}function wi(f,E){f.h&&f.h==E?f.h=null:f.g&&f.g.has(E)&&f.g.delete(E)}Cl.prototype.cancel=function(){if(this.i=Fn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Fn(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let E=f.i;for(const b of f.g.values())E=E.concat(b.D);return E}return A(f.i)}function gu(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(h(f)){for(var E=[],b=f.length,O=0;O<b;O++)E.push(f[O]);return E}E=[],b=0;for(O in f)E[b++]=f[O];return E}function hf(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(h(f)||typeof f=="string"){var E=[];f=f.length;for(var b=0;b<f;b++)E.push(b);return E}E=[],b=0;for(const O in f)E[b++]=O;return E}}}function ho(f,E){if(f.forEach&&typeof f.forEach=="function")f.forEach(E,void 0);else if(h(f)||typeof f=="string")Array.prototype.forEach.call(f,E,void 0);else for(var b=hf(f),O=gu(f),Y=O.length,ie=0;ie<Y;ie++)E.call(void 0,O[ie],b&&b[ie],f)}var Ol=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fo(f,E){if(f){f=f.split("&");for(var b=0;b<f.length;b++){var O=f[b].indexOf("="),Y=null;if(0<=O){var ie=f[b].substring(0,O);Y=f[b].substring(O+1)}else ie=f[b];E(ie,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Or(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Or){this.h=f.h,_s(this,f.j),this.o=f.o,this.g=f.g,va(this,f.s),this.l=f.l;var E=f.i,b=new ar;b.i=E.i,E.g&&(b.g=new Map(E.g),b.h=E.h),mo(this,b),this.m=f.m}else f&&(E=String(f).match(Ol))?(this.h=!1,_s(this,E[1]||"",!0),this.o=vs(E[2]||""),this.g=vs(E[3]||"",!0),va(this,E[4]),this.l=vs(E[5]||"",!0),mo(this,E[6]||"",!0),this.m=vs(E[7]||"")):(this.h=!1,this.i=new ar(null,this.h))}Or.prototype.toString=function(){var f=[],E=this.j;E&&f.push(bi(E,xl,!0),":");var b=this.g;return(b||E=="file")&&(f.push("//"),(E=this.o)&&f.push(bi(E,xl,!0),"@"),f.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&f.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&f.push("/"),f.push(bi(b,b.charAt(0)=="/"?Dl:yu,!0))),(b=this.i.toString())&&f.push("?",b),(b=this.m)&&f.push("#",bi(b,pf)),f.join("")};function Jt(f){return new Or(f)}function _s(f,E,b){f.j=b?vs(E,!0):E,f.j&&(f.j=f.j.replace(/:$/,""))}function va(f,E){if(E){if(E=Number(E),isNaN(E)||0>E)throw Error("Bad port number "+E);f.s=E}else f.s=null}function mo(f,E,b){E instanceof ar?(f.i=E,_u(f.i,f.h)):(b||(E=bi(E,mf)),f.i=new ar(E,f.h))}function St(f,E,b){f.i.set(E,b)}function Ea(f){return St(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function vs(f,E){return f?E?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function bi(f,E,b){return typeof f=="string"?(f=encodeURI(f).replace(E,ff),b&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function ff(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var xl=/[#\/\?@]/g,yu=/[#\?:]/g,Dl=/[#\?]/g,mf=/[#\?@]/g,pf=/#/g;function ar(f,E){this.h=this.g=null,this.i=f||null,this.j=!!E}function Sn(f){f.g||(f.g=new Map,f.h=0,f.i&&fo(f.i,function(E,b){f.add(decodeURIComponent(E.replace(/\+/g," ")),b)}))}n=ar.prototype,n.add=function(f,E){Sn(this),this.i=null,f=li(this,f);var b=this.g.get(f);return b||this.g.set(f,b=[]),b.push(E),this.h+=1,this};function po(f,E){Sn(f),E=li(f,E),f.g.has(E)&&(f.i=null,f.h-=f.g.get(E).length,f.g.delete(E))}function go(f,E){return Sn(f),E=li(f,E),f.g.has(E)}n.forEach=function(f,E){Sn(this),this.g.forEach(function(b,O){b.forEach(function(Y){f.call(E,Y,O,this)},this)},this)},n.na=function(){Sn(this);const f=Array.from(this.g.values()),E=Array.from(this.g.keys()),b=[];for(let O=0;O<E.length;O++){const Y=f[O];for(let ie=0;ie<Y.length;ie++)b.push(E[O])}return b},n.V=function(f){Sn(this);let E=[];if(typeof f=="string")go(this,f)&&(E=E.concat(this.g.get(li(this,f))));else{f=Array.from(this.g.values());for(let b=0;b<f.length;b++)E=E.concat(f[b])}return E},n.set=function(f,E){return Sn(this),this.i=null,f=li(this,f),go(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[E]),this.h+=1,this},n.get=function(f,E){return f?(f=this.V(f),0<f.length?String(f[0]):E):E};function xr(f,E,b){po(f,E),0<b.length&&(f.i=null,f.g.set(li(f,E),A(b)),f.h+=b.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],E=Array.from(this.g.keys());for(var b=0;b<E.length;b++){var O=E[b];const ie=encodeURIComponent(String(O)),Ee=this.V(O);for(O=0;O<Ee.length;O++){var Y=ie;Ee[O]!==""&&(Y+="="+encodeURIComponent(String(Ee[O]))),f.push(Y)}}return this.i=f.join("&")};function li(f,E){return E=String(E),f.j&&(E=E.toLowerCase()),E}function _u(f,E){E&&!f.j&&(Sn(f),f.i=null,f.g.forEach(function(b,O){var Y=O.toLowerCase();O!=Y&&(po(this,O),xr(this,Y,b))},f)),f.j=E}function kl(f,E){const b=new fs;if(d.Image){const O=new Image;O.onload=T(Yn,b,"TestLoadImage: loaded",!0,E,O),O.onerror=T(Yn,b,"TestLoadImage: error",!1,E,O),O.onabort=T(Yn,b,"TestLoadImage: abort",!1,E,O),O.ontimeout=T(Yn,b,"TestLoadImage: timeout",!1,E,O),d.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=f}else E(!1)}function vu(f,E){const b=new fs,O=new AbortController,Y=setTimeout(()=>{O.abort(),Yn(b,"TestPingServer: timeout",!1,E)},1e4);fetch(f,{signal:O.signal}).then(ie=>{clearTimeout(Y),ie.ok?Yn(b,"TestPingServer: ok",!0,E):Yn(b,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(Y),Yn(b,"TestPingServer: error",!1,E)})}function Yn(f,E,b,O,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),O(b)}catch{}}function Fi(){this.g=new ai}function Ml(f,E,b){const O=b||"";try{ho(f,function(Y,ie){let Ee=Y;m(Y)&&(Ee=Fe(Y)),E.push(O+ie+"="+encodeURIComponent(Ee))})}catch(Y){throw E.push(O+"type="+encodeURIComponent("_badmap")),Y}}function or(f){this.l=f.Ub||null,this.j=f.eb||!1}I(or,Ei),or.prototype.g=function(){return new ci(this.l,this.j)},or.prototype.i=(function(f){return function(){return f}})({});function ci(f,E){_e.call(this),this.D=f,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(ci,_e),n=ci.prototype,n.open=function(f,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=E,this.readyState=1,Es(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const E={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(E.body=f),(this.D||d).fetch(new Request(this.A,E)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,lr(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Es(this)),this.g&&(this.readyState=3,Es(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yo(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function yo(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var E=f.value?f.value:new Uint8Array(0);(E=this.v.decode(E,{stream:!f.done}))&&(this.response=this.responseText+=E)}f.done?lr(this):Es(this),this.readyState==3&&yo(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,lr(this))},n.Qa=function(f){this.g&&(this.response=f,lr(this))},n.ga=function(){this.g&&lr(this)};function lr(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Es(f)}n.setRequestHeader=function(f,E){this.u.append(f,E)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],E=this.h.entries();for(var b=E.next();!b.done;)b=b.value,f.push(b[0]+": "+b[1]),b=E.next();return f.join(`\r
`)};function Es(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(ci.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Sa(f){let E="";return se(f,function(b,O){E+=O,E+=":",E+=b,E+=`\r
`}),E}function Ss(f,E,b){e:{for(O in b){var O=!1;break e}O=!0}O||(b=Sa(b),typeof f=="string"?b!=null&&encodeURIComponent(String(b)):St(f,E,b))}function Gt(f){_e.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I(Gt,_e);var Ln=/^https?$/i,Dr=["POST","PUT"];n=Gt.prototype,n.Ha=function(f){this.J=f},n.ea=function(f,E,b,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);E=E?E.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ir.g(),this.v=this.o?oi(this.o):oi(ir),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(E,String(f),!0),this.B=!1}catch(ie){wa(this,ie);return}if(f=b||"",b=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var Y in O)b.set(Y,O[Y]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ie of O.keys())b.set(ie,O.get(ie));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(b.keys()).find(ie=>ie.toLowerCase()=="content-type"),Y=d.FormData&&f instanceof d.FormData,!(0<=Array.prototype.indexOf.call(Dr,E,void 0))||O||Y||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,Ee]of b)this.g.setRequestHeader(ie,Ee);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_o(this),this.u=!0,this.g.send(f),this.u=!1}catch(ie){wa(this,ie)}};function wa(f,E){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=E,f.m=5,ws(f),bs(f)}function ws(f){f.A||(f.A=!0,me(f,"complete"),me(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,me(this,"complete"),me(this,"abort"),bs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bs(this,!0)),Gt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Eu(this):this.bb())},n.bb=function(){Eu(this)};function Eu(f){if(f.h&&typeof c<"u"&&(!f.v[1]||Gn(f)!=4||f.Z()!=2)){if(f.u&&Gn(f)==4)re(f.Ea,0,f);else if(me(f,"readystatechange"),Gn(f)==4){f.h=!1;try{const Ee=f.Z();e:switch(Ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var b;if(!(b=E)){var O;if(O=Ee===0){var Y=String(f.D).match(Ol)[1]||null;!Y&&d.self&&d.self.location&&(Y=d.self.location.protocol.slice(0,-1)),O=!Ln.test(Y?Y.toLowerCase():"")}b=O}if(b)me(f,"complete"),me(f,"success");else{f.m=6;try{var ie=2<Gn(f)?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.Z()+"]",ws(f)}}finally{bs(f)}}}}function bs(f,E){if(f.g){_o(f);const b=f.g,O=f.v[0]?()=>{}:null;f.g=null,f.v=null,E||me(f,"ready");try{b.onreadystatechange=O}catch{}}}function _o(f){f.I&&(d.clearTimeout(f.I),f.I=null)}n.isActive=function(){return!!this.g};function Gn(f){return f.g?f.g.readyState:0}n.Z=function(){try{return 2<Gn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var E=this.g.responseText;return f&&E.indexOf(f)==0&&(E=E.substring(f.length)),Et(E)}};function ba(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Su(f){const E={};f=(f.g&&2<=Gn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<f.length;O++){if(x(f[O]))continue;var b=B(f[O]);const Y=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const ie=E[Y]||[];E[Y]=ie,ie.push(b)}D(E,function(O){return O.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ta(f,E,b){return b&&b.internalChannelParams&&b.internalChannelParams[f]||E}function wu(f){this.Aa=0,this.i=[],this.j=new fs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ta("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ta("baseRetryDelayMs",5e3,f),this.cb=Ta("retryDelaySeedMs",1e4,f),this.Wa=Ta("forwardChannelMaxRetries",2,f),this.wa=Ta("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Cl(f&&f.concurrentRequestLimit),this.Da=new Fi,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=wu.prototype,n.la=8,n.G=1,n.connect=function(f,E,b,O){In(0),this.W=f,this.H=E||{},b&&O!==void 0&&(this.H.OSID=b,this.H.OAID=O),this.F=this.X,this.I=Cu(this,null,this.W),vo(this)};function Ll(f){if(bu(f),f.G==3){var E=f.U++,b=Jt(f.I);if(St(b,"SID",f.K),St(b,"RID",E),St(b,"TYPE","terminate"),Aa(f,b),E=new rr(f,f.j,E),E.L=2,E.v=Ea(Jt(b)),b=!1,d.navigator&&d.navigator.sendBeacon)try{b=d.navigator.sendBeacon(E.v.toString(),"")}catch{}!b&&d.Image&&(new Image().src=E.v,b=!0),b||(E.g=Nu(E.j,null),E.g.ea(E.v)),E.F=Date.now(),Bi(E)}zl(f)}function Ts(f){f.g&&(jl(f),f.g.cancel(),f.g=null)}function bu(f){Ts(f),f.u&&(d.clearTimeout(f.u),f.u=null),As(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&d.clearTimeout(f.s),f.s=null)}function vo(f){if(!Nl(f.h)&&!f.s){f.s=!0;var E=f.Ga;he||Ge(),Ie||(he(),Ie=!0),Le.add(E,f),f.B=0}}function gf(f,E){return pu(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=E.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=hs(v(f.Ga,f,E),Pu(f,f.B)),f.B++,!0)}n.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const Y=new rr(this,this.j,f);let ie=this.o;if(this.S&&(ie?(ie=P(ie),M(ie,this.S)):ie=this.S),this.m!==null||this.O||(Y.H=ie,ie=null),this.P)e:{for(var E=0,b=0;b<this.i.length;b++){t:{var O=this.i[b];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(E+=O,4096<E){E=b;break e}if(E===4096||b===this.i.length-1){E=b+1;break e}}E=1e3}else E=1e3;E=Ul(this,Y,E),b=Jt(this.I),St(b,"RID",f),St(b,"CVER",22),this.D&&St(b,"X-HTTP-Session-Id",this.D),Aa(this,b),ie&&(this.O?E="headers="+encodeURIComponent(String(Sa(ie)))+"&"+E:this.m&&Ss(b,this.m,ie)),ys(this.h,Y),this.Ua&&St(b,"TYPE","init"),this.P?(St(b,"$req",E),St(b,"SID","null"),Y.T=!0,ya(Y,b,null)):ya(Y,b,E),this.G=2}}else this.G==3&&(f?Tu(this,f):this.i.length==0||Nl(this.h)||Tu(this))};function Tu(f,E){var b;E?b=E.l:b=f.U++;const O=Jt(f.I);St(O,"SID",f.K),St(O,"RID",b),St(O,"AID",f.T),Aa(f,O),f.m&&f.o&&Ss(O,f.m,f.o),b=new rr(f,f.j,b,f.B+1),f.m===null&&(b.H=f.o),E&&(f.i=E.D.concat(f.i)),E=Ul(f,b,1e3),b.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),ys(f.h,b),ya(b,O,E)}function Aa(f,E){f.H&&se(f.H,function(b,O){St(E,O,b)}),f.l&&ho({},function(b,O){St(E,O,b)})}function Ul(f,E,b){b=Math.min(f.i.length,b);var O=f.l?v(f.l.Na,f.l,f):null;e:{var Y=f.i;let ie=-1;for(;;){const Ee=["count="+b];ie==-1?0<b?(ie=Y[0].g,Ee.push("ofs="+ie)):ie=0:Ee.push("ofs="+ie);let Pt=!0;for(let cn=0;cn<b;cn++){let ot=Y[cn].g;const wn=Y[cn].map;if(ot-=ie,0>ot)ie=Math.max(0,Y[cn].g-100),Pt=!1;else try{Ml(wn,Ee,"req"+ot+"_")}catch{O&&O(wn)}}if(Pt){O=Ee.join("&");break e}}}return f=f.i.splice(0,b),E.D=f,O}function Au(f){if(!f.g&&!f.u){f.Y=1;var E=f.Fa;he||Ge(),Ie||(he(),Ie=!0),Le.add(E,f),f.v=0}}function Vl(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=hs(v(f.Fa,f),Pu(f,f.v)),f.v++,!0)}n.Fa=function(){if(this.u=null,Ru(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=hs(v(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,In(10),Ts(this),Ru(this))};function jl(f){f.A!=null&&(d.clearTimeout(f.A),f.A=null)}function Ru(f){f.g=new rr(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var E=Jt(f.qa);St(E,"RID","rpc"),St(E,"SID",f.K),St(E,"AID",f.T),St(E,"CI",f.F?"0":"1"),!f.F&&f.ja&&St(E,"TO",f.ja),St(E,"TYPE","xmlhttp"),Aa(f,E),f.m&&f.o&&Ss(E,f.m,f.o),f.L&&(f.g.I=f.L);var b=f.g;f=f.ia,b.L=1,b.v=Ea(Jt(E)),b.m=null,b.P=!0,Cr(b,f)}n.Za=function(){this.C!=null&&(this.C=null,Ts(this),Vl(this),In(19))};function As(f){f.C!=null&&(d.clearTimeout(f.C),f.C=null)}function Iu(f,E){var b=null;if(f.g==E){As(f),jl(f),f.g=null;var O=2}else if(gs(f.h,E))b=E.D,wi(f.h,E),O=1;else return;if(f.G!=0){if(E.o)if(O==1){b=E.m?E.m.length:0,E=Date.now()-E.F;var Y=f.B;O=co(),me(O,new Al(O,b)),vo(f)}else Au(f);else if(Y=E.s,Y==3||Y==0&&0<E.X||!(O==1&&gf(f,E)||O==2&&Vl(f)))switch(b&&0<b.length&&(E=f.h,E.i=E.i.concat(b)),Y){case 1:kr(f,5);break;case 4:kr(f,10);break;case 3:kr(f,6);break;default:kr(f,2)}}}function Pu(f,E){let b=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(b*=2),b*E}function kr(f,E){if(f.j.info("Error code "+E),E==2){var b=v(f.fb,f),O=f.Xa;const Y=!O;O=new Or(O||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||_s(O,"https"),Ea(O),Y?kl(O.toString(),b):vu(O.toString(),b)}else In(2);f.G=0,f.l&&f.l.sa(E),zl(f),bu(f)}n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),In(2)):(this.j.info("Failed to ping google.com"),In(1))};function zl(f){if(f.G=0,f.ka=[],f.l){const E=Fn(f.h);(E.length!=0||f.i.length!=0)&&(C(f.ka,E),C(f.ka,f.i),f.h.i.length=0,A(f.i),f.i.length=0),f.l.ra()}}function Cu(f,E,b){var O=b instanceof Or?Jt(b):new Or(b);if(O.g!="")E&&(O.g=E+"."+O.g),va(O,O.s);else{var Y=d.location;O=Y.protocol,E=E?E+"."+Y.hostname:Y.hostname,Y=+Y.port;var ie=new Or(null);O&&_s(ie,O),E&&(ie.g=E),Y&&va(ie,Y),b&&(ie.l=b),O=ie}return b=f.D,E=f.ya,b&&E&&St(O,b,E),St(O,"VER",f.la),Aa(f,O),O}function Nu(f,E,b){if(E&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return E=f.Ca&&!f.pa?new Gt(new or({eb:b})):new Gt(f.pa),E.Ha(f.J),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ou(){}n=Ou.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Eo(){}Eo.prototype.g=function(f,E){return new Hn(f,E)};function Hn(f,E){_e.call(this),this.g=new wu(E),this.l=f,this.h=E&&E.messageUrlParams||null,f=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(f?f["X-WebChannel-Content-Type"]=E.messageContentType:f={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.va&&(f?f["X-WebChannel-Client-Profile"]=E.va:f={"X-WebChannel-Client-Profile":E.va}),this.g.S=f,(f=E&&E.Sb)&&!x(f)&&(this.g.m=f),this.v=E&&E.supportsCrossDomainXhr||!1,this.u=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!x(E)&&(this.g.D=E,f=this.h,f!==null&&E in f&&(f=this.h,E in f&&delete f[E])),this.j=new Rs(this)}I(Hn,_e),Hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){Ll(this.g)},Hn.prototype.o=function(f){var E=this.g;if(typeof f=="string"){var b={};b.__data__=f,f=b}else this.u&&(b={},b.__data__=Fe(f),f=b);E.i.push(new df(E.Ya++,f)),E.G==3&&vo(E)},Hn.prototype.N=function(){this.g.l=null,delete this.j,Ll(this.g),delete this.g,Hn.aa.N.call(this)};function xu(f){cs.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var E=f.__sm__;if(E){e:{for(const b in E){f=b;break e}f=void 0}(this.i=f)&&(f=this.i,E=E!==null&&f in E?E[f]:void 0),this.data=E}else this.data=f}I(xu,cs);function Du(){zi.call(this),this.status=1}I(Du,zi);function Rs(f){this.g=f}I(Rs,Ou),Rs.prototype.ua=function(){me(this.g,"a")},Rs.prototype.ta=function(f){me(this.g,new xu(f))},Rs.prototype.sa=function(f){me(this.g,new Du)},Rs.prototype.ra=function(){me(this.g,"b")},Eo.prototype.createWebChannel=Eo.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,$w=function(){return new Eo},Hw=function(){return co()},Gw=Si,Vp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xt.NO_ERROR=0,Xt.TIMEOUT=8,Xt.HTTP_ERROR=6,Wd=Xt,Pn.COMPLETE="complete",Fw=Pn,ji.EventType=tr,tr.OPEN="a",tr.CLOSE="b",tr.ERROR="c",tr.MESSAGE="d",_e.prototype.listen=_e.prototype.K,Pc=ji,Gt.prototype.listenOnce=Gt.prototype.L,Gt.prototype.getLastError=Gt.prototype.Ka,Gt.prototype.getLastErrorCode=Gt.prototype.Ba,Gt.prototype.getStatus=Gt.prototype.Z,Gt.prototype.getResponseJson=Gt.prototype.Oa,Gt.prototype.getResponseText=Gt.prototype.oa,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Ha,Bw=Gt}).apply(typeof Ud<"u"?Ud:typeof self<"u"?self:typeof window<"u"?window:{});const vE="@firebase/firestore",EE="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ei.UNAUTHENTICATED=new ei(null),ei.GOOGLE_CREDENTIALS=new ei("google-credentials-uid"),ei.FIRST_PARTY=new ei("first-party-uid"),ei.MOCK_USER=new ei("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vl="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=new jh("@firebase/firestore");function Qo(){return Xa.logLevel}function Ce(n,...e){if(Xa.logLevel<=ft.DEBUG){const t=e.map(bg);Xa.debug(`Firestore (${vl}): ${n}`,...t)}}function ss(n,...e){if(Xa.logLevel<=ft.ERROR){const t=e.map(bg);Xa.error(`Firestore (${vl}): ${n}`,...t)}}function Ja(n,...e){if(Xa.logLevel<=ft.WARN){const t=e.map(bg);Xa.warn(`Firestore (${vl}): ${n}`,...t)}}function bg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function He(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,qw(n,r,t)}function qw(n,e,t){let r=`FIRESTORE (${vl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ss(r),new Error(r)}function Ct(n,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,n||qw(e,a,r)}function Je(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Vi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ei.UNAUTHENTICATED)))}shutdown(){}}class DC{constructor(e){this.t=e,this.currentUser=ei.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ct(this.o===void 0,42304);let r=this.i;const a=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let l=new is;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new is,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const h=l;e.enqueueRetryable((async()=>{await h.promise,await a(this.currentUser)}))},d=h=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((h=>d(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?d(h):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new is)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ct(typeof r.accessToken=="string",31837,{l:r}),new OC(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ct(e===null||typeof e=="string",2055,{h:e}),new ei(e)}}class kC{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ei.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class MC{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new kC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ei.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class SE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ct(this.o===void 0,3512);const r=l=>{l.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Ce("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const a=l=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new SE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ct(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new SE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=UC(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function lt(n,e){return n<e?-1:n>e?1:0}function jp(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),a=e.codePointAt(t);if(r!==a){if(r<128&&a<128)return lt(r,a);{const l=Yw(),c=VC(l.encode(wE(n,t)),l.encode(wE(e,t)));return c!==0?c:lt(r,a)}}t+=r>65535?2:1}return lt(n.length,e.length)}function wE(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function VC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return lt(n[t],e[t]);return lt(n.length,e.length)}function dl(n,e,t){return n.length===e.length&&n.every(((r,a)=>t(r,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE="__name__";class pr{constructor(e,t,r){t===void 0?t=0:t>e.length&&He(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&He(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return pr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof pr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=pr.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return lt(e.length,t.length)}static compareSegments(e,t){const r=pr.isNumericId(e),a=pr.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?pr.extractNumericId(e).compare(pr.extractNumericId(t)):jp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ta.fromString(e.substring(4,e.length-2))}}class Bt extends pr{construct(e,t,r){return new Bt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(ce.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Bt(t)}static emptyPath(){return new Bt([])}}const jC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kn extends pr{construct(e,t,r){return new kn(e,t,r)}static isValidIdentifier(e){return jC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bE}static keyField(){return new kn([bE])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new Re(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new Re(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Re(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(r+=d,a++):(l(),a++)}if(l(),c)throw new Re(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kn(t)}static emptyPath(){return new kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.path=e}static fromPath(e){return new Me(Bt.fromString(e))}static fromName(e){return new Me(Bt.fromString(e).popFirst(5))}static empty(){return new Me(Bt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Bt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Bt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Me(new Bt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(n,e,t){if(!t)throw new Re(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zC(n,e,t,r){if(e===!0&&r===!0)throw new Re(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function TE(n){if(!Me.isDocumentKey(n))throw new Re(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function AE(n){if(Me.isDocumentKey(n))throw new Re(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ww(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function zh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":He(12329,{type:typeof n})}function Ji(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=zh(n);throw new Re(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(n,e){const t={typeString:n};return e&&(t.value=e),t}function nu(n,e){if(!Ww(n))throw new Re(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const c=n[r];if(a&&typeof c!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new Re(ce.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE=-62135596800,IE=1e6;class Dt{static now(){return Dt.fromMillis(Date.now())}static fromDate(e){return Dt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*IE);return new Dt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<RE)throw new Re(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/IE}_compareTo(e){return this.seconds===e.seconds?lt(this.nanoseconds,e.nanoseconds):lt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(nu(e,Dt._jsonSchema))return new Dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-RE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Dt._jsonSchemaVersion="firestore/timestamp/1.0",Dt._jsonSchema={type:gn("string",Dt._jsonSchemaVersion),seconds:gn("number"),nanoseconds:gn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new Dt(0,0))}static max(){return new Qe(new Dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=-1;function BC(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,a=Qe.fromTimestamp(r===1e9?new Dt(t+1,0):new Dt(t,r));return new sa(a,Me.empty(),e)}function FC(n){return new sa(n.readTime,n.key,Gc)}class sa{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new sa(Qe.min(),Me.empty(),Gc)}static max(){return new sa(Qe.max(),Me.empty(),Gc)}}function GC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Me.comparator(n.documentKey,e.documentKey),t!==0?t:lt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $C{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function El(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==HC)throw n;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&He(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe(((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.reject(t)}static resolve(e){return new fe(((t,r)=>{t(e)}))}static reject(e){return new fe(((t,r)=>{r(e)}))}static waitFor(e){return new fe(((t,r)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&t()}),(h=>r(h)))})),c=!0,l===a&&t()}))}static or(e){let t=fe.resolve(!1);for(const r of e)t=t.next((a=>a?fe.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,l)=>{r.push(t.call(this,a,l))})),this.waitFor(r)}static mapArray(e,t){return new fe(((r,a)=>{const l=e.length,c=new Array(l);let d=0;for(let h=0;h<l;h++){const m=h;t(e[m]).next((g=>{c[m]=g,++d,d===l&&r(c)}),(g=>a(g)))}}))}static doWhile(e,t){return new fe(((r,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):r()};l()}))}}function qC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Sl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Bh.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ag=-1;function Fh(n){return n==null}function uh(n){return n===0&&1/n==-1/0}function YC(n){return typeof n=="number"&&Number.isInteger(n)&&!uh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="";function KC(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=PE(e)),e=WC(n.get(t),e);return PE(e)}function WC(n,e){let t=e;const r=n.length;for(let a=0;a<r;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case Qw:t+="";break;default:t+=l}}return t}function PE(n){return n+Qw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CE(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function pa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Xw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,t){this.comparator=e,this.root=t||Dn.EMPTY}insert(e,t){return new Qt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dn.BLACK,null,null))}remove(e){return new Qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vd(this.root,e,this.comparator,!0)}}class Vd{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dn{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??Dn.RED,this.left=a??Dn.EMPTY,this.right=l??Dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new Dn(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Dn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw He(43730,{key:this.key,value:this.value});if(this.right.isRed())throw He(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw He(27949);return e+(this.isRed()?0:1)}}Dn.EMPTY=null,Dn.RED=!0,Dn.BLACK=!1;Dn.EMPTY=new class{constructor(){this.size=0}get key(){throw He(57766)}get value(){throw He(16141)}get color(){throw He(16727)}get left(){throw He(29726)}get right(){throw He(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new Dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.comparator=e,this.data=new Qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new NE(this.data.getIterator())}getIteratorFrom(e){return new NE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof En)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new En(this.comparator);return t.data=e,t}}class NE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.fields=e,e.sort(kn.comparator)}static empty(){return new yi([])}unionWith(e){let t=new En(kn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new yi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return dl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Jw("Invalid base64 string: "+l):l}})(e);return new Mn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new Mn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Mn.EMPTY_BYTE_STRING=new Mn("");const QC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function aa(n){if(Ct(!!n,39018),typeof n=="string"){let e=0;const t=QC.exec(n);if(Ct(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ln(n.seconds),nanos:ln(n.nanos)}}function ln(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function oa(n){return typeof n=="string"?Mn.fromBase64String(n):Mn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw="server_timestamp",eb="__type__",tb="__previous_value__",nb="__local_write_time__";function Rg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[eb])===null||t===void 0?void 0:t.stringValue)===Zw}function Gh(n){const e=n.mapValue.fields[tb];return Rg(e)?Gh(e):e}function Hc(n){const e=aa(n.mapValue.fields[nb].timestampValue);return new Dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,t,r,a,l,c,d,h,m,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=g}}const dh="(default)";class $c{constructor(e,t){this.projectId=e,this.database=t||dh}static empty(){return new $c("","")}get isDefaultDatabase(){return this.database===dh}isEqual(e){return e instanceof $c&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib="__type__",JC="__max__",jd={mapValue:{}},rb="__vector__",hh="value";function la(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Rg(n)?4:e1(n)?9007199254740991:ZC(n)?10:11:He(28295,{value:n})}function Tr(n,e){if(n===e)return!0;const t=la(n);if(t!==la(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Hc(n).isEqual(Hc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=aa(a.timestampValue),d=aa(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return oa(a.bytesValue).isEqual(oa(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return ln(a.geoPointValue.latitude)===ln(l.geoPointValue.latitude)&&ln(a.geoPointValue.longitude)===ln(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return ln(a.integerValue)===ln(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=ln(a.doubleValue),d=ln(l.doubleValue);return c===d?uh(c)===uh(d):isNaN(c)&&isNaN(d)}return!1})(n,e);case 9:return dl(n.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(CE(c)!==CE(d))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(d[h]===void 0||!Tr(c[h],d[h])))return!1;return!0})(n,e);default:return He(52216,{left:n})}}function qc(n,e){return(n.values||[]).find((t=>Tr(t,e)))!==void 0}function hl(n,e){if(n===e)return 0;const t=la(n),r=la(e);if(t!==r)return lt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return lt(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=ln(l.integerValue||l.doubleValue),h=ln(c.integerValue||c.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1})(n,e);case 3:return OE(n.timestampValue,e.timestampValue);case 4:return OE(Hc(n),Hc(e));case 5:return jp(n.stringValue,e.stringValue);case 6:return(function(l,c){const d=oa(l),h=oa(c);return d.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),h=c.split("/");for(let m=0;m<d.length&&m<h.length;m++){const g=lt(d[m],h[m]);if(g!==0)return g}return lt(d.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=lt(ln(l.latitude),ln(c.latitude));return d!==0?d:lt(ln(l.longitude),ln(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return xE(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var d,h,m,g;const _=l.fields||{},v=c.fields||{},T=(d=_[hh])===null||d===void 0?void 0:d.arrayValue,I=(h=v[hh])===null||h===void 0?void 0:h.arrayValue,A=lt(((m=T==null?void 0:T.values)===null||m===void 0?void 0:m.length)||0,((g=I==null?void 0:I.values)===null||g===void 0?void 0:g.length)||0);return A!==0?A:xE(T,I)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===jd.mapValue&&c===jd.mapValue)return 0;if(l===jd.mapValue)return 1;if(c===jd.mapValue)return-1;const d=l.fields||{},h=Object.keys(d),m=c.fields||{},g=Object.keys(m);h.sort(),g.sort();for(let _=0;_<h.length&&_<g.length;++_){const v=jp(h[_],g[_]);if(v!==0)return v;const T=hl(d[h[_]],m[g[_]]);if(T!==0)return T}return lt(h.length,g.length)})(n.mapValue,e.mapValue);default:throw He(23264,{le:t})}}function OE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return lt(n,e);const t=aa(n),r=aa(e),a=lt(t.seconds,r.seconds);return a!==0?a:lt(t.nanos,r.nanos)}function xE(n,e){const t=n.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=hl(t[a],r[a]);if(l)return l}return lt(t.length,r.length)}function fl(n){return zp(n)}function zp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=aa(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return oa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Me.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=zp(l);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of r)l?l=!1:a+=",",a+=`${c}:${zp(t.fields[c])}`;return a+"}"})(n.mapValue):He(61005,{value:n})}function Qd(n){switch(la(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Gh(n);return e?16+Qd(e):16;case 5:return 2*n.stringValue.length;case 6:return oa(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,l)=>a+Qd(l)),0)})(n.arrayValue);case 10:case 11:return(function(r){let a=0;return pa(r.fields,((l,c)=>{a+=l.length+Qd(c)})),a})(n.mapValue);default:throw He(13486,{value:n})}}function DE(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Bp(n){return!!n&&"integerValue"in n}function Ig(n){return!!n&&"arrayValue"in n}function kE(n){return!!n&&"nullValue"in n}function ME(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Xd(n){return!!n&&"mapValue"in n}function ZC(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[ib])===null||t===void 0?void 0:t.stringValue)===rb}function Mc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return pa(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Mc(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Mc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function e1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===JC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.value=e}static empty(){return new ni({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Xd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mc(t)}setAll(e){let t=kn.emptyPath(),r={},a=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,r,a),r={},a=[],t=d.popLast()}c?r[d.lastSegment()]=Mc(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());Xd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Xd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){pa(t,((a,l)=>e[a]=l));for(const a of r)delete e[a]}clone(){return new ni(Mc(this.value))}}function sb(n){const e=[];return pa(n.fields,((t,r)=>{const a=new kn([t]);if(Xd(r)){const l=sb(r.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new yi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,t,r,a,l,c,d){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new jn(e,0,Qe.min(),Qe.min(),Qe.min(),ni.empty(),0)}static newFoundDocument(e,t,r,a){return new jn(e,1,t,Qe.min(),r,a,0)}static newNoDocument(e,t){return new jn(e,2,t,Qe.min(),Qe.min(),ni.empty(),0)}static newUnknownDocument(e,t){return new jn(e,3,t,Qe.min(),Qe.min(),ni.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ni.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ni.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,t){this.position=e,this.inclusive=t}}function LE(n,e,t){let r=0;for(let a=0;a<n.position.length;a++){const l=e[a],c=n.position[a];if(l.field.isKeyField()?r=Me.comparator(Me.fromName(c.referenceValue),t.key):r=hl(c,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function UE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,t="asc"){this.field=e,this.dir=t}}function t1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{}class pn extends ab{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new i1(e,t,r):t==="array-contains"?new a1(e,r):t==="in"?new o1(e,r):t==="not-in"?new l1(e,r):t==="array-contains-any"?new c1(e,r):new pn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new r1(e,r):new s1(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(hl(t,this.value)):t!==null&&la(this.value)===la(t)&&this.matchesComparison(hl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return He(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zi extends ab{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Zi(e,t)}matches(e){return ob(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ob(n){return n.op==="and"}function lb(n){return n1(n)&&ob(n)}function n1(n){for(const e of n.filters)if(e instanceof Zi)return!1;return!0}function Fp(n){if(n instanceof pn)return n.field.canonicalString()+n.op.toString()+fl(n.value);if(lb(n))return n.filters.map((e=>Fp(e))).join(",");{const e=n.filters.map((t=>Fp(t))).join(",");return`${n.op}(${e})`}}function cb(n,e){return n instanceof pn?(function(r,a){return a instanceof pn&&r.op===a.op&&r.field.isEqual(a.field)&&Tr(r.value,a.value)})(n,e):n instanceof Zi?(function(r,a){return a instanceof Zi&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((l,c,d)=>l&&cb(c,a.filters[d])),!0):!1})(n,e):void He(19439)}function ub(n){return n instanceof pn?(function(t){return`${t.field.canonicalString()} ${t.op} ${fl(t.value)}`})(n):n instanceof Zi?(function(t){return t.op.toString()+" {"+t.getFilters().map(ub).join(" ,")+"}"})(n):"Filter"}class i1 extends pn{constructor(e,t,r){super(e,t,r),this.key=Me.fromName(r.referenceValue)}matches(e){const t=Me.comparator(e.key,this.key);return this.matchesComparison(t)}}class r1 extends pn{constructor(e,t){super(e,"in",t),this.keys=db("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class s1 extends pn{constructor(e,t){super(e,"not-in",t),this.keys=db("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function db(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>Me.fromName(r.referenceValue)))}class a1 extends pn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ig(t)&&qc(t.arrayValue,this.value)}}class o1 extends pn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&qc(this.value.arrayValue,t)}}class l1 extends pn{constructor(e,t){super(e,"not-in",t)}matches(e){if(qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!qc(this.value.arrayValue,t)}}class c1 extends pn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ig(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>qc(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,t=null,r=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Pe=null}}function VE(n,e=null,t=[],r=[],a=null,l=null,c=null){return new u1(n,e,t,r,a,l,c)}function Pg(n){const e=Je(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Fp(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),Fh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>fl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>fl(r))).join(",")),e.Pe=t}return e.Pe}function Cg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!t1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!cb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!UE(n.startAt,e.startAt)&&UE(n.endAt,e.endAt)}function Gp(n){return Me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,t=null,r=[],a=[],l=null,c="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function d1(n,e,t,r,a,l,c,d){return new iu(n,e,t,r,a,l,c,d)}function Ng(n){return new iu(n)}function jE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function hb(n){return n.collectionGroup!==null}function Lc(n){const e=Je(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new En(kn.comparator);return c.filters.forEach((h=>{h.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new mh(l,r))})),t.has(kn.keyField().canonicalString())||e.Te.push(new mh(kn.keyField(),r))}return e.Te}function gr(n){const e=Je(n);return e.Ie||(e.Ie=h1(e,Lc(n))),e.Ie}function h1(n,e){if(n.limitType==="F")return VE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new mh(a.field,l)}));const t=n.endAt?new fh(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new fh(n.startAt.position,n.startAt.inclusive):null;return VE(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Hp(n,e){const t=n.filters.concat([e]);return new iu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ph(n,e,t){return new iu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Hh(n,e){return Cg(gr(n),gr(e))&&n.limitType===e.limitType}function fb(n){return`${Pg(gr(n))}|lt:${n.limitType}`}function Xo(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>ub(a))).join(", ")}]`),Fh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>fl(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>fl(a))).join(",")),`Target(${r})`})(gr(n))}; limitType=${n.limitType})`}function $h(n,e){return e.isFoundDocument()&&(function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):Me.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(n,e)&&(function(r,a){for(const l of Lc(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(r,a){return!(r.startAt&&!(function(c,d,h){const m=LE(c,d,h);return c.inclusive?m<=0:m<0})(r.startAt,Lc(r),a)||r.endAt&&!(function(c,d,h){const m=LE(c,d,h);return c.inclusive?m>=0:m>0})(r.endAt,Lc(r),a))})(n,e)}function f1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function mb(n){return(e,t)=>{let r=!1;for(const a of Lc(n)){const l=m1(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function m1(n,e,t){const r=n.field.isKeyField()?Me.comparator(e.key,t.key):(function(l,c,d){const h=c.data.field(l),m=d.data.field(l);return h!==null&&m!==null?hl(h,m):He(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return He(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){pa(this.inner,((t,r)=>{for(const[a,l]of r)e(a,l)}))}isEmpty(){return Xw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=new Qt(Me.comparator);function as(){return p1}const pb=new Qt(Me.comparator);function Cc(...n){let e=pb;for(const t of n)e=e.insert(t.key,t);return e}function gb(n){let e=pb;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ka(){return Uc()}function yb(){return Uc()}function Uc(){return new so((n=>n.toString()),((n,e)=>n.isEqual(e)))}const g1=new Qt(Me.comparator),y1=new En(Me.comparator);function mt(...n){let e=y1;for(const t of n)e=e.add(t);return e}const _1=new En(lt);function v1(){return _1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uh(e)?"-0":e}}function _b(n){return{integerValue:""+n}}function vb(n,e){return YC(e)?_b(e):Og(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(){this._=void 0}}function E1(n,e,t){return n instanceof Yc?(function(a,l){const c={fields:{[eb]:{stringValue:Zw},[nb]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Rg(l)&&(l=Gh(l)),l&&(c.fields[tb]=l),{mapValue:c}})(t,e):n instanceof Kc?Sb(n,e):n instanceof Wc?wb(n,e):(function(a,l){const c=Eb(a,l),d=zE(c)+zE(a.Ee);return Bp(c)&&Bp(a.Ee)?_b(d):Og(a.serializer,d)})(n,e)}function S1(n,e,t){return n instanceof Kc?Sb(n,e):n instanceof Wc?wb(n,e):t}function Eb(n,e){return n instanceof Qc?(function(r){return Bp(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class Yc extends qh{}class Kc extends qh{constructor(e){super(),this.elements=e}}function Sb(n,e){const t=bb(e);for(const r of n.elements)t.some((a=>Tr(a,r)))||t.push(r);return{arrayValue:{values:t}}}class Wc extends qh{constructor(e){super(),this.elements=e}}function wb(n,e){let t=bb(e);for(const r of n.elements)t=t.filter((a=>!Tr(a,r)));return{arrayValue:{values:t}}}class Qc extends qh{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function zE(n){return ln(n.integerValue||n.doubleValue)}function bb(n){return Ig(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,t){this.field=e,this.transform=t}}function w1(n,e){return n.field.isEqual(e.field)&&(function(r,a){return r instanceof Kc&&a instanceof Kc||r instanceof Wc&&a instanceof Wc?dl(r.elements,a.elements,Tr):r instanceof Qc&&a instanceof Qc?Tr(r.Ee,a.Ee):r instanceof Yc&&a instanceof Yc})(n.transform,e.transform)}class b1{constructor(e,t){this.version=e,this.transformResults=t}}class Qi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qi}static exists(e){return new Qi(void 0,e)}static updateTime(e){return new Qi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Yh{}function Ab(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ib(n.key,Qi.none()):new ru(n.key,n.data,Qi.none());{const t=n.data,r=ni.empty();let a=new En(kn.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?r.delete(l):r.set(l,c),a=a.add(l)}return new ga(n.key,r,new yi(a.toArray()),Qi.none())}}function T1(n,e,t){n instanceof ru?(function(a,l,c){const d=a.value.clone(),h=FE(a.fieldTransforms,l,c.transformResults);d.setAll(h),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):n instanceof ga?(function(a,l,c){if(!Jd(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=FE(a.fieldTransforms,l,c.transformResults),h=l.data;h.setAll(Rb(a)),h.setAll(d),l.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Vc(n,e,t,r){return n instanceof ru?(function(l,c,d,h){if(!Jd(l.precondition,c))return d;const m=l.value.clone(),g=GE(l.fieldTransforms,h,c);return m.setAll(g),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,r):n instanceof ga?(function(l,c,d,h){if(!Jd(l.precondition,c))return d;const m=GE(l.fieldTransforms,h,c),g=c.data;return g.setAll(Rb(l)),g.setAll(m),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((_=>_.field)))})(n,e,t,r):(function(l,c,d){return Jd(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(n,e,t)}function A1(n,e){let t=null;for(const r of n.fieldTransforms){const a=e.data.field(r.field),l=Eb(r.transform,a||null);l!=null&&(t===null&&(t=ni.empty()),t.set(r.field,l))}return t||null}function BE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&dl(r,a,((l,c)=>w1(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ru extends Yh{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ga extends Yh{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Rb(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function FE(n,e,t){const r=new Map;Ct(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],c=l.transform,d=e.data.field(l.field);r.set(l.field,S1(c,d,t[a]))}return r}function GE(n,e,t){const r=new Map;for(const a of n){const l=a.transform,c=t.data.field(a.field);r.set(a.field,E1(l,c,e))}return r}class Ib extends Yh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class R1 extends Yh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&T1(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Vc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Vc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=yb();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(a.key)?null:d;const h=Ab(c,d);h!==null&&r.set(a.key,h),c.isValidDocument()||c.convertToNoDocument(Qe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),mt())}isEqual(e){return this.batchId===e.batchId&&dl(this.mutations,e.mutations,((t,r)=>BE(t,r)))&&dl(this.baseMutations,e.baseMutations,((t,r)=>BE(t,r)))}}class xg{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){Ct(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let a=(function(){return g1})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,r[c].version);return new xg(e,t,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn,vt;function N1(n){switch(n){case ce.OK:return He(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return He(15467,{code:n})}}function Pb(n){if(n===void 0)return ss("GRPC error has no .code"),ce.UNKNOWN;switch(n){case mn.OK:return ce.OK;case mn.CANCELLED:return ce.CANCELLED;case mn.UNKNOWN:return ce.UNKNOWN;case mn.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case mn.INTERNAL:return ce.INTERNAL;case mn.UNAVAILABLE:return ce.UNAVAILABLE;case mn.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case mn.NOT_FOUND:return ce.NOT_FOUND;case mn.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case mn.ABORTED:return ce.ABORTED;case mn.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case mn.DATA_LOSS:return ce.DATA_LOSS;default:return He(39323,{code:n})}}(vt=mn||(mn={}))[vt.OK=0]="OK",vt[vt.CANCELLED=1]="CANCELLED",vt[vt.UNKNOWN=2]="UNKNOWN",vt[vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",vt[vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",vt[vt.NOT_FOUND=5]="NOT_FOUND",vt[vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",vt[vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",vt[vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",vt[vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",vt[vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",vt[vt.ABORTED=10]="ABORTED",vt[vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",vt[vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",vt[vt.INTERNAL=13]="INTERNAL",vt[vt.UNAVAILABLE=14]="UNAVAILABLE",vt[vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1=new ta([4294967295,4294967295],0);function HE(n){const e=Yw().encode(n),t=new zw;return t.update(e),new Uint8Array(t.digest())}function $E(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ta([t,r],0),new ta([a,l],0)]}class Dg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Nc(`Invalid padding: ${t}`);if(r<0)throw new Nc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Nc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Nc(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ta.fromNumber(this.fe)}pe(e,t,r){let a=e.add(t.multiply(ta.fromNumber(r)));return a.compare(O1)===1&&(a=new ta([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=HE(e),[r,a]=$E(t);for(let l=0;l<this.hashCount;l++){const c=this.pe(r,a,l);if(!this.ye(c))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new Dg(l,a,t);return r.forEach((d=>c.insert(d))),c}insert(e){if(this.fe===0)return;const t=HE(e),[r,a]=$E(t);for(let l=0;l<this.hashCount;l++){const c=this.pe(r,a,l);this.we(c)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,su.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Kh(Qe.min(),a,new Qt(lt),as(),mt())}}class su{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new su(r,t,mt(),mt(),mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,t,r,a){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=a}}class Cb{constructor(e,t){this.targetId=e,this.De=t}}class Nb{constructor(e,t,r=Mn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class qE{constructor(){this.ve=0,this.Ce=YE(),this.Fe=Mn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=mt(),t=mt(),r=mt();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:He(38017,{changeType:l})}})),new su(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=YE()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Ct(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class x1{constructor(e){this.We=e,this.Ge=new Map,this.ze=as(),this.je=zd(),this.Je=zd(),this.He=new Qt(lt)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:He(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((r,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,r=e.De.count,a=this.st(t);if(a){const l=a.target;if(Gp(l))if(r===0){const c=new Me(l.path);this.Xe(t,c,jn.newNoDocument(c,Qe.min()))}else Ct(r===1,20013,{expectedCount:r});else{const c=this.ot(t);if(c!==r){const d=this._t(e),h=d?this.ut(d,e,c):1;if(h!==0){this.rt(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,m)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let c,d;try{c=oa(r).toUint8Array()}catch(h){if(h instanceof Jw)return Ja("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{d=new Dg(c,a,l)}catch(h){return Ja(h instanceof Nc?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return d.fe===0?null:d}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let a=0;return r.forEach((l=>{const c=this.We.lt(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,c)=>{const d=this.st(c);if(d){if(l.current&&Gp(d.target)){const h=new Me(d.target.path);this.Tt(h).has(c)||this.It(c,h)||this.Xe(c,h,jn.newNoDocument(h,e))}l.Ne&&(t.set(c,l.Le()),l.ke())}}));let r=mt();this.Je.forEach(((l,c)=>{let d=!0;c.forEachWhile((h=>{const m=this.st(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(l))})),this.ze.forEach(((l,c)=>c.setReadTime(e)));const a=new Kh(e,t,this.He,this.ze,r);return this.ze=as(),this.je=zd(),this.Je=zd(),this.He=new Qt(lt),a}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new qE,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new En(lt),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new En(lt),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Ce("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new qE),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function zd(){return new Qt(Me.comparator)}function YE(){return new Qt(Me.comparator)}const D1={asc:"ASCENDING",desc:"DESCENDING"},k1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},M1={and:"AND",or:"OR"};class L1{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $p(n,e){return n.useProto3Json||Fh(e)?e:{value:e}}function gh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ob(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function U1(n,e){return gh(n,e.toTimestamp())}function yr(n){return Ct(!!n,49232),Qe.fromTimestamp((function(t){const r=aa(t);return new Dt(r.seconds,r.nanos)})(n))}function kg(n,e){return qp(n,e).canonicalString()}function qp(n,e){const t=(function(a){return new Bt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function xb(n){const e=Bt.fromString(n);return Ct(Ub(e),10190,{key:e.toString()}),e}function Yp(n,e){return kg(n.databaseId,e.path)}function Sp(n,e){const t=xb(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Me(kb(t))}function Db(n,e){return kg(n.databaseId,e)}function V1(n){const e=xb(n);return e.length===4?Bt.emptyPath():kb(e)}function Kp(n){return new Bt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function kb(n){return Ct(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function KE(n,e,t){return{name:Yp(n,e),fields:t.value.mapValue.fields}}function j1(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:He(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,g){return m.useProto3Json?(Ct(g===void 0||typeof g=="string",58123),Mn.fromBase64String(g||"")):(Ct(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Mn.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(m){const g=m.code===void 0?ce.UNKNOWN:Pb(m.code);return new Re(g,m.message||"")})(c);t=new Nb(r,a,l,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=Sp(n,r.document.name),l=yr(r.document.updateTime),c=r.document.createTime?yr(r.document.createTime):Qe.min(),d=new ni({mapValue:{fields:r.document.fields}}),h=jn.newFoundDocument(a,l,c,d),m=r.targetIds||[],g=r.removedTargetIds||[];t=new Zd(m,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=Sp(n,r.document),l=r.readTime?yr(r.readTime):Qe.min(),c=jn.newNoDocument(a,l),d=r.removedTargetIds||[];t=new Zd([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=Sp(n,r.document),l=r.removedTargetIds||[];t=new Zd([],l,a,null)}else{if(!("filter"in e))return He(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,c=new C1(a,l),d=r.targetId;t=new Cb(d,c)}}return t}function z1(n,e){let t;if(e instanceof ru)t={update:KE(n,e.key,e.value)};else if(e instanceof Ib)t={delete:Yp(n,e.key)};else if(e instanceof ga)t={update:KE(n,e.key,e.data),updateMask:W1(e.fieldMask)};else{if(!(e instanceof R1))return He(16599,{Rt:e.type});t={verify:Yp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,c){const d=c.transform;if(d instanceof Yc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Kc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Wc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Qc)return{fieldPath:c.field.canonicalString(),increment:d.Ee};throw He(20930,{transform:c.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:U1(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:He(27497)})(n,e.precondition)),t}function B1(n,e){return n&&n.length>0?(Ct(e!==void 0,14353),n.map((t=>(function(a,l){let c=a.updateTime?yr(a.updateTime):yr(l);return c.isEqual(Qe.min())&&(c=yr(l)),new b1(c,a.transformResults||[])})(t,e)))):[]}function F1(n,e){return{documents:[Db(n,e.path)]}}function G1(n,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Db(n,a);const l=(function(m){if(m.length!==0)return Lb(Zi.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(m){if(m.length!==0)return m.map((g=>(function(v){return{field:Jo(v.field),direction:q1(v.dir)}})(g)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=$p(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{Vt:t,parent:a}}function H1(n){let e=V1(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){Ct(r===1,65062);const g=t.from[0];g.allDescendants?a=g.collectionId:e=e.child(g.collectionId)}let l=[];t.where&&(l=(function(_){const v=Mb(_);return v instanceof Zi&&lb(v)?v.getFilters():[v]})(t.where));let c=[];t.orderBy&&(c=(function(_){return _.map((v=>(function(I){return new mh(Zo(I.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(v)))})(t.orderBy));let d=null;t.limit&&(d=(function(_){let v;return v=typeof _=="object"?_.value:_,Fh(v)?null:v})(t.limit));let h=null;t.startAt&&(h=(function(_){const v=!!_.before,T=_.values||[];return new fh(T,v)})(t.startAt));let m=null;return t.endAt&&(m=(function(_){const v=!_.before,T=_.values||[];return new fh(T,v)})(t.endAt)),d1(e,a,c,l,d,"F",h,m)}function $1(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return He(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Mb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Zo(t.unaryFilter.field);return pn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=Zo(t.unaryFilter.field);return pn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Zo(t.unaryFilter.field);return pn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Zo(t.unaryFilter.field);return pn.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return He(61313);default:return He(60726)}})(n):n.fieldFilter!==void 0?(function(t){return pn.create(Zo(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return He(58110);default:return He(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Zi.create(t.compositeFilter.filters.map((r=>Mb(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return He(1026)}})(t.compositeFilter.op))})(n):He(30097,{filter:n})}function q1(n){return D1[n]}function Y1(n){return k1[n]}function K1(n){return M1[n]}function Jo(n){return{fieldPath:n.canonicalString()}}function Zo(n){return kn.fromServerFormat(n.fieldPath)}function Lb(n){return n instanceof pn?(function(t){if(t.op==="=="){if(ME(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NAN"}};if(kE(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ME(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NAN"}};if(kE(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jo(t.field),op:Y1(t.op),value:t.value}}})(n):n instanceof Zi?(function(t){const r=t.getFilters().map((a=>Lb(a)));return r.length===1?r[0]:{compositeFilter:{op:K1(t.op),filters:r}}})(n):He(54877,{filter:n})}function W1(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ub(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,t,r,a,l=Qe.min(),c=Qe.min(),d=Mn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new Js(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e){this.gt=e}}function X1(n){const e=H1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ph(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(){this.Dn=new Z1}addToCollectionParentIndex(e,t){return this.Dn.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}deleteAllFieldIndexes(e){return fe.resolve()}createTargetIndexes(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t){return fe.resolve(null)}getIndexType(e,t){return fe.resolve(0)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}getMinOffset(e,t){return fe.resolve(sa.min())}getMinOffsetFromCollectionGroup(e,t){return fe.resolve(sa.min())}updateCollectionGroup(e,t,r){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class Z1{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new En(Bt.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new En(Bt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Vb=41943040;class ti{static withCacheSize(e){return new ti(e,ti.DEFAULT_COLLECTION_PERCENTILE,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ti.DEFAULT_COLLECTION_PERCENTILE=10,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ti.DEFAULT=new ti(Vb,ti.DEFAULT_COLLECTION_PERCENTILE,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ti.DISABLED=new ti(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new ml(0)}static ur(){return new ml(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE="LruGarbageCollector",jb=1048576;function XE([n,e],[t,r]){const a=lt(n,t);return a===0?lt(e,r):a}class eN{constructor(e){this.Tr=e,this.buffer=new En(XE),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();XE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class tN{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Ce(QE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Sl(t)?Ce(QE,"Ignoring IndexedDB error during garbage collection: ",t):await El(t)}await this.Rr(3e5)}))}}class nN{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return fe.resolve(Bh.ue);const r=new eN(t);return this.Vr.forEachTarget(e,(a=>r.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>r.Er(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(WE)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WE):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,a,l,c,d,h,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),a=this.params.maximumSequenceNumbersToCollect):a=_,c=Date.now(),this.nthSequenceNumber(e,a)))).next((_=>(r=_,d=Date.now(),this.removeTargets(e,r,t)))).next((_=>(l=_,h=Date.now(),this.removeOrphanedDocuments(e,r)))).next((_=>(m=Date.now(),Qo()<=ft.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(h-d)+`ms
	Removed ${_} documents in `+(m-h)+`ms
Total Duration: ${m-g}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:_}))))}}function iN(n,e){return new nN(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(){this.changes=new so((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,jn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&Vc(r.mutation,a,yi.empty(),Dt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,mt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=mt()){const a=Ka();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((l=>{let c=Cc();return l.forEach(((d,h)=>{c=c.insert(d,h.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const r=Ka();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,mt())))}populateOverlays(e,t,r){const a=[];return r.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,r,a){let l=as();const c=Uc(),d=(function(){return Uc()})();return t.forEach(((h,m)=>{const g=r.get(m.key);a.has(m.key)&&(g===void 0||g.mutation instanceof ga)?l=l.insert(m.key,m):g!==void 0?(c.set(m.key,g.mutation.getFieldMask()),Vc(g.mutation,m,g.mutation.getFieldMask(),Dt.now())):c.set(m.key,yi.empty())})),this.recalculateAndSaveOverlays(e,l).next((h=>(h.forEach(((m,g)=>c.set(m,g))),t.forEach(((m,g)=>{var _;return d.set(m,new sN(g,(_=c.get(m))!==null&&_!==void 0?_:null))})),d)))}recalculateAndSaveOverlays(e,t){const r=Uc();let a=new Qt(((c,d)=>c-d)),l=mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((h=>{const m=t.get(h);if(m===null)return;let g=r.get(h)||yi.empty();g=d.applyToLocalView(m,g),r.set(h,g);const _=(a.get(d.batchId)||mt()).add(h);a=a.insert(d.batchId,_)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),m=h.key,g=h.value,_=yb();g.forEach((v=>{if(!l.has(v)){const T=Ab(t.get(v),r.get(v));T!==null&&_.set(v,T),l=l.add(v)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,_))}return fe.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return(function(c){return Me.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):hb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):fe.resolve(Ka());let d=Gc,h=l;return c.next((m=>fe.forEach(m,((g,_)=>(d<_.largestBatchId&&(d=_.largestBatchId),l.get(g)?fe.resolve():this.remoteDocumentCache.getEntry(e,g).next((v=>{h=h.insert(g,v)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,h,m,mt()))).next((g=>({batchId:d,changes:gb(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Me(t)).next((r=>{let a=Cc();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let c=Cc();return this.indexManager.getCollectionParents(e,l).next((d=>fe.forEach(d,(h=>{const m=(function(_,v){return new iu(v,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,h.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,r,a).next((g=>{g.forEach(((_,v)=>{c=c.insert(_,v)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a)))).next((c=>{l.forEach(((h,m)=>{const g=m.getKey();c.get(g)===null&&(c=c.insert(g,jn.newInvalidDocument(g)))}));let d=Cc();return c.forEach(((h,m)=>{const g=l.get(h);g!==void 0&&Vc(g.mutation,m,yi.empty(),Dt.now()),$h(t,m)&&(d=d.insert(h,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return fe.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:yr(a.createTime)}})(t)),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:X1(a.bundledQuery),readTime:yr(a.readTime)}})(t)),fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(){this.overlays=new Qt(Me.comparator),this.kr=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ka();return fe.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,l)=>{this.wt(e,t,l)})),fe.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.kr.get(r);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(r)),fe.resolve()}getOverlaysForCollection(e,t,r){const a=Ka(),l=t.length+1,c=new Me(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const h=d.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&h.largestBatchId>r&&a.set(h.getKey(),h)}return fe.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new Qt(((m,g)=>m-g));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let g=l.get(m.largestBatchId);g===null&&(g=Ka(),l=l.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const d=Ka(),h=l.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((m,g)=>d.set(m,g))),!(d.size()>=a)););return fe.resolve(d)}wt(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const c=this.kr.get(a.largestBatchId).delete(r.key);this.kr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new P1(t,r));let l=this.kr.get(t);l===void 0&&(l=mt(),this.kr.set(t,l)),this.kr.set(t,l.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(){this.sessionToken=Mn.EMPTY_BYTE_STRING}getSessionToken(e){return fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(){this.qr=new En(An.Qr),this.$r=new En(An.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new An(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new An(e,t))}Gr(e,t){e.forEach((r=>this.removeReference(r,t)))}zr(e){const t=new Me(new Bt([])),r=new An(t,e),a=new An(t,e+1),l=[];return this.$r.forEachInRange([r,a],(c=>{this.Wr(c),l.push(c.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Me(new Bt([])),r=new An(t,e),a=new An(t,e+1);let l=mt();return this.$r.forEachInRange([r,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new An(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class An{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Me.comparator(e.key,t.key)||lt(e.Hr,t.Hr)}static Ur(e,t){return lt(e.Hr,t.Hr)||Me.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new En(An.Qr)}checkEmpty(e){return fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new I1(l,t,r,a);this.mutationQueue.push(c);for(const d of a)this.Yr=this.Yr.add(new An(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return fe.resolve(c)}lookupMutationBatch(e,t){return fe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.Xr(r),l=a<0?0:a;return fe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(this.mutationQueue.length===0?Ag:this.er-1)}getAllMutationBatches(e){return fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new An(t,0),a=new An(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([r,a],(c=>{const d=this.Zr(c.Hr);l.push(d)})),fe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new En(lt);return t.forEach((a=>{const l=new An(a,0),c=new An(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,c],(d=>{r=r.add(d.Hr)}))})),fe.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;Me.isDocumentKey(l)||(l=l.child(""));const c=new An(new Me(l),0);let d=new En(lt);return this.Yr.forEachWhile((h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===a&&(d=d.add(h.Hr)),!0)}),c),fe.resolve(this.ei(d))}ei(e){const t=[];return e.forEach((r=>{const a=this.Zr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Ct(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return fe.forEach(t.mutations,(a=>{const l=new An(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=r}))}rr(e){}containsKey(e,t){const r=new An(t,0),a=this.Yr.firstAfterOrEqual(r);return fe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,fe.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e){this.ni=e,this.docs=(function(){return new Qt(Me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,c=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return fe.resolve(r?r.document.mutableCopy():jn.newInvalidDocument(t))}getEntries(e,t){let r=as();return t.forEach((a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():jn.newInvalidDocument(a))})),fe.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=as();const c=t.path,d=new Me(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:m,value:{document:g}}=h.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||GC(FC(g),r)<=0||(a.has(g.key)||$h(t,g))&&(l=l.insert(g.key,g.mutableCopy()))}return fe.resolve(l)}getAllFromCollectionGroup(e,t,r,a){He(9500)}ri(e,t){return fe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new hN(this)}getSize(e){return fe.resolve(this.size)}}class hN extends rN{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(r)})),fe.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.persistence=e,this.ii=new so((t=>Pg(t)),Cg),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.si=0,this.oi=new Mg,this.targetCount=0,this._i=ml.ar()}forEachTarget(e,t){return this.ii.forEach(((r,a)=>t(a))),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),fe.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new ml(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.hr(t),fe.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.ii.forEach(((c,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.ii.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),fe.waitFor(l).next((()=>a))}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return fe.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),fe.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),fe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return fe.resolve(r)}containsKey(e,t){return fe.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e,t){this.ai={},this.overlays={},this.ui=new Bh(0),this.ci=!1,this.ci=!0,this.li=new cN,this.referenceDelegate=e(this),this.hi=new fN(this),this.indexManager=new J1,this.remoteDocumentCache=(function(a){return new dN(a)})((r=>this.referenceDelegate.Pi(r))),this.serializer=new Q1(t),this.Ti=new oN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new lN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new uN(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){Ce("MemoryPersistence","Starting transaction:",e);const a=new mN(this.ui.next());return this.referenceDelegate.Ii(),r(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return fe.or(Object.values(this.ai).map((r=>()=>r.containsKey(e,t))))}}class mN extends $C{constructor(e){super(),this.currentSequenceNumber=e}}class Lg{constructor(e){this.persistence=e,this.Ai=new Mg,this.Ri=null}static Vi(e){return new Lg(e)}get mi(){if(this.Ri)return this.Ri;throw He(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),fe.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.mi,(r=>{const a=Me.fromPath(r);return this.fi(e,a).next((l=>{l||t.removeEntry(a,Qe.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return fe.or([()=>fe.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class yh{constructor(e,t){this.persistence=e,this.gi=new so((r=>KC(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=iN(this,t)}static Vi(e,t){return new yh(e,t)}Ii(){}di(e){return fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}gr(e,t){return fe.forEach(this.gi,((r,a)=>this.Sr(e,r,a).next((l=>l?fe.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(c=>this.Sr(e,c,t).next((d=>{d||(r++,l.removeEntry(c,Qe.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),fe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),fe.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),fe.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),fe.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Qd(e.data.value)),t}Sr(e,t,r){return fe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return fe.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=a}static Es(e,t){let r=mt(),a=mt();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Ug(e,t.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return dP()?8:qC(zn())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.ps(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ys(e,t,a,r).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new pN;return this.ws(e,t,c).next((d=>{if(l.result=d,this.Rs)return this.Ss(e,t,c,d.size)}))})).next((()=>l.result))}Ss(e,t,r,a){return r.documentReadCount<this.Vs?(Qo()<=ft.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",Xo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),fe.resolve()):(Qo()<=ft.DEBUG&&Ce("QueryEngine","Query:",Xo(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.fs*a?(Qo()<=ft.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",Xo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gr(t))):fe.resolve())}ps(e,t){if(jE(t))return fe.resolve(null);let r=gr(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=ph(t,null,"F"),r=gr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const c=mt(...l);return this.gs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,r).next((h=>{const m=this.bs(t,d);return this.Ds(t,m,c,h.readTime)?this.ps(e,ph(t,null,"F")):this.vs(e,m,t,h)}))))})))))}ys(e,t,r,a){return jE(t)||a.isEqual(Qe.min())?fe.resolve(null):this.gs.getDocuments(e,r).next((l=>{const c=this.bs(t,l);return this.Ds(t,c,r,a)?fe.resolve(null):(Qo()<=ft.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Xo(t)),this.vs(e,c,t,BC(a,Gc)).next((d=>d)))}))}bs(e,t){let r=new En(mb(e));return t.forEach(((a,l)=>{$h(e,l)&&(r=r.add(l))})),r}Ds(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,r){return Qo()<=ft.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",Xo(t)),this.gs.getDocumentsMatchingQuery(e,t,sa.min(),r)}vs(e,t,r,a){return this.gs.getDocumentsMatchingQuery(e,r,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg="LocalStore",yN=3e8;class _N{constructor(e,t,r,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Qt(lt),this.Ms=new so((l=>Pg(l)),Cg),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new aN(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function vN(n,e,t,r){return new _N(n,e,t,r)}async function Bb(n,e){const t=Je(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const c=[],d=[];let h=mt();for(const m of a){c.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}for(const m of l){d.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}return t.localDocuments.getDocuments(r,h).next((m=>({Bs:m,removedBatchIds:c,addedBatchIds:d})))}))}))}function EN(n,e){const t=Je(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(d,h,m,g){const _=m.batch,v=_.keys();let T=fe.resolve();return v.forEach((I=>{T=T.next((()=>g.getEntry(h,I))).next((A=>{const C=m.docVersions.get(I);Ct(C!==null,48541),A.version.compareTo(C)<0&&(_.applyToRemoteDocument(A,m),A.isValidDocument()&&(A.setReadTime(m.commitVersion),g.addEntry(A)))}))})),T.next((()=>d.mutationQueue.removeMutationBatch(h,_)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let h=mt();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(h=h.add(d.batch.mutations[m].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function Fb(n){const e=Je(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function SN(n,e){const t=Je(n),r=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const d=[];e.targetChanges.forEach(((g,_)=>{const v=a.get(_);if(!v)return;d.push(t.hi.removeMatchingKeys(l,g.removedDocuments,_).next((()=>t.hi.addMatchingKeys(l,g.addedDocuments,_))));let T=v.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(_)!==null?T=T.withResumeToken(Mn.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,r)),a=a.insert(_,T),(function(A,C,L){return A.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=yN?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(v,T,g)&&d.push(t.hi.updateTargetData(l,T))}));let h=as(),m=mt();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,g))})),d.push(wN(l,c,e.documentUpdates).next((g=>{h=g.Ls,m=g.ks}))),!r.isEqual(Qe.min())){const g=t.hi.getLastRemoteSnapshotVersion(l).next((_=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,r)));d.push(g)}return fe.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,h,m))).next((()=>h))})).then((l=>(t.Fs=a,l)))}function wN(n,e,t){let r=mt(),a=mt();return t.forEach((l=>r=r.add(l))),e.getEntries(n,r).next((l=>{let c=as();return t.forEach(((d,h)=>{const m=l.get(d);h.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(d)),h.isNoDocument()&&h.version.isEqual(Qe.min())?(e.removeEntry(d,h.readTime),c=c.insert(d,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),c=c.insert(d,h)):Ce(Vg,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",h.version)})),{Ls:c,ks:a}}))}function bN(n,e){const t=Je(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Ag),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function TN(n,e){const t=Je(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.hi.getTargetData(r,e).next((l=>l?(a=l,fe.resolve(a)):t.hi.allocateTargetId(r).next((c=>(a=new Js(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.Fs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r}))}async function Wp(n,e,t){const r=Je(n),a=r.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(c=>r.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!Sl(c))throw c;Ce(Vg,`Failed to update sequence numbers for target ${e}: ${c}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(a.target)}function JE(n,e,t){const r=Je(n);let a=Qe.min(),l=mt();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(h,m,g){const _=Je(h),v=_.Ms.get(g);return v!==void 0?fe.resolve(_.Fs.get(v)):_.hi.getTargetData(m,g)})(r,c,gr(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(c,d.targetId).next((h=>{l=h}))})).next((()=>r.Cs.getDocumentsMatchingQuery(c,e,t?a:Qe.min(),t?l:mt()))).next((d=>(AN(r,f1(e),d),{documents:d,qs:l})))))}function AN(n,e,t){let r=n.xs.get(e)||Qe.min();t.forEach(((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),n.xs.set(e,r)}class ZE{constructor(){this.activeTargetIds=v1()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class RN{constructor(){this.Fo=new ZE,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new ZE,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS="ConnectivityMonitor";class tS{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ce(eS,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ce(eS,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bd=null;function Qp(){return Bd===null?Bd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bd++,"0x"+Bd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp="RestConnection",PN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CN{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${a}`,this.Ko=this.databaseId.database===dh?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Wo(e,t,r,a,l){const c=Qp(),d=this.Go(e,t.toUriEncodedString());Ce(wp,`Sending RPC '${e}' ${c}:`,d,r);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,a,l);const{host:m}=new URL(d),g=io(m);return this.jo(e,d,h,r,g).then((_=>(Ce(wp,`Received RPC '${e}' ${c}: `,_),_)),(_=>{throw Ja(wp,`RPC '${e}' ${c} failed with error: `,_,"url: ",d,"request:",r),_}))}Jo(e,t,r,a,l,c){return this.Wo(e,t,r,a,l)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+vl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),r&&r.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const r=PN[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="WebChannelConnection";class ON extends CN{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,a,l){const c=Qp();return new Promise(((d,h)=>{const m=new Bw;m.setWithCredentials(!0),m.listenOnce(Fw.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Wd.NO_ERROR:const _=m.getResponseJson();Ce(Vn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(_)),d(_);break;case Wd.TIMEOUT:Ce(Vn,`RPC '${e}' ${c} timed out`),h(new Re(ce.DEADLINE_EXCEEDED,"Request time out"));break;case Wd.HTTP_ERROR:const v=m.getStatus();if(Ce(Vn,`RPC '${e}' ${c} failed with status:`,v,"response text:",m.getResponseText()),v>0){let T=m.getResponseJson();Array.isArray(T)&&(T=T[0]);const I=T==null?void 0:T.error;if(I&&I.status&&I.message){const A=(function(L){const x=L.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(x)>=0?x:ce.UNKNOWN})(I.status);h(new Re(A,I.message))}else h(new Re(ce.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new Re(ce.UNAVAILABLE,"Connection failed."));break;default:He(9055,{c_:e,streamId:c,l_:m.getLastErrorCode(),h_:m.getLastError()})}}finally{Ce(Vn,`RPC '${e}' ${c} completed.`)}}));const g=JSON.stringify(a);Ce(Vn,`RPC '${e}' ${c} sending request:`,a),m.send(t,"POST",g,r,15)}))}P_(e,t,r){const a=Qp(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=$w(),d=Hw(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=l.join("");Ce(Vn,`Creating RPC '${e}' stream ${a}: ${g}`,h);const _=c.createWebChannel(g,h);this.T_(_);let v=!1,T=!1;const I=new NN({Ho:C=>{T?Ce(Vn,`Not sending because RPC '${e}' stream ${a} is closed:`,C):(v||(Ce(Vn,`Opening RPC '${e}' stream ${a} transport.`),_.open(),v=!0),Ce(Vn,`RPC '${e}' stream ${a} sending:`,C),_.send(C))},Yo:()=>_.close()}),A=(C,L,x)=>{C.listen(L,(U=>{try{x(U)}catch(z){setTimeout((()=>{throw z}),0)}}))};return A(_,Pc.EventType.OPEN,(()=>{T||(Ce(Vn,`RPC '${e}' stream ${a} transport opened.`),I.s_())})),A(_,Pc.EventType.CLOSE,(()=>{T||(T=!0,Ce(Vn,`RPC '${e}' stream ${a} transport closed`),I.__(),this.I_(_))})),A(_,Pc.EventType.ERROR,(C=>{T||(T=!0,Ja(Vn,`RPC '${e}' stream ${a} transport errored. Name:`,C.name,"Message:",C.message),I.__(new Re(ce.UNAVAILABLE,"The operation could not be completed")))})),A(_,Pc.EventType.MESSAGE,(C=>{var L;if(!T){const x=C.data[0];Ct(!!x,16349);const U=x,z=(U==null?void 0:U.error)||((L=U[0])===null||L===void 0?void 0:L.error);if(z){Ce(Vn,`RPC '${e}' stream ${a} received error:`,z);const $=z.status;let se=(function(N){const M=mn[N];if(M!==void 0)return Pb(M)})($),D=z.message;se===void 0&&(se=ce.INTERNAL,D="Unknown error status: "+$+" with message "+z.message),T=!0,I.__(new Re(se,D)),_.close()}else Ce(Vn,`RPC '${e}' stream ${a} received:`,x),I.a_(x)}})),A(d,Gw.STAT_EVENT,(C=>{C.stat===Vp.PROXY?Ce(Vn,`RPC '${e}' stream ${a} detected buffering proxy`):C.stat===Vp.NOPROXY&&Ce(Vn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{I.o_()}),0),I}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function bp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(n){return new L1(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-r);a>0&&Ce("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="PersistentStream";class Hb{constructor(e,t,r,a,l,c,d,h){this.Fi=e,this.w_=r,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Gb(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(ss(t.toString()),ss("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.b_===t&&this.W_(r,a)}),(r=>{e((()=>{const a=new Re(ce.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(a)}))}))}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.e_((()=>{r((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{r((()=>this.G_(a)))})),this.stream.onMessage((a=>{r((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Ce(nS,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Ce(nS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xN extends Hb{constructor(e,t,r,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=j1(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Qe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Qe.min():c.readTime?yr(c.readTime):Qe.min()})(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=Kp(this.serializer),t.addTarget=(function(l,c){let d;const h=c.target;if(d=Gp(h)?{documents:F1(l,h)}:{query:G1(l,h).Vt},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=Ob(l,c.resumeToken);const m=$p(l,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(Qe.min())>0){d.readTime=gh(l,c.snapshotVersion.toTimestamp());const m=$p(l,c.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const r=$1(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=Kp(this.serializer),t.removeTarget=e,this.k_(t)}}class DN extends Hb{constructor(e,t,r,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=B1(e.writeResults,e.commitTime),r=yr(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=Kp(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>z1(this.serializer,r)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{}class MN extends kN{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Re(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,qp(t,r),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Re(ce.UNKNOWN,l.toString())}))}Jo(e,t,r,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Jo(e,qp(t,r),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Re(ce.UNKNOWN,c.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class LN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ss(t),this._a=!1):Ce("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za="RemoteStore";class UN{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((c=>{r.enqueueAndForget((async()=>{ao(this)&&(Ce(Za,"Restarting streams for network reachability change."),await(async function(h){const m=Je(h);m.Ia.add(4),await au(m),m.Aa.set("Unknown"),m.Ia.delete(4),await Qh(m)})(this))}))})),this.Aa=new LN(r,a)}}async function Qh(n){if(ao(n))for(const e of n.da)await e(!0)}async function au(n){for(const e of n.da)await e(!1)}function $b(n,e){const t=Je(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Fg(t)?Bg(t):wl(t).x_()&&zg(t,e))}function jg(n,e){const t=Je(n),r=wl(t);t.Ta.delete(e),r.x_()&&qb(t,e),t.Ta.size===0&&(r.x_()?r.B_():ao(t)&&t.Aa.set("Unknown"))}function zg(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}wl(n).H_(e)}function qb(n,e){n.Ra.$e(e),wl(n).Y_(e)}function Bg(n){n.Ra=new x1({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),wl(n).start(),n.Aa.aa()}function Fg(n){return ao(n)&&!wl(n).M_()&&n.Ta.size>0}function ao(n){return Je(n).Ia.size===0}function Yb(n){n.Ra=void 0}async function VN(n){n.Aa.set("Online")}async function jN(n){n.Ta.forEach(((e,t)=>{zg(n,e)}))}async function zN(n,e){Yb(n),Fg(n)?(n.Aa.la(e),Bg(n)):n.Aa.set("Unknown")}async function BN(n,e,t){if(n.Aa.set("Online"),e instanceof Nb&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ta.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ta.delete(d),a.Ra.removeTarget(d))})(n,e)}catch(r){Ce(Za,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _h(n,r)}else if(e instanceof Zd?n.Ra.Ye(e):e instanceof Cb?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Qe.min()))try{const r=await Fb(n.localStore);t.compareTo(r)>=0&&await(function(l,c){const d=l.Ra.Pt(c);return d.targetChanges.forEach(((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const g=l.Ta.get(m);g&&l.Ta.set(m,g.withResumeToken(h.resumeToken,c))}})),d.targetMismatches.forEach(((h,m)=>{const g=l.Ta.get(h);if(!g)return;l.Ta.set(h,g.withResumeToken(Mn.EMPTY_BYTE_STRING,g.snapshotVersion)),qb(l,h);const _=new Js(g.target,h,m,g.sequenceNumber);zg(l,_)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){Ce(Za,"Failed to raise snapshot:",r),await _h(n,r)}}async function _h(n,e,t){if(!Sl(e))throw e;n.Ia.add(1),await au(n),n.Aa.set("Offline"),t||(t=()=>Fb(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ce(Za,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Qh(n)}))}function Kb(n,e){return e().catch((t=>_h(n,t,e)))}async function Xh(n){const e=Je(n),t=ca(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Ag;for(;FN(e);)try{const a=await bN(e.localStore,r);if(a===null){e.Pa.length===0&&t.B_();break}r=a.batchId,GN(e,a)}catch(a){await _h(e,a)}Wb(e)&&Qb(e)}function FN(n){return ao(n)&&n.Pa.length<10}function GN(n,e){n.Pa.push(e);const t=ca(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Wb(n){return ao(n)&&!ca(n).M_()&&n.Pa.length>0}function Qb(n){ca(n).start()}async function HN(n){ca(n).na()}async function $N(n){const e=ca(n);for(const t of n.Pa)e.X_(t.mutations)}async function qN(n,e,t){const r=n.Pa.shift(),a=xg.from(r,e,t);await Kb(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await Xh(n)}async function YN(n,e){e&&ca(n).Z_&&await(async function(r,a){if((function(c){return N1(c)&&c!==ce.ABORTED})(a.code)){const l=r.Pa.shift();ca(r).N_(),await Kb(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Xh(r)}})(n,e),Wb(n)&&Qb(n)}async function iS(n,e){const t=Je(n);t.asyncQueue.verifyOperationInProgress(),Ce(Za,"RemoteStore received new credentials");const r=ao(t);t.Ia.add(3),await au(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Qh(t)}async function KN(n,e){const t=Je(n);e?(t.Ia.delete(2),await Qh(t)):e||(t.Ia.add(2),await au(t),t.Aa.set("Unknown"))}function wl(n){return n.Va||(n.Va=(function(t,r,a){const l=Je(t);return l.ia(),new xN(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:VN.bind(null,n),e_:jN.bind(null,n),n_:zN.bind(null,n),J_:BN.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Fg(n)?Bg(n):n.Aa.set("Unknown")):(await n.Va.stop(),Yb(n))}))),n.Va}function ca(n){return n.ma||(n.ma=(function(t,r,a){const l=Je(t);return l.ia(),new DN(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:HN.bind(null,n),n_:YN.bind(null,n),ea:$N.bind(null,n),ta:qN.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await Xh(n)):(await n.ma.stop(),n.Pa.length>0&&(Ce(Za,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const c=Date.now()+r,d=new Gg(e,t,c,a,l);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hg(n,e){if(ss("AsyncQueue",`${e}: ${n}`),Sl(n))return new Re(ce.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{static emptySet(e){return new sl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Me.comparator(t.key,r.key):(t,r)=>Me.comparator(t.key,r.key),this.keyedMap=Cc(),this.sortedSet=new Qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof sl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new sl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(){this.fa=new Qt(Me.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):He(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,r)=>{e.push(r)})),e}}class pl{constructor(e,t,r,a,l,c,d,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,a,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new pl(e,t,sl.emptySet(t),c,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class QN{constructor(){this.queries=sS(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const a=Je(t),l=a.queries;a.queries=sS(),l.forEach(((c,d)=>{for(const h of d.wa)h.onError(r)}))})(this,new Re(ce.ABORTED,"Firestore shutting down"))}}function sS(){return new so((n=>fb(n)),Hh)}async function Xb(n,e){const t=Je(n);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(r=2):(l=new WN,r=e.ba()?0:1);try{switch(r){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const d=Hg(c,`Initialization of query '${Xo(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&$g(t)}async function Jb(n,e){const t=Je(n),r=e.query;let a=3;const l=t.queries.get(r);if(l){const c=l.wa.indexOf(e);c>=0&&(l.wa.splice(c,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function XN(n,e){const t=Je(n);let r=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const d of c.wa)d.Ca(a)&&(r=!0);c.ya=a}}r&&$g(t)}function JN(n,e,t){const r=Je(n),a=r.queries.get(e);if(a)for(const l of a.wa)l.onError(t);r.queries.delete(e)}function $g(n){n.Da.forEach((e=>{e.next()}))}var Xp,aS;(aS=Xp||(Xp={})).Fa="default",aS.Cache="cache";class Zb{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new pl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=pl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Xp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e){this.key=e}}class tT{constructor(e){this.key=e}}class ZN{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=mt(),this.mutatedKeys=mt(),this.Xa=mb(e),this.eu=new sl(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new rS,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,d=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((g,_)=>{const v=a.get(g),T=$h(this.query,_)?_:null,I=!!v&&this.mutatedKeys.has(v.key),A=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let C=!1;v&&T?v.data.isEqual(T.data)?I!==A&&(r.track({type:3,doc:T}),C=!0):this.iu(v,T)||(r.track({type:2,doc:T}),C=!0,(h&&this.Xa(T,h)>0||m&&this.Xa(T,m)<0)&&(d=!0)):!v&&T?(r.track({type:0,doc:T}),C=!0):v&&!T&&(r.track({type:1,doc:v}),C=!0,(h||m)&&(d=!0)),C&&(T?(c=c.add(T),l=A?l.add(g):l.delete(g)):(c=c.delete(g),l=l.delete(g)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),l=l.delete(g.key),r.track({type:1,doc:g})}return{eu:c,ru:r,Ds:d,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const c=e.ru.pa();c.sort(((g,_)=>(function(T,I){const A=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return He(20277,{At:C})}};return A(T)-A(I)})(g.type,_.type)||this.Xa(g.doc,_.doc))),this.su(r),a=a!=null&&a;const d=t&&!a?this.ou():[],h=this.Za.size===0&&this.current&&!a?1:0,m=h!==this.Ya;return this.Ya=h,c.length!==0||m?{snapshot:new pl(this.query,e.eu,l,c,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:d}:{_u:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new rS,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=mt(),this.eu.forEach((r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))}));const t=[];return e.forEach((r=>{this.Za.has(r)||t.push(new tT(r))})),this.Za.forEach((r=>{e.has(r)||t.push(new eT(r))})),t}uu(e){this.Ha=e.qs,this.Za=mt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return pl.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const qg="SyncEngine";class eO{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class tO{constructor(e){this.key=e,this.lu=!1}}class nO{constructor(e,t,r,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new so((d=>fb(d)),Hh),this.Tu=new Map,this.Iu=new Set,this.du=new Qt(Me.comparator),this.Eu=new Map,this.Au=new Mg,this.Ru={},this.Vu=new Map,this.mu=ml.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function iO(n,e,t=!0){const r=oT(n);let a;const l=r.Pu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await nT(r,e,t,!0),a}async function rO(n,e){const t=oT(n);await nT(t,e,!0,!1)}async function nT(n,e,t,r){const a=await TN(n.localStore,gr(e)),l=a.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let d;return r&&(d=await sO(n,e,l,c==="current",a.resumeToken)),n.isPrimaryClient&&t&&$b(n.remoteStore,a),d}async function sO(n,e,t,r,a){n.gu=(_,v,T)=>(async function(A,C,L,x){let U=C.view.nu(L);U.Ds&&(U=await JE(A.localStore,C.query,!1).then((({documents:D})=>C.view.nu(D,U))));const z=x&&x.targetChanges.get(C.targetId),$=x&&x.targetMismatches.get(C.targetId)!=null,se=C.view.applyChanges(U,A.isPrimaryClient,z,$);return lS(A,C.targetId,se._u),se.snapshot})(n,_,v,T);const l=await JE(n.localStore,e,!0),c=new ZN(e,l.qs),d=c.nu(l.documents),h=su.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",a),m=c.applyChanges(d,n.isPrimaryClient,h);lS(n,t,m._u);const g=new eO(e,t,c);return n.Pu.set(e,g),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),m.snapshot}async function aO(n,e,t){const r=Je(n),a=r.Pu.get(e),l=r.Tu.get(a.targetId);if(l.length>1)return r.Tu.set(a.targetId,l.filter((c=>!Hh(c,e)))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Wp(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&jg(r.remoteStore,a.targetId),Jp(r,a.targetId)})).catch(El)):(Jp(r,a.targetId),await Wp(r.localStore,a.targetId,!0))}async function oO(n,e){const t=Je(n),r=t.Pu.get(e),a=t.Tu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),jg(t.remoteStore,r.targetId))}async function lO(n,e,t){const r=pO(n);try{const a=await(function(c,d){const h=Je(c),m=Dt.now(),g=d.reduce(((T,I)=>T.add(I.key)),mt());let _,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let I=as(),A=mt();return h.Os.getEntries(T,g).next((C=>{I=C,I.forEach(((L,x)=>{x.isValidDocument()||(A=A.add(L))}))})).next((()=>h.localDocuments.getOverlayedDocuments(T,I))).next((C=>{_=C;const L=[];for(const x of d){const U=A1(x,_.get(x.key).overlayedDocument);U!=null&&L.push(new ga(x.key,U,sb(U.value.mapValue),Qi.exists(!0)))}return h.mutationQueue.addMutationBatch(T,m,L,d)})).next((C=>{v=C;const L=C.applyToLocalDocumentSet(_,A);return h.documentOverlayCache.saveOverlays(T,C.batchId,L)}))})).then((()=>({batchId:v.batchId,changes:gb(_)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(c,d,h){let m=c.Ru[c.currentUser.toKey()];m||(m=new Qt(lt)),m=m.insert(d,h),c.Ru[c.currentUser.toKey()]=m})(r,a.batchId,t),await ou(r,a.changes),await Xh(r.remoteStore)}catch(a){const l=Hg(a,"Failed to persist write");t.reject(l)}}async function iT(n,e){const t=Je(n);try{const r=await SN(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Eu.get(l);c&&(Ct(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.lu=!0:a.modifiedDocuments.size>0?Ct(c.lu,14607):a.removedDocuments.size>0&&(Ct(c.lu,42227),c.lu=!1))})),await ou(t,r,e)}catch(r){await El(r)}}function oS(n,e,t){const r=Je(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Pu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const h=Je(c);h.onlineState=d;let m=!1;h.queries.forEach(((g,_)=>{for(const v of _.wa)v.va(d)&&(m=!0)})),m&&$g(h)})(r.eventManager,e),a.length&&r.hu.J_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function cO(n,e,t){const r=Je(n);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Eu.get(e),l=a&&a.key;if(l){let c=new Qt(Me.comparator);c=c.insert(l,jn.newNoDocument(l,Qe.min()));const d=mt().add(l),h=new Kh(Qe.min(),new Map,new Qt(lt),c,d);await iT(r,h),r.du=r.du.remove(l),r.Eu.delete(e),Yg(r)}else await Wp(r.localStore,e,!1).then((()=>Jp(r,e,t))).catch(El)}async function uO(n,e){const t=Je(n),r=e.batch.batchId;try{const a=await EN(t.localStore,e);sT(t,r,null),rT(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ou(t,a)}catch(a){await El(a)}}async function dO(n,e,t){const r=Je(n);try{const a=await(function(c,d){const h=Je(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let g;return h.mutationQueue.lookupMutationBatch(m,d).next((_=>(Ct(_!==null,37113),g=_.keys(),h.mutationQueue.removeMutationBatch(m,_)))).next((()=>h.mutationQueue.performConsistencyCheck(m))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(m,g,d))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g))).next((()=>h.localDocuments.getDocuments(m,g)))}))})(r.localStore,e);sT(r,e,t),rT(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ou(r,a)}catch(a){await El(a)}}function rT(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function sT(n,e,t){const r=Je(n);let a=r.Ru[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.Ru[r.currentUser.toKey()]=a}}function Jp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((r=>{n.Au.containsKey(r)||aT(n,r)}))}function aT(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(jg(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Yg(n))}function lS(n,e,t){for(const r of t)r instanceof eT?(n.Au.addReference(r.key,e),hO(n,r)):r instanceof tT?(Ce(qg,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||aT(n,r.key)):He(19791,{yu:r})}function hO(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(Ce(qg,"New document in limbo: "+t),n.Iu.add(r),Yg(n))}function Yg(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Me(Bt.fromString(e)),r=n.mu.next();n.Eu.set(r,new tO(t)),n.du=n.du.insert(t,r),$b(n.remoteStore,new Js(gr(Ng(t.path)),r,"TargetPurposeLimboResolution",Bh.ue))}}async function ou(n,e,t){const r=Je(n),a=[],l=[],c=[];r.Pu.isEmpty()||(r.Pu.forEach(((d,h)=>{c.push(r.gu(h,e,t).then((m=>{var g;if((m||t)&&r.isPrimaryClient){const _=m?!m.fromCache:(g=t==null?void 0:t.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(m){a.push(m);const _=Ug.Es(h.targetId,m);l.push(_)}})))})),await Promise.all(c),r.hu.J_(a),await(async function(h,m){const g=Je(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>fe.forEach(m,(v=>fe.forEach(v.Is,(T=>g.persistence.referenceDelegate.addReference(_,v.targetId,T))).next((()=>fe.forEach(v.ds,(T=>g.persistence.referenceDelegate.removeReference(_,v.targetId,T)))))))))}catch(_){if(!Sl(_))throw _;Ce(Vg,"Failed to update sequence numbers: "+_)}for(const _ of m){const v=_.targetId;if(!_.fromCache){const T=g.Fs.get(v),I=T.snapshotVersion,A=T.withLastLimboFreeSnapshotVersion(I);g.Fs=g.Fs.insert(v,A)}}})(r.localStore,l))}async function fO(n,e){const t=Je(n);if(!t.currentUser.isEqual(e)){Ce(qg,"User change. New user:",e.toKey());const r=await Bb(t.localStore,e);t.currentUser=e,(function(l,c){l.Vu.forEach((d=>{d.forEach((h=>{h.reject(new Re(ce.CANCELLED,c))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ou(t,r.Bs)}}function mO(n,e){const t=Je(n),r=t.Eu.get(e);if(r&&r.lu)return mt().add(r.key);{let a=mt();const l=t.Tu.get(e);if(!l)return a;for(const c of l){const d=t.Pu.get(c);a=a.unionWith(d.view.tu)}return a}}function oT(n){const e=Je(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=iT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cO.bind(null,e),e.hu.J_=XN.bind(null,e.eventManager),e.hu.pu=JN.bind(null,e.eventManager),e}function pO(n){const e=Je(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=uO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dO.bind(null,e),e}class vh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return vN(this.persistence,new gN,e.initialUser,this.serializer)}Du(e){return new zb(Lg.Vi,this.serializer)}bu(e){return new RN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vh.provider={build:()=>new vh};class gO extends vh{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Ct(this.persistence.referenceDelegate instanceof yh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new tN(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?ti.withCacheSize(this.cacheSizeBytes):ti.DEFAULT;return new zb((r=>yh.Vi(r,t)),this.serializer)}}class Zp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>oS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fO.bind(null,this.syncEngine),await KN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new QN})()}createDatastore(e){const t=Wh(e.databaseInfo.databaseId),r=(function(l){return new ON(l)})(e.databaseInfo);return(function(l,c,d,h){return new MN(l,c,d,h)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,l,c,d){return new UN(r,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>oS(this.syncEngine,t,0)),(function(){return tS.C()?new tS:new IN})())}createSyncEngine(e,t){return(function(a,l,c,d,h,m,g){const _=new nO(a,l,c,d,h,m);return g&&(_.fu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Je(a);Ce(Za,"RemoteStore shutting down."),l.Ia.add(5),await au(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Zp.provider={build:()=>new Zp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ss("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="FirestoreClient";class yO{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=ei.UNAUTHENTICATED,this.clientId=Tg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async c=>{Ce(ua,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(Ce(ua,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Hg(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Tp(n,e){n.asyncQueue.verifyOperationInProgress(),Ce(ua,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async a=>{r.isEqual(a)||(await Bb(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>{Ja("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Ce("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Ja("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function cS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await _O(n);Ce(ua,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>iS(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,a)=>iS(e.remoteStore,a))),n._onlineComponents=e}async function _O(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ce(ua,"Using user provided OfflineComponentProvider");try{await Tp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ce.FAILED_PRECONDITION||a.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Ja("Error using user provided cache. Falling back to memory cache: "+t),await Tp(n,new vh)}}else Ce(ua,"Using default OfflineComponentProvider"),await Tp(n,new gO(void 0));return n._offlineComponents}async function cT(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ce(ua,"Using user provided OnlineComponentProvider"),await cS(n,n._uninitializedComponentsProvider._online)):(Ce(ua,"Using default OnlineComponentProvider"),await cS(n,new Zp))),n._onlineComponents}function vO(n){return cT(n).then((e=>e.syncEngine))}async function uT(n){const e=await cT(n),t=e.eventManager;return t.onListen=iO.bind(null,e.syncEngine),t.onUnlisten=aO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=oO.bind(null,e.syncEngine),t}function dT(n,e,t={}){const r=new is;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,h,m){const g=new lT({next:v=>{g.Ou(),c.enqueueAndForget((()=>Jb(l,_)));const T=v.docs.has(d);!T&&v.fromCache?m.reject(new Re(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&v.fromCache&&h&&h.source==="server"?m.reject(new Re(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(v)},error:v=>m.reject(v)}),_=new Zb(Ng(d.path),g,{includeMetadataChanges:!0,ka:!0});return Xb(l,_)})(await uT(n),n.asyncQueue,e,t,r))),r.promise}function EO(n,e,t={}){const r=new is;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,h,m){const g=new lT({next:v=>{g.Ou(),c.enqueueAndForget((()=>Jb(l,_))),v.fromCache&&h.source==="server"?m.reject(new Re(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(v)},error:v=>m.reject(v)}),_=new Zb(d,g,{includeMetadataChanges:!0,ka:!0});return Xb(l,_)})(await uT(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO="firestore.googleapis.com",dS=!0;class hS{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Re(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=SO,this.ssl=dS}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:dS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Vb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jb)throw new Re(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kg{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new xC;switch(r.type){case"firstParty":return new MC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Re(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=uS.get(t);r&&(Ce("ComponentProvider","Removing Datastore"),uS.delete(t),r.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oo(this.firestore,e,this._query)}}class tn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new na(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new tn(this.firestore,e,this._key)}toJSON(){return{type:tn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(nu(t,tn._jsonSchema))return new tn(e,r||null,new Me(Bt.fromString(t.referencePath)))}}tn._jsonSchemaVersion="firestore/documentReference/1.0",tn._jsonSchema={type:gn("string",tn._jsonSchemaVersion),referencePath:gn("string")};class na extends oo{constructor(e,t,r){super(e,t,Ng(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new tn(this.firestore,null,new Me(e))}withConverter(e){return new na(this.firestore,e,this._path)}}function Wg(n,e,...t){if(n=nn(n),Kw("collection","path",e),n instanceof Kg){const r=Bt.fromString(e,...t);return AE(r),new na(n,null,r)}{if(!(n instanceof tn||n instanceof na))throw new Re(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Bt.fromString(e,...t));return AE(r),new na(n.firestore,null,r)}}function At(n,e,...t){if(n=nn(n),arguments.length===1&&(e=Tg.newId()),Kw("doc","path",e),n instanceof Kg){const r=Bt.fromString(e,...t);return TE(r),new tn(n,null,new Me(r))}{if(!(n instanceof tn||n instanceof na))throw new Re(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Bt.fromString(e,...t));return TE(r),new tn(n.firestore,n instanceof na?n.converter:null,new Me(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS="AsyncQueue";class mS{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Gb(this,"async_queue_retry"),this.oc=()=>{const r=bp();r&&Ce(fS,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=bp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=bp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new is;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Sl(e))throw e;Ce(fS,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((r=>{throw this.tc=r,this.nc=!1,ss("INTERNAL UNHANDLED ERROR: ",pS(r)),r})).then((r=>(this.nc=!1,r))))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=Gg.createAndSchedule(this,e,t,r,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&He(47125,{hc:pS(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function pS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class lo extends Kg{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new mS,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mS(e),this._firestoreClient=void 0,await e}}}function gS(n,e,t){t||(t=dh);const r=ma(n,"firestore");if(r.isInitialized(t)){const a=r.getImmediate({identifier:t}),l=r.getOptions(t);if(ra(l,e))return a;throw new Re(ce.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Re(ce.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jb)throw new Re(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&io(e.host)&&Eg(e.host),r.initialize({options:e,instanceIdentifier:t})}function Jh(n){if(n._terminated)throw new Re(ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||wO(n),n._firestoreClient}function wO(n){var e,t,r;const a=n._freezeSettings(),l=(function(d,h,m,g){return new XC(d,h,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,hT(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new yO(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Li(Mn.fromBase64String(e))}catch(t){throw new Re(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Li(Mn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Li._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(nu(e,Li._jsonSchema))return Li.fromBase64String(e.bytes)}}Li._jsonSchemaVersion="firestore/bytes/1.0",Li._jsonSchema={type:gn("string",Li._jsonSchemaVersion),bytes:gn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Re(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return lt(this._lat,e._lat)||lt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:_r._jsonSchemaVersion}}static fromJSON(e){if(nu(e,_r._jsonSchema))return new _r(e.latitude,e.longitude)}}_r._jsonSchemaVersion="firestore/geoPoint/1.0",_r._jsonSchema={type:gn("string",_r._jsonSchemaVersion),latitude:gn("number"),longitude:gn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:vr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(nu(e,vr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new vr(e.vectorValues);throw new Re(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}vr._jsonSchemaVersion="firestore/vectorValue/1.0",vr._jsonSchema={type:gn("string",vr._jsonSchemaVersion),vectorValues:gn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO=/^__.*__$/;class TO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ga(e,this.data,this.fieldMask,t,this.fieldTransforms):new ru(e,this.data,t,this.fieldTransforms)}}class fT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ga(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function mT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw He(40011,{Ec:n})}}class Qg{constructor(e,t,r,a,l,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Qg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:r,mc:!1});return a.fc(e),a}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:r,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Eh(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(mT(this.Ec)&&bO.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class AO{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Wh(e)}Dc(e,t,r,a=!1){return new Qg({Ec:e,methodName:t,bc:r,path:kn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ef(n){const e=n._freezeSettings(),t=Wh(n._databaseId);return new AO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function pT(n,e,t,r,a,l={}){const c=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Zg("Data must be an object, but it was:",c,r);const d=gT(r,c);let h,m;if(l.merge)h=new yi(c.fieldMask),m=c.fieldTransforms;else if(l.mergeFields){const g=[];for(const _ of l.mergeFields){const v=eg(e,_,t);if(!c.contains(v))throw new Re(ce.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);_T(g,v)||g.push(v)}h=new yi(g),m=c.fieldTransforms.filter((_=>h.covers(_.field)))}else h=null,m=c.fieldTransforms;return new TO(new ni(d),h,m)}class tf extends lu{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof tf}}class Xg extends lu{_toFieldTransform(e){return new Tb(e.path,new Yc)}isEqual(e){return e instanceof Xg}}class Jg extends lu{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){const t=new Qc(e.serializer,vb(e.serializer,this.Cc));return new Tb(e.path,t)}isEqual(e){return e instanceof Jg&&this.Cc===e.Cc}}function RO(n,e,t,r){const a=n.Dc(1,e,t);Zg("Data must be an object, but it was:",a,r);const l=[],c=ni.empty();pa(r,((h,m)=>{const g=ey(e,h,t);m=nn(m);const _=a.gc(g);if(m instanceof tf)l.push(g);else{const v=cu(m,_);v!=null&&(l.push(g),c.set(g,v))}}));const d=new yi(l);return new fT(c,d,a.fieldTransforms)}function IO(n,e,t,r,a,l){const c=n.Dc(1,e,t),d=[eg(e,r,t)],h=[a];if(l.length%2!=0)throw new Re(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<l.length;v+=2)d.push(eg(e,l[v])),h.push(l[v+1]);const m=[],g=ni.empty();for(let v=d.length-1;v>=0;--v)if(!_T(m,d[v])){const T=d[v];let I=h[v];I=nn(I);const A=c.gc(T);if(I instanceof tf)m.push(T);else{const C=cu(I,A);C!=null&&(m.push(T),g.set(T,C))}}const _=new yi(m);return new fT(g,_,c.fieldTransforms)}function PO(n,e,t,r=!1){return cu(t,n.Dc(r?4:3,e))}function cu(n,e){if(yT(n=nn(n)))return Zg("Unsupported field value:",e,n),gT(n,e);if(n instanceof lu)return(function(r,a){if(!mT(a.Ec))throw a.wc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,a){const l=[];let c=0;for(const d of r){let h=cu(d,a.yc(c));h==null&&(h={nullValue:"NULL_VALUE"}),l.push(h),c++}return{arrayValue:{values:l}}})(n,e)}return(function(r,a){if((r=nn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vb(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=Dt.fromDate(r);return{timestampValue:gh(a.serializer,l)}}if(r instanceof Dt){const l=new Dt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:gh(a.serializer,l)}}if(r instanceof _r)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Li)return{bytesValue:Ob(a.serializer,r._byteString)};if(r instanceof tn){const l=a.databaseId,c=r.firestore._databaseId;if(!c.isEqual(l))throw a.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:kg(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof vr)return(function(c,d){return{mapValue:{fields:{[ib]:{stringValue:rb},[hh]:{arrayValue:{values:c.toArray().map((m=>{if(typeof m!="number")throw d.wc("VectorValues must only contain numeric values.");return Og(d.serializer,m)}))}}}}}})(r,a);throw a.wc(`Unsupported field value: ${zh(r)}`)})(n,e)}function gT(n,e){const t={};return Xw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pa(n,((r,a)=>{const l=cu(a,e.Vc(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function yT(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Dt||n instanceof _r||n instanceof Li||n instanceof tn||n instanceof lu||n instanceof vr)}function Zg(n,e,t){if(!yT(t)||!Ww(t)){const r=zh(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function eg(n,e,t){if((e=nn(e))instanceof Zh)return e._internalPath;if(typeof e=="string")return ey(n,e);throw Eh("Field path arguments must be of type string or ",n,!1,void 0,t)}const CO=new RegExp("[~\\*/\\[\\]]");function ey(n,e,t){if(e.search(CO)>=0)throw Eh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Zh(...e.split("."))._internalPath}catch{throw Eh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Eh(n,e,t,r,a){const l=r&&!r.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(l||c)&&(h+=" (found",l&&(h+=` in field ${r}`),c&&(h+=` in document ${a}`),h+=")"),new Re(ce.INVALID_ARGUMENT,d+n+h)}function _T(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new NO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ET("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class NO extends vT{data(){return super.data()}}function ET(n,e){return typeof e=="string"?ey(n,e):e instanceof Zh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Re(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ty{}class ST extends ty{}function xO(n,e,...t){let r=[];e instanceof ty&&r.push(e),r=r.concat(t),(function(l){const c=l.filter((h=>h instanceof iy)).length,d=l.filter((h=>h instanceof ny)).length;if(c>1||c>0&&d>0)throw new Re(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)n=a._apply(n);return n}class ny extends ST{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ny(e,t,r)}_apply(e){const t=this._parse(e);return wT(e._query,t),new oo(e.firestore,e.converter,Hp(e._query,t))}_parse(e){const t=ef(e.firestore);return(function(l,c,d,h,m,g,_){let v;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new Re(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){_S(_,g);const I=[];for(const A of _)I.push(yS(h,l,A));v={arrayValue:{values:I}}}else v=yS(h,l,_)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||_S(_,g),v=PO(d,c,_,g==="in"||g==="not-in");return pn.create(m,g,v)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class iy extends ty{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new iy(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Zi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const h of d)wT(c,h),c=Hp(c,h)})(e._query,t),new oo(e.firestore,e.converter,Hp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ry extends ST{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new ry(e,t,r)}_apply(e){return new oo(e.firestore,e.converter,ph(e._query,this._limit,this._limitType))}}function DO(n){return ry._create("limit",n,"F")}function yS(n,e,t){if(typeof(t=nn(t))=="string"){if(t==="")throw new Re(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hb(e)&&t.indexOf("/")!==-1)throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Bt.fromString(t));if(!Me.isDocumentKey(r))throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return DE(n,new Me(r))}if(t instanceof tn)return DE(n,t._key);throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zh(t)}.`)}function _S(n,e){if(!Array.isArray(n)||n.length===0)throw new Re(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wT(n,e){const t=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Re(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class kO{convertValue(e,t="none"){switch(la(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(oa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw He(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return pa(e,((a,l)=>{r[a]=this.convertValue(l,t)})),r}convertVectorValue(e){var t,r,a;const l=(a=(r=(t=e.fields)===null||t===void 0?void 0:t[hh].arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map((c=>ln(c.doubleValue)));return new vr(l)}convertGeoPoint(e){return new _r(ln(e.latitude),ln(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Gh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Hc(e));default:return null}}convertTimestamp(e){const t=aa(e);return new Dt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Bt.fromString(e);Ct(Ub(r),9688,{name:e});const a=new $c(r.get(1),r.get(3)),l=new Me(r.popFirst(5));return a.isEqual(t)||ss(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Oc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qa extends vT{constructor(e,t,r,a,l,c){super(e,t,r,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(ET("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qa._jsonSchema={type:gn("string",Qa._jsonSchemaVersion),bundleSource:gn("string","DocumentSnapshot"),bundleName:gn("string"),bundle:gn("string")};class eh extends Qa{data(e={}){return super.data(e)}}class al{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Oc(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new eh(this._firestore,this._userDataWriter,r.key,r,new Oc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const h=new eh(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Oc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const h=new eh(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Oc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,g=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),g=c.indexOf(d.doc.key)),{type:MO(d.type),doc:h,oldIndex:m,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=al._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function MO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return He(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(n){n=Ji(n,tn);const e=Ji(n.firestore,lo);return dT(Jh(e),n._key).then((t=>RT(e,n,t)))}al._jsonSchemaVersion="firestore/querySnapshot/1.0",al._jsonSchema={type:gn("string",al._jsonSchemaVersion),bundleSource:gn("string","QuerySnapshot"),bundleName:gn("string"),bundle:gn("string")};class TT extends kO{constructor(e){super(),this.firestore=e}convertBytes(e){return new Li(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tn(this.firestore,null,t)}}function LO(n){n=Ji(n,tn);const e=Ji(n.firestore,lo);return dT(Jh(e),n._key,{source:"server"}).then((t=>RT(e,n,t)))}function AT(n){n=Ji(n,oo);const e=Ji(n.firestore,lo),t=Jh(e),r=new TT(e);return OO(n._query),EO(t,n._query).then((a=>new al(e,r,n,a)))}function da(n,e,t){n=Ji(n,tn);const r=Ji(n.firestore,lo),a=bT(n.converter,e,t);return sy(r,[pT(ef(r),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Qi.none())])}function Tc(n,e,t,...r){n=Ji(n,tn);const a=Ji(n.firestore,lo),l=ef(a);let c;return c=typeof(e=nn(e))=="string"||e instanceof Zh?IO(l,"updateDoc",n._key,e,t,r):RO(l,"updateDoc",n._key,e),sy(a,[c.toMutation(n._key,Qi.exists(!0))])}function UO(n,e){const t=Ji(n.firestore,lo),r=At(n),a=bT(n.converter,e);return sy(t,[pT(ef(n.firestore),"addDoc",r._key,a,n.converter!==null,{}).toMutation(r._key,Qi.exists(!1))]).then((()=>r))}function sy(n,e){return(function(r,a){const l=new is;return r.asyncQueue.enqueueAndForget((async()=>lO(await vO(r),a,l))),l.promise})(Jh(n),e)}function RT(n,e,t){const r=t.docs.get(e._key),a=new TT(n);return new Qa(n,a,e._key,r,new Oc(t.hasPendingWrites,t.fromCache),e.converter)}function Xc(){return new Xg("serverTimestamp")}function ki(n){return new Jg("increment",n)}(function(e,t=!0){(function(a){vl=a})(_l),Xi(new Ui("firestore",((r,{instanceIdentifier:a,options:l})=>{const c=r.getProvider("app").getImmediate(),d=new lo(new DC(r.getProvider("auth-internal")),new LC(c,r.getProvider("app-check-internal")),(function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Re(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $c(m.options.projectId,g)})(c,a),c);return l=Object.assign({useFetchStreams:t},l),d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),ri(vE,EE,e),ri(vE,EE,"esm2017")})();var VO="firebase",jO="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ri(VO,jO,"app");function ay(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}function IT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PT=IT,CT=new ro("auth","Firebase",IT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh=new jh("@firebase/auth");function zO(n,...e){Sh.logLevel<=ft.WARN&&Sh.warn(`Auth (${_l}): ${n}`,...e)}function th(n,...e){Sh.logLevel<=ft.ERROR&&Sh.error(`Auth (${_l}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(n,...e){throw oy(n,...e)}function Er(n,...e){return oy(n,...e)}function NT(n,e,t){const r=Object.assign(Object.assign({},PT()),{[e]:t});return new ro("auth","Firebase",r).create(e,{appName:n.name})}function ia(n){return NT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oy(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return CT.create(n,...e)}function Ye(n,e,...t){if(!n)throw oy(e,...t)}function ts(n){const e="INTERNAL ASSERTION FAILED: "+n;throw th(e),new Error(e)}function ls(n,e){n||ts(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function BO(){return vS()==="http:"||vS()==="https:"}function vS(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BO()||Ow()||"connection"in navigator)?navigator.onLine:!0}function GO(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ls(t>e,"Short delay should be less than long delay!"),this.isMobile=aP()||cP()}get(){return FO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(n,e){ls(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ts("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ts("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ts("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qO=new uu(3e4,6e4);function nf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function bl(n,e,t,r,a={}){return xT(n,a,async()=>{let l={},c={};r&&(e==="GET"?c=r:l={body:JSON.stringify(r)});const d=tu(Object.assign({key:n.config.apiKey},c)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:h},l);return lP()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&io(n.emulatorConfig.host)&&(m.credentials="include"),OT.fetch()(await kT(n,n.config.apiHost,t,d),m)})}async function xT(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},HO),e);try{const a=new YO(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Fd(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[h,m]=d.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fd(n,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Fd(n,"email-already-in-use",c);if(h==="USER_DISABLED")throw Fd(n,"user-disabled",c);const g=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw NT(n,g,m);os(n,g)}}catch(a){if(a instanceof Vi)throw a;os(n,"network-request-failed",{message:String(a)})}}async function DT(n,e,t,r,a={}){const l=await bl(n,e,t,r,a);return"mfaPendingCredential"in l&&os(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function kT(n,e,t,r){const a=`${e}${t}?${r}`,l=n,c=l.config.emulator?ly(n.config,a):`${n.config.apiScheme}://${a}`;return $O.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}class YO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Er(this.auth,"network-request-failed")),qO.get())})}}function Fd(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=Er(n,e,r);return a.customData._tokenResponse=t,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KO(n,e){return bl(n,"POST","/v1/accounts:delete",e)}async function wh(n,e){return bl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function MT(n,e=!1){const t=nn(n),r=await t.getIdToken(e),a=cy(r);Ye(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:r,authTime:jc(Ap(a.auth_time)),issuedAtTime:jc(Ap(a.iat)),expirationTime:jc(Ap(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Ap(n){return Number(n)*1e3}function cy(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return th("JWT malformed, contained fewer than 3 sections"),null;try{const a=Rw(t);return a?JSON.parse(a):(th("Failed to decode base64 JWT payload"),null)}catch(a){return th("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function ES(n){const e=cy(n);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Vi&&WO(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function WO({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jc(this.lastLoginAt),this.creationTime=jc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bh(n){var e;const t=n.auth,r=await n.getIdToken(),a=await Jc(n,wh(t,{idToken:r}));Ye(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const c=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?UT(l.providerUserInfo):[],d=XO(n.providerData,c),h=n.isAnonymous,m=!(n.email&&l.passwordHash)&&!(d!=null&&d.length),g=h?m:!1,_={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new ng(l.createdAt,l.lastLoginAt),isAnonymous:g};Object.assign(n,_)}async function LT(n){const e=nn(n);await bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XO(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function UT(n){return n.map(e=>{var{providerId:t}=e,r=ay(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JO(n,e){const t=await xT(n,{},async()=>{const r=tu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,c=await kT(n,a,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:d,body:r};return n.emulatorConfig&&io(n.emulatorConfig.host)&&(h.credentials="include"),OT.fetch()(c,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function ZO(n,e){return bl(n,"POST","/v2/accounts:revokeToken",nf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ES(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const t=ES(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await JO(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,c=new ol;return r&&(Ye(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),a&&(Ye(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Ye(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ol,this.toJSON())}_performRefresh(){return ts("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(n,e){Ye(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Wi{constructor(e){var{uid:t,auth:r,stsTokenManager:a}=e,l=ay(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new QO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new ng(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await Jc(this,this.stsTokenManager.getToken(this.auth,e));return Ye(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return MT(this,e)}reload(){return LT(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Wi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await bh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mi(this.auth.app))return Promise.reject(ia(this.auth));const e=await this.getIdToken();return await Jc(this,KO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,a,l,c,d,h,m,g;const _=(r=t.displayName)!==null&&r!==void 0?r:void 0,v=(a=t.email)!==null&&a!==void 0?a:void 0,T=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,I=(c=t.photoURL)!==null&&c!==void 0?c:void 0,A=(d=t.tenantId)!==null&&d!==void 0?d:void 0,C=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,L=(m=t.createdAt)!==null&&m!==void 0?m:void 0,x=(g=t.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:U,emailVerified:z,isAnonymous:$,providerData:se,stsTokenManager:D}=t;Ye(U&&D,e,"internal-error");const P=ol.fromJSON(this.name,D);Ye(typeof U=="string",e,"internal-error"),Qs(_,e.name),Qs(v,e.name),Ye(typeof z=="boolean",e,"internal-error"),Ye(typeof $=="boolean",e,"internal-error"),Qs(T,e.name),Qs(I,e.name),Qs(A,e.name),Qs(C,e.name),Qs(L,e.name),Qs(x,e.name);const N=new Wi({uid:U,auth:e,email:v,emailVerified:z,displayName:_,isAnonymous:$,photoURL:I,phoneNumber:T,tenantId:A,stsTokenManager:P,createdAt:L,lastLoginAt:x});return se&&Array.isArray(se)&&(N.providerData=se.map(M=>Object.assign({},M))),C&&(N._redirectEventId=C),N}static async _fromIdTokenResponse(e,t,r=!1){const a=new ol;a.updateFromServerResponse(t);const l=new Wi({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await bh(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];Ye(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?UT(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),d=new ol;d.updateFromIdToken(r);const h=new Wi({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new ng(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS=new Map;function ns(n){ls(n instanceof Function,"Expected a class definition");let e=SS.get(n);return e?(ls(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,SS.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}VT.type="NONE";const Th=VT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(n,e,t){return`firebase:${n}:${e}:${t}`}class ll{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=nh(this.userKey,a.apiKey,l),this.fullPersistenceKey=nh("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await wh(this.auth,{idToken:e}).catch(()=>{});return t?Wi._fromGetAccountInfoResponse(this.auth,t,e):null}return Wi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ll(ns(Th),e,r);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||ns(Th);const c=nh(r,e.config.apiKey,e.name);let d=null;for(const m of t)try{const g=await m._get(c);if(g){let _;if(typeof g=="string"){const v=await wh(e,{idToken:g}).catch(()=>{});if(!v)break;_=await Wi._fromGetAccountInfoResponse(e,v,g)}else _=Wi._fromJSON(e,g);m!==l&&(d=_),l=m;break}}catch{}const h=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!h.length?new ll(l,e,r):(l=h[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(c)}catch{}})),new ll(l,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(FT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(HT(e))return"Blackberry";if($T(e))return"Webos";if(zT(e))return"Safari";if((e.includes("chrome/")||BT(e))&&!e.includes("edge/"))return"Chrome";if(GT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function jT(n=zn()){return/firefox\//i.test(n)}function zT(n=zn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function BT(n=zn()){return/crios\//i.test(n)}function FT(n=zn()){return/iemobile/i.test(n)}function GT(n=zn()){return/android/i.test(n)}function HT(n=zn()){return/blackberry/i.test(n)}function $T(n=zn()){return/webos/i.test(n)}function uy(n=zn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ex(n=zn()){var e;return uy(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function tx(){return uP()&&document.documentMode===10}function qT(n=zn()){return uy(n)||GT(n)||$T(n)||HT(n)||/windows phone/i.test(n)||FT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(n,e=[]){let t;switch(n){case"Browser":t=wS(zn());break;case"Worker":t=`${wS(zn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${_l}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((c,d)=>{try{const h=e(l);c(h)}catch(h){d(h)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ix(n,e={}){return bl(n,"GET","/v2/passwordPolicy",nf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx=6;class sx{constructor(e){var t,r,a,l;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:rx,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,a,l,c,d;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(a=h.containsLowercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsUppercaseLetter)!==null&&l!==void 0?l:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(d=h.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bS(this),this.idTokenSubscription=new bS(this),this.beforeStateQueue=new nx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=CT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ns(t)),this._initializationPromise=this.queue(async()=>{var r,a,l;if(!this._deleted&&(this.persistenceManager=await ll.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await wh(this,{idToken:e}),r=await Wi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Mi(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let a=r,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=a==null?void 0:a._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===d)&&(h!=null&&h.user)&&(a=h.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(c){a=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mi(this.app))return Promise.reject(ia(this));const t=e?nn(e):null;return t&&Ye(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mi(this.app)?Promise.reject(ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mi(this.app)?Promise.reject(ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ix(this),t=new sx(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ro("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await ZO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ns(e)||this._popupRedirectResolver;Ye(t,this,"argument-error"),this.redirectPersistenceManager=await ll.create(this,[ns(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,a);return()=>{c=!0,h()}}else{const h=e.addObserver(t);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=YT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Mi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&zO(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function rf(n){return nn(n)}class bS{constructor(e){this.auth=e,this.observer=null,this.addObserver=yP(t=>this.observer=t)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ox(n){dy=n}function lx(n){return dy.loadJS(n)}function cx(){return dy.gapiScript}function ux(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(n,e){const t=ma(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(ra(l,e??{}))return a;os(a,"already-initialized")}return t.initialize({options:e})}function dx(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ns);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function KT(n,e,t){const r=rf(n);Ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,l=WT(e),{host:c,port:d}=hx(e),h=d===null?"":`:${d}`,m={url:`${l}//${c}${h}/`},g=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){Ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ye(ra(m,r.config.emulator)&&ra(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,io(c)?(Eg(`${l}//${c}${h}`),Nw("Auth",!0)):fx()}function WT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function hx(n){const e=WT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:TS(r.substr(l.length+1))}}else{const[l,c]=r.split(":");return{host:l,port:TS(c)}}}function TS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function fx(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ts("not implemented")}_getIdTokenResponse(e){return ts("not implemented")}_linkToIdToken(e,t){return ts("not implemented")}_getReauthenticationResolver(e){return ts("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cl(n,e){return DT(n,"POST","/v1/accounts:signInWithIdp",nf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx="http://localhost";class ha extends hy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ha(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):os("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a}=t,l=ay(t,["providerId","signInMethod"]);if(!r||!a)return null;const c=new ha(r,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return cl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,cl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,cl(e,t)}buildRequest(){const e={requestUri:mx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=tu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends QT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends du{constructor(){super("facebook.com")}static credential(e){return ha._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ha._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Jr.credential(t,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends du{constructor(){super("github.com")}static credential(e){return ha._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.GITHUB_SIGN_IN_METHOD="github.com";Zr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends du{constructor(){super("twitter.com")}static credential(e,t){return ha._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return es.credential(t,r)}catch{return null}}}es.TWITTER_SIGN_IN_METHOD="twitter.com";es.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function px(n,e){return DT(n,"POST","/v1/accounts:signUp",nf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await Wi._fromIdTokenResponse(e,r,a),c=AS(r);return new fa({user:l,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=AS(r);return new fa({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function AS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sf(n){var e;if(Mi(n.app))return Promise.reject(ia(n));const t=rf(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new fa({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await px(t,{returnSecureToken:!0}),a=await fa._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah extends Vi{constructor(e,t,r,a){var l;super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Ah.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new Ah(e,t,r,a)}}function XT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Ah._fromErrorAndOperation(n,l,e,r):l})}async function gx(n,e,t=!1){const r=await Jc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fa._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yx(n,e,t=!1){const{auth:r}=n;if(Mi(r.app))return Promise.reject(ia(r));const a="reauthenticate";try{const l=await Jc(n,XT(r,a,e,n),t);Ye(l.idToken,r,"internal-error");const c=cy(l.idToken);Ye(c,r,"internal-error");const{sub:d}=c;return Ye(n.uid===d,r,"user-mismatch"),fa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&os(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _x(n,e,t=!1){if(Mi(n.app))return Promise.reject(ia(n));const r="signIn",a=await XT(n,r,e),l=await fa._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(l.user),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(n,e){return nn(n).setPersistence(e)}function JT(n,e,t,r){return nn(n).onIdTokenChanged(e,t,r)}function ZT(n,e,t){return nn(n).beforeAuthStateChanged(e,t)}function vx(n,e,t,r){return nn(n).onAuthStateChanged(e,t,r)}const Rh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rh,"1"),this.storage.removeItem(Rh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex=1e3,Sx=10;class tA extends eA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,h)=>{this.notifyListeners(c,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},l=this.storage.getItem(r);tx()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Sx):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Ex)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tA.type="LOCAL";const Ih=tA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA extends eA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nA.type="SESSION";const fy=nA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new af(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const d=Array.from(c).map(async m=>m(t.origin,l)),h=await wx(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}af.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,h)=>{const m=my("",20);a.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:a,onMessage(_){const v=_;if(v.data.eventId===m)switch(v.data.status){case"ack":clearTimeout(g),l=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(v.data.response);break;default:clearTimeout(g),clearTimeout(l),h(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(){return window}function Tx(n){Sr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(){return typeof Sr().WorkerGlobalScope<"u"&&typeof Sr().importScripts=="function"}async function Ax(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Rx(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Ix(){return iA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="firebaseLocalStorageDb",Px=1,Ph="firebaseLocalStorage",sA="fbase_key";class hu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function of(n,e){return n.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function Cx(){const n=indexedDB.deleteDatabase(rA);return new hu(n).toPromise()}function rg(){const n=indexedDB.open(rA,Px);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ph,{keyPath:sA})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ph)?e(r):(r.close(),await Cx(),e(await rg()))})})}async function RS(n,e,t){const r=of(n,!0).put({[sA]:e,value:t});return new hu(r).toPromise()}async function Nx(n,e){const t=of(n,!1).get(e),r=await new hu(t).toPromise();return r===void 0?null:r.value}function IS(n,e){const t=of(n,!0).delete(e);return new hu(t).toPromise()}const Ox=800,xx=3;class aA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>xx)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return iA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=af._getInstance(Ix()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Ax(),!this.activeServiceWorker)return;this.sender=new bx(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Rx()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rg();return await RS(e,Rh,"1"),await IS(e,Rh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>RS(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Nx(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>IS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=of(a,!1).getAll();return new hu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Ox)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aA.type="LOCAL";const Ch=aA;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(n,e){return e?ns(e):(Ye(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py extends hy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return cl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return cl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return cl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function kx(n){return _x(n.auth,new py(n),n.bypassAuthState)}function Mx(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),yx(t,new py(n),n.bypassAuthState)}async function Lx(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),gx(t,new py(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kx;case"linkViaPopup":case"linkViaRedirect":return Lx;case"reauthViaPopup":case"reauthViaRedirect":return Mx;default:os(this.auth,"internal-error")}}resolve(e){ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux=new uu(2e3,1e4);class il extends oA{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,il.currentPopupAction&&il.currentPopupAction.cancel(),il.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){ls(this.filter.length===1,"Popup operations only handle one event");const e=my();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,il.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Ux.get())};e()}}il.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="pendingRedirect",ih=new Map;class jx extends oA{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ih.get(this.auth._key());if(!e){try{const r=await zx(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ih.set(this.auth._key(),e)}return this.bypassAuthState||ih.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function zx(n,e){const t=Gx(e),r=Fx(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}function Bx(n,e){ih.set(n._key(),e)}function Fx(n){return ns(n._redirectPersistence)}function Gx(n){return nh(Vx,n.config.apiKey,n.name)}async function Hx(n,e,t=!1){if(Mi(n.app))return Promise.reject(ia(n));const r=rf(n),a=Dx(r,e),c=await new jx(r,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=600*1e3;class qx{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Yx(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!lA(e)){const a=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Er(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$x&&this.cachedEventUids.clear(),this.cachedEventUids.has(PS(e))}saveEventToCache(e){this.cachedEventUids.add(PS(e)),this.lastProcessedEventTime=Date.now()}}function PS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function lA({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Yx(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kx(n,e={}){return bl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qx=/^https?/;async function Xx(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Kx(n);for(const t of e)try{if(Jx(t))return}catch{}os(n,"unauthorized-domain")}function Jx(n){const e=tg(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!Qx.test(t))return!1;if(Wx.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx=new uu(3e4,6e4);function CS(){const n=Sr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function eD(n){return new Promise((e,t)=>{var r,a,l;function c(){CS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{CS(),t(Er(n,"network-request-failed"))},timeout:Zx.get()})}if(!((a=(r=Sr().gapi)===null||r===void 0?void 0:r.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Sr().gapi)===null||l===void 0)&&l.load)c();else{const d=ux("iframefcb");return Sr()[d]=()=>{gapi.load?c():t(Er(n,"network-request-failed"))},lx(`${cx()}?onload=${d}`).catch(h=>t(h))}}).catch(e=>{throw rh=null,e})}let rh=null;function tD(n){return rh=rh||eD(n),rh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD=new uu(5e3,15e3),iD="__/auth/iframe",rD="emulator/auth/iframe",sD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oD(n){const e=n.config;Ye(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ly(e,rD):`https://${n.config.authDomain}/${iD}`,r={apiKey:e.apiKey,appName:n.name,v:_l},a=aD.get(n.config.apiHost);a&&(r.eid=a);const l=n._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${tu(r).slice(1)}`}async function lD(n){const e=await tD(n),t=Sr().gapi;return Ye(t,n,"internal-error"),e.open({where:document.body,url:oD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sD,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const c=Er(n,"network-request-failed"),d=Sr().setTimeout(()=>{l(c)},nD.get());function h(){Sr().clearTimeout(d),a(r)}r.ping(h).then(h,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uD=500,dD=600,hD="_blank",fD="http://localhost";class NS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mD(n,e,t,r=uD,a=dD){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const h=Object.assign(Object.assign({},cD),{width:r.toString(),height:a.toString(),top:l,left:c}),m=zn().toLowerCase();t&&(d=BT(m)?hD:t),jT(m)&&(e=e||fD,h.scrollbars="yes");const g=Object.entries(h).reduce((v,[T,I])=>`${v}${T}=${I},`,"");if(ex(m)&&d!=="_self")return pD(e||"",d),new NS(null);const _=window.open(e||"",d,g);Ye(_,n,"popup-blocked");try{_.focus()}catch{}return new NS(_)}function pD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD="__/auth/handler",yD="emulator/auth/handler",_D=encodeURIComponent("fac");async function OS(n,e,t,r,a,l){Ye(n.config.authDomain,n,"auth-domain-config-required"),Ye(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:_l,eventId:a};if(e instanceof QT){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",gP(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries({}))c[g]=_}if(e instanceof du){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(c.scopes=g.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const g of Object.keys(d))d[g]===void 0&&delete d[g];const h=await n._getAppCheckToken(),m=h?`#${_D}=${encodeURIComponent(h)}`:"";return`${vD(n)}?${tu(d).slice(1)}${m}`}function vD({config:n}){return n.emulator?ly(n,yD):`https://${n.authDomain}/${gD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp="webStorageSupport";class ED{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fy,this._completeRedirectFn=Hx,this._overrideRedirectResult=Bx}async _openPopup(e,t,r,a){var l;ls((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const c=await OS(e,t,r,tg(),a);return mD(e,c,my())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await OS(e,t,r,tg(),a);return Tx(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(ls(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await lD(e),r=new qx(e);return t.register("authEvent",a=>(Ye(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rp,{type:Rp},a=>{var l;const c=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[Rp];c!==void 0&&t(!!c),os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Xx(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return qT()||zT()||uy()}}const cA=ED;var xS="@firebase/auth",DS="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bD(n){Xi(new Ui("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=r.options;Ye(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:YT(n)},m=new ax(r,a,l,h);return dx(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Xi(new Ui("auth-internal",e=>{const t=rf(e.getProvider("auth").getImmediate());return(r=>new SD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ri(xS,DS,wD(n)),ri(xS,DS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=300,AD=Cw("authIdTokenMaxAge")||TD;let kS=null;const RD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>AD)return;const a=t==null?void 0:t.token;kS!==a&&(kS=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function sg(n=wg()){const e=ma(n,"auth");if(e.isInitialized())return e.getImmediate();const t=zc(n,{popupRedirectResolver:cA,persistence:[Ch,Ih,fy]}),r=Cw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(r,location.origin);if(location.origin===l.origin){const c=RD(l.toString());ZT(t,c,()=>c(t.currentUser)),JT(t,d=>c(d))}}const a=Iw("auth");return a&&KT(t,`http://${a}`),t}function ID(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}ox({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const l=Er("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",ID().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bD("Browser");const MS=Object.freeze(Object.defineProperty({__proto__:null,AuthCredential:hy,FacebookAuthProvider:Xr,GithubAuthProvider:Zr,GoogleAuthProvider:Jr,OAuthCredential:ha,TwitterAuthProvider:es,beforeAuthStateChanged:ZT,browserLocalPersistence:Ih,browserPopupRedirectResolver:cA,browserSessionPersistence:fy,connectAuthEmulator:KT,getAuth:sg,getIdTokenResult:MT,inMemoryPersistence:Th,indexedDBLocalPersistence:Ch,initializeAuth:zc,onAuthStateChanged:vx,onIdTokenChanged:JT,prodErrorMap:PT,reload:LT,setPersistence:ig,signInAnonymously:sf},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD="type.googleapis.com/google.protobuf.Int64Value",CD="type.googleapis.com/google.protobuf.UInt64Value";function uA(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function Nh(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Nh(e));if(typeof n=="function"||typeof n=="object")return uA(n,e=>Nh(e));throw new Error("Data cannot be encoded in JSON: "+n)}function gl(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case PD:case CD:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>gl(e)):typeof n=="function"||typeof n=="object"?uA(n,e=>gl(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ii extends Vi{constructor(e,t,r){super(`${gy}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,ii.prototype)}}function ND(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Oh(n,e){let t=ND(n),r=t,a;try{const l=e&&e.error;if(l){const c=l.status;if(typeof c=="string"){if(!LS[c])return new ii("internal","internal");t=LS[c],r=c}const d=l.message;typeof d=="string"&&(r=d),a=l.details,a!==void 0&&(a=gl(a))}}catch{}return t==="ok"?null:new ii(t,r,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,t,r,a){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Mi(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(l=>this.auth=l,()=>{}),this.messaging||r.get().then(l=>this.messaging=l,()=>{}),this.appCheck||a==null||a.get().then(l=>this.appCheck=l,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),a=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:a}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="us-central1",xD=/^data: (.*?)(?:\n|$)/;function DD(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new ii("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class kD{constructor(e,t,r,a,l=ag,c=(...d)=>fetch(...d)){this.app=e,this.fetchImpl=c,this.emulatorOrigin=null,this.contextProvider=new OD(e,t,r,a),this.cancelAllRequests=new Promise(d=>{this.deleteService=()=>Promise.resolve(d())});try{const d=new URL(l);this.customDomain=d.origin+(d.pathname==="/"?"":d.pathname),this.region=ag}catch{this.customDomain=null,this.region=l}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function MD(n,e,t){const r=io(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(Eg(n.emulatorOrigin),Nw("Functions",!0))}function LD(n,e,t){const r=a=>VD(n,e,a,{});return r.stream=(a,l)=>zD(n,e,a,l),r}async function UD(n,e,t,r){t["Content-Type"]="application/json";let a;try{a=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let l=null;try{l=await a.json()}catch{}return{status:a.status,json:l}}async function dA(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function VD(n,e,t,r){const a=n._url(e);return jD(n,a,t,r)}async function jD(n,e,t,r){t=Nh(t);const a={data:t},l=await dA(n,r),c=r.timeout||7e4,d=DD(c),h=await Promise.race([UD(e,a,l,n.fetchImpl),d.promise,n.cancelAllRequests]);if(d.cancel(),!h)throw new ii("cancelled","Firebase Functions instance was deleted.");const m=Oh(h.status,h.json);if(m)throw m;if(!h.json)throw new ii("internal","Response is not valid JSON object.");let g=h.json.data;if(typeof g>"u"&&(g=h.json.result),typeof g>"u")throw new ii("internal","Response is missing data field.");return{data:gl(g)}}function zD(n,e,t,r){const a=n._url(e);return BD(n,a,t,r||{})}async function BD(n,e,t,r){var a;t=Nh(t);const l={data:t},c=await dA(n,r);c["Content-Type"]="application/json",c.Accept="text/event-stream";let d;try{d=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(l),headers:c,signal:r==null?void 0:r.signal})}catch(T){if(T instanceof Error&&T.name==="AbortError"){const A=new ii("cancelled","Request was cancelled.");return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}const I=Oh(0,null);return{data:Promise.reject(I),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(I)}}}}}}let h,m;const g=new Promise((T,I)=>{h=T,m=I});(a=r==null?void 0:r.signal)===null||a===void 0||a.addEventListener("abort",()=>{const T=new ii("cancelled","Request was cancelled.");m(T)});const _=d.body.getReader(),v=FD(_,h,m,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const T=v.getReader();return{async next(){const{value:I,done:A}=await T.read();return{value:I,done:A}},async return(){return await T.cancel(),{done:!0,value:void 0}}}}},data:g}}function FD(n,e,t,r){const a=(c,d)=>{const h=c.match(xD);if(!h)return;const m=h[1];try{const g=JSON.parse(m);if("result"in g){e(gl(g.result));return}if("message"in g){d.enqueue(gl(g.message));return}if("error"in g){const _=Oh(0,g);d.error(_),t(_);return}}catch(g){if(g instanceof ii){d.error(g),t(g);return}}},l=new TextDecoder;return new ReadableStream({start(c){let d="";return h();async function h(){if(r!=null&&r.aborted){const m=new ii("cancelled","Request was cancelled");return c.error(m),t(m),Promise.resolve()}try{const{value:m,done:g}=await n.read();if(g){d.trim()&&a(d.trim(),c),c.close();return}if(r!=null&&r.aborted){const v=new ii("cancelled","Request was cancelled");c.error(v),t(v),await n.cancel();return}d+=l.decode(m,{stream:!0});const _=d.split(`
`);d=_.pop()||"";for(const v of _)v.trim()&&a(v.trim(),c);return h()}catch(m){const g=m instanceof ii?m:Oh(0,null);c.error(g),t(g)}}},cancel(){return n.cancel()}})}const US="@firebase/functions",VS="0.12.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD="auth-internal",HD="app-check-internal",$D="messaging-internal";function qD(n){const e=(t,{instanceIdentifier:r})=>{const a=t.getProvider("app").getImmediate(),l=t.getProvider(GD),c=t.getProvider($D),d=t.getProvider(HD);return new kD(a,l,c,d,r)};Xi(new Ui(gy,e,"PUBLIC").setMultipleInstances(!0)),ri(US,VS,n),ri(US,VS,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(n=wg(),e=ag){const r=ma(nn(n),gy).getImmediate({identifier:e}),a=nP("functions");return a&&KD(r,...a),r}function KD(n,e,t){MD(nn(n),e,t)}function yy(n,e,t){return LD(nn(n),e)}qD();/*! Capacitor: https://capacitorjs.com/ - MIT License */var eo;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(eo||(eo={}));class sh extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const WD=n=>{var e,t;return n!=null&&n.androidBridge?"android":!((t=(e=n==null?void 0:n.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},QD=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},a=()=>e!==null?e.name:WD(n),l=()=>a()!=="web",c=_=>{const v=m.get(_);return!!(v!=null&&v.platforms.has(a())||d(_))},d=_=>{var v;return(v=t.PluginHeaders)===null||v===void 0?void 0:v.find(T=>T.name===_)},h=_=>n.console.error(_),m=new Map,g=(_,v={})=>{const T=m.get(_);if(T)return console.warn(`Capacitor plugin "${_}" already registered. Cannot register plugins twice.`),T.proxy;const I=a(),A=d(_);let C;const L=async()=>(!C&&I in v?C=typeof v[I]=="function"?C=await v[I]():C=v[I]:e!==null&&!C&&"web"in v&&(C=typeof v.web=="function"?C=await v.web():C=v.web),C),x=(P,N)=>{var M,B;if(A){const G=A==null?void 0:A.methods.find(k=>N===k.name);if(G)return G.rtype==="promise"?k=>t.nativePromise(_,N.toString(),k):(k,Ve)=>t.nativeCallback(_,N.toString(),k,Ve);if(P)return(M=P[N])===null||M===void 0?void 0:M.bind(P)}else{if(P)return(B=P[N])===null||B===void 0?void 0:B.bind(P);throw new sh(`"${_}" plugin is not implemented on ${I}`,eo.Unimplemented)}},U=P=>{let N;const M=(...B)=>{const G=L().then(k=>{const Ve=x(k,P);if(Ve){const tt=Ve(...B);return N=tt==null?void 0:tt.remove,tt}else throw new sh(`"${_}.${P}()" is not implemented on ${I}`,eo.Unimplemented)});return P==="addListener"&&(G.remove=async()=>N()),G};return M.toString=()=>`${P.toString()}() { [capacitor code] }`,Object.defineProperty(M,"name",{value:P,writable:!1,configurable:!1}),M},z=U("addListener"),$=U("removeListener"),se=(P,N)=>{const M=z({eventName:P},N),B=async()=>{const k=await M;$({eventName:P,callbackId:k},N)},G=new Promise(k=>M.then(()=>k({remove:B})));return G.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await B()},G},D=new Proxy({},{get(P,N){switch(N){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return A?se:z;case"removeListener":return $;default:return U(N)}}});return r[_]=D,m.set(_,{name:_,proxy:D,platforms:new Set([...Object.keys(v),...A?[I]:[]])}),D};return t.convertFileSrc||(t.convertFileSrc=_=>_),t.getPlatform=a,t.handleError=h,t.isNativePlatform=l,t.isPluginAvailable=c,t.registerPlugin=g,t.Exception=sh,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},XD=n=>n.Capacitor=QD(n),Ne=XD(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),er=Ne.registerPlugin;class _y{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const l=this.windowListeners[e];l&&!l.registered&&this.addWindowListener(l),r&&this.sendRetainedArgumentsForEvent(e);const c=async()=>this.removeListener(e,t);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const a=this.listeners[e];if(!a){if(r){let l=this.retainedEventArguments[e];l||(l=[]),l.push(t),this.retainedEventArguments[e]=l}return}a.forEach(l=>l(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new Ne.Exception(e,eo.Unimplemented)}unavailable(e="not available"){return new Ne.Exception(e,eo.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const a=r.indexOf(t);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const jS=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),zS=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class JD extends _y{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,l]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=zS(a).trim(),l=zS(l).trim(),t[a]=l}),t}async setCookie(e){try{const t=jS(e.key),r=jS(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,l=(e.path||"/").replace("path=",""),c=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${a}; path=${l}; ${c};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}er("CapacitorCookies",{web:()=>new JD});const ZD=async n=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>t(a),r.readAsDataURL(n)}),e2=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(a=>a.toLocaleLowerCase()).reduce((a,l,c)=>(a[l]=n[e[c]],a),{})},t2=(n,e=!0)=>n?Object.entries(n).reduce((r,a)=>{const[l,c]=a;let d,h;return Array.isArray(c)?(h="",c.forEach(m=>{d=e?encodeURIComponent(m):m,h+=`${l}=${d}&`}),h.slice(0,-1)):(d=e?encodeURIComponent(c):c,h=`${l}=${d}`),`${r}&${h}`},"").substr(1):null,hA=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),a=e2(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(a.includes("application/x-www-form-urlencoded")){const l=new URLSearchParams;for(const[c,d]of Object.entries(n.data||{}))l.set(c,d);t.body=l.toString()}else if(a.includes("multipart/form-data")||n.data instanceof FormData){const l=new FormData;if(n.data instanceof FormData)n.data.forEach((d,h)=>{l.append(h,d)});else for(const d of Object.keys(n.data))l.append(d,n.data[d]);t.body=l;const c=new Headers(t.headers);c.delete("content-type"),t.headers=c}else(a.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class n2 extends _y{async request(e){const t=hA(e,e.webFetchExtra),r=t2(e.params,e.shouldEncodeUrlParams),a=r?`${e.url}?${r}`:e.url,l=await fetch(a,t),c=l.headers.get("content-type")||"";let{responseType:d="text"}=l.ok?e:{};c.includes("application/json")&&(d="json");let h,m;switch(d){case"arraybuffer":case"blob":m=await l.blob(),h=await ZD(m);break;case"json":h=await l.json();break;case"document":case"text":default:h=await l.text()}const g={};return l.headers.forEach((_,v)=>{g[v]=_}),{data:h,headers:g,status:l.status,url:l.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}er("CapacitorHttp",{web:()=>new n2});const i2=Object.freeze(Object.defineProperty({__proto__:null,Capacitor:Ne,CapacitorException:sh,get ExceptionCode(){return eo},WebPlugin:_y,buildRequestInit:hA,registerPlugin:er},Symbol.toStringTag,{value:"Module"}));Ne.getPlatform()==="ios"&&X.error("[firebaseConfig]  iOS detectado - Usando configuracin Web estndar compatible con capacitor://");const xh={apiKey:"AIzaSyBx7eIcSrFFQ-TAaGM1DQJ1GNcHc1wDHkg",authDomain:"yo-nunca-85b0c.firebaseapp.com",projectId:"yo-nunca-85b0c",storageBucket:"yo-nunca-85b0c.firebasestorage.app",messagingSenderId:"814751987159",appId:"1:814751987159:web:5849912e1b43a82899c792"};xh.apiKey||X.error("[firebaseConfig]  FATAL: No se encontr API Key. Fallback fall.");let xi,st,Ut,yl;const Ft=!!xh.apiKey&&!!xh.projectId;if(Ft)try{if(X.error("[firebaseConfig]  Inicializando Firebase (Modo Debug)..."),xi=Uw(xh),X.error(`[firebaseConfig]  Platform: ${Ne.getPlatform()}`),X.error(`[firebaseConfig]  UserAgent: ${navigator.userAgent}`),X.error(`[firebaseConfig]  Origin: ${window.location.href}`),X.error(`[firebaseConfig]  Online Status: ${navigator.onLine}`),Ne.getPlatform()==="ios")try{st=gS(xi,{experimentalForceLongPolling:!0}),X.error("[firebaseConfig]  Firestore inicializado (LongPolling: ON)")}catch(n){X.error("[firebaseConfig]  Error inicializando Firestore:",n)}else st=gS(xi,{}),X.error("[firebaseConfig]  Firestore inicializado (Standard)");if(Ne.getPlatform()==="ios")try{Ut=zc(xi,{persistence:Ch}),X.error("[firebaseConfig]  Auth inicializado con INDEXED_DB persistence (iOS)")}catch(n){try{Ut=zc(xi,{persistence:Ih}),X.error("[firebaseConfig]  Auth inicializado con LOCAL persistence (iOS)")}catch(e){try{Ut=zc(xi,{persistence:Th}),X.error("[firebaseConfig]  Auth inicializado con MEMORY persistence (iOS fallback)")}catch(t){X.error(`[firebaseConfig]  Fall initializeAuth (${(t==null?void 0:t.message)||(e==null?void 0:e.message)||(n==null?void 0:n.message)}), usando getAuth estndar`),Ut=sg(xi)}}}else Ut=sg(xi);Ut.onAuthStateChanged(n=>{n?X.error(`[firebaseConfig]  onAuthStateChanged: LOGUEADO (${n.uid})`):X.error("[firebaseConfig]  onAuthStateChanged: NO LOGUEADO")}),yl=YD(xi),(async()=>{try{X.error("[firebaseConfig]  Configurando persistencia...");try{await ig(Ut,Ch),X.error("[firebaseConfig]  Persistencia establecida: INDEXED_DB")}catch{await ig(Ut,Ih),X.error("[firebaseConfig]  Persistencia establecida: LOCAL")}}catch(n){X.error(`[firebaseConfig]  Error en setPersistence: ${n.message}`)}try{if(Ut.currentUser)X.error("[firebaseConfig]  Usuario ya autenticado: "+Ut.currentUser.uid);else{X.error("[firebaseConfig]  Iniciando sesin annima automtica...");const n=await sf(Ut);X.error(`[firebaseConfig]  Sesin annima creada: ${n.user.uid}`)}X.error(`[Firebase]  Inicializado correctamente en ${Ne.getPlatform()}`)}catch(n){X.error(`[Firebase]  Error CRTICO en signInAnonymously: ${n.message} (Code: ${n.code})`)}})()}catch(n){X.error("[Firebase]  Error crtico durante inicializacin:",n)}else X.error("[Firebase]  No se inicializ: faltan variables de entorno");const og=async()=>{X.error("[TestFirestore]  Iniciando test...");try{if(!st)return X.error("[TestFirestore]  DB es null"),{success:!1,message:"Firestore no inicializado"};try{const c=navigator.onLine;X.error(`[TestFirestore]  Navigator Online: ${c}`)}catch{}const n=Ut==null?void 0:Ut.currentUser;X.error(`[TestFirestore]  Auth User: ${n?n.uid:"NULL"}`),X.error('[TestFirestore]  Intentando leer coleccin "config"...');const e=Wg(st,"config"),t=xO(e,DO(1)),r=Date.now(),a=await AT(t),l=Date.now()-r;return X.error(`[TestFirestore]  Lectura exitosa en ${l}ms. Docs: ${a.size}`),a.empty?X.error("[TestFirestore]  La coleccin est vaca, pero la conexin funciona."):a.forEach(c=>X.error(`[TestFirestore]  Doc ID: ${c.id}`)),{success:!0,count:a.size,message:`Conexin exitosa. Docs ledos: ${a.size}`}}catch(n){return X.error("[TestFirestore]  Error CRTICO:",n),X.error("[TestFirestore]  Code:",n.code),X.error("[TestFirestore]  Message:",n.message),{success:!1,message:n.message,code:n.code||"UNKNOWN"}}},r2=Object.freeze(Object.defineProperty({__proto__:null,FIREBASE_ENABLED:Ft,get auth(){return Ut},get db(){return st},get firebaseApp(){return xi},get functions(){return yl},httpsCallable:yy,signInAnonymously:sf,testFirestoreConnection:og},Symbol.toStringTag,{value:"Module"})),mr={RATE_LIMITS:{PHRASES_READ:30,ADMIN_OPERATIONS:100,SUGGESTIONS:5,GAME_SESSIONS:60,STORE_QUERIES:20,CACHE_REFRESH:2,PROMO_ATTEMPTS:3,ADMIN_CREATE_PHRASE:50,ADMIN_UPDATE_PHRASE:100,ADMIN_DELETE_PHRASE:20},TIME_WINDOWS:{RATE_LIMIT_WINDOW:60*1e3,BLOCK_DURATION:900*1e3,CLEANUP_INTERVAL:600*1e3,METRICS_RESET:1440*60*1e3},THRESHOLDS:{CRITICAL_THRESHOLD_MULTIPLIER:2,MAX_PARAM_LENGTH:1e3,MAX_QUERY_TYPE_LENGTH:50},MALICIOUS_PATTERNS:[/javascript:/i,/<script/i,/eval\(/i,/function\(/i,/\$\{/,/\.__proto__/,/constructor/,/alert\(/i,/document\./i,/window\./i,/location\./i,/cookie/i,/onclick/i,/onload/i,/onerror/i,/innerHTML/i,/outerHTML/i],LOGGING:{ENABLE_CONSOLE_LOGS:!0,ENABLE_SECURITY_ALERTS:!0,ENABLE_METRICS_LOGGING:!0,LOG_BLOCKED_REQUESTS:!0,LOG_SUSPICIOUS_ACTIVITY:!0}},Ga=n=>mr.LOGGING[n]||!1,qa=class qa{constructor(){De(this,"rateLimitMap",new Map);De(this,"metrics",{totalRequests:0,blockedRequests:0,suspiciousIPs:new Set,lastReset:Date.now()});De(this,"RATE_LIMITS",mr.RATE_LIMITS);De(this,"TIME_WINDOW",mr.TIME_WINDOWS.RATE_LIMIT_WINDOW);De(this,"BLOCK_DURATION",mr.TIME_WINDOWS.BLOCK_DURATION);this.startCleanupInterval(),this.startMetricsReset()}static getInstance(){return qa.instance||(qa.instance=new qa),qa.instance}checkRateLimit(e,t){const r=Date.now(),a=this.RATE_LIMITS[t];this.metrics.totalRequests++;const l=`${e}|${String(t)}`;let c=this.rateLimitMap.get(l);return c||(c={count:0,firstRequest:r,lastRequest:r,blocked:!1},this.rateLimitMap.set(l,c)),c.blocked&&c.blockExpiry&&r<c.blockExpiry?(this.metrics.blockedRequests++,console.warn(`[Security]  Solicitud bloqueada para ${e} (${t})`),!1):(r-c.firstRequest>this.TIME_WINDOW&&(c.count=0,c.firstRequest=r,c.blocked=!1,c.blockExpiry=void 0),c.count++,c.lastRequest=r,c.count>a?(c.blocked=!0,c.blockExpiry=r+this.BLOCK_DURATION,this.metrics.blockedRequests++,this.metrics.suspiciousIPs.add(e),Ga("LOG_BLOCKED_REQUESTS")&&console.warn(`[Security]  RATE LIMIT EXCEDIDO: ${e} (${t}) - ${c.count}/${a} solicitudes`),c.count>a*mr.THRESHOLDS.CRITICAL_THRESHOLD_MULTIPLIER&&this.triggerSecurityAlert(e,t,c.count),!1):!0)}getClientIdentifier(){const e=navigator.userAgent,t=navigator.language,r=Intl.DateTimeFormat().resolvedOptions().timeZone;return btoa(`${e}-${t}-${r}`).slice(0,16)}checkReadOperation(e){const t=this.getClientIdentifier();switch(e){case"phrases":return this.checkRateLimit(t,"PHRASES_READ");case"store":return this.checkRateLimit(t,"STORE_QUERIES");case"cache":return this.checkRateLimit(t,"CACHE_REFRESH");default:return!1}}checkWriteOperation(e){const t=this.getClientIdentifier();switch(e){case"suggestion":return this.checkRateLimit(t,"SUGGESTIONS");case"admin":return this.checkRateLimit(t,"ADMIN_OPERATIONS");case"game":return this.checkRateLimit(t,"GAME_SESSIONS");default:return!1}}getSecurityMetrics(){return{...this.metrics,suspiciousIPs:Array.from(this.metrics.suspiciousIPs),currentTime:Date.now(),activeClients:this.rateLimitMap.size}}startCleanupInterval(){setInterval(()=>{const e=Date.now(),t=[];this.rateLimitMap.forEach((r,a)=>{e-r.lastRequest>3600*1e3&&t.push(a)}),t.forEach(r=>{this.rateLimitMap.delete(r)}),t.length>0&&Ga("ENABLE_CONSOLE_LOGS")&&console.log(`[Security]  Limpiados ${t.length} registros expirados`)},mr.TIME_WINDOWS.CLEANUP_INTERVAL)}startMetricsReset(){setInterval(()=>{const e=Date.now();e-this.metrics.lastReset>mr.TIME_WINDOWS.METRICS_RESET&&(Ga("ENABLE_METRICS_LOGGING")&&console.log("[Security]  Reseteando mtricas diarias:",this.getSecurityMetrics()),this.metrics={totalRequests:0,blockedRequests:0,suspiciousIPs:new Set,lastReset:e})},3600*1e3)}triggerSecurityAlert(e,t,r){const a={timestamp:new Date().toISOString(),identifier:e,operation:t,requestCount:r,type:"POTENTIAL_DDOS_ATTACK"};Ga("ENABLE_SECURITY_ALERTS")&&console.error("[Security]  ALERTA DE SEGURIDAD:",a)}validateQuery(e,t){if(typeof e!="string"||e.length>mr.THRESHOLDS.MAX_QUERY_TYPE_LENGTH)return Ga("LOG_SUSPICIOUS_ACTIVITY")&&console.warn(`[Security]  Tipo de consulta invlido: ${e}`),!1;if(t){const r=JSON.stringify(t);if(r.length>mr.THRESHOLDS.MAX_PARAM_LENGTH)return Ga("LOG_SUSPICIOUS_ACTIVITY")&&console.warn("[Security]  Parmetros demasiado largos:",r.length),!1;for(const a of mr.MALICIOUS_PATTERNS)if(a.test(r))return Ga("LOG_SUSPICIOUS_ACTIVITY")&&console.warn("[Security]  Patrn malicioso detectado en consulta:",t),!1}return!0}};De(qa,"instance");let lg=qa;const vy=lg.getInstance(),fA=n=>vy.checkReadOperation(n),mA=n=>vy.checkWriteOperation(n),pA=(n,e)=>vy.validateQuery(n,e),Dh=new Map,Ey=()=>{const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`},gA=n=>n===Ey(),yA=async(n,e)=>{try{const t=JSON.stringify(e);typeof window<"u"&&window.localStorage?(localStorage.setItem(n,t),console.log(`[PHRASE_FLOW][STORAGE]  set ${n} (localStorage)`)):(Dh.set(n,t),console.log(`[PHRASE_FLOW][STORAGE]  set ${n} (memory)`))}catch(t){console.error(`[PHRASE_FLOW][STORAGE]  set error ${n}:`,t),Dh.set(n,JSON.stringify(e))}},_A=async n=>{try{let e=null;if(typeof window<"u"&&window.localStorage?e=localStorage.getItem(n):e=Dh.get(n)||null,e){const t=JSON.parse(e);return console.log(`[PHRASE_FLOW][STORAGE]  get ${n}`),t}return null}catch(e){return console.error(`[PHRASE_FLOW][STORAGE]  get error ${n}:`,e),null}},cg=async n=>{try{typeof window<"u"&&window.localStorage?localStorage.removeItem(n):Dh.delete(n),console.log(`[PHRASE_FLOW][STORAGE]  remove ${n}`)}catch(e){console.error(`[Storage] Error eliminando ${n}:`,e)}},kh=2,Ip=async n=>{const e={...n,cacheDate:Ey(),version:kh};await yA("phrases_cache",e),console.log(`[PHRASE_FLOW][CACHE_SAVE]  phrases_cache date=${e.cacheDate} v=${kh} total=${e.allPhrases.length} packs=${Object.keys(n.packPhrases||{}).length}`),console.log("[PHRASE_FLOW][CACHE_SAVE]  packDetail="+Object.entries(n.packPhrases||{}).map(([t,r])=>`${t}:${r.length}`).join(" | "))},s2=async()=>{const n=await _A("phrases_cache");return n?!n.version||n.version<kh?(console.warn(`[PHRASE_FLOW][CACHE_LOAD]  obsolete v${n.version||0}<${kh} -> purge`),await cg("phrases_cache"),null):gA(n.cacheDate)?(console.log(`[PHRASE_FLOW][CACHE_LOAD]  valid date=${n.cacheDate} v=${n.version} total=${n.allPhrases.length} premium=${n.premiumPhrases.length} packs=${Object.keys(n.packPhrases||{}).length}`),console.log("[PHRASE_FLOW][CACHE_LOAD]  packDetail="+Object.entries(n.packPhrases||{}).map(([e,t])=>`${e}:${t.length}`).join(" | ")),{freePhrases:n.freePhrases,premiumPhrases:n.premiumPhrases,adultPhrases:n.adultPhrases,allPhrases:n.allPhrases,packPhrases:n.packPhrases||{},lastUpdated:n.lastUpdated}):(console.log(`[PHRASE_FLOW][CACHE_LOAD]  stale date=${n.cacheDate} -> purge`),await cg("phrases_cache"),null):(console.log("[PHRASE_FLOW][CACHE_LOAD]  phrases_cache missing"),null)},a2=async n=>{const e={data:n,lastUpdated:Date.now(),cacheDate:Ey()};await yA("config_cache",e),console.log(`[PHRASE_FLOW][CONFIG_SAVE]  config_cache date=${e.cacheDate}`)},o2=async()=>{const n=await _A("config_cache");return n?gA(n.cacheDate)?(console.log(`[PHRASE_FLOW][CONFIG_LOAD]  valid date=${n.cacheDate}`),n.data):(console.log(`[PHRASE_FLOW][CONFIG_LOAD]  stale date=${n.cacheDate} -> purge`),await cg("config_cache"),null):(console.log("[PHRASE_FLOW][CONFIG_LOAD]  config_cache missing"),null)},Yi=[{id:"1",text:"he fingido que me gustaba un regalo.",isPremium:!1},{id:"2",text:"he espiado el mvil de mi pareja.",isPremium:!1},{id:"3",text:"he usado el cepillo de dientes de otra persona.",isPremium:!1},{id:"4",text:"he vuelto con un ex.",isPremium:!1},{id:"5",text:"me he redo en un momento inoportuno.",isPremium:!1},{id:"6",text:"he querido besar a alguien de esta mesa.",isPremium:!1},{id:"7",text:"me he besado con alguien que no sea mi pareja en un sueo.",isPremium:!1},{id:"8",text:"he salido solo de fiesta.",isPremium:!1},{id:"9",text:"he trabajado en algo que no me gusta.",isPremium:!1},{id:"10",text:"he puesto los cuernos a mi pareja.",isPremium:!1},{id:"11",text:"he criticado a alguien de esta mesa.",isPremium:!1},{id:"12",text:"me he puesto celoso por alguien de esta mesa.",isPremium:!1},{id:"13",text:"he pensado que alguien de esta mesa es tonto.",isPremium:!1},{id:"14",text:"he conducido a mas de 130km/h.",isPremium:!1},{id:"15",text:"he cogido un vuelo.",isPremium:!1}],W={freePhrases:[],premiumPhrases:[],adultPhrases:[],allPhrases:[],packPhrases:{},lastUpdated:0},vA=()=>W.lastUpdated>0&&W.allPhrases.length>0;let qi=!1;const ul=async(n=!1,e=[])=>{const t="[PHRASE_FLOW]";if(console.log(`${t}  updatePhraseCache(forceUpdate=${n}, owned=[${e.join(",")}])`),qi&&!n){console.log(`${t}  Abortado: actualizacin concurrente en progreso`);return}if(qi=!0,vA()&&!n){const r=Object.keys(W.packPhrases),a=e.filter(_=>!r.includes(_)&&_!=="remove_ads"),l=e.filter(_=>_!=="remove_ads"&&(!W.packPhrases[_]||W.packPhrases[_].length===0));console.log(`${t}  Cache vlido. cached=[${r.join(",")}] new=[${a.join(",")}] emptyOwned=[${l.join(",")}]`);let c=[];if(a.length===0&&l.length===0){console.log(`${t}  Early return: sin nuevos packs ni packs vacos`),qi=!1;return}else a.length>0?(c=[...a],l.forEach(_=>{c.includes(_)||c.push(_)}),console.log(`${t}  Cargando packs nuevos+vacos -> ${c.join(",")}`)):(c=[...l],console.log(`${t}  Recuperando packs vacos -> ${c.join(",")}`));const d=W.allPhrases.length;console.log(`${t}  Antes incremental all=${d} detalle=`+c.map(_=>{var v;return`${_}:${((v=W.packPhrases[_])==null?void 0:v.length)||0}`}).join(" | "));for(const _ of c)try{const v=`consolidated/phrases_pack_${_}`;console.log(`${t}  Leyendo ${v}`);const T=At(st,"consolidated",`phrases_pack_${_}`),I=await vn(T);if(I.exists()){const C=I.data().phrases||[];W.packPhrases[_]=C,W.allPhrases.push(...C),console.log(`${t}  Pack ${_} frases=${C.length}`)}else console.warn(`${t}  Documento pack inexistente ${_}`)}catch(v){if(console.error(`${t}  Error pack ${_}`,v),v instanceof Error&&(v.message.includes("offline")||v.message.includes("network"))){console.warn(`${t}  Modo offline detectado - usando cache existente`);break}}const h=new Map;W.allPhrases.forEach(_=>{_.id&&!h.has(_.id)&&h.set(_.id,_)});const m=W.allPhrases.length;W.allPhrases=[...h.values()];const g=m-W.allPhrases.length;W.adultPhrases=W.allPhrases.filter(_=>_.isAdult),W.lastUpdated=Date.now(),console.log(`${t}  Incremental fin all=${W.allPhrases.length} dupEliminados=${g} packs=`+Object.entries(W.packPhrases).map(([_,v])=>`${_}:${v.length}`).join(" | "));try{await Ip({freePhrases:W.freePhrases,premiumPhrases:W.premiumPhrases,adultPhrases:W.adultPhrases,allPhrases:W.allPhrases,packPhrases:W.packPhrases,lastUpdated:W.lastUpdated}),console.log(`${t}  Guardado incremental packs=${c.length}`)}catch(_){console.warn(`${t}  Error guardando incremental`,_)}qi=!1;return}if(n)console.log(`${t}  Full reload (forceUpdate=true)`);else{console.log(`${t}  Verificando almacenamiento local...`);const r=await s2();if(r){const a=Object.keys(r.packPhrases||{}).sort(),l=e.filter(d=>d!=="remove_ads").sort(),c=JSON.stringify(a)===JSON.stringify(l);if(console.log(`${t}  Comparando packs storage vs usuario`,{enCache:a,actuales:l,coinciden:c}),c){W.freePhrases=[],W.premiumPhrases=[],W.adultPhrases=[],W.allPhrases=[],W.packPhrases={},W.freePhrases=r.freePhrases,W.premiumPhrases=r.premiumPhrases,W.adultPhrases=r.adultPhrases,W.allPhrases=r.allPhrases,W.packPhrases=r.packPhrases||{},W.lastUpdated=r.lastUpdated;const d=new Map;W.allPhrases.forEach(_=>{_.id&&!d.has(_.id)&&d.set(_.id,_)});const h=W.allPhrases.length;W.allPhrases=Array.from(d.values());const m=h-W.allPhrases.length;m>0&&console.warn(`[updatePhraseCache]  ${m} DUPLICADOS eliminados del cach restaurado`);const g=W.allPhrases.filter(_=>_.packIds&&_.packIds.length>0);if(g.length>0){console.log(`[updatePhraseCache]  Detectadas ${g.length} frases con packIds en cache`);const _=[...new Set(g.flatMap(I=>I.packIds||[]))];console.log("[updatePhraseCache]  PackIds en cache:",_),console.log("[updatePhraseCache]  PackIds autorizados:",l);const v=W.allPhrases.length;W.allPhrases=W.allPhrases.filter(I=>!I.packIds||I.packIds.length===0||I.isDemo===!0?!0:I.packIds.some(A=>l.includes(A)));const T=v-W.allPhrases.length;if(T>0){console.log(`[updatePhraseCache]  ${T} frases de packs no autorizados eliminadas del cache`),W.adultPhrases=W.allPhrases.filter(I=>I.isAdult);try{await Ip({freePhrases:W.freePhrases,premiumPhrases:W.premiumPhrases,adultPhrases:W.adultPhrases,allPhrases:W.allPhrases,packPhrases:W.packPhrases,lastUpdated:W.lastUpdated}),console.log("[updatePhraseCache]  Cache limpio guardado")}catch(I){console.warn("[updatePhraseCache] Error guardando cache limpio:",I)}}}console.log(`${t}  Restaurado storage frases=${W.allPhrases.length} dupEliminados=${m} packs=${Object.keys(W.packPhrases).length}`),console.log(`${t}  Detalle packs=`+Object.entries(W.packPhrases).map(([_,v])=>`${_}:${v.length}`).join(" | ")),qi=!1;return}else{console.log("[updatePhraseCache]  Los packs del usuario cambiaron, invalidando cache local");try{typeof window<"u"&&window.localStorage&&localStorage.removeItem("phrases_cache")}catch(d){console.warn("[updatePhraseCache] Error limpiando cache:",d)}}}console.log(`${t}  Storage invlido -> full reload Firestore`)}if(W.lastUpdated>0&&!fA("cache")){console.warn("[updatePhraseCache]  Operacin de cache bloqueada por rate limiting"),qi=!1;return}if(!Ft){console.warn("[updatePhraseCache] Firebase no est configurado, usando datos mock."),W.freePhrases=Yi.filter(r=>!r.isPremium),W.premiumPhrases=Yi.filter(r=>r.isPremium),W.adultPhrases=[],W.allPhrases=Yi,W.lastUpdated=Date.now(),qi=!1;return}try{console.log(`${t}  Full reload: limpiando cache y leyendo documentos consolidados`);try{const I=At(st,"consolidated","phrases_free");await vn(I)}catch(I){if(console.error(`${t}  Error de conectividad detectado:`,I),W.allPhrases.length===0){console.warn(`${t}  MODO OFFLINE SIN CACHE - Usando datos mock`),W.freePhrases=Yi.filter(A=>!A.isPremium),W.premiumPhrases=Yi.filter(A=>A.isPremium),W.adultPhrases=[],W.allPhrases=Yi,W.lastUpdated=Date.now(),qi=!1;return}else{console.warn(`${t}  MODO OFFLINE - Usando cache existente (${W.allPhrases.length} frases)`),qi=!1;return}}if(!pA("phrases_cache_update",{forceUpdate:n}))throw new Error("Consulta no vlida por seguridad");W.freePhrases=[],W.premiumPhrases=[],W.adultPhrases=[],W.allPhrases=[],W.packPhrases={};const r=At(st,"consolidated","phrases_free"),a=await vn(r);if(a.exists()){const A=a.data().phrases||[],C=A.filter(z=>!z.packIds||z.packIds.length===0||z.isDemo===!0),L=A.filter(z=>z.packIds&&z.packIds.length>0&&z.isDemo!==!0);if(L.length>0){const z=[...new Set(L.flatMap($=>$.packIds||[]))];console.log(`[updatePhraseCache]  Documento phrases_free contiene ${L.length} frases NO-DEMO con packIds:`,z),console.log("[updatePhraseCache]  Estas frases NO se aadirn aqu (requieren comprar el pack)")}W.freePhrases=C,W.allPhrases.push(...C);const x=C.filter(z=>z.isDemo).length,U=C.filter(z=>!z.isDemo).length;console.log(`[updatePhraseCache]  Frases gratuitas cargadas: ${C.length} (${U} gratuitas + ${x} demos) - ${L.length} excluidas por packIds`)}else{console.warn("[updatePhraseCache]  No se encontr documento phrases_free, usando estructura antigua"),await l2();return}if(e.length>0){console.log(`${t}  Full reload packs=[${e.join(",")}] count=${e.length}`);for(const A of e){const C=A==="starter_pack"?"[starter_pack]":"";if(console.log(`[updatePhraseCache] ${C} Procesando pack: ${A}`),A==="remove_ads"){console.log(`[updatePhraseCache]  Saltando producto sin frases: ${A}`);continue}try{const L=`consolidated/phrases_pack_${A}`;console.log(`[updatePhraseCache] ${C}  Intentando leer documento: ${L}`);const x=A,U=At(st,"consolidated",`phrases_pack_${x}`);let z=await vn(U),$=!1,se=null;if(!z.exists()&&x.endsWith("_pack")){se=x.replace(/_pack$/,"");const N=At(st,"consolidated",`phrases_pack_${se}`),M=await vn(N);M.exists()&&(z=M,$=!0,console.warn(`[updatePhraseCache] ${C}  Usando alias phrases_pack_${se} para ${x}`))}if(!z.exists()){console.warn(`[updatePhraseCache] ${C}  Documento phrases_pack_${x} NO existe`);const N=W.freePhrases.filter(M=>M.packIds&&M.packIds.includes(x));N.length>0&&console.warn(`[updatePhraseCache] ${C}  Detectadas ${N.length} frases de ${x} dentro de phrases_free (no-demo). Deben migrarse a consolidated/phrases_pack_${x}.`);continue}let P=z.data().phrases||[];if($&&se&&(P=P.map(N=>{const M=Array.isArray(N.packIds)?N.packIds.slice():[];return M.includes(x)||M.push(x),{...N,packIds:M}})),console.log(`[updatePhraseCache] ${C}  Pack ${x}: ${P.length} frases encontradas`),W.packPhrases[x]=P,W.allPhrases.push(...P),console.log(`[updatePhraseCache] ${C}  Pack ${x}: ${P.length} frases aadidas (allPhrases ahora ${W.allPhrases.length})`),x==="starter_pack"){const N=P.slice(0,3).map(M=>M.id||M.text).join(", ");console.log(`[updatePhraseCache] [starter_pack] Ejemplo de frases cargadas: ${N||"<<vaco>>"}`)}}catch(L){console.error(`[updatePhraseCache] ${C}  Error cargando pack ${A}:`,L)}}const I=Object.entries(W.packPhrases).map(([A,C])=>`${A}:${C.length}`).join(" | ");console.log(`[updatePhraseCache]  Total frases en allPhrases tras packs: ${W.allPhrases.length}`),console.log(`[updatePhraseCache]  Packs en cache: ${Object.keys(W.packPhrases).length} -> ${I}`),W.packPhrases.starter_pack?W.packPhrases.starter_pack.length===0&&console.warn("[updatePhraseCache]  starter_pack cargado pero vaco (documento sin frases o filtradas)"):console.warn("[updatePhraseCache]  starter_pack NO est en phraseCache.packPhrases (verificar documento Firestore y ownedPackIds)")}const l=new Map;W.allPhrases.forEach(I=>{I.id&&!l.has(I.id)&&l.set(I.id,I)});const c=W.allPhrases.length;W.allPhrases=Array.from(l.values());const d=c-W.allPhrases.length;d>0&&console.warn(`[updatePhraseCache]  ${d} DUPLICADOS eliminados de allPhrases`),W.adultPhrases=W.allPhrases.filter(I=>I.isAdult),W.lastUpdated=Date.now();const h=Object.values(W.packPhrases).reduce((I,A)=>I+A.length,0),m=W.allPhrases.filter(I=>!I.packIds||I.packIds.length===0).length,g=W.allPhrases.filter(I=>(!I.packIds||I.packIds.length===0)&&!I.isDemo).length,_=W.allPhrases.filter(I=>I.isDemo).length;console.log(`[updatePhraseCache]  Cach actualizado con ${W.allPhrases.length} frases en total (${d} duplicados eliminados)`),console.log(`[updatePhraseCache]  Gratis (freePhrases doc): ${W.freePhrases.length}, Packs: ${h}, Adulto: ${W.adultPhrases.length}`),console.log(`[updatePhraseCache]  Gratuitas reales (sin packIds): ${m} (${g} sin demos + ${_} demos)`),console.log("[updatePhraseCache]  Packs cargados:",Object.keys(W.packPhrases)),console.log("[updatePhraseCache]  Frases por pack:",Object.entries(W.packPhrases).map(([I,A])=>({[I]:A.length}))),console.log(`[updatePhraseCache]  OPTIMIZACIN: Solo ${1+e.filter(I=>I!=="remove_ads").length} lecturas de Firestore`),console.log("[updatePhraseCache]  Guardando cach en almacenamiento local...");const v=W.allPhrases.filter(I=>I.packIds&&I.packIds.length>0),T=W.allPhrases.filter(I=>!I.packIds||I.packIds.length===0);if(console.log("[updatePhraseCache]  VERIFICACIN FINAL:"),console.log(`[updatePhraseCache]   - Sin packIds (gratuitas): ${T.length}`),console.log(`[updatePhraseCache]   - Con packIds: ${v.length}`),v.length>0){const I=[...new Set(v.flatMap(C=>C.packIds||[]))];console.log("[updatePhraseCache]   - PackIds encontrados en allPhrases:",I),console.log("[updatePhraseCache]   - PackIds del usuario (ownedPackIds):",e);const A=I.filter(C=>!e.includes(C)&&C!=="remove_ads");A.length>0&&console.error("[updatePhraseCache]  ERROR: Hay frases de packs NO AUTORIZADOS:",A)}try{await Ip({freePhrases:W.freePhrases,premiumPhrases:W.premiumPhrases,adultPhrases:W.adultPhrases,allPhrases:W.allPhrases,packPhrases:W.packPhrases,lastUpdated:W.lastUpdated}),console.log("[updatePhraseCache]  Cach guardado en almacenamiento local para hoy")}catch(I){console.warn("[updatePhraseCache]  Error guardando en almacenamiento local:",I)}}catch(r){console.error(`${t}  Error actualizando cach FULL:`,r),console.error("Error details:",{message:r instanceof Error?r.message:"Unknown error",stack:r instanceof Error?r.stack:void 0,firebaseEnabled:Ft,dbConfigured:!!st}),console.warn(`${t} Usando datos mock como fallback (error en full reload)`),W.freePhrases=Yi.filter(a=>!a.isPremium),W.premiumPhrases=Yi.filter(a=>a.isPremium),W.adultPhrases=[],W.allPhrases=Yi,W.lastUpdated=Date.now(),qi=!1}qi=!1},l2=async()=>{console.log("[loadPhrasesFromOldStructure] Cargando desde estructura antigua...");const n=Wg(st,"phrases"),e=await AT(n);console.log(`[loadPhrasesFromOldStructure] ${e.size} documentos obtenidos`),W.freePhrases=[],W.premiumPhrases=[],W.adultPhrases=[],W.allPhrases=[],e.forEach(t=>{const r={id:t.id,...t.data()};W.allPhrases.push(r),r.isPremium?W.premiumPhrases.push(r):W.freePhrases.push(r),r.isAdult&&W.adultPhrases.push(r)}),W.lastUpdated=Date.now(),console.log(`[loadPhrasesFromOldStructure]  Cach cargado: ${W.allPhrases.length} frases`)},EA=async(n,e=!1,t=[])=>{const r="[PHRASE_FLOW]";if(console.log(`${r}  includePremium=${n} (OBSOLETO) adult=${e} owned=[${t.join(",")}] cache: all=${W.allPhrases.length} free=${W.freePhrases.length} packsLoaded=${Object.keys(W.packPhrases).length}`),W.allPhrases.length>0&&!fA("phrases")){console.warn("[fetchPhrases]  Operacin de lectura bloqueada por rate limiting");const a=W.allPhrases.filter(l=>!l.packIds||l.packIds.length===0?!0:l.packIds.some(c=>t.includes(c)));return e?a:a.filter(l=>!l.isAdult)}if(!Ft){console.warn("[fetchPhrases] Firebase no est configurado, devolviendo datos mock.");const a=Yi.filter(l=>!l.packIds||l.packIds.length===0?!0:l.packIds.some(c=>t.includes(c)));return e?a:a.filter(l=>!l.isAdult)}try{if(!vA()||W.allPhrases.length===0)console.log("[fetchPhrases]  Cache vaco o invlido, cargando..."),await ul(!1,t);else{const l=Object.keys(W.packPhrases),c=t.filter(d=>!l.includes(d)&&d!=="remove_ads");c.length>0&&(console.log(`${r}  Nuevos packs detectados: ${c.join(", ")}`),await ul(!1,t))}let a=W.allPhrases.filter(l=>!l.packIds||l.packIds.length===0?!0:l.packIds.some(c=>t.includes(c)));return e||(a=a.filter(l=>!l.isAdult)),console.log(`${r}  result frases=${a.length} demo=${a.filter(l=>l.isDemo).length} permanentes=${a.filter(l=>!l.isDemo).length}`),console.log(`${r}  owned=[${t.join(",")}]`),console.log(`${r}  distribucin packs`,a.reduce((l,c)=>(c.packIds&&c.packIds.length>0?c.packIds.forEach(d=>{l[d]=(l[d]||0)+1}):l.gratuitas=(l.gratuitas||0)+1,l),{})),a}catch(a){console.error(`${r}  Error obteniendo frases:`,a),console.error(`${r}  Fallback - mock`);const l=Yi.filter(c=>!c.packIds||c.packIds.length===0?!0:c.packIds.some(d=>t.includes(d)));return e?l:l.filter(c=>!c.isAdult)}},SA=async n=>{if(console.log(`Adding suggestion: "${n}"`),!mA("suggestion"))throw new Error(" Demasiadas sugerencias enviadas. Espera un momento antes de enviar otra.");if(!pA("add_suggestion",{text:n}))throw new Error("El contenido de la sugerencia no es vlido.");try{if(!Ft)throw console.warn("[addSuggestion] Firebase no est configurado. La sugerencia no se enviar en este entorno."),new Error("Firebase no configurado en este entorno.");await UO(Wg(st,"suggestions"),{text:n,createdAt:new Date,status:"pending"}),console.log("Suggestion submitted successfully.")}catch(e){throw console.error("Error adding suggestion:",e),new Error("No se pudo enviar la sugerencia. Intntalo ms tarde.")}};let Xs=null,ah=!1,Ac=null;const Ar=async()=>ah&&Xs?(console.log("[loadConsolidatedConfig]  Usando cach de configuracin en memoria"),Xs):Ac?(console.log("[loadConsolidatedConfig]  Esperando a carga en progreso..."),Ac):(Ac=(async()=>{try{console.log("[loadConsolidatedConfig]  Verificando almacenamiento local...");const n=await o2();if(n)return Xs=n,ah=!0,console.log("[loadConsolidatedConfig]  Configuracin restaurada desde almacenamiento local (0 lecturas de Firestore)"),console.log("[loadConsolidatedConfig]  AHORRO: 0 lecturas vs 1 lectura desde Firestore"),Xs;console.log("[loadConsolidatedConfig]  No hay configuracin local vlida, descargando desde Firestore...");try{console.log("[loadConsolidatedConfig]  Cargando configuracin consolidada (solo una vez al inicio)...");const e=At(st,"consolidated","app_config"),t=await vn(e);if(t.exists()){Xs=t.data(),ah=!0,console.log("[loadConsolidatedConfig]  Configuracin consolidada cargada y almacenada"),console.log("[loadConsolidatedConfig]  OPTIMIZACIN: 1 lectura vs mltiples lecturas anteriormente"),console.log("[loadConsolidatedConfig]  Guardando configuracin en almacenamiento local...");try{await a2(Xs),console.log("[loadConsolidatedConfig]  Configuracin guardada en almacenamiento local para hoy")}catch(r){console.warn("[loadConsolidatedConfig]  Error guardando en almacenamiento local:",r)}return Xs}else return console.warn("[loadConsolidatedConfig]  No se encontr documento consolidado, usando estructura antigua"),null}catch(e){return console.error("[loadConsolidatedConfig] Error:",e),null}}finally{Ac=null}})(),Ac),wA=async()=>{console.log("[forceReloadConfig]  Forzando recarga de configuracin..."),Xs=null,ah=!1;try{typeof window<"u"&&window.localStorage&&(localStorage.removeItem("config_cache"),console.log("[forceReloadConfig]  Cach local eliminado"))}catch(n){console.warn("[forceReloadConfig] Error limpiando cach local:",n)}return await Ar()},bA=async()=>{try{if(!Ft)return"Prueba el pack premium para descubrir algunas de las nuevas frases que puedes desbloquear en la tienda";const n=await Ar();return!n||!n.premiumPromoMessage?"Prueba el pack premium para descubrir algunas de las nuevas frases que puedes desbloquear en la tienda":n.premiumPromoMessage}catch(n){return console.error("[getPremiumPromoMessage] Error:",n),"Prueba el pack premium para descubrir algunas de las nuevas frases que puedes desbloquear en la tienda"}},TA=async(n,e)=>{try{return!Ft||!yl?!1:(await yy(yl,"incrementEntryCodeUsage")({productId:n,entryCode:e}),!0)}catch(t){return console.error("[incrementEntryCodeUsage] Error:",t),!1}},Sy=async()=>{try{if(console.log("[getStoreProducts]  Cargando productos de tienda..."),!Ft)return console.warn("[getStoreProducts]  Firebase no habilitado"),[];const n=At(st,"consolidated","app_config");let e;try{e=await LO(n)}catch(t){console.warn("[getStoreProducts]  getDocFromServer fall, usando getDoc estndar (podra devolver cach):",t),e=await vn(n)}if(e.exists()){const t=e.data(),r=Array.isArray(t.storeProducts)?t.storeProducts:null,a=Array.isArray(t.store_products)?t.store_products:null,l=r||a||[],c=l.map(d=>{let h;return Array.isArray(d==null?void 0:d.benefits)?h=d.benefits.filter(m=>typeof m=="string"&&m.trim().length>0):typeof(d==null?void 0:d.benefits)=="string"?h=String(d.benefits).split(`
`).map(m=>m.trim()).filter(m=>!!m):h=void 0,{...d,benefits:h}});if(l.length>0)return console.log(`[getStoreProducts]  ${l.length} productos cargados`),console.log("[getStoreProducts]  IDs:",c.map(d=>d.productId).join(", ")),c}return console.warn("[getStoreProducts]  No hay storeProducts/store_products en app_config"),[]}catch(n){return console.error("[getStoreProducts]  Error:",n),[]}},c2=async()=>{try{if(!Ft)return{enable_store:!0,enable_remove_ads_purchase:!0,enable_premium_purchase:!0,enable_share_button:!0,enable_play:!0};const n=await Ar();if(n&&n.featureFlags){console.log("[getFeatureFlags]  Feature flags desde config consolidada");const r=n.featureFlags,a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=(h,m,g)=>l?m??h:c?g??h:h;return{enable_store:d(r.enable_store,r.enable_store_ios,r.enable_store_web),enable_play:d(r.enable_play,r.enable_play_ios,r.enable_play_web),enable_share_button:d(r.enable_share_button,r.enable_share_button_ios,r.enable_share_button_web),enable_adult_mode:d(r.enable_adult_mode,r.enable_adult_mode_ios,r.enable_adult_mode_web),enable_remove_ads_purchase:r.enable_remove_ads_purchase,enable_premium_purchase:r.enable_premium_purchase}}console.log("[getFeatureFlags] Usando estructura antigua...");const e=At(st,"config","feature_flags"),t=await vn(e);if(t.exists()){const r=t.data(),a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=(h,m,g)=>l?m??h:c?g??h:h;return{enable_store:d(r.enable_store,r.enable_store_ios,r.enable_store_web),enable_play:d(r.enable_play,r.enable_play_ios,r.enable_play_web),enable_share_button:d(r.enable_share_button,r.enable_share_button_ios,r.enable_share_button_web),enable_adult_mode:d(r.enable_adult_mode,r.enable_adult_mode_ios,r.enable_adult_mode_web),enable_remove_ads_purchase:r.enable_remove_ads_purchase,enable_premium_purchase:r.enable_premium_purchase}}return{enable_store:!0,enable_remove_ads_purchase:!0,enable_premium_purchase:!0,enable_share_button:!0,enable_play:!0}}catch(n){return console.error("[getFeatureFlags] Error:",n),{enable_store:!0,enable_remove_ads_purchase:!0,enable_premium_purchase:!0,enable_share_button:!0,enable_play:!0}}},u2=async()=>{try{if(!Ft)return{required_update_version:void 0};const n=await Ar();if(n&&n.appSettings){console.log("[getAppSettings]  App settings desde config consolidada");const r=n.appSettings,a=Ne.getPlatform();return{required_update_version:a==="ios"?r.required_update_version_ios??r.required_update_version:a==="web"?r.required_update_version_web??r.required_update_version:r.required_update_version}}console.log("[getAppSettings] Usando estructura antigua...");const e=At(st,"config","app_settings"),t=await vn(e);if(t.exists()){const r=t.data(),a=Ne.getPlatform();return{required_update_version:a==="ios"?r.required_update_version_ios??r.required_update_version:a==="web"?r.required_update_version_web??r.required_update_version:r.required_update_version}}return{required_update_version:void 0}}catch(n){return console.error("[getAppSettings] Error:",n),{required_update_version:void 0}}},d2=async()=>{var n;try{if(!Ft)return"https://play.google.com/store/apps/details?id=com.mrodr.yonunca";const e=await Ar();if(e&&e.externalLinks&&e.externalLinks.play_store_url)return console.log("[getPlayStoreUrl]  URL desde config consolidada"),e.externalLinks.play_store_url;console.log("[getPlayStoreUrl] Usando estructura antigua...");const t=At(st,"config","app_config"),r=await vn(t);if(r.exists()){const a=r.data();return((n=a==null?void 0:a.external_links)==null?void 0:n.play_store_url)||void 0}return}catch(e){console.error("[getPlayStoreUrl] Error:",e);return}},h2=async()=>{try{if(!Ft)return"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos.";const n=await Ar();if(n&&n.appSettings)return console.log("[getWelcomeMessage]  Mensaje desde config consolidada"),n.appSettings.welcome_message||"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos.";console.log("[getWelcomeMessage] Usando estructura antigua...");const e=At(st,"config","app_settings"),t=await vn(e);if(t.exists()){const r=t.data();return(r==null?void 0:r.welcome_message)||"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."}return"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."}catch(n){return console.error("[getWelcomeMessage] Error:",n),"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."}},f2=async()=>{try{if(!Ft)return{enabled:!1,title:"",message:"",buttonText:"Entendido"};const n=await Ar();if(n&&n.appSettings){console.log("[getPopupConfig]  Popup config desde config consolidada");const r=n.appSettings,a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=l?r.popup_enabled_ios??r.popup_enabled:c?r.popup_enabled_web??r.popup_enabled:r.popup_enabled,h=l?r.popup_show_playstore_button_ios??r.popup_show_playstore_button:c?r.popup_show_playstore_button_web??r.popup_show_playstore_button:r.popup_show_playstore_button;return{enabled:!!d,title:l?r.popup_title_ios??r.popup_title??"":c?r.popup_title_web??r.popup_title??"":r.popup_title??"",message:l?r.popup_message_ios??r.popup_message??"":c?r.popup_message_web??r.popup_message??"":r.popup_message??"",buttonText:l?r.popup_button_text_ios??r.popup_button_text??"Entendido":c?r.popup_button_text_web??r.popup_button_text??"Entendido":r.popup_button_text??"Entendido",showPlayStoreButton:!!h,playStoreButtonText:l?r.popup_playstore_button_text_ios??r.popup_playstore_button_text??"Descargar App":c?r.popup_playstore_button_text_web??r.popup_playstore_button_text??"Descargar App":r.popup_playstore_button_text??"Descargar App",playStoreUrl:l?r.popup_playstore_url_ios??r.popup_playstore_url??"":c?r.popup_playstore_url_web??r.popup_playstore_url??"":r.popup_playstore_url??""}}console.log("[getPopupConfig] Usando estructura antigua...");const e=At(st,"config","app_settings"),t=await vn(e);if(t.exists()){const r=t.data(),a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=l?r.popup_enabled_ios??r.popup_enabled:c?r.popup_enabled_web??r.popup_enabled:r.popup_enabled,h=l?r.popup_show_playstore_button_ios??r.popup_show_playstore_button:c?r.popup_show_playstore_button_web??r.popup_show_playstore_button:r.popup_show_playstore_button;return{enabled:!!d,title:l?r.popup_title_ios??r.popup_title??"":c?r.popup_title_web??r.popup_title??"":r.popup_title??"",message:l?r.popup_message_ios??r.popup_message??"":c?r.popup_message_web??r.popup_message??"":r.popup_message??"",buttonText:l?r.popup_button_text_ios??r.popup_button_text??"Entendido":c?r.popup_button_text_web??r.popup_button_text??"Entendido":r.popup_button_text??"Entendido",showPlayStoreButton:!!h,playStoreButtonText:l?r.popup_playstore_button_text_ios??r.popup_playstore_button_text??"Descargar App":c?r.popup_playstore_button_text_web??r.popup_playstore_button_text??"Descargar App":r.popup_playstore_button_text??"Descargar App",playStoreUrl:l?r.popup_playstore_url_ios??r.popup_playstore_url??"":c?r.popup_playstore_url_web??r.popup_playstore_url??"":r.popup_playstore_url??""}}return{enabled:!1,title:"",message:"",buttonText:"Entendido"}}catch(n){return console.error("[getPopupConfig] Error:",n),{enabled:!1,title:"",message:"",buttonText:"Entendido"}}},AA=async()=>{try{const n="ca-app-pub-3940256099942544/6300978111",e="ca-app-pub-3940256099942544/1033173712",t="ca-app-pub-3940256099942544/5224354917";if(!Ft)return{enabled:!0,testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0,bannerId:n,interstitialId:e,rewardedVideoId:t};const r=await Ar();if(r&&r.admobSettings){console.log("[getAdMobConfig]  AdMob config desde config consolidada");const d=Ne.getPlatform()==="ios",h=r.admobSettings||{},m=d?h.test_mode_ios===!0||h.test_mode_ios==null&&h.test_mode===!0:h.test_mode_android===!0||h.test_mode_android==null&&h.test_mode===!0,g=d?h.ios_banner_id||h.banner_id||n:h.android_banner_id||h.banner_id||n,_=d?h.ios_interstitial_id||h.interstitial_id||e:h.android_interstitial_id||h.interstitial_id||e,v=d?h.ios_rewarded_video_id||h.rewarded_video_id||t:h.android_rewarded_video_id||h.rewarded_video_id||t;return{enabled:h.ads_enabled!==!1,testMode:m,interstitialCooldown:h.interstitial_cooldown_seconds?h.interstitial_cooldown_seconds*1e3:6e4,rewardedCooldown:h.rewarded_cooldown_seconds?h.rewarded_cooldown_seconds*1e3:3e4,showBanners:h.show_banners!==!1,showInterstitials:h.show_interstitials!==!1,showRewardedVideos:h.show_rewarded_videos!==!1,bannerId:m?n:g,interstitialId:m?e:_,rewardedVideoId:m?t:v}}console.log("[getAdMobConfig] Usando estructura antigua...");const a=At(st,"config","admob_settings"),l=await vn(a);if(l.exists()){const c=l.data(),d=Ne.getPlatform()==="ios",h=d?(c==null?void 0:c.test_mode_ios)===!0||(c==null?void 0:c.test_mode_ios)==null&&(c==null?void 0:c.test_mode)===!0:(c==null?void 0:c.test_mode_android)===!0||(c==null?void 0:c.test_mode_android)==null&&(c==null?void 0:c.test_mode)===!0;return{enabled:(c==null?void 0:c.ads_enabled)!==!1,testMode:h,interstitialCooldown:c!=null&&c.interstitial_cooldown_seconds?c.interstitial_cooldown_seconds*1e3:6e4,rewardedCooldown:c!=null&&c.rewarded_cooldown_seconds?c.rewarded_cooldown_seconds*1e3:3e4,showBanners:(c==null?void 0:c.show_banners)!==!1,showInterstitials:(c==null?void 0:c.show_interstitials)!==!1,showRewardedVideos:(c==null?void 0:c.show_rewarded_videos)!==!1,bannerId:h?n:d?(c==null?void 0:c.ios_banner_id)||n:(c==null?void 0:c.banner_id)||n,interstitialId:h?e:d?(c==null?void 0:c.ios_interstitial_id)||e:(c==null?void 0:c.interstitial_id)||e,rewardedVideoId:h?t:d?(c==null?void 0:c.ios_rewarded_video_id)||t:(c==null?void 0:c.rewarded_video_id)||t}}return{enabled:!0,testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0,bannerId:n,interstitialId:e,rewardedVideoId:t}}catch(n){return console.error("[getAdMobConfig] Error:",n),{enabled:!0,testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0,bannerId:"ca-app-pub-3940256099942544/6300978111",interstitialId:"ca-app-pub-3940256099942544/1033173712",rewardedVideoId:"ca-app-pub-3940256099942544/5224354917"}}},RA=async n=>{var e;try{if(!Ft)return{total:0,available:0,assigned:0};const t=await Ar(),r=((e=t==null?void 0:t.promo_codes)==null?void 0:e[n])||[];if(!Array.isArray(r)||r.length===0)return{total:0,available:0,assigned:0};let a=0,l=0,c=!1;if(r.forEach(h=>{const m=h.maxUses||0,g=h.usedCount||0;m===0?c=!0:(a+=m,l+=g)}),c)return{total:999999,available:999999,assigned:0};const d=a-l;return{total:a,available:d>0?d:0,assigned:l}}catch(t){return console.error("[getPromoCodesStats] Error:",t),{total:0,available:0,assigned:0}}},ug=async n=>{var e;try{const t=await Ar(),r=((e=t==null?void 0:t.promo_codes)==null?void 0:e[n])||[];if(console.log("[getValidEntryCodesForProduct]  Product:",n),console.log("[getValidEntryCodesForProduct]  Cdigos encontrados:",r.length),!Array.isArray(r))return console.warn("[getValidEntryCodesForProduct]  promo_codes no es array"),[];const a=r.map(l=>l==null?void 0:l.code).filter(l=>l&&typeof l=="string").map(l=>l.toUpperCase());return console.log("[getValidEntryCodesForProduct]  Cdigos:",a),a}catch(t){return console.error("[getValidEntryCodesForProduct] Error:",t),[]}},IA=async()=>{if(W.allPhrases.length>0){const n=Object.values(W.packPhrases).flat().length,e=W.allPhrases.filter(t=>t.isDemo).length;return console.log("[getPhraseCounters]  Usando contadores desde cach (0 lecturas)"),console.log("[getPhraseCounters]  Premium (packs):",n,"Demo:",e,"Free:",W.freePhrases.length),{totalPremiumPhrases:n,totalDemoPhrases:e,totalFreePhrases:W.freePhrases.length}}try{if(!Ft)return console.warn("[getPhraseCounters]  Firebase deshabilitado - usando valores por defecto"),{totalPremiumPhrases:161,totalDemoPhrases:26,totalFreePhrases:192};console.log("[getPhraseCounters]  Leyendo contador de frases gratuitas...");const n=At(st,"consolidated","phrases_free"),e=await vn(n);if(e.exists()){const r=e.data().phrases||[],a=r.filter(l=>l.isDemo).length;return console.log("[getPhraseCounters]  Contadores desde documento gratuitas (1 lectura)"),console.log("[getPhraseCounters]  Free:",r.length,"Demo:",a),{totalPremiumPhrases:0,totalDemoPhrases:a,totalFreePhrases:r.length}}return console.log("[getPhraseCounters]  No se encontr documento consolidado, usando valores estimados"),{totalPremiumPhrases:0,totalDemoPhrases:26,totalFreePhrases:192}}catch(n){return console.error("[getPhraseCounters]  Error al obtener contadores:",n),console.warn("[getPhraseCounters]  Usando valores de fallback"),{totalPremiumPhrases:0,totalDemoPhrases:26,totalFreePhrases:192}}},m2=async(n,e)=>{try{if(!Ft||!st){console.warn("[linkDeviceToUser] Firebase no habilitado");return}const t=At(st,"device_mappings",n);await da(t,{deviceId:n,firebaseUid:e,lastSeen:new Date,platform:typeof navigator<"u"?navigator.platform:"unknown",userAgent:typeof navigator<"u"?navigator.userAgent:"unknown"},{merge:!0}),console.log("[linkDeviceToUser]  Device vinculado a usuario:",{deviceId:n,firebaseUid:e})}catch(t){console.error("[linkDeviceToUser]  Error vinculando device:",t)}},p2=async(n,e)=>{try{if(!Ft||!st){console.warn("[updateUserProfile] Firebase no habilitado");return}const t=At(st,"users",n);await da(t,{deviceId:e,lastLogin:new Date,updatedAt:new Date},{merge:!0}),console.log("[updateUserProfile]  Perfil actualizado:",{firebaseUid:n,deviceId:e})}catch(t){console.error("[updateUserProfile]  Error actualizando perfil:",t)}},Ki=Object.freeze(Object.defineProperty({__proto__:null,addSuggestion:SA,fetchPhrases:EA,forceReloadConfig:wA,getAdMobConfig:AA,getAppSettings:u2,getFeatureFlags:c2,getPhraseCounters:IA,getPlayStoreUrl:d2,getPopupConfig:f2,getPremiumPromoMessage:bA,getPromoCodesStats:RA,getStoreProducts:Sy,getValidEntryCodesForProduct:ug,getWelcomeMessage:h2,incrementEntryCodeUsage:TA,linkDeviceToUser:m2,phraseCache:W,updatePhraseCache:ul,updateUserProfile:p2},Symbol.toStringTag,{value:"Module"}));class g2{constructor(){De(this,"counters",{totalPremiumPhrases:0,totalDemoPhrases:0,totalFreePhrases:0,isLoaded:!1})}async loadCounters(){try{console.log("[PhraseCounters] Cargando contadores desde Firebase...");const e=await IA();this.counters={...e,isLoaded:!0},console.log("[PhraseCounters] Contadores cargados:",this.counters)}catch(e){console.error("[PhraseCounters]  Error cargando contadores:",e),console.warn("[PhraseCounters]  Usando valores de fallback"),this.counters={totalPremiumPhrases:161,totalDemoPhrases:26,totalFreePhrases:100,isLoaded:!0},console.log("[PhraseCounters] Fallback aplicado:",this.counters)}}async getCounters(){return this.counters.isLoaded||await this.loadCounters(),{...this.counters}}getPremiumCount(){return this.counters.totalPremiumPhrases}getDemoCount(){return this.counters.totalDemoPhrases}isReady(){return this.counters.isLoaded}async refresh(){this.counters.isLoaded=!1,await this.loadCounters()}}const PA=new g2;var BS;(function(n){n.General="General",n.ParentalGuidance="ParentalGuidance",n.Teen="Teen",n.MatureAudience="MatureAudience"})(BS||(BS={}));var FS;(function(n){n.SizeChanged="bannerAdSizeChanged",n.Loaded="bannerAdLoaded",n.FailedToLoad="bannerAdFailedToLoad",n.Opened="bannerAdOpened",n.Closed="bannerAdClosed",n.AdImpression="bannerAdImpression"})(FS||(FS={}));var dg;(function(n){n.TOP_CENTER="TOP_CENTER",n.CENTER="CENTER",n.BOTTOM_CENTER="BOTTOM_CENTER"})(dg||(dg={}));var hg;(function(n){n.BANNER="BANNER",n.FULL_BANNER="FULL_BANNER",n.LARGE_BANNER="LARGE_BANNER",n.MEDIUM_RECTANGLE="MEDIUM_RECTANGLE",n.LEADERBOARD="LEADERBOARD",n.ADAPTIVE_BANNER="ADAPTIVE_BANNER",n.SMART_BANNER="SMART_BANNER"})(hg||(hg={}));var GS;(function(n){n.Loaded="interstitialAdLoaded",n.FailedToLoad="interstitialAdFailedToLoad",n.Showed="interstitialAdShowed",n.FailedToShow="interstitialAdFailedToShow",n.Dismissed="interstitialAdDismissed"})(GS||(GS={}));var HS;(function(n){n.Loaded="onRewardedInterstitialAdLoaded",n.FailedToLoad="onRewardedInterstitialAdFailedToLoad",n.Showed="onRewardedInterstitialAdShowed",n.FailedToShow="onRewardedInterstitialAdFailedToShow",n.Dismissed="onRewardedInterstitialAdDismissed",n.Rewarded="onRewardedInterstitialAdReward"})(HS||(HS={}));var $S;(function(n){n.Loaded="onRewardedVideoAdLoaded",n.FailedToLoad="onRewardedVideoAdFailedToLoad",n.Showed="onRewardedVideoAdShowed",n.FailedToShow="onRewardedVideoAdFailedToShow",n.Dismissed="onRewardedVideoAdDismissed",n.Rewarded="onRewardedVideoAdReward"})($S||($S={}));var qS;(function(n){n.NOT_REQUIRED="NOT_REQUIRED",n.OBTAINED="OBTAINED",n.REQUIRED="REQUIRED",n.UNKNOWN="UNKNOWN"})(qS||(qS={}));var YS;(function(n){n[n.DISABLED=0]="DISABLED",n[n.EEA=1]="EEA",n[n.NOT_EEA=2]="NOT_EEA",n[n.US=3]="US",n[n.OTHER=4]="OTHER"})(YS||(YS={}));const Di=er("AdMob",{web:()=>Yt(()=>import("./web-BkTtXU4_.js"),[]).then(n=>new n.AdMobWeb)}),CA="@firebase/installations",wy="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=1e4,OA=`w:${wy}`,xA="FIS_v2",y2="https://firebaseinstallations.googleapis.com/v1",_2=3600*1e3,v2="installations",E2="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},to=new ro(v2,E2,S2);function DA(n){return n instanceof Vi&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA({projectId:n}){return`${y2}/projects/${n}/installations`}function MA(n){return{token:n.token,requestStatus:2,expiresIn:b2(n.expiresIn),creationTime:Date.now()}}async function LA(n,e){const r=(await e.json()).error;return to.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function UA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function w2(n,{refreshToken:e}){const t=UA(n);return t.append("Authorization",T2(e)),t}async function VA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function b2(n){return Number(n.replace("s","000"))}function T2(n){return`${xA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A2({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=kA(n),a=UA(n),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={fid:t,authVersion:xA,appId:n.appId,sdkVersion:OA},d={method:"POST",headers:a,body:JSON.stringify(c)},h=await VA(()=>fetch(r,d));if(h.ok){const m=await h.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:MA(m.authToken)}}else throw await LA("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=/^[cdef][\w-]{21}$/,fg="";function P2(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=C2(n);return I2.test(t)?t:fg}catch{return fg}}function C2(n){return R2(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA=new Map;function BA(n,e){const t=lf(n);FA(t,e),N2(t,e)}function FA(n,e){const t=zA.get(n);if(t)for(const r of t)r(e)}function N2(n,e){const t=O2();t&&t.postMessage({key:n,fid:e}),x2()}let Wa=null;function O2(){return!Wa&&"BroadcastChannel"in self&&(Wa=new BroadcastChannel("[Firebase] FID Change"),Wa.onmessage=n=>{FA(n.data.key,n.data.fid)}),Wa}function x2(){zA.size===0&&Wa&&(Wa.close(),Wa=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2="firebase-installations-database",k2=1,no="firebase-installations-store";let Pp=null;function by(){return Pp||(Pp=Lw(D2,k2,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(no)}}})),Pp}async function Mh(n,e){const t=lf(n),a=(await by()).transaction(no,"readwrite"),l=a.objectStore(no),c=await l.get(t);return await l.put(e,t),await a.done,(!c||c.fid!==e.fid)&&BA(n,e.fid),e}async function GA(n){const e=lf(n),r=(await by()).transaction(no,"readwrite");await r.objectStore(no).delete(e),await r.done}async function cf(n,e){const t=lf(n),a=(await by()).transaction(no,"readwrite"),l=a.objectStore(no),c=await l.get(t),d=e(c);return d===void 0?await l.delete(t):await l.put(d,t),await a.done,d&&(!c||c.fid!==d.fid)&&BA(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ty(n){let e;const t=await cf(n.appConfig,r=>{const a=M2(r),l=L2(n,a);return e=l.registrationPromise,l.installationEntry});return t.fid===fg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function M2(n){const e=n||{fid:P2(),registrationStatus:0};return HA(e)}function L2(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(to.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=U2(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:V2(n)}:{installationEntry:e}}async function U2(n,e){try{const t=await A2(n,e);return Mh(n.appConfig,t)}catch(t){throw DA(t)&&t.customData.serverCode===409?await GA(n.appConfig):await Mh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function V2(n){let e=await KS(n.appConfig);for(;e.registrationStatus===1;)await jA(100),e=await KS(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await Ty(n);return r||t}return e}function KS(n){return cf(n,e=>{if(!e)throw to.create("installation-not-found");return HA(e)})}function HA(n){return j2(n)?{fid:n.fid,registrationStatus:0}:n}function j2(n){return n.registrationStatus===1&&n.registrationTime+NA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z2({appConfig:n,heartbeatServiceProvider:e},t){const r=B2(n,t),a=w2(n,t),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={installation:{sdkVersion:OA,appId:n.appId}},d={method:"POST",headers:a,body:JSON.stringify(c)},h=await VA(()=>fetch(r,d));if(h.ok){const m=await h.json();return MA(m)}else throw await LA("Generate Auth Token",h)}function B2(n,{fid:e}){return`${kA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ay(n,e=!1){let t;const r=await cf(n.appConfig,l=>{if(!$A(l))throw to.create("not-registered");const c=l.authToken;if(!e&&H2(c))return l;if(c.requestStatus===1)return t=F2(n,e),l;{if(!navigator.onLine)throw to.create("app-offline");const d=q2(l);return t=G2(n,d),d}});return t?await t:r.authToken}async function F2(n,e){let t=await WS(n.appConfig);for(;t.authToken.requestStatus===1;)await jA(100),t=await WS(n.appConfig);const r=t.authToken;return r.requestStatus===0?Ay(n,e):r}function WS(n){return cf(n,e=>{if(!$A(e))throw to.create("not-registered");const t=e.authToken;return Y2(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function G2(n,e){try{const t=await z2(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await Mh(n.appConfig,r),t}catch(t){if(DA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await GA(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Mh(n.appConfig,r)}throw t}}function $A(n){return n!==void 0&&n.registrationStatus===2}function H2(n){return n.requestStatus===2&&!$2(n)}function $2(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+_2}function q2(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function Y2(n){return n.requestStatus===1&&n.requestTime+NA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K2(n){const e=n,{installationEntry:t,registrationPromise:r}=await Ty(e);return r?r.catch(console.error):Ay(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W2(n,e=!1){const t=n;return await Q2(t),(await Ay(t,e)).token}async function Q2(n){const{registrationPromise:e}=await Ty(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X2(n){if(!n||!n.options)throw Cp("App Configuration");if(!n.name)throw Cp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Cp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Cp(n){return to.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA="installations",J2="installations-internal",Z2=n=>{const e=n.getProvider("app").getImmediate(),t=X2(e),r=ma(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},ek=n=>{const e=n.getProvider("app").getImmediate(),t=ma(e,qA).getImmediate();return{getId:()=>K2(t),getToken:a=>W2(t,a)}};function tk(){Xi(new Ui(qA,Z2,"PUBLIC")),Xi(new Ui(J2,ek,"PRIVATE"))}tk();ri(CA,wy);ri(CA,wy,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="analytics",nk="firebase_id",ik="origin",rk=60*1e3,sk="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ry="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new jh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},_i=new ro("analytics","Analytics",ak);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(n){if(!n.startsWith(Ry)){const e=_i.create("invalid-gtag-resource",{gtagURL:n});return si.warn(e.message),""}return n}function YA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function lk(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function ck(n,e){const t=lk("firebase-js-sdk-policy",{createScriptURL:ok}),r=document.createElement("script"),a=`${Ry}?l=${n}&id=${e}`;r.src=t?t==null?void 0:t.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function uk(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function dk(n,e,t,r,a,l){const c=r[a];try{if(c)await e[c];else{const h=(await YA(t)).find(m=>m.measurementId===a);h&&await e[h.appId]}}catch(d){si.error(d)}n("config",a,l)}async function hk(n,e,t,r,a){try{let l=[];if(a&&a.send_to){let c=a.send_to;Array.isArray(c)||(c=[c]);const d=await YA(t);for(const h of c){const m=d.find(_=>_.measurementId===h),g=m&&e[m.appId];if(g)l.push(g);else{l=[];break}}}l.length===0&&(l=Object.values(e)),await Promise.all(l),n("event",r,a||{})}catch(l){si.error(l)}}function fk(n,e,t,r){async function a(l,...c){try{if(l==="event"){const[d,h]=c;await hk(n,e,t,d,h)}else if(l==="config"){const[d,h]=c;await dk(n,e,t,r,d,h)}else if(l==="consent"){const[d,h]=c;n("consent",d,h)}else if(l==="get"){const[d,h,m]=c;n("get",d,h,m)}else if(l==="set"){const[d]=c;n("set",d)}else n(l,...c)}catch(d){si.error(d)}}return a}function mk(n,e,t,r,a){let l=function(...c){window[r].push(arguments)};return window[a]&&typeof window[a]=="function"&&(l=window[a]),window[a]=fk(l,n,e,t),{gtagCore:l,wrappedGtag:window[a]}}function pk(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Ry)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=30,yk=1e3;class _k{constructor(e={},t=yk){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const KA=new _k;function vk(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function Ek(n){var e;const{appId:t,apiKey:r}=n,a={method:"GET",headers:vk(r)},l=sk.replace("{app-id}",t),c=await fetch(l,a);if(c.status!==200&&c.status!==304){let d="";try{const h=await c.json();!((e=h.error)===null||e===void 0)&&e.message&&(d=h.error.message)}catch{}throw _i.create("config-fetch-failed",{httpStatus:c.status,responseMessage:d})}return c.json()}async function Sk(n,e=KA,t){const{appId:r,apiKey:a,measurementId:l}=n.options;if(!r)throw _i.create("no-app-id");if(!a){if(l)return{measurementId:l,appId:r};throw _i.create("no-api-key")}const c=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new Tk;return setTimeout(async()=>{d.abort()},rk),WA({appId:r,apiKey:a,measurementId:l},c,d,e)}async function WA(n,{throttleEndTimeMillis:e,backoffCount:t},r,a=KA){var l;const{appId:c,measurementId:d}=n;try{await wk(r,e)}catch(h){if(d)return si.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:c,measurementId:d};throw h}try{const h=await Ek(n);return a.deleteThrottleMetadata(c),h}catch(h){const m=h;if(!bk(m)){if(a.deleteThrottleMetadata(c),d)return si.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:c,measurementId:d};throw h}const g=Number((l=m==null?void 0:m.customData)===null||l===void 0?void 0:l.httpStatus)===503?cE(t,a.intervalMillis,gk):cE(t,a.intervalMillis),_={throttleEndTimeMillis:Date.now()+g,backoffCount:t+1};return a.setThrottleMetadata(c,_),si.debug(`Calling attemptFetch again in ${g} millis`),WA(n,_,r,a)}}function wk(n,e){return new Promise((t,r)=>{const a=Math.max(e-Date.now(),0),l=setTimeout(t,a);n.addEventListener(()=>{clearTimeout(l),r(_i.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function bk(n){if(!(n instanceof Vi)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Tk{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Ak(n,e,t,r,a){if(a&&a.global){n("event",t,r);return}else{const l=await e,c=Object.assign(Object.assign({},r),{send_to:l});n("event",t,c)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rk(){if(xw())try{await Dw()}catch(n){return si.warn(_i.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return si.warn(_i.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Ik(n,e,t,r,a,l,c){var d;const h=Sk(n);h.then(T=>{t[T.measurementId]=T.appId,n.options.measurementId&&T.measurementId!==n.options.measurementId&&si.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${T.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(T=>si.error(T)),e.push(h);const m=Rk().then(T=>{if(T)return r.getId()}),[g,_]=await Promise.all([h,m]);pk(l)||ck(l,g.measurementId),a("js",new Date);const v=(d=c==null?void 0:c.config)!==null&&d!==void 0?d:{};return v[ik]="firebase",v.update=!0,_!=null&&(v[nk]=_),a("config",g.measurementId,v),g.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.app=e}_delete(){return delete Bc[this.app.options.appId],Promise.resolve()}}let Bc={},QS=[];const XS={};let Np="dataLayer",Ck="gtag",JS,QA,ZS=!1;function Nk(){const n=[];if(Ow()&&n.push("This is a browser extension environment."),hP()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,a)=>`(${a+1}) ${r}`).join(" "),t=_i.create("invalid-analytics-context",{errorInfo:e});si.warn(t.message)}}function Ok(n,e,t){Nk();const r=n.options.appId;if(!r)throw _i.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)si.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw _i.create("no-api-key");if(Bc[r]!=null)throw _i.create("already-exists",{id:r});if(!ZS){uk(Np);const{wrappedGtag:l,gtagCore:c}=mk(Bc,QS,XS,Np,Ck);QA=l,JS=c,ZS=!0}return Bc[r]=Ik(n,QS,XS,e,JS,Np,t),new Pk(n)}function xk(n=wg()){n=nn(n);const e=ma(n,Lh);return e.isInitialized()?e.getImmediate():Dk(n)}function Dk(n,e={}){const t=ma(n,Lh);if(t.isInitialized()){const a=t.getImmediate();if(ra(e,t.getOptions()))return a;throw _i.create("already-initialized")}return t.initialize({options:e})}function XA(n,e,t,r){n=nn(n),Ak(QA,Bc[n.app.options.appId],e,t,r).catch(a=>si.error(a))}const ew="@firebase/analytics",tw="0.10.17";function kk(){Xi(new Ui(Lh,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return Ok(r,a,t)},"PUBLIC")),Xi(new Ui("analytics-internal",n,"PRIVATE")),ri(ew,tw),ri(ew,tw,"esm2017");function n(e){try{const t=e.getProvider(Lh).getImmediate();return{logEvent:(r,a,l)=>XA(t,r,a,l)}}catch(t){throw _i.create("interop-component-reg-failed",{reason:t})}}}kk();let mg=null,oh=!1;const Mk=n=>{try{if(!Ft){console.warn("[Analytics] Firebase no est habilitado");return}Ne.getPlatform()==="web"?(mg=xk(n),oh=!0,console.log("[Analytics]  Inicializado para Web")):(console.log("[Analytics]  En plataforma nativa, Analytics se maneja por el SDK nativo"),oh=!1)}catch(e){console.error("[Analytics]  Error inicializando:",e),oh=!1}},vi=(n,e)=>{try{if(!oh||!mg){console.log("[Analytics] Event (not tracked - web only):",n,e);return}XA(mg,n,e),console.log("[Analytics]  Event tracked:",n,e)}catch(t){console.error("[Analytics]  Error tracking event:",t)}},Lk=()=>{vi("app_open")},nw=n=>{vi("screen_view",{screen_name:n,screen_class:n})},Uk=n=>{vi("game_start",{include_adult:n.includeAdult||!1,adult_only:n.adultOnly||!1,has_premium:n.hasPremium||!1})},Vk=n=>{vi("game_end",{phrases_played:n.phrasesPlayed,duration_seconds:n.duration||0,include_adult:n.includeAdult||!1})},iw=n=>{vi("game_completion",{is_premium:n.isPremium,is_adult:n.isAdult})},rw=n=>{vi("ad_shown",{ad_type:n})},jk=(n,e)=>{vi("begin_checkout",{product_id:n,product_type:e})},Gd=n=>{vi("purchase",{transaction_id:`${Date.now()}_${n.productId}`,value:n.price||0,currency:n.currency||"EUR",items:[{item_id:n.productId,item_name:n.productType,price:n.price||0}]})},zk=n=>{vi("purchase_restored",{product_count:n})},Bk=()=>{vi("phrase_suggested")},Fk=()=>{vi("store_opened")},sw={banner:.15,interstitial:2.5,rewarded:4,fillRate:{banner:.85,interstitial:.75,rewarded:.8}},aw=async n=>{try{if(!Ft||!st){console.log("[RevenueAnalytics] Firebase no habilitado");return}const e=sw.fillRate[n],t=sw[n],r=t/1e3*e,a=new Date().toISOString().split("T")[0],l=localStorage.getItem("firebase_uid")||"anonymous",c=At(st,"analytics_revenue",a,"users",l);await da(c,{[`ads.${n}.impressions`]:ki(1),[`ads.${n}.revenue`]:ki(r),lastUpdate:Xc()},{merge:!0});const d=At(st,"analytics_revenue",a);await da(d,{[`ads.${n}.impressions`]:ki(1),[`ads.${n}.revenue`]:ki(r),totalAdRevenue:ki(r),lastUpdate:Xc()},{merge:!0}),vi("ad_impression_revenue",{ad_type:n,estimated_revenue_eur:r,ecpm:t,fill_rate:e}),console.log(`[RevenueAnalytics]  Ad revenue tracked: ${n} = ${r.toFixed(4)}`)}catch(e){console.error("[RevenueAnalytics]  Error tracking ad revenue:",e)}},Gk=async n=>{try{if(!Ft||!st){console.log("[RevenueAnalytics] Firebase no habilitado");return}const e=new Date().toISOString().split("T")[0],t=localStorage.getItem("firebase_uid")||"anonymous",r=.3,a=n.price*(1-r),l=At(st,"analytics_revenue",e,"users",t);await da(l,{"purchases.transactions":ki(1),"purchases.grossRevenue":ki(n.price),"purchases.netRevenue":ki(a),lastUpdate:Xc()},{merge:!0});const c=At(st,"analytics_revenue",e);await da(c,{"purchases.transactions":ki(1),"purchases.grossRevenue":ki(n.price),"purchases.netRevenue":ki(a),totalPurchaseRevenue:ki(a),lastUpdate:Xc()},{merge:!0}),vi("purchase_revenue",{product_id:n.productId,product_type:n.productType,gross_revenue:n.price,net_revenue:a,currency:n.currency,google_play_commission:n.price*r}),console.log(`[RevenueAnalytics]  Purchase revenue tracked: ${n.productId} = ${a.toFixed(2)} (after 30% Google commission)`)}catch(e){console.error("[RevenueAnalytics]  Error tracking purchase revenue:",e)}};class Hk{constructor(){De(this,"config");De(this,"isInitialized",!1);De(this,"isInitializing",!1);De(this,"initPromise",null);De(this,"lastInterstitialTime",0);De(this,"lastRewardedVideoTime",0);De(this,"INTERSTITIAL_COOLDOWN",6e4);De(this,"REWARDED_COOLDOWN",3e4);De(this,"interstitialReady",!1);De(this,"rewardedVideoReady",!1);De(this,"TEST_REWARDED_ID","ca-app-pub-3940256099942544/5224354917");this.config={enabled:!0,interstitialId:"ca-app-pub-3940256099942544/1033173712",rewardedVideoId:"ca-app-pub-3940256099942544/5224354917",bannerId:"ca-app-pub-3940256099942544/6300978111",testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0}}async loadAdMobConfig(){try{console.log("[AdService] Cargando configuracin de Firebase...");const e=await AA();this.config.enabled=e.enabled,this.config.interstitialId=e.interstitialId,this.config.rewardedVideoId=e.rewardedVideoId,this.config.bannerId=e.bannerId,this.config.testMode=e.testMode,this.config.interstitialCooldown=e.interstitialCooldown,this.config.rewardedCooldown=e.rewardedCooldown,this.config.showBanners=e.showBanners,this.config.showInterstitials=e.showInterstitials,this.config.showRewardedVideos=e.showRewardedVideos,this.INTERSTITIAL_COOLDOWN=e.interstitialCooldown,this.REWARDED_COOLDOWN=e.rewardedCooldown,console.log("[AdService]  Configuracin de AdMob cargada:",this.config),this.config.testMode&&(this.config.enabled=!0,this.config.showBanners=!0,this.config.showInterstitials=!0,this.config.showRewardedVideos=!0)}catch(e){console.warn("[AdService]  Error cargando configuracin de Firebase, usando valores por defecto:",e)}}async ensureInitialized(){return this.isInitialized?!0:this.isInitializing&&this.initPromise?this.initPromise:this.initialize()}async initialize(){return this.isInitializing&&this.initPromise?this.initPromise:this.isInitialized?!0:(this.isInitializing=!0,this.initPromise=(async()=>{console.log("[AdService] Iniciando inicializacin...");try{const e=Ne.getPlatform();if(console.log("[AdService] Platform detectada:",e),e==="web")return console.log("[AdService] Platform web - modo simulacin activado"),this.isInitialized=!0,!0;try{await this.loadAdMobConfig()}catch{console.warn("[AdService] Continuando sin configuracin de Firebase")}try{if(await Di.initialize({initializeForTesting:this.config.testMode}),e==="ios")try{await Di.requestTrackingAuthorization()}catch(r){console.warn("[AdService] Tracking authorization no disponible:",r)}console.log("[AdService]  AdMob iniciado correctamente")}catch(r){return console.error("[AdService]  Error iniciando AdMob:",r),this.isInitialized=!0,!1}return console.log("[AdService] Preparando anuncios..."),(await Promise.allSettled([this.prepareInterstitial(),this.prepareRewardedVideo()])).forEach((r,a)=>{const l=a===0?"Intersticial":"Video recompensado";r.status==="fulfilled"?console.log(`[AdService]  ${l} preparado`):console.warn(`[AdService]  ${l} no se pudo preparar:`,r.reason)}),this.isInitialized=!0,!0}catch(e){return console.error("[AdService]  Error crtico inicializando:",e),this.isInitialized=!0,!1}finally{this.isInitializing=!1,this.initPromise=null}})(),this.initPromise)}async prepareInterstitial(){try{const e={adId:this.config.testMode?"ca-app-pub-3940256099942544/1033173712":this.config.interstitialId,isTesting:this.config.testMode};await Di.prepareInterstitial(e),this.interstitialReady=!0}catch(e){throw console.warn("[AdService] Error preparando intersticial:",e),this.interstitialReady=!1,e}}async prepareRewardedVideo(){try{const e={adId:this.config.testMode?this.TEST_REWARDED_ID:this.config.rewardedVideoId,isTesting:this.config.testMode};await Di.prepareRewardVideoAd(e),this.rewardedVideoReady=!0}catch(e){throw console.warn("[AdService] Error preparando video recompensado:",e),this.rewardedVideoReady=!1,e}}async showEndGameInterstitial(e){console.log("[AdService]  Intentando mostrar intersticial fin de partida");try{if(!await this.ensureInitialized())return{success:!1,error:"Servicio no disponible"};const r=this.config.testMode===!0;return!this.config.enabled&&!r?{success:!1,error:"Anuncios deshabilitados"}:!this.config.showInterstitials&&!r?{success:!1,error:"Intersticiales deshabilitados"}:!(e!=null&&e.force)&&!this.canShowInterstitial()?{success:!1,error:"Intersticial en cooldown"}:Ne.getPlatform()==="web"?(await this.simulateWebAd("intersticial"),this.lastInterstitialTime=Date.now(),{success:!0}):(this.interstitialReady||await this.prepareInterstitial(),await Di.showInterstitial(),rw("interstitial"),aw("interstitial"),this.lastInterstitialTime=Date.now(),this.interstitialReady=!1,setTimeout(()=>this.prepareInterstitial().catch(console.warn),1e3),{success:!0})}catch(t){return console.error("[AdService]  Error mostrando intersticial:",t),{success:!1,error:String(t)}}}async showPremiumDemoRewardedVideo(){console.log("[AdService]  Intentando mostrar video recompensado");try{if(!await this.ensureInitialized())return{success:!1,error:"Servicio no disponible"};const t=this.config.testMode===!0;if(!this.config.enabled&&!t)return{success:!1,error:"Anuncios deshabilitados"};if(!this.config.showRewardedVideos&&!t)return{success:!1,error:"Videos recompensados deshabilitados"};if(!this.canShowRewardedVideo())return{success:!1,error:"Video en cooldown"};if(Ne.getPlatform()==="web")return await this.simulateWebAd("video recompensado"),this.lastRewardedVideoTime=Date.now(),{success:!0,rewarded:!0};this.rewardedVideoReady||await this.prepareRewardedVideo();const r=await Di.showRewardVideoAd();return rw("rewarded"),aw("rewarded"),this.lastRewardedVideoTime=Date.now(),this.rewardedVideoReady=!1,setTimeout(()=>this.prepareRewardedVideo().catch(console.warn),1e3),{success:!0,rewarded:r&&r.amount>0}}catch(e){return console.error("[AdService]  Error mostrando video recompensado:",e),{success:!1,error:String(e)}}}canShowInterstitial(){return this.config.testMode?!0:Date.now()-this.lastInterstitialTime>=this.INTERSTITIAL_COOLDOWN}canShowRewardedVideo(){return this.config.testMode?!0:Date.now()-this.lastRewardedVideoTime>=this.REWARDED_COOLDOWN}simulateWebAd(e){return new Promise(t=>{console.log(`[AdService]  Simulando ${e} en web (3s)...`),setTimeout(()=>{console.log(`[AdService]  ${e} simulado completado`),t()},3e3)})}async showBanner(){if(console.log("[AdService]  Intentando mostrar banner"),Ne.getPlatform()==="web"){console.log("[AdService] Banner no soportado en web");return}try{if(!await this.ensureInitialized())return;const t=this.config.testMode===!0;if(!this.config.enabled&&!t||!this.config.showBanners&&!t)return;const r={adId:this.config.testMode?this.config.bannerId:this.config.bannerId,adSize:hg.ADAPTIVE_BANNER,position:dg.BOTTOM_CENTER,margin:0,isTesting:this.config.testMode};await Di.showBanner(r),console.log("[AdService]  Banner mostrado")}catch(e){console.error("[AdService]  Error mostrando banner:",e)}}async hideBanner(){if(Ne.getPlatform()!=="web")try{await Di.hideBanner(),console.log("[AdService]  Banner ocultado")}catch(e){console.warn("[AdService] Error ocultando banner:",e)}}async removeBanner(){if(Ne.getPlatform()!=="web")try{await Di.removeBanner(),console.log("[AdService]  Banner eliminado")}catch(e){console.warn("[AdService] Error eliminando banner:",e)}}async retryLoadAdsAfterConnectionRestored(){if(!(Ne.getPlatform()==="web"||!await this.ensureInitialized())){try{await this.loadAdMobConfig()}catch{}try{(await Promise.allSettled([this.prepareInterstitial(),this.prepareRewardedVideo()])).forEach((a,l)=>{const c=l===0?"Intersticial":"Video recompensado";a.status==="fulfilled"?console.log(`[AdService]  ${c} preparado tras reconexin`):console.warn(`[AdService]  ${c} no se pudo preparar tras reconexin:`,a.reason)})}catch(r){console.warn("[AdService]  Error reintentando preparacin de anuncios:",r)}}}}const wr=new Hk;var yt=(n=>(n.Home="HOME",n.Game="GAME",n.Store="STORE",n))(yt||{});const Kt=({children:n,variant:e="primary",size:t="normal",fullWidth:r=!1,shimmerVariant:a="default",className:l="",...c})=>{const[d,h]=te.useState(!1),m=L=>{c.disabled||(h(!0),setTimeout(()=>h(!1),400),c.onClick&&c.onClick(L))},g="font-bold rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 flex items-center justify-center relative overflow-hidden",_={primary:"bg-gradient-to-r from-cyan-500 to-pink-500 text-white hover:opacity-90 hover:shadow-2xl shadow-lg shadow-cyan-500/20 disabled:opacity-50 disabled:cursor-not-allowed focus:ring-cyan-400 hover:scale-105 active:scale-95",secondary:"bg-slate-700 text-slate-200 hover:bg-slate-600 border border-slate-600 disabled:opacity-50 disabled:cursor-not-allowed focus:ring-slate-500 hover:scale-105 active:scale-95",custom:""},v={normal:"py-2 px-4 text-base",large:"py-3 px-6 text-lg"},T=r?"w-full":"w-auto",I=d?e==="primary"?"animate-button-press":"animate-button-press-secondary":"",A=!c.disabled&&!d&&e==="primary"?"button-idle-pulse button-idle-glow":"",C=`${g} ${_[e]} ${v[t]} ${T} ${I} ${A} ${l}`;return S.jsxs("button",{className:C,...c,onClick:m,children:[S.jsx("span",{className:"relative z-10",children:n}),e==="primary"&&!c.disabled&&S.jsx("span",{className:`absolute inset-0 ${a==="discount"?"shimmer-effect-discount opacity-20 hover:opacity-60":"shimmer-effect opacity-0 hover:opacity-100"} transition-opacity duration-500 pointer-events-none`})]})},$k=er("Network",{web:()=>Yt(()=>import("./web-B97FsCxv.js"),[]).then(n=>new n.NetworkWeb)}),qk={BASE_URL:"/games/yo-nunca/play/",DEV:!1,MODE:"web",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"pro",VITE_DEBUG_OVERLAY:"false",VITE_FIREBASE_API_KEY:"AIzaSyBx7eIcSrFFQ-TAaGM1DQJ1GNcHc1wDHkg",VITE_FIREBASE_APP_ID:"1:814751987159:web:5849912e1b43a82899c792",VITE_FIREBASE_AUTH_DOMAIN:"yo-nunca-85b0c.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"814751987159",VITE_FIREBASE_PROJECT_ID:"yo-nunca-85b0c",VITE_FIREBASE_STORAGE_BUCKET:"yo-nunca-85b0c.firebasestorage.app",VITE_MOBAPP_APP_ID:"ca-app-pub-9300246128306730~3854820499",VITE_MOBAPP_BANNER_ID:"ca-app-pub-9300246128306730/2896321418",VITE_MOBAPP_INTERSTITIAL_ID:"ca-app-pub-9300246128306730/6309593444",VITE_STRIPE_PUBLIC_KEY:"pk_live_51SD6NXIJBts2wisdy1ExsCAvJ4hpKT6JwNgC1eUHZVC9KDSWRyby1LPmewZRb9gOLoGJVicGJzSHn01VDHKyK2Tn00NaZXZ2Aa"};class Yk{constructor(){De(this,"OFFLINE_GAMES_PER_DAY",1);De(this,"OFFLINE_PHRASES_LIMIT",15);De(this,"PREMIUM_PHRASES_LIMIT",30);De(this,"STORAGE_KEY","offline_game_data");De(this,"CONNECTION_CACHE_KEY","connection_status_cache");De(this,"CONNECTION_CHECK_INTERVAL",6e4);De(this,"CONNECTION_CACHE_TTL",3e4);De(this,"connectionCheckInterval",null);De(this,"lastConnectionStatus",!0);De(this,"onConnectionLostCallback",null);De(this,"onConnectionRestoredCallback",null);De(this,"connectionCache",null)}async canPlayOffline(e,t=!1,r){console.log("[OfflineService]  Verificando permiso para jugar offline..."),console.log("[OfflineService] Usuario con remove_ads?:",e),console.log("[OfflineService] Es continuacin?:",t);const a=(r==null?void 0:r.ownedPackIds)||[],l=Array.isArray(r==null?void 0:r.storeProducts)?r==null?void 0:r.storeProducts:[];let c=!1;if(l.length>0&&a.length>0)try{c=l.filter(_=>(_==null?void 0:_.grantsUnlimitedOffline)&&a.includes(_.productId)).length>0}catch(g){console.warn("[OfflineService]  Error evaluando grantsUnlimitedOffline:",g)}if(console.log("[OfflineService] Tiene offline ilimitado por pack?:",c),e||c)return console.log("[OfflineService]  Usuario con privilegios de offline ilimitado"),{allowed:!0,remaining:-1,phrasesLimit:c?this.PREMIUM_PHRASES_LIMIT:this.PREMIUM_PHRASES_LIMIT};if(await this.checkConnection(!0)&&!(r!=null&&r.forceRecalcUnlimited))return console.log("[OfflineService]  Tiene conexin - puede jugar online"),{allowed:!0,remaining:-1,phrasesLimit:this.PREMIUM_PHRASES_LIMIT};const h=this.getOfflineGameData();if(h.currentGameStarted&&!t)return console.log("[OfflineService]  Ya tiene una partida offline en curso (no es continuacin)"),{allowed:!1,remaining:0,reason:"Ya has agotado tu lmite de partidas offline por da. Compra el pack sin anuncios para poder jugar offline de forma ilimitada.",phrasesLimit:this.OFFLINE_PHRASES_LIMIT};if(h.currentGameStarted&&t)return console.log("[OfflineService]  Continuando partida offline existente"),{allowed:!0,remaining:this.OFFLINE_GAMES_PER_DAY-h.gamesPlayed,phrasesLimit:this.OFFLINE_PHRASES_LIMIT};const m=this.OFFLINE_GAMES_PER_DAY-h.gamesPlayed;return m>0?(console.log("[OfflineService]  Puede iniciar partida offline:",m,"restante(s)"),{allowed:!0,remaining:m,phrasesLimit:this.OFFLINE_PHRASES_LIMIT}):(console.log("[OfflineService]  Lmite de partidas offline alcanzado"),{allowed:!1,remaining:0,reason:"Ya usaste tu partida offline diaria. Vuelve maana o desbloquea el Pack Sin Anuncios.",phrasesLimit:this.OFFLINE_PHRASES_LIMIT})}markOfflineGameStarted(){console.log("[OfflineService]  Marcando partida offline como iniciada (anti-fraude)");const e=this.getOfflineGameData();e.currentGameStarted=!0,e.currentGameStartTime=Date.now(),e.currentGamePhrasesPlayed=0,this.saveOfflineGameData(e),console.log("[OfflineService]  Partida offline marcada - no puede reiniciar hasta completar")}incrementOfflinePhrasesPlayed(){const e=this.getOfflineGameData();if(!e.currentGameStarted){console.warn("[OfflineService]  No hay partida offline en curso");return}e.currentGamePhrasesPlayed++,this.saveOfflineGameData(e),console.log(`[OfflineService]  Frase offline jugada: ${e.currentGamePhrasesPlayed}/${this.OFFLINE_PHRASES_LIMIT}`)}markOfflineGameCompleted(){console.log("[OfflineService]  Marcando partida offline como completada");const e=this.getOfflineGameData();e.gamesPlayed=1,e.currentGameStarted=!1,e.currentGameStartTime=0,e.currentGamePhrasesPlayed=0,this.saveOfflineGameData(e),console.log("[OfflineService]  Partida offline completada - no puede jugar ms hasta maana")}hasActiveOfflineGame(){return this.getOfflineGameData().currentGameStarted}getOfflineGameProgress(){return{current:this.getOfflineGameData().currentGamePhrasesPlayed,total:this.OFFLINE_PHRASES_LIMIT}}isOfflineGameLimitReached(){return this.getOfflineGameData().currentGamePhrasesPlayed>=this.OFFLINE_PHRASES_LIMIT}async checkConnection(e=!1){try{const t=typeof import.meta<"u"&&qk&&!1;if(!e&&this.connectionCache){const l=Date.now()-this.connectionCache.timestamp;if(l<this.CONNECTION_CACHE_TTL)return console.log(`[OfflineService]  Usando cache de conexin (${l}ms): ${this.connectionCache.connected}`),this.connectionCache.connected}console.log("[OfflineService]  Verificando conexin a internet (check real)...");const r=await $k.getStatus();if(console.log("[OfflineService]  Estado de red del dispositivo:",{connected:r.connected,connectionType:r.connectionType}),!r.connected)return console.log("[OfflineService]  Sin conexin de red (dispositivo)"),this.updateConnectionCache(!1,"network"),!1;const a=await this.verifyRealConnection();return console.log("[OfflineService]  Verificacin real:",a?" OK":" FAIL"),this.updateConnectionCache(a,"fetch"),a}catch(t){return console.error("[OfflineService] Error verificando conexin:",t),this.updateConnectionCache(!1,"error"),!1}}async verifyRealConnection(){const e=["https://www.gstatic.com/generate_204","https://www.google.com/favicon.ico","https://1.1.1.1"],t=e.map(r=>this.fetchWithTimeout(r,4e3).then(()=>!0).catch(()=>!1));try{const a=(await Promise.all(t)).filter(c=>c).length,l=a>=2;return console.log("[OfflineService]  Endpoints OK:",a,"/",e.length),l}catch(r){return console.error("[OfflineService] Error en verificacin mltiple:",r),!1}}async fetchWithTimeout(e,t){const r=new AbortController,a=setTimeout(()=>r.abort(),t);try{const l=await fetch(e,{method:"HEAD",signal:r.signal,cache:"no-cache",mode:"no-cors"});return clearTimeout(a),l}catch(l){throw clearTimeout(a),l}}updateConnectionCache(e,t){this.connectionCache={connected:e,timestamp:Date.now(),method:t};try{localStorage.setItem(this.CONNECTION_CACHE_KEY,JSON.stringify(this.connectionCache))}catch{console.warn("[OfflineService] No se pudo guardar cache de conexin")}}startConnectionMonitoring(e,t){console.log("[OfflineService]  Iniciando monitoreo de conexin (cada 60s)"),this.onConnectionLostCallback=e,this.onConnectionRestoredCallback=t||null,this.stopConnectionMonitoring(),this.checkConnection(!0).then(r=>{this.lastConnectionStatus=r,console.log("[OfflineService] Estado inicial de conexin:",r?" Online":" Offline")}),this.connectionCheckInterval=setInterval(async()=>{var a,l;const r=await this.checkConnection(!0);this.lastConnectionStatus&&!r?(console.log("[OfflineService]  CONEXIN PERDIDA - Notificando..."),(a=this.onConnectionLostCallback)==null||a.call(this)):!this.lastConnectionStatus&&r&&(console.log("[OfflineService]  CONEXIN RESTAURADA - Notificando..."),(l=this.onConnectionRestoredCallback)==null||l.call(this)),this.lastConnectionStatus=r},this.CONNECTION_CHECK_INTERVAL),console.log("[OfflineService]  Monitoreo de conexin iniciado")}stopConnectionMonitoring(){this.connectionCheckInterval&&(console.log("[OfflineService]  Deteniendo monitoreo de conexin"),clearInterval(this.connectionCheckInterval),this.connectionCheckInterval=null)}getOfflineGameData(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(!e)return this.createFreshData();const t=JSON.parse(e),r=this.getTodayString(),a=new Date(t.date),l=new Date(r);return a>l?(console.warn("[OfflineService]  Fecha futura detectada - resetando (anti-fraude)"),this.createFreshData()):t.date!==r?(console.log("[OfflineService]  Nuevo da detectado - resetando lmites"),t.currentGameStarted&&console.log("[OfflineService]  Partida offline incompleta detectada - marcando como usada (anti-fraude)"),this.createFreshData()):t}catch(e){return console.error("[OfflineService] Error leyendo datos offline:",e),this.createFreshData()}}saveOfflineGameData(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e)),console.log("[OfflineService]  Datos guardados:",e)}catch(t){console.error("[OfflineService] Error guardando datos offline:",t)}}createFreshData(){return{date:this.getTodayString(),gamesPlayed:0,currentGameStarted:!1,currentGameStartTime:0,currentGamePhrasesPlayed:0}}getTodayString(){return new Date().toISOString().split("T")[0]}clearOfflineData(){console.log("[OfflineService]  Limpiando datos offline"),localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.CONNECTION_CACHE_KEY),this.connectionCache=null}getOfflineStats(){const e=this.getOfflineGameData();return{gamesPlayedToday:e.gamesPlayed,remainingGames:Math.max(0,this.OFFLINE_GAMES_PER_DAY-e.gamesPlayed),hasActiveGame:e.currentGameStarted,currentGameProgress:{current:e.currentGamePhrasesPlayed,total:this.OFFLINE_PHRASES_LIMIT}}}}const xt=new Yk,br=({children:n,onClose:e,isVisible:t=!0})=>t?S.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fadeIn",onClick:e,children:S.jsx("div",{className:"w-full max-w-md animate-scaleUp",onClick:r=>r.stopPropagation(),children:n})}):null;function Kk({title:n,titleId:e,...t},r){return te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?te.createElement("title",{id:e},n):null,te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const Wk=te.forwardRef(Kk);function Qk({title:n,titleId:e,...t},r){return te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?te.createElement("title",{id:e},n):null,te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const Xk=te.forwardRef(Qk);function Jk({title:n,titleId:e,...t},r){return te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?te.createElement("title",{id:e},n):null,te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0"}))}const Zk=te.forwardRef(Jk);function eM({title:n,titleId:e,...t},r){return te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?te.createElement("title",{id:e},n):null,te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const tM=te.forwardRef(eM);function nM({title:n,titleId:e,...t},r){return te.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?te.createElement("title",{id:e},n):null,te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const iM=te.forwardRef(nM),JA=({isOpen:n,onStartOfflineGame:e,onConnectionRestored:t,onClose:r,hasRemoveAds:a})=>{const[l,c]=te.useState(!1),[d,h]=te.useState(!0),[m,g]=te.useState("");Sw.useEffect(()=>{n&&!a&&_()},[n,a]);const _=async()=>{const I=await xt.canPlayOffline(a);h(I.allowed),g(I.reason||"")},v=async()=>{c(!0);try{if(await xt.checkConnection(!0)){console.log("[OfflineLimitModal]  Conexin restaurada");try{console.log("[OfflineLimitModal]  Recargando anuncios tras recuperar conexin..."),await wr.retryLoadAdsAfterConnectionRestored()}catch(A){console.warn("[OfflineLimitModal]  Error recargando anuncios:",A)}t()}else console.log("[OfflineLimitModal]  An sin conexin"),alert("An no hay conexin a internet. Por favor, verifica tu WiFi o datos mviles.")}catch(I){console.error("[OfflineLimitModal] Error verificando conexin:",I),alert("Error verificando conexin. Intenta nuevamente.")}finally{c(!1)}},T=()=>{if(!d){alert(m||"No puedes iniciar partida offline");return}e()};return S.jsx(br,{isVisible:n,onClose:r,children:S.jsxs("div",{className:"bg-gray-900 rounded-2xl p-4 md:p-8 shadow-xl flex flex-col items-center max-w-[95vw] w-full sm:w-[400px] mx-auto",children:[S.jsxs("div",{className:"flex flex-col items-center w-full border-b border-gray-700 pb-4 mb-2",children:[S.jsx("div",{className:"text-5xl mb-1",children:""}),S.jsx("h2",{className:"text-2xl font-bold text-white",children:"Sin Conexin a Internet"})]}),S.jsxs("div",{className:"text-center space-y-2 w-full",children:[S.jsx("p",{className:"text-lg text-gray-200 font-medium",children:"Perdiste la conexin a internet"}),S.jsx("p",{className:"text-sm text-gray-400",children:a?"Con tu Pack Sin Anuncios puedes seguir jugando offline.":"Puedes conectarte nuevamente o iniciar tu partida offline diaria."})]}),!a&&S.jsxs("div",{className:"bg-purple-900/30 border border-purple-500/50 rounded-lg p-2 w-full mt-4 flex flex-col items-center",children:[S.jsx("div",{className:"flex items-center justify-center mb-1 w-full",children:S.jsx("h3",{className:"font-bold text-purple-200 text-base text-center",children:"Partida Offline Diaria"})}),S.jsxs("ul",{className:"text-sm text-purple-300 space-y-1 text-center",children:[S.jsx("li",{children:" Mximo 15 frases por da"}),S.jsx("li",{children:" 1 partida offline gratis al da"}),S.jsx("li",{children:" Se renueva cada 24 horas"})]})]}),!a&&!d&&S.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-3 w-full mt-3 flex items-center gap-3",children:[S.jsx(iM,{className:"h-7 w-7 text-red-300 flex-shrink-0","aria-hidden":"true"}),S.jsxs("div",{className:"flex-1",children:[S.jsx("h3",{className:"font-bold text-red-200 mb-1",children:"Lmite Alcanzado"}),S.jsx("p",{className:"text-sm text-red-300",children:m})]})]}),S.jsxs("div",{className:"flex flex-col gap-3 w-full mt-6",children:[S.jsx(Kt,{onClick:v,disabled:l,className:"w-full flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-base py-3",children:l?S.jsxs(S.Fragment,{children:[S.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-white",viewBox:"0 0 24 24",children:[S.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),S.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Verificando conexin..."]}):S.jsxs(S.Fragment,{children:[S.jsx(tM,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Vuelvo a tener conexin"]})}),!a&&d&&S.jsxs(Kt,{onClick:T,className:"w-full flex items-center justify-center bg-purple-600 hover:bg-purple-700 text-base py-3",children:[S.jsx(Xk,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Iniciar Partida Offline (15 frases)"]}),a&&S.jsxs(Kt,{onClick:T,className:"w-full flex items-center justify-center bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-base py-3",children:[S.jsx(Zk,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Continuar en Modo Offline Premium"]}),S.jsxs(Kt,{onClick:r,className:"w-full flex items-center justify-center bg-gray-700 hover:bg-gray-600 text-base py-3",children:[S.jsx(Wk,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Volver"]})]}),!a&&S.jsxs("div",{className:"bg-gradient-to-r from-yellow-900/40 to-orange-900/40 border border-yellow-500/50 rounded-lg p-3 mt-5 w-full flex flex-col items-center",children:[S.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[S.jsx("span",{className:"text-2xl",role:"img","aria-label":"trophy",children:""}),S.jsx("span",{className:"font-bold text-yellow-200 text-base",children:"Juegas sin internet frecuentemente?"})]}),S.jsxs("p",{className:"text-sm text-yellow-300 text-center mb-1",children:["Con ",S.jsx("span",{className:"font-semibold text-yellow-100",children:"Pack Sin Anuncios"})," puedes jugar ",S.jsx("span",{className:"font-semibold text-yellow-100",children:"partidas completas ilimitadas"})," sin conexin."]}),S.jsxs("div",{className:"text-xs text-yellow-400 text-center flex flex-wrap gap-x-2 gap-y-1 justify-center",children:[S.jsx("span",{children:" 30 frases por partida"}),S.jsx("span",{children:" Sin lmite de partidas"}),S.jsx("span",{children:" Sin anuncios"})]})]})]})})},rM=({isActive:n,onComplete:e})=>{const[t,r]=te.useState(!1);return te.useEffect(()=>{if(n){r(!0);const a=setTimeout(()=>{r(!1),e==null||e()},1e3);return()=>clearTimeout(a)}},[n,e]),t?S.jsx("div",{className:"fire-transition-overlay",children:S.jsx("div",{className:"fire-emoji",children:""})}):null},sM=({navigate:n,onSuggestClick:e,onStartGame:t,disablePlay:r,disableStore:a,disableShare:l,disableAdultMode:c,welcomeMessage:d="Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos.",hasPremium:h=!1,hasRemoveAds:m=!1,ownedPackIds:g=[],playStoreUrl:_="https://play.google.com/store/apps/details?id=com.mrodr.yonunca",appStoreUrl:v="https://tiendaapple.com"})=>{const[T,I]=te.useState(!1),[A,C]=te.useState(!1),[L,x]=te.useState(null),[U,z]=te.useState(!1),[$,se]=te.useState(!1),[D,P]=te.useState(!1),[N,M]=te.useState(!1),[B,G]=te.useState(!1),[k,Ve]=te.useState(!1),[tt,ee]=te.useState(!1),[he,Ie]=te.useState(!1),Le=Ne.getPlatform(),Ge=Le==="web",j=(()=>{if(!Ge)return!1;try{const We=navigator.userAgent||"";return/iPad|iPhone|iPod/i.test(We)||We.includes("Mac")&&typeof document<"u"&&"ontouchend"in document}catch{return!1}})(),K=(()=>{var We,Ke;if(!Ge)return!1;try{const Ze=navigator;return(Ze==null?void 0:Ze.standalone)===!0||typeof window<"u"&&((Ke=(We=window.matchMedia)==null?void 0:We.call(window,"(display-mode: standalone)"))==null?void 0:Ke.matches)===!0}catch{return!1}})(),ue=async(We,Ke)=>{console.log("[HomeScreen]  Intentando iniciar partida...",{includeAdult:We,adultOnly:Ke}),z(!0);try{if(await xt.checkConnection(!0)){if(console.log("[HomeScreen]  Conexin disponible - iniciando partida online"),Ke){Ve(!0),G(!0),se(!0),console.log("[HomeScreen]  Precargando frases durante animacin del fuego...");const Wt=Date.now(),Rn=(async()=>{try{const{fetchPhrases:Te}=await Yt(async()=>{const{fetchPhrases:Se}=await Promise.resolve().then(()=>Ki);return{fetchPhrases:Se}},void 0),{updatePhraseCache:oe}=await Yt(async()=>{const{updatePhraseCache:Se}=await Promise.resolve().then(()=>Ki);return{updatePhraseCache:Se}},void 0);console.log("[HomeScreen]  Actualizando cach con packs:",g),await oe(!1,g),console.log("[HomeScreen]  Obteniendo frases del cach...");const Ue=await Te(h||!1,!0,g),ve=Ue.filter(Se=>Se.isAdult),Ae=Date.now()-Wt;return console.log("[HomeScreen]  Precarga completada:",{totalPhrases:Ue.length,adultPhrases:ve.length,timeMs:Ae}),ve.length>0}catch(Te){return console.error("[HomeScreen]  Error precargando frases:",Te),!1}})(),[yn]=await Promise.all([Rn,new Promise(Te=>setTimeout(Te,1200))]);yn?console.log("[HomeScreen]  Frases listas, navegando a juego..."):console.warn("[HomeScreen]  No hay frases +18, navegando igualmente..."),t(We,Ke),n(yt.Game),setTimeout(()=>{se(!1),Ve(!1)},100)}else se(!0),await new Promise(Wt=>setTimeout(Wt,400)),t(We,Ke),n(yt.Game),setTimeout(()=>se(!1),500);return}console.log("[HomeScreen]  Sin conexin - verificando lmite offline");const Vt=await xt.canPlayOffline(m);x({includeAdult:We,adultOnly:Ke}),C(!0)}catch(Ze){console.error("[HomeScreen] Error verificando conexin:",Ze),alert("Error verificando conexin. Intenta nuevamente.")}finally{z(!1)}},pe=()=>{L&&(console.log("[HomeScreen]  Iniciando partida offline..."),xt.markOfflineGameStarted(),console.log("[HomeScreen]  Partida offline marcada como iniciada (anti-fraude)"),L.adultOnly?(Ve(!0),G(!0),se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(yt.Game),setTimeout(()=>{se(!1),Ve(!1)},100)},1200)):(se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(yt.Game),setTimeout(()=>se(!1),500)},400)))},Pe=async()=>{if(!L)return;console.log("[HomeScreen]  Usuario confirm conexin, verificando..."),await xt.checkConnection(!0)?(console.log("[HomeScreen]  Conexin restaurada - iniciando partida online"),L.adultOnly?(Ve(!0),G(!0),se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(yt.Game),setTimeout(()=>{se(!1),Ve(!1)},100)},1200)):(se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(yt.Game),setTimeout(()=>se(!1),500)},400))):(console.log("[HomeScreen]  An sin conexin"),alert("An no hay conexin a internet. Verifica tu WiFi o datos mviles e intenta nuevamente."))},je=async We=>{var Ke;try{if((Ke=navigator.clipboard)!=null&&Ke.writeText)return await navigator.clipboard.writeText(We),!0}catch{}try{const Ze=document.createElement("textarea");Ze.value=We,Ze.setAttribute("readonly",""),Ze.style.position="fixed",Ze.style.top="0",Ze.style.left="0",Ze.style.opacity="0",document.body.appendChild(Ze),Ze.select();const Vt=document.execCommand("copy");return document.body.removeChild(Ze),Vt}catch{return!1}},nt=async()=>{var Ke,Ze;if(Ge){try{const Vt=((Ze=(Ke=import.meta)==null?void 0:Ke.env)==null?void 0:Ze.BASE_URL)||"/games/yo-nunca/play/",Wt=new URL(Vt,window.location.origin).toString();await je(Wt)&&(I(!0),setTimeout(()=>I(!1),2e3))}catch(Vt){console.error("No se pudo copiar al portapapeles",Vt)}return}const We=Le==="ios"?v:_;if(navigator.share)try{await navigator.share({title:"Yo Nunca",text:"Descarga Yo Nunca y juega con tus amigos!",url:We});return}catch(Vt){console.error("Error compartiendo la app:",Vt)}try{await je(We)&&(I(!0),setTimeout(()=>I(!1),2e3))}catch(Vt){console.error("No se pudo copiar al portapapeles",Vt)}};return S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"fixed inset-0 pointer-events-none select-none overflow-hidden","aria-hidden":"true",style:{zIndex:-1},children:[S.jsx("div",{className:"absolute -top-16 -left-20 w-80 h-80 bg-cyan-500/35 rounded-full blur-2xl animate-float-background opacity-50"}),S.jsx("div",{className:"absolute -bottom-20 -right-16 w-96 h-96 bg-red-500/35 rounded-full blur-2xl animate-float-background-reverse opacity-50"}),S.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[28rem] h-[28rem] bg-purple-500/30 rounded-full blur-2xl animate-float-background opacity-45",style:{animationDelay:"2s"}}),S.jsx("div",{className:"absolute top-1/4 -right-10 w-72 h-72 bg-blue-500/30 rounded-full blur-2xl animate-float-background opacity-45",style:{animationDelay:"4s"}}),S.jsx("div",{className:"absolute -bottom-10 left-1/4 w-80 h-80 bg-pink-500/30 rounded-full blur-2xl animate-float-background-reverse opacity-45",style:{animationDelay:"6s"}}),S.jsx("div",{className:"absolute top-1/6 left-1/3 w-64 h-64 bg-emerald-500/25 rounded-full blur-2xl animate-float-background opacity-40",style:{animationDelay:"1s"}}),S.jsx("div",{className:"absolute bottom-1/3 right-1/3 w-72 h-72 bg-orange-500/25 rounded-full blur-2xl animate-float-background-reverse opacity-40",style:{animationDelay:"3s"}}),S.jsx("div",{className:"absolute top-3/4 left-1/6 w-56 h-56 bg-indigo-500/25 rounded-full blur-2xl animate-float-background opacity-40",style:{animationDelay:"5s"}}),S.jsx("div",{className:"absolute top-1/5 right-1/4 w-60 h-60 bg-rose-500/25 rounded-full blur-2xl animate-float-background-reverse opacity-40",style:{animationDelay:"7s"}})]}),S.jsxs("div",{className:`relative overflow-hidden flex flex-col items-center justify-center min-h-screen w-full text-center p-4 ${$&&!k?"animate-fade-out-scale":k?"screen-slide-out":""}`,children:[S.jsx("h1",{className:"text-6xl md:text-7xl font-bold title-shimmer mb-4 drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]",children:"Yo Nunca"}),S.jsx("p",{className:"text-slate-300 mb-8 text-base md:text-lg max-w-xl px-4",children:d}),S.jsxs("div",{className:"w-full max-w-xs space-y-4 relative z-10",children:[S.jsx("div",{className:"main-play-button",children:S.jsx(Kt,{onClick:()=>ue(!c,!1),fullWidth:!0,size:"large",disabled:r||U,children:U?S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Verificando conexin..."]}):S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-play mr-2"}),"Iniciar Partida"]})})}),!c&&S.jsxs("button",{onClick:()=>{!r&&!U&&(P(!0),M(!0),setTimeout(()=>P(!1),400),setTimeout(()=>M(!1),800),ue(!0,!0))},disabled:r||U,className:`w-full flex items-center justify-center gap-1 py-3 rounded-lg font-bold text-base transition-all relative overflow-hidden ${r||U?"bg-slate-700 text-slate-500 cursor-not-allowed":"bg-gradient-to-r from-red-500 to-pink-600 text-white shadow-lg shadow-pink-500/30 hover:shadow-pink-500/50 hover:shadow-2xl hover:scale-105 active:scale-95 fire-button-idle"} ${D?"animate-button-press":""}`,children:[S.jsx("span",{className:"relative z-10",children:U?S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"Verificando..."]}):S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-fire mr-1"}),"Solo +18"]})}),!r&&!U&&S.jsx("span",{className:"absolute inset-0 shimmer-effect opacity-0 hover:opacity-100 transition-opacity duration-500"}),N&&S.jsx("span",{className:"fire-swipe-effect"})]}),S.jsxs(Kt,{onClick:()=>n(yt.Store),variant:"secondary",fullWidth:!0,disabled:a,children:[S.jsx("i",{className:"fas fa-store mr-2"}),"Tienda"]}),!l&&S.jsx(Kt,{onClick:nt,variant:"secondary",fullWidth:!0,children:T?"Enlace copiado!":Ge?"Compartir":"Compartir App"}),!l&&j&&!K&&S.jsxs(Kt,{onClick:()=>Ie(!0),variant:"secondary",fullWidth:!0,children:[S.jsx("i",{className:"fas fa-plus-square mr-2"}),"Aadir al escritorio"]})]}),S.jsxs("button",{onClick:()=>ee(!0),className:"mt-6 text-slate-400 hover:text-cyan-400 transition-colors text-sm flex items-center justify-center gap-1 relative z-10",children:[S.jsx("i",{className:"fas fa-question-circle text-xs"}),"Cmo jugar?"]}),S.jsx(JA,{isOpen:A,onStartOfflineGame:pe,onConnectionRestored:Pe,onClose:()=>{C(!1),x(null)},hasRemoveAds:m}),tt&&S.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 ",onClick:()=>ee(!1),children:S.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 max-w-lg w-full border-2 border-cyan-500/30 shadow-2xl shadow-cyan-500/20 animate-pop-in max-h-[90vh] overflow-y-auto",onClick:We=>We.stopPropagation(),children:[S.jsxs("div",{className:"flex items-center justify-between mb-4",children:[S.jsxs("h2",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-pink-500",children:[S.jsx("i",{className:"fas fa-question-circle mr-2"}),"Cmo jugar?"]}),S.jsx("button",{onClick:()=>ee(!1),className:"text-slate-400 hover:text-white transition-colors text-2xl",children:S.jsx("i",{className:"fas fa-times"})})]}),S.jsxs("div",{className:"space-y-4 text-slate-300",children:[S.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-cyan-500/20",children:[S.jsxs("h3",{className:"font-bold text-cyan-400 mb-2 flex items-center",children:[S.jsx("i",{className:"fas fa-gamepad mr-2"}),"Reglas Bsicas"]}),S.jsx("p",{className:"text-sm leading-relaxed",children:'"Yo Nunca" es un juego de preguntas donde los jugadores descubren experiencias que han vivido. El juego mostrar frases que comienzan con "Yo nunca..." y los jugadores deben indicar si han hecho o no esa accin.'})]}),S.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-pink-500/20",children:[S.jsxs("h3",{className:"font-bold text-pink-400 mb-2 flex items-center",children:[S.jsx("i",{className:"fas fa-play-circle mr-2"}),"Cmo se Juega"]}),S.jsxs("ul",{className:"text-sm space-y-2",children:[S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Lee la frase:"}),' Aparecer una frase como "Yo nunca he viajado en avin"']})]}),S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Pulsa el botn:"})," Toca la pantalla para ver la siguiente frase"]})]}),S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Los jugadores responden:"})," Quien S haya hecho esa accin bebe o pierde un punto"]})]}),S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Contina:"})," Sigue con ms frases y divirtete conociendo a tus amigos"]})]})]})]}),S.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-purple-500/20",children:[S.jsxs("h3",{className:"font-bold text-purple-400 mb-2 flex items-center",children:[S.jsx("i",{className:"fas fa-fire mr-2"}),"Modo +18"]}),S.jsx("p",{className:"text-sm leading-relaxed",children:"El modo +18 incluye frases ms atrevidas y picantes para jugadores adultos. Este modo es solo para mayores de 18 aos y ambientes apropiados."})]})]}),S.jsx("div",{className:"mt-6",children:S.jsxs(Kt,{onClick:()=>ee(!1),fullWidth:!0,variant:"primary",children:[S.jsx("i",{className:"fas fa-check mr-2"}),"Entendido!"]})})]})}),he&&S.jsx(br,{onClose:()=>Ie(!1),children:S.jsxs("div",{className:"bg-slate-900/95 border border-slate-700 rounded-xl p-6 shadow-2xl",children:[S.jsxs("div",{className:"text-center mb-5",children:[S.jsx("div",{className:"text-3xl mb-2 text-cyan-400",children:S.jsx("i",{className:"fas fa-mobile-alt"})}),S.jsx("h2",{className:"text-xl font-bold text-white",children:"Aadir al escritorio"}),S.jsx("p",{className:"text-slate-300 text-sm mt-2",children:"Para instalar esta web como app en iPhone/iPad:"})]}),S.jsxs("ol",{className:"text-left text-slate-200 text-sm space-y-2 mb-6",children:[S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-cyan-400 font-bold",children:"1."}),S.jsxs("span",{children:["Abre el men de compartir de Safari (",S.jsx("i",{className:"fas fa-share-square"}),")."]})]}),S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-cyan-400 font-bold",children:"2."}),S.jsx("span",{children:"Selecciona Aadir a pantalla de inicio."})]}),S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-cyan-400 font-bold",children:"3."}),S.jsx("span",{children:"Pulsa Aadir."})]})]}),S.jsxs(Kt,{onClick:()=>Ie(!1),fullWidth:!0,variant:"primary",children:[S.jsx("i",{className:"fas fa-check mr-2"}),"Entendido"]})]})})]}),S.jsx(rM,{isActive:B,onComplete:()=>G(!1)})]})};class aM{constructor(){De(this,"PHRASES_PER_PARTIDA",30);De(this,"SESSION_STORAGE_BASE_KEY","game_session");De(this,"currentSession",null);De(this,"phrases",[]);De(this,"phraseCounters",{totalPremiumPhrases:0,totalDemoPhrases:0,totalFreePhrases:0,isLoaded:!1})}async loadPhraseCounters(){try{console.log("[GameSession] Cargando contadores de frases...");const e=await PA.getCounters();this.phraseCounters={totalPremiumPhrases:e.totalPremiumPhrases,totalDemoPhrases:e.totalDemoPhrases,totalFreePhrases:e.totalFreePhrases,isLoaded:!0},console.log("[GameSession] Contadores cargados:",this.phraseCounters)}catch(e){console.error("[GameSession]  Error cargando contadores:",e),console.warn("[GameSession]  Usando valores de fallback"),this.phraseCounters={totalPremiumPhrases:161,totalDemoPhrases:26,totalFreePhrases:100,isLoaded:!1},console.log("[GameSession] Fallback aplicado:",this.phraseCounters)}}getStorageKey(e){return`${this.SESSION_STORAGE_BASE_KEY}_${e}`}async initializeSession(e,t,r=!1,a=!1,l=!1,c=[]){if(console.log("[GameSession] Inicializando sesin para categora:",e),console.log("[GameSession] Usuario tiene premium?:",r),console.log("[GameSession] Usuario tiene Pack Bienvenida (DEPRECATED)?:",l),console.log("[GameSession] Packs del usuario:",c),console.log("[GameSession] Total frases cargadas:",t.length),!mA("game"))throw new Error(" Demasiadas sesiones iniciadas. Espera un momento antes de continuar.");this.phrases=t,await this.loadPhraseCounters();const d=await this.getStoredSession(e);if(d&&d.category===e){if(console.log("[GameSession] Sesin existente encontrada"),this.currentSession=d,this.currentSession.hasPremium=r,this.currentSession.hasRemoveAds=a||this.currentSession.hasRemoveAds===!0,this.currentSession.hasStarterPack=l,this.currentSession.ownedPackIds=c,this.currentSession.availablePool.length>1&&this.isPoolSequential(this.currentSession.availablePool)){console.log("[GameSession]  Pool secuencial detectado en sesin existente, mezclando...");const m=[...this.currentSession.availablePool];for(let g=m.length-1;g>0;g--){const _=Math.floor(Math.random()*(g+1));[m[g],m[_]]=[m[_],m[g]]}this.currentSession.availablePool=m,await this.saveSession(),console.log("[GameSession]  Pool de sesin existente mezclado aleatoriamente")}if(!this.currentSession.hasPremium){const h=this.currentSession.availablePool.length;this.currentSession.isDemoMode?this.currentSession.availablePool=this.currentSession.availablePool.filter(g=>{const _=this.phrases[g];return(_==null?void 0:_.isDemo)===!0}):this.currentSession.availablePool=this.currentSession.availablePool.filter(g=>{var T;const _=this.phrases[g],v=((T=this.currentSession)==null?void 0:T.ownedPackIds)||[];return _!=null&&_.packIds&&_.packIds.length>0&&_.packIds.some(A=>v.includes(A))||_!=null&&_.starterPack&&this.currentSession&&this.currentSession.hasStarterPack?!0:!(_!=null&&_.isPremium)&&!(_!=null&&_.isDemo)&&!(_!=null&&_.starterPack)&&(!(_!=null&&_.packIds)||_.packIds.length===0)});const m=this.currentSession.availablePool.length;console.log(`[GameSession] Pool filtrado por modo (${this.currentSession.isDemoMode?"demo":"gratuito"}): ${h}  ${m}`),await this.saveSession()}try{await xt.checkConnection(!0)?this.currentSession.isOfflineMode&&await this.deactivateOfflineMode():(this.currentSession.isOfflineMode=!0,this.currentSession.hasRemoveAds=this.currentSession.hasRemoveAds===!0||!!a,this.currentSession.offlinePhrasesLimit=this.currentSession.hasRemoveAds?30:15,await this.saveSession(),console.log("[GameSession]  Ajuste automtico: modo offline activado (initializeSession - sesin existente). Lmite:",this.currentSession.offlinePhrasesLimit))}catch(h){console.warn("[GameSession]  No se pudo verificar conexin para auto offline/online (sesin existente):",h)}this.currentSession.currentPartidaCount>=this.getPhrasesPerPartida()?(console.log("[GameSession] Partida anterior completada, iniciando nueva partida"),await this.startNewPartida()):(console.log("[GameSession] Continuando partida existente"),await this.checkAndReorganizeIfNeeded())}else if(console.log("[GameSession] Creando nueva sesin"),await this.createNewSession(e,r,l,c),this.currentSession&&(this.currentSession.hasRemoveAds=a),this.currentSession)try{await xt.checkConnection(!0)?this.currentSession.isOfflineMode&&await this.deactivateOfflineMode():(this.currentSession.isOfflineMode=!0,this.currentSession.hasRemoveAds=this.currentSession.hasRemoveAds===!0||!!a,this.currentSession.offlinePhrasesLimit=this.currentSession.hasRemoveAds?30:15,await this.saveSession(),console.log("[GameSession]  Ajuste automtico: modo offline activado (initializeSession - sesin nueva). Lmite:",this.currentSession.offlinePhrasesLimit))}catch(h){console.warn("[GameSession]  No se pudo verificar conexin para auto offline/online (sesin nueva):",h)}}getCurrentPhrase(){if(!this.currentSession)return null;if(this.currentSession.currentPartidaCount>=this.getPhrasesPerPartida())return{phrase:null,id:-1,isEndOfPartida:!0,stats:this.calculatePartidaStats()};if(this.currentSession.availablePool.length===0)return null;const e=this.getNextAvailablePhraseId();return{phrase:this.phrases[e],id:e,isEndOfPartida:!1,stats:void 0}}getCurrentProgress(){return this.currentSession?{current:this.currentSession.currentPartidaCount+1,total:this.getPhrasesPerPartida()}:{current:0,total:this.PHRASES_PER_PARTIDA}}async createNewSession(e,t=!1,r=!1,a=[]){const l=this.phrases.map((h,m)=>m);let c;t?(c=l,console.log("[GameSession] Modo premium: pool inicial con todas las frases")):(c=l.filter(h=>{const m=this.phrases[h];return m!=null&&m.packIds&&m.packIds.length>0&&m.packIds.some(_=>a.includes(_))||m!=null&&m.starterPack&&r?!0:!(m!=null&&m.isPremium)&&!(m!=null&&m.isDemo)&&!(m!=null&&m.starterPack)&&(!(m!=null&&m.packIds)||m.packIds.length===0)}),console.log("[GameSession] Modo gratuito: pool inicial solo con frases base + packs del usuario"));const d=[...c];for(let h=d.length-1;h>0;h--){const m=Math.floor(Math.random()*(h+1));[d[h],d[m]]=[d[m],d[h]]}console.log("[GameSession]  Frases mezcladas aleatoriamente para nueva sesin"),this.currentSession={category:e,phrasesShown:[],currentPartidaCount:0,totalPhrasesViewed:0,partida:1,startTime:Date.now(),sessionStartTime:Date.now(),availablePool:d,needsReorganization:!1,isDemoMode:!1,demoPhrasesShown:0,demoPhrasesTarget:10,hasPremium:t,hasRemoveAds:!1,isOfflineMode:!1,offlinePhrasesLimit:t?30:15,hasStarterPack:r,ownedPackIds:a},await this.saveSession(),console.log("[GameSession] Nueva sesin creada con orden aleatorio:",this.currentSession)}async getNextPhrase(){if(!this.currentSession)throw new Error("Sesin no inicializada");if((await this.checkAndReorganizeIfNeeded(this.currentSession.isDemoMode===!0)).needsCompletion)return{phrase:null,id:-1,isEndOfPartida:!0,stats:this.calculatePartidaStats(),needsCompletionModal:!0};if(this.currentSession.currentPartidaCount>=this.getPhrasesPerPartida()){const c=this.calculatePartidaStats(),d=this.currentSession.isOfflineMode&&!this.currentSession.hasRemoveAds;return{phrase:null,id:-1,isEndOfPartida:!0,stats:c,isOfflineLimitReached:d}}const t=this.getNextAvailablePhraseId(),r=this.phrases[t];this.currentSession.isDemoMode&&(r!=null&&r.isDemo)&&(this.currentSession.demoPhrasesShown++,console.log(`[GameSession]  Frase demo mostrada. Progreso: ${this.currentSession.demoPhrasesShown}/${this.currentSession.demoPhrasesTarget}`)),this.currentSession.phrasesShown.push(t),this.currentSession.currentPartidaCount++,this.currentSession.totalPhrasesViewed++,this.currentSession.isOfflineMode&&(xt.incrementOfflinePhrasesPlayed(),console.log("[GameSession]  Frase offline registrada")),this.currentSession.availablePool=this.currentSession.availablePool.filter(c=>c!==t),await this.saveSession();const a=this.getPhrasesPerPartida();console.log(`[GameSession] Frase ${this.currentSession.currentPartidaCount}/${a}:`,r.text||r.frase);const l=this.currentSession.isOfflineMode&&this.currentSession.currentPartidaCount>=a;return console.log("[GameSession]  Verificacin lmite offline:",{isOfflineMode:this.currentSession.isOfflineMode,currentPartidaCount:this.currentSession.currentPartidaCount,phrasesLimit:a,isOfflineLimitReached:l,hasRemoveAds:this.currentSession.hasRemoveAds}),{phrase:r,id:t,isEndOfPartida:this.currentSession.currentPartidaCount>=a,stats:this.currentSession.currentPartidaCount>=a?this.calculatePartidaStats():void 0,isOfflineLimitReached:l}}async startNewPartida(){if(!this.currentSession)throw new Error("Sesin no inicializada");console.log("[GameSession]  Iniciando nueva partida..."),console.log("[GameSession] Partida actual:",this.currentSession.partida),console.log("[GameSession] Frases en pool antes de reorganizar:",this.currentSession.availablePool.length),this.currentSession.partida++,this.currentSession.currentPartidaCount=0,this.currentSession.startTime=Date.now(),console.log("[GameSession]  Contadores reseteados, reorganizando pool..."),await this.checkAndReorganizeIfNeeded(!0),console.log("[GameSession]  Pool reorganizado, frases disponibles:",this.currentSession.availablePool.length),await this.saveSession(),console.log(`[GameSession]  Nueva partida iniciada: #${this.currentSession.partida}`)}async activateDemoMode(){if(!this.currentSession)throw new Error("Sesin no inicializada");const e=10;this.currentSession.isDemoMode=!0,this.currentSession.demoPhrasesShown=0,this.currentSession.demoPhrasesTarget=e;try{const r=[...this.phrases.map((a,l)=>l).filter(a=>{const l=this.phrases[a];return(l==null?void 0:l.isDemo)===!0}).filter(a=>!this.currentSession.phrasesShown.includes(a))];for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,console.log(`[GameSession]  Pool actualizado para modo demo. Total frases demo disponibles: ${r.length}`)}catch(t){console.warn("[GameSession]  Error reconstruyendo pool para demo, se mantiene pool actual:",t)}await this.saveSession(),console.log("[GameSession]  Modo demo activado - 10 frases demo por partida")}async deactivateDemoMode(){if(!this.currentSession)throw new Error("Sesin no inicializada");this.currentSession.isDemoMode=!1,this.currentSession.demoPhrasesShown=0,this.currentSession.demoPhrasesTarget=0,await this.saveSession(),console.log("[GameSession] Modo demo desactivado")}async activateOfflineMode(e=!1){if(!this.currentSession)throw new Error("Sesin no inicializada");this.currentSession.isOfflineMode=!0,this.currentSession.hasRemoveAds=e,this.currentSession.offlinePhrasesLimit=e?30:15,await this.saveSession(),console.log(`[GameSession]  Modo offline activado - lmite: ${this.currentSession.offlinePhrasesLimit} frases`),console.log(`[GameSession] Usuario con remove_ads: ${e}`)}async deactivateOfflineMode(){if(!this.currentSession)throw new Error("Sesin no inicializada");this.currentSession.isOfflineMode=!1,this.currentSession.offlinePhrasesLimit=30,await this.saveSession(),console.log("[GameSession] Modo offline desactivado - volviendo a lmite normal de 30 frases")}getPhrasesPerPartida(){if(!this.currentSession)return this.PHRASES_PER_PARTIDA;if(this.currentSession.isDemoMode)return console.log("[GameSession]  Lmite modo demo: 10 frases"),10;const e=this.currentSession.isOfflineMode,t=this.currentSession.hasRemoveAds===!0;return console.log("[GameSession]  Verificacin de lmites - Offline en sesin:",this.currentSession.isOfflineMode),console.log("[GameSession]  Verificacin de lmites - Usuario con remove_ads:",t),e&&!t?(console.log("[GameSession]  Lmite offline aplicado: 15 frases (usuario sin remove_ads)"),15):(console.log("[GameSession] Lmite normal: 30 frases"),this.PHRASES_PER_PARTIDA)}isPartidaLimitReached(){if(!this.currentSession)return!1;const e=this.getPhrasesPerPartida();return this.currentSession.currentPartidaCount>=e}async checkAndReorganizeIfNeeded(e=!1){if(!this.currentSession)return{};const t=this.currentSession.availablePool.length,r=this.getPhrasesPerPartida();if(console.log("[GameSession]  Verificando pool - Frases restantes:",t),console.log("[GameSession]  Frases necesarias por partida:",r),console.log("[GameSession]  Es usuario premium?:",this.currentSession.hasPremium),console.log("[GameSession]  Modo offline?:",this.currentSession.isOfflineMode),t<r){console.log("[GameSession]  Pool insuficiente para partida completa, verificando completitud...");const a=this.hasUserCompletedAvailableContent();if(console.log("[GameSession]  Ha completado todo el contenido disponible?:",a),a)if(e)console.log("[GameSession]  Contenido completado pero se permite replay: reorganizando pool y continuando"),await this.reorganizePool();else return console.log("[GameSession]  Usuario complet todo el contenido disponible - MOSTRAR MODAL"),{needsCompletion:!0};else console.log("[GameSession]  Reorganizando pool para continuar jugando..."),await this.reorganizePool()}return{}}hasUserCompletedAvailableContent(){if(!this.currentSession)return!1;const e=[...new Set(this.currentSession.phrasesShown)];console.log("[GameSession] Verificando completitud:",{uniquePhrasesPlayed:e.length,totalPhrases:this.phrases.length,isDemoMode:this.currentSession.isDemoMode,hasPremium:this.currentSession.hasPremium,category:this.currentSession.category});let t=[];this.currentSession.hasPremium?(t=this.phrases,console.log("[GameSession] Usuario premium - Todas las frases disponibles:",t.length)):this.currentSession.isDemoMode?(t=this.phrases.filter(h=>!h.isPremium||h.isDemo===!0),console.log("[GameSession] Modo demo - Frases disponibles:",t.length)):(t=this.phrases.filter(h=>!h.isPremium&&!h.isDemo),console.log("[GameSession] Modo gratuito - Frases disponibles:",t.length));const r=e.filter(h=>{var g,_;const m=this.phrases[h];return m?(g=this.currentSession)!=null&&g.hasPremium?!0:(_=this.currentSession)!=null&&_.isDemoMode?!m.isPremium||m.isDemo===!0:!m.isPremium&&!m.isDemo:!1}),a=r.length>=t.length,l=t.length-r.length,c=this.getPhrasesPerPartida(),d=l<c;return console.log("[GameSession] Estado completitud:",{playedAvailablePhrases:r.length,availablePhrases:t.length,phrasesRemaining:l,phrasesPerPartida:c,hasCompletedAllAvailable:a,insufficientForFullGame:d,shouldShowModal:a||d,percentage:Math.round(r.length/t.length*100)}),a}hasCompletedAvailableContent(){return this.hasUserCompletedAvailableContent()}async reorganizePool(){if(!this.currentSession)return;console.log("[GameSession]  Reorganizando pool de frases"),console.log("[GameSession] Estado actual:",{category:this.currentSession.category,hasPremium:this.currentSession.hasPremium,isDemoMode:this.currentSession.isDemoMode,totalPhrases:this.phrases.length,phrasesShown:this.currentSession.phrasesShown.length});let e=[];this.currentSession.hasPremium?(e=this.phrases.map((r,a)=>a),console.log("[GameSession] Modo premium: usando todas las frases")):this.currentSession.isDemoMode?(e=this.phrases.map((r,a)=>({phrase:r,index:a})).filter(({phrase:r})=>!r.isPremium||r.isDemo===!0).map(({index:r})=>r),console.log("[GameSession] Modo demo: usando frases gratuitas + demo")):(e=this.phrases.map((r,a)=>({phrase:r,index:a})).filter(({phrase:r})=>!r.isPremium&&!r.isDemo).map(({index:r})=>r),console.log("[GameSession] Modo gratuito: usando solo frases base (no premium, no demo)")),console.log("[GameSession] Frases disponibles para este modo:",e.length);const t=e.filter(r=>!this.currentSession.phrasesShown.includes(r));if(console.log("[GameSession] Reorganizacin:",{totalAvailable:e.length,alreadySeen:this.currentSession.phrasesShown.length,notSeen:t.length,hasPremium:this.currentSession.hasPremium,mode:this.currentSession.hasPremium?"premium":this.currentSession.isDemoMode?"demo":"gratuito"}),t.length===0&&e.length>0){console.log("[GameSession]  Usuario complet una vuelta completa, reiniciando pool para replay"),this.currentSession.phrasesShown=[];const r=[...e];for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,console.log("[GameSession]  Pool reiniciado con orden aleatorio. Frases disponibles:",this.currentSession.availablePool.length)}else if(t.length>0){const r=[...t];for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,console.log("[GameSession]  Pool actualizado con frases restantes mezcladas aleatoriamente:",this.currentSession.availablePool.length)}else if(console.warn("[GameSession]  No hay frases sin ver y availablePhraseIds est vaco"),console.log("[GameSession]  Forzando reinicio del pool con todas las frases disponibles"),this.phrases.length>0){const r=this.phrases.map((a,l)=>l);for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,this.currentSession.phrasesShown=[],console.log("[GameSession]  Pool reiniciado con todas las frases de this.phrases mezcladas aleatoriamente:",this.currentSession.availablePool.length)}else throw console.error("[GameSession]  CRTICO: this.phrases est vaco, no hay frases para mostrar"),new Error("No hay frases disponibles para jugar");await this.saveSession()}getNextAvailablePhraseId(){if(!this.currentSession||this.currentSession.availablePool.length===0)throw new Error("No hay frases disponibles");if(!this.currentSession.isDemoMode)return this.currentSession.availablePool[0];const t=this.getPhrasesPerPartida()-this.currentSession.currentPartidaCount,r=this.currentSession.demoPhrasesTarget-this.currentSession.demoPhrasesShown,a=this.currentSession.availablePool.filter(c=>this.phrases[c]&&this.phrases[c].isDemo===!0),l=this.currentSession.availablePool.filter(c=>!this.phrases[c]||this.phrases[c].isDemo!==!0);return console.log(`[GameSession] Demo logic - Need: ${r}, Remaining: ${t}, Demo available: ${a.length}`),a.length>0?(console.log("[GameSession]  Mostrando frase demo (modo demo puro)"),a[0]):(r<=0||a.length===0)&&l.length>0?(console.log("[GameSession]  Objetivo demo cumplido o sin frases demo, mostrando frase normal"),l[0]):this.currentSession.availablePool[0]}calculatePartidaStats(){if(!this.currentSession)throw new Error("Sesin no disponible para calcular stats");const e=Date.now(),t=Math.floor((e-this.currentSession.startTime)/1e3),r=Math.floor((e-this.currentSession.sessionStartTime)/1e3),a=this.calculateContentBreakdown(),l=this.calculateMotivationalStats(),c={partidaNumber:this.currentSession.partida,phrasesInPartida:this.currentSession.currentPartidaCount,partidaDuration:t,totalPhrasesInSession:this.currentSession.totalPhrasesViewed,sessionDuration:r,contentBreakdown:a,motivation:l};return this.currentSession.isDemoMode&&(c.wasDemoMode=!0,c.demoPhrasesShown=this.currentSession.demoPhrasesShown,c.demoPhrasesTarget=this.currentSession.demoPhrasesTarget),c}calculateContentBreakdown(){if(!this.currentSession)throw new Error("Sesin no disponible");const e=this.phrases.filter(m=>!m.isPremium&&!m.isDemo),t=this.phrases.filter(m=>m.isPremium&&!m.isDemo),r=this.phrases.filter(m=>m.isDemo===!0),a=this.currentSession.phrasesShown;console.log("[GameSession] Calculando progreso:",{totalPhrases:this.phrases.length,basePhrases:e.length,premiumPhrases:t.length,demoPhrases:r.length,playedTotal:a.length});const l=a.filter(m=>{const g=this.phrases[m];return g&&!g.isPremium&&!g.isDemo}),c=a.filter(m=>{const g=this.phrases[m];return g&&g.isPremium&&!g.isDemo}),d=a.filter(m=>{const g=this.phrases[m];return g&&g.isDemo===!0});console.log("[GameSession] Frases jugadas por tipo:",{base:l.length,premium:c.length,demo:d.length});const h={basePhrases:{played:l.length,total:e.length,remaining:Math.max(0,e.length-l.length)}};return t.length>0&&(h.premiumPhrases={played:c.length,total:t.length,remaining:Math.max(0,t.length-c.length)}),r.length>0&&(h.demoPhrases={played:d.length,total:r.length,remaining:Math.max(0,r.length-d.length)}),console.log("[GameSession] Desglose final:",h),h}calculateMotivationalStats(){var T,I,A,C,L;if(!this.currentSession)throw new Error("Sesin no disponible");const e=this.currentSession.ownedPackIds||[];console.log("[GameSession]  Packs del usuario para clculo de stats:",e),console.log("[GameSession]  Total frases en this.phrases:",this.phrases.length);const r=this.phrases.filter(x=>x.isDemo?!1:!x.packIds||x.packIds.length===0?!0:x.packIds.some(U=>e.includes(U))).length;console.log("[GameSession]  Frases accesibles (sin demos):",r),console.log("[GameSession]  Desglose:",{gratuitas:this.phrases.filter(x=>!x.isDemo&&(!x.packIds||x.packIds.length===0)).length,dePacks:this.phrases.filter(x=>!x.isDemo&&x.packIds&&x.packIds.length>0&&x.packIds.some(U=>e.includes(U))).length,demos:this.phrases.filter(x=>x.isDemo).length,total:this.phrases.length});const a=[...new Set(this.currentSession.phrasesShown)].filter(x=>{const U=this.phrases[x];return U&&!U.isDemo}).length,l=Math.round(a/r*100),c=Math.max(0,r-a),d=this.currentSession.phrasesShown,h=d.filter(x=>{const U=this.phrases[x];return U&&U.isPremium&&!U.isDemo}).length,m=d.filter(x=>{const U=this.phrases[x];return U&&U.isDemo===!0}).length,g=this.phraseCounters.isLoaded?this.phraseCounters.totalPremiumPhrases:161,_=this.phraseCounters.isLoaded?this.phraseCounters.totalDemoPhrases:26;this.phraseCounters.isLoaded?console.log("[GameSession]  Usando contadores cargados - Premium:",g,"Demo:",_):console.warn("[GameSession]  Contadores no cargados, usando fallback - Premium:",g,"Demo:",_);let v=0;try{if(console.log("[GameSession]  Calculando frases premium +18..."),console.log("[GameSession] DEBUG phraseCache:",{exists:!!W,hasPremiumPhrases:((T=W==null?void 0:W.premiumPhrases)==null?void 0:T.length)>0,hasAllPhrases:((I=W==null?void 0:W.allPhrases)==null?void 0:I.length)>0,premiumPhrasesCount:(A=W==null?void 0:W.premiumPhrases)==null?void 0:A.length,allPhrasesCount:(C=W==null?void 0:W.allPhrases)==null?void 0:C.length,thisPhrases:this.phrases.length,category:(L=this.currentSession)==null?void 0:L.category}),W&&Array.isArray(W.premiumPhrases)&&W.premiumPhrases.length>0){v=W.premiumPhrases.filter(z=>z.isAdult===!0).length,console.log("[GameSession]  Frases premium +18 desde phraseCache.premiumPhrases:",v),console.log("[GameSession]  Total frases premium en cache:",W.premiumPhrases.length);const U=W.premiumPhrases.filter(z=>z.isAdult===!0).slice(0,3).map(z=>{var $;return{text:(($=z.text)==null?void 0:$.substring(0,40))+"...",isAdult:z.isAdult,isPremium:z.isPremium}});console.log("[GameSession]  Muestra de frases premium +18:",U)}else if(W&&Array.isArray(W.allPhrases)&&W.allPhrases.length>0)v=W.allPhrases.filter(U=>U.isPremium===!0&&U.isAdult===!0).length,console.log("[GameSession]  Frases premium +18 desde phraseCache.allPhrases:",v);else{console.warn("[GameSession]  phraseCache no disponible, usando valor estimado");const x=this.phraseCounters.totalPremiumPhrases||161;v=Math.floor(x*.4),console.log("[GameSession]  Frases premium +18 estimadas:",v,`(${x} * 40%)`)}}catch(x){console.error("[GameSession] Error accediendo al phraseCache:",x);const U=this.phraseCounters.totalPremiumPhrases||161;v=Math.floor(U*.4),console.log("[GameSession] Frases premium +18 estimadas (error fallback):",v)}return console.log("[GameSession] Estadsticas calculadas:",{totalPhrasesAvailable:r,totalPhrasesPlayed:a,progressPercentage:l,phrasesUntilCompletion:c,totalPremium:g,totalDemo:_,premiumViewed:h,demoViewed:m,totalPremiumAdultPhrases:v,thisPhrases:this.phrases.length,thisPhrasesWithoutDemo:this.phrases.filter(x=>!x.isDemo).length,countersLoaded:this.phraseCounters.isLoaded}),{totalPhrasesAvailable:r,totalPhrasesPlayed:a,progressPercentage:l,phrasesUntilCompletion:c,category:this.currentSession.category,premiumStats:{premiumPhrasesViewed:h,totalPremiumPhrases:g,demoPhrasesViewed:m,totalDemoPhrases:_,demoPhrasesRemaining:Math.max(0,_-m),totalPremiumAdultPhrases:v}}}getSessionStats(){return this.currentSession?this.calculatePartidaStats():null}async clearSession(e){console.log("[GameSession] Limpiando sesin"),this.currentSession=null;try{typeof window<"u"&&window.localStorage&&(e?window.localStorage.removeItem(this.getStorageKey(e)):["regular","all-categories","adult-only"].forEach(r=>{window.localStorage.removeItem(this.getStorageKey(r))}))}catch(t){console.error("[GameSession] Error limpiando sesin:",t)}}async saveSession(){if(this.currentSession)try{if(typeof window<"u"&&window.localStorage){const e=this.getStorageKey(this.currentSession.category);window.localStorage.setItem(e,JSON.stringify(this.currentSession))}}catch(e){console.error("[GameSession] Error guardando sesin:",e)}}async getStoredSession(e){try{if(typeof window<"u"&&window.localStorage){const t=window.localStorage.getItem(this.getStorageKey(e));if(t)return JSON.parse(t)}}catch(t){console.error("[GameSession] Error obteniendo sesin guardada:",t)}return null}hasActiveSession(){return this.currentSession!==null}getCurrentPartidaNumber(){var e;return((e=this.currentSession)==null?void 0:e.partida)||0}getCurrentPartidaCount(){var e;return((e=this.currentSession)==null?void 0:e.currentPartidaCount)||0}isPoolSequential(e){if(e.length<2)return!1;const t=Math.min(10,e.length);let r=0,a=0;for(let c=0;c<t-1;c++)e[c+1]===e[c]+1&&r++,e[c+1]===e[c]-1&&a++;const l=(t-1)*.7;return r>=l||a>=l}static formatTime(e){const t=Math.floor(e/60),r=e%60;return`${t}:${r.toString().padStart(2,"0")}`}}const zt=new aM;class oM{constructor(){De(this,"DEMO_STORAGE_KEY","premium_demo_session");De(this,"MAX_PARTIDAS",1);De(this,"demoSession",null);De(this,"demoPhrases",[])}setDemoPhrases(e){this.demoPhrases=e.filter(t=>t.isDemo===!0),console.log(`[PremiumDemo] ${this.demoPhrases.length} frases demo configuradas`)}async activateDemo(){return this.demoPhrases.length===0?(console.log("[PremiumDemo] No hay frases demo disponibles"),!1):(this.demoSession={isActive:!0,startTime:Date.now(),partidasUsadas:0,maxPartidas:this.MAX_PARTIDAS,phrasesShown:0,currentIndex:0,partidaEnCurso:!1},await this.saveSession(),console.log(`[PremiumDemo]  Demo activada por ${this.MAX_PARTIDAS} partida`),!0)}async renewDemo(){return this.demoPhrases.length===0?(console.log("[PremiumDemo] No hay frases demo disponibles para renovar"),!1):(this.demoSession={isActive:!0,startTime:Date.now(),partidasUsadas:0,maxPartidas:this.MAX_PARTIDAS,phrasesShown:0,currentIndex:0,partidaEnCurso:!1},await this.saveSession(),console.log(`[PremiumDemo]  Demo renovada por ${this.MAX_PARTIDAS} partida ms`),!0)}async startDemoPartida(){if(this.demoSession){if(this.demoSession.partidaEnCurso){console.log("[PremiumDemo] La partida demo ya est en curso");return}this.demoSession.partidaEnCurso=!0,this.demoSession.partidasUsadas=Math.min(this.demoSession.partidasUsadas+1,this.demoSession.maxPartidas),await this.saveSession(),console.log("[PremiumDemo]  Demo consumida al iniciar la partida")}}async completePartida(){this.demoSession&&(this.demoSession.partidaEnCurso=!1,this.demoSession.partidasUsadas>=this.demoSession.maxPartidas&&(console.log("[PremiumDemo] Demo completada tras 1 partida"),this.demoSession.isActive=!1),await this.saveSession())}getNextDemoPhrase(){if(!this.isActive())return console.log("[PremiumDemo] Demo no activa"),null;if(!this.demoSession||this.demoSession.currentIndex>=this.demoPhrases.length)return console.log("[PremiumDemo] No hay ms frases demo disponibles"),null;const e=this.demoPhrases[this.demoSession.currentIndex];return this.demoSession.currentIndex++,this.demoSession.phrasesShown++,this.saveSession(),console.log(`[PremiumDemo] Frase demo ${this.demoSession.phrasesShown}/${this.demoPhrases.length}:`,e.text),e}isActive(){return!this.demoSession||!this.demoSession.isActive?!1:this.demoSession.partidasUsadas>=this.demoSession.maxPartidas&&!this.demoSession.partidaEnCurso?(console.log("[PremiumDemo] Demo expirada - partidas agotadas"),this.demoSession.isActive=!1,this.saveSession(),!1):!0}getDemoStatus(){if(!this.demoSession||!this.demoSession.isActive)return{isActive:!1,partidasRestantes:0,phrasesShown:0,totalPhrases:this.demoPhrases.length,canRenew:this.demoPhrases.length>0};const e=Math.max(0,this.demoSession.maxPartidas-this.demoSession.partidasUsadas);return e<=0?this.demoSession.partidaEnCurso?{isActive:!0,partidasRestantes:0,phrasesShown:this.demoSession.phrasesShown,totalPhrases:this.demoPhrases.length,canRenew:!1}:(this.demoSession.isActive=!1,this.saveSession(),{isActive:!1,partidasRestantes:0,phrasesShown:this.demoSession.phrasesShown,totalPhrases:this.demoPhrases.length,canRenew:!0}):{isActive:!0,partidasRestantes:e,phrasesShown:this.demoSession.phrasesShown,totalPhrases:this.demoPhrases.length,canRenew:(this.demoSession.partidaEnCurso,!1)}}hasAvailableDemoPhrases(){return this.demoPhrases.length>0}getAvailableDemoCount(){return this.demoPhrases.length}async initialize(){console.log("[PremiumDemo] Inicializando servicio...");try{const e=await this.getStoredSession();return e&&(this.demoSession=e,console.log("[PremiumDemo] Sesin cargada:",this.getDemoStatus())),!0}catch(e){return console.error("[PremiumDemo] Error inicializando:",e),!1}}clearSession(){console.log("[PremiumDemo] Limpiando sesin"),this.demoSession=null;try{typeof window<"u"&&window.localStorage&&window.localStorage.removeItem(this.DEMO_STORAGE_KEY)}catch(e){console.error("[PremiumDemo] Error limpiando sesin:",e)}}async saveSession(){if(this.demoSession)try{typeof window<"u"&&window.localStorage&&window.localStorage.setItem(this.DEMO_STORAGE_KEY,JSON.stringify(this.demoSession))}catch(e){console.error("[PremiumDemo] Error guardando sesin:",e)}}async getStoredSession(){try{if(typeof window<"u"&&window.localStorage){const e=window.localStorage.getItem(this.DEMO_STORAGE_KEY);if(e)return JSON.parse(e)}}catch(e){console.error("[PremiumDemo] Error obteniendo sesin guardada:",e)}return null}}const rl=new oM;var gt=(n=>(n.Success="success",n.Error="error",n.Warning="warning",n.Info="info",n))(gt||{});const lM=({message:n,type:e,onClose:t,duration:r=4e3})=>{te.useEffect(()=>{const c=setTimeout(()=>{t()},r);return()=>clearTimeout(c)},[r,t]);const l=(()=>{switch(e){case"success":return{bg:"bg-gradient-to-r from-green-500 to-emerald-600",icon:"fa-check-circle",iconColor:"text-white"};case"error":return{bg:"bg-gradient-to-r from-red-500 to-rose-600",icon:"fa-exclamation-circle",iconColor:"text-white"};case"warning":return{bg:"bg-gradient-to-r from-yellow-500 to-amber-600",icon:"fa-exclamation-triangle",iconColor:"text-white"};case"info":return{bg:"bg-gradient-to-r from-blue-500 to-cyan-600",icon:"fa-info-circle",iconColor:"text-white"};default:return{bg:"bg-slate-700",icon:"fa-bell",iconColor:"text-slate-300"}}})();return S.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 animate-fadeIn",style:{paddingTop:"calc(env(safe-area-inset-top) + 1rem)"},children:S.jsxs("div",{className:`${l.bg} rounded-lg shadow-2xl p-4 flex items-center gap-3 max-w-lg mx-auto`,children:[S.jsx("div",{className:"flex-shrink-0",children:S.jsx("i",{className:`fas ${l.icon} ${l.iconColor} text-2xl`})}),S.jsx("div",{className:"flex-1 text-white font-medium leading-snug",children:n}),S.jsx("button",{onClick:t,className:"flex-shrink-0 text-white hover:text-gray-200 transition-colors",children:S.jsx("i",{className:"fas fa-times"})})]})})},on=er("Preferences",{web:()=>Yt(()=>import("./web-D3JO0Q1J.js"),[]).then(n=>new n.PreferencesWeb)}),qn={GAMES_PLAYED:"rate_games_played",HAS_RATED:"rate_has_rated",LAST_PROMPT:"rate_last_prompt",PROMPT_COUNT:"rate_prompt_count",DONT_SHOW_AGAIN:"rate_dont_show_again"};class cM{constructor(){De(this,"gamesPlayed",0);De(this,"hasRated",!1);De(this,"lastPromptDate",null);De(this,"promptCount",0);De(this,"dontShowAgain",!1);De(this,"initialized",!1)}async initialize(){if(!this.initialized)try{const[e,t,r,a,l]=await Promise.all([on.get({key:qn.GAMES_PLAYED}),on.get({key:qn.HAS_RATED}),on.get({key:qn.LAST_PROMPT}),on.get({key:qn.PROMPT_COUNT}),on.get({key:qn.DONT_SHOW_AGAIN})]);this.gamesPlayed=parseInt(e.value||"0"),this.hasRated=t.value==="true",this.lastPromptDate=r.value?parseInt(r.value):null,this.promptCount=parseInt(a.value||"0"),this.dontShowAgain=l.value==="true",this.initialized=!0}catch(e){console.error("[RateAppService] Error initializing:",e)}}async incrementGamesPlayed(){this.initialized||await this.initialize(),this.gamesPlayed++,await on.set({key:qn.GAMES_PLAYED,value:this.gamesPlayed.toString()}),console.log("[RateAppService] Games played:",this.gamesPlayed)}async shouldShowRateModal(){return this.initialized||await this.initialize(),!(this.hasRated||this.dontShowAgain||this.gamesPlayed<3||!((this.gamesPlayed-3)%10===0)&&this.gamesPlayed!==3||this.lastPromptDate&&(Date.now()-this.lastPromptDate)/864e5<3)}async markAsShown(){this.lastPromptDate=Date.now(),this.promptCount++,await Promise.all([on.set({key:qn.LAST_PROMPT,value:this.lastPromptDate.toString()}),on.set({key:qn.PROMPT_COUNT,value:this.promptCount.toString()})])}async markAsRated(){this.hasRated=!0,await on.set({key:qn.HAS_RATED,value:"true"})}async markDontShowAgain(){this.dontShowAgain=!0,await on.set({key:qn.DONT_SHOW_AGAIN,value:"true"})}async reset(){this.gamesPlayed=0,this.hasRated=!1,this.lastPromptDate=null,this.promptCount=0,this.dontShowAgain=!1,await Promise.all([on.remove({key:qn.GAMES_PLAYED}),on.remove({key:qn.HAS_RATED}),on.remove({key:qn.LAST_PROMPT}),on.remove({key:qn.PROMPT_COUNT}),on.remove({key:qn.DONT_SHOW_AGAIN})]),await this.initialize()}}const lh=new cM,ZA=er("Browser",{web:()=>Yt(()=>import("./web-DiMmv9u3.js"),[]).then(n=>new n.BrowserWeb)}),uM=er("AppLauncher",{web:()=>Yt(()=>import("./web-Bi8BB0MD.js"),[]).then(n=>new n.AppLauncherWeb)}),ow=(n,e)=>new Promise((t,r)=>{const a=setTimeout(()=>r(new Error("timeout")),e);n.then(l=>{clearTimeout(a),t(l)}).catch(l=>{clearTimeout(a),r(l)})}),dM=({isVisible:n,onClose:e})=>{const[t,r]=te.useState(!1),a=async()=>{if(!t){r(!0),console.log("[RateModal]  Abriendo Google Play directamente"),await lh.markAsRated();try{await l()}catch(d){console.error("[RateModal]  Error abriendo Google Play:",d)}finally{r(!1),setTimeout(()=>{console.log("[RateModal]  Cerrando modal"),e()},300)}}},l=async()=>{const d="com.mrodr.yonunca";if(Ne.getPlatform()==="android")try{console.log("[RateModal]  Intentando abrir Play Store con AppLauncher");const g=await ow(uM.openUrl({url:`market://details?id=${d}`}),1500);if(g!=null&&g.completed){console.log("[RateModal]  Play Store abierta con AppLauncher");return}}catch(g){console.warn("[RateModal]  AppLauncher fall o tard demasiado  fallback",g)}const m=`https://play.google.com/store/apps/details?id=${d}`;console.log("[RateModal]  Abriendo URL web:",m),await ow(ZA.open({url:m,windowName:"_system"}),1500)},c=()=>{console.log('[RateModal]  Usuario seleccion "Ahora no"'),e()};return S.jsx(br,{isVisible:n,onClose:e,children:S.jsx("div",{className:"bg-gradient-to-br from-indigo-900 to-purple-900 rounded-2xl p-6 text-white max-w-sm mx-auto relative overflow-hidden shadow-2xl border border-white/10",children:S.jsxs("div",{className:"relative z-10 text-center",children:[S.jsx("div",{className:"text-5xl mb-4",children:""}),S.jsx("h2",{className:"text-xl font-bold mb-3",children:"Te lo ests pasando bien?"}),S.jsx("p",{className:"text-purple-200 mb-6 text-sm leading-relaxed",children:"Djanos una resea en Google Play y aydanos a mejorar "}),S.jsxs("div",{className:"space-y-3",children:[S.jsx(Kt,{onClick:a,fullWidth:!0,disabled:t,className:"bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white font-bold shadow-lg disabled:opacity-50",children:t?"Abriendo...":"Resear"}),S.jsx(Kt,{onClick:c,fullWidth:!0,variant:"secondary",className:"text-sm text-purple-300 hover:text-white bg-transparent",children:"Ahora no"})]})]})})})},hM=({isVisible:n,stats:e,onNewGame:t,onDemoActivated:r,onBuyPremium:a,onGoHome:l,hasPremium:c,hasRemoveAds:d,includeAdult:h,adultOnly:m,wasOfflineGame:g=!1})=>{const v=te.useRef(!0);te.useEffect(()=>(v.current=!0,()=>{v.current=!1}),[]);const[T,I]=te.useState(!1),[A,C]=te.useState(!1),[L,x]=te.useState(!1),[U,z]=te.useState(rl.getDemoStatus()),[$,se]=te.useState(!1),[D,P]=te.useState(""),[N,M]=te.useState(null),[B,G]=te.useState("El pack premium incluye +200 nuevas frases"),[k,Ve]=te.useState(!1),[tt,ee]=te.useState(!1);te.useEffect(()=>{bA().then(K=>{v.current&&G(K)}).catch(K=>{console.error("[EndGameModal] Error cargando mensaje promocional:",K)})},[]),te.useEffect(()=>{n&&(async()=>(await lh.incrementGamesPlayed(),await lh.shouldShowRateModal()&&ee(!0)))()},[n]),te.useEffect(()=>{if(n&&L&&tt){const K=setTimeout(()=>{v.current&&(Ve(!0),lh.markAsShown(),ee(!1))},1e3);return()=>clearTimeout(K)}},[n,L,tt]),te.useEffect(()=>{if(n&&!L){if(d){I(!1),x(!0);return}try{if(sessionStorage.getItem("suppress_endgame_ad_once")==="1"){I(!1),x(!0),sessionStorage.removeItem("suppress_endgame_ad_once");return}}catch{}he()}},[n,L]),te.useEffect(()=>{n||(I(!1),Ve(!1),ee(!1))},[n]),te.useEffect(()=>{const K=setInterval(()=>{z(rl.getDemoStatus())},1e3);return()=>clearInterval(K)},[]),te.useEffect(()=>{(async()=>{try{if(!n)return;if(await xt.checkConnection(!0)){se(!1),P("");return}if(d)se(!1),P("");else{const pe=await xt.canPlayOffline(d);pe.allowed?(se(!1),P("")):(se(!0),P(pe.reason||"Lmite offline alcanzado"))}}catch(ue){console.warn("[EndGameModal] Error verificando estado offline:",ue)}})()},[n,d]);const he=async()=>{if(!L){I(!0);try{console.log("[EndGameModal] Mostrando anuncio intersticial...");let K;const ue=new Promise(Pe=>{K=window.setTimeout(()=>{Pe({success:!1,error:"timeout"})},12e4)}),pe=await Promise.race([wr.showEndGameInterstitial({force:!0}),ue]);K&&clearTimeout(K),pe.success?console.log("[EndGameModal]  Anuncio mostrado exitosamente"):pe.error==="timeout"?console.log("[EndGameModal]  Timeout al cargar el intersticial (>10s). Continuando sin anuncio."):console.log("[EndGameModal]  Anuncio no disponible:",pe.error)}catch(K){console.error("[EndGameModal] Error mostrando anuncio:",K)}finally{if(!v.current)return;I(!1),x(!0)}}},Ie=()=>{x(!1),t()},Le=K=>{const{progressPercentage:ue,phrasesUntilCompletion:pe,totalPhrasesPlayed:Pe,totalPhrasesAvailable:je}=K;return m?pe===0?c?{emoji:"",title:"100% completado de frases +18!",subtitle:"Has descubierto todas las frases +18. Cambia al modo normal para ms contenido."}:{emoji:"",title:"100% completado de frases +18 gratuitas!",subtitle:"Compra el pack premium para desbloquear ms frases +18, o cambia al modo normal para disfrutar de muchas ms frases gratuitas."}:ue>=80?{emoji:"",title:"Casi terminas las frases +18!",subtitle:`Has visto ${Pe} de ${je} frases +18. Solo quedan ${pe}! Tambin hay ms frases en el modo normal.`}:ue>=50?{emoji:"",title:"Vas por buen camino en +18!",subtitle:`${Pe} frases +18 vistas. Quedan ${pe} por descubrir.`}:ue>=25?{emoji:"",title:"Buen progreso en +18!",subtitle:`${Pe} frases +18 descubiertas. Quedan ${pe} ms! Tambin puedes probar el modo normal.`}:{emoji:"",title:"Acabas de empezar en +18!",subtitle:`Solo ${Pe} frases +18 vistas. ${pe} esperando! Recuerda que el modo normal tiene ms contenido.`}:ue>=80?{emoji:"",title:"Casi eres un experto!",subtitle:`Has descubierto ${Pe} de ${je} frases.
Solo quedan ${pe}!`}:ue>=50?{emoji:"",title:"Vas por buen camino!",subtitle:`${Pe} frases vistas. Quedan ${pe} por descubrir`}:ue>=25?{emoji:"",title:"Buen progreso!",subtitle:`${Pe} frases descubiertas. Quedan ${pe} ms!`}:{emoji:"",title:"Acabas de empezar!",subtitle:`Solo ${Pe} frases vistas. ${pe} esperando por ti!`}},j=m?{text:"Nueva Partida +18",emoji:S.jsx("i",{className:"fas fa-fire text-lg"}),className:"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white shadow-lg shadow-red-500/20",wrapperClass:""}:{text:"Nueva Partida",emoji:S.jsx("i",{className:"fas fa-play text-lg"}),className:"bg-gradient-to-r from-cyan-500 to-pink-500 hover:from-cyan-600 hover:to-pink-600 text-white font-bold",wrapperClass:"main-play-button"};return S.jsxs(S.Fragment,{children:[S.jsxs(br,{isVisible:n,onClose:l,children:[S.jsxs("div",{className:"bg-gradient-to-br from-purple-900 via-blue-900 to-purple-800 rounded-2xl p-6 text-white max-w-sm mx-auto relative overflow-hidden",children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-purple-400/10 animate-pulse"}),S.jsxs("div",{className:"relative z-10",children:[S.jsxs("div",{className:"text-center mb-4",children:[S.jsx("div",{className:"text-3xl mb-1 modal-icon-bounce",children:""}),S.jsx("h2",{className:"text-xl font-bold",children:"Partida Completada!"})]}),e.wasDemoMode&&S.jsx("div",{className:"bg-white/10 rounded-xl p-3 mb-4 backdrop-blur-sm",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-sm font-semibold text-orange-400 mb-1",children:" Modo Demo"}),S.jsxs("div",{className:"text-xs text-gray-300",children:["Frases premium vistas: ",S.jsxs("span",{className:"font-bold text-orange-300",children:[e.demoPhrasesShown,"/",e.demoPhrasesTarget]})]}),e.demoPhrasesShown===e.demoPhrasesTarget&&S.jsx("div",{className:"text-xs text-green-300 mt-1",children:" Objetivo completado!"})]})}),S.jsx("div",{className:"bg-gradient-to-r from-cyan-500/10 to-purple-500/10 rounded-xl p-4 mb-4 backdrop-blur-sm border border-cyan-400/20",children:(()=>{const K=Le(e.motivation);return S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-2xl mb-2",children:K.emoji}),S.jsx("div",{className:"text-sm font-semibold text-cyan-300 mb-1",children:K.title}),S.jsx("div",{className:"text-xs text-gray-300 mb-3",children:K.subtitle}),S.jsx("div",{className:"bg-gray-700 rounded-full h-2 mb-2",children:S.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-purple-500 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(e.motivation.progressPercentage,100)}%`}})}),S.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-3",children:[S.jsxs("span",{children:[e.motivation.totalPhrasesPlayed," ",m?"frases +18 vistas":"frases vistas"]}),S.jsxs("span",{children:[e.motivation.progressPercentage,"% ","completado"]})]}),!c&&S.jsx("div",{className:"space-y-2 text-xs",children:S.jsx("div",{className:"bg-orange-500/10 rounded-lg px-3 py-2",children:S.jsx("div",{className:"text-orange-300 text-center",children:S.jsx("div",{className:"text-orange-200 mt-1",children:B})})})})]})})()}),T&&!L&&S.jsx("div",{className:"bg-yellow-500/20 rounded-xl p-3 mb-4 text-center",children:S.jsxs("div",{className:"text-sm flex items-center justify-center",children:[S.jsx("i",{className:"fas fa-film text-lg mr-2 animate-bounce"}),"Cargando anuncio..."]})}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("div",{className:j.wrapperClass,children:S.jsxs(Kt,{onClick:Ie,fullWidth:!0,size:"normal",className:j.className,disabled:T&&!L,children:[S.jsx("span",{className:"mr-2",children:j.emoji}),j.text]})}),!d&&$&&S.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-3 w-full flex items-center gap-3",children:[S.jsx("i",{className:"fas fa-ban text-red-300"}),S.jsx("div",{className:"text-sm text-red-300",children:D||"Lmite offline alcanzado. Vuelve maana o desbloquea el Pack Sin Anuncios."})]}),S.jsxs("div",{className:"flex gap-3",children:[S.jsx(Kt,{onClick:a,size:"normal",className:g?"w-1/2 bg-gradient-to-r from-yellow-500 via-amber-500 to-orange-500 hover:from-yellow-600 hover:via-amber-600 hover:to-orange-600 text-white font-semibold shadow-xl shadow-amber-500/30 border-2 border-yellow-400/50":"flex-1 bg-gradient-to-r from-yellow-500 via-amber-500 to-orange-500 hover:from-yellow-600 hover:via-amber-600 hover:to-orange-600 text-white font-semibold shadow-xl shadow-amber-500/30 border-2 border-yellow-400/50",disabled:T&&!L,children:S.jsxs("span",{className:"flex items-center justify-center gap-2",children:[S.jsx("i",{className:"fas fa-store text-lg"}),S.jsx("span",{className:"text-sm font-bold",children:"Tienda"})]})}),S.jsxs(Kt,{onClick:l,variant:"secondary",size:"normal",className:g?"w-1/2":"flex-1",disabled:T&&!L,children:[S.jsx("i",{className:"fas fa-home mr-1"}),"Men"]})]})]}),U.isActive&&S.jsxs("div",{className:"mt-4 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-3 text-center border border-purple-400/30",children:[S.jsxs("div",{className:"text-sm font-medium flex items-center justify-center",children:[S.jsx("i",{className:"fas fa-gamepad mr-2 text-purple-300"}),"Demo Premium Activa"]}),S.jsxs("div",{className:"text-xs text-purple-200 mt-1",children:[U.phrasesShown," frases usadas  ",U.partidasRestantes," partida restante"]})]})]})]}),N&&S.jsx(lM,{message:N.message,type:N.type,onClose:()=>M(null)})]}),S.jsx(dM,{isVisible:k,onClose:()=>Ve(!1)})]})},fM=({isVisible:n,onContinuePlaying:e,onGoToStore:t,onGoToNormalMode:r,hasPremium:a,content:l})=>{const d=l||{icon:"fa-trophy",title:"Enhorabuena bebedor!",subtitle:"Has completado todas las frases disponibles",message:a?"Has visto todas las frases! Puedes seguir jugando para revivirlas.":"Has completado todas las frases gratuitas! Desbloquea cientos de frases adicionales con el pack premium.",showStoreButton:!a,showReplay:!0,showGoToNormal:!1,buttonText:a?"Jugar de Nuevo":"Ver Tienda Premium",primaryAction:void 0},h=d.primaryAction||(d.showStoreButton?"store":"replay");return S.jsx(br,{isVisible:n,onClose:e,children:S.jsxs("div",{className:"bg-gradient-to-br from-green-900 via-emerald-900 to-teal-800 rounded-2xl p-6 text-white max-w-sm mx-auto relative overflow-hidden",children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/10 to-green-400/10 animate-pulse"}),S.jsxs("div",{className:"relative z-10 text-center",children:[S.jsx("div",{className:"text-5xl mb-3 select-none modal-icon-bounce",children:S.jsx("i",{className:`fas ${d.icon||"fa-trophy"} text-yellow-300`})}),S.jsx("h2",{className:"text-xl font-bold mb-2 text-yellow-300",children:d.title}),d.subtitle&&S.jsx("p",{className:"text-sm text-green-200 mb-4",children:d.subtitle}),S.jsx("div",{className:"bg-white/10 rounded-xl p-4 mb-6 backdrop-blur-sm",children:S.jsx("p",{className:"text-sm text-gray-200 leading-relaxed",children:d.message})}),S.jsxs("div",{className:"bg-gradient-to-r from-emerald-500/20 to-teal-500/20 rounded-lg p-3 mb-6 border border-emerald-400/30",children:[S.jsxs("div",{className:"text-lg font-bold text-emerald-300 flex items-center justify-center gap-2",children:[S.jsx("i",{className:"fas fa-bullseye select-none"}),S.jsx("span",{children:"100% Completado"})]}),S.jsx("div",{className:"text-xs text-emerald-200 mt-1",children:a?"Coleccin completa vista":d.showGoToNormal?"Contenido gratuito +18 completado":"Contenido gratuito completado"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs(Kt,{onClick:h==="store"?t:h==="goToNormal"&&r?r:e,fullWidth:!0,size:"large",className:"bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700 text-white shadow-lg shadow-yellow-500/20",children:[S.jsx("i",{className:`fas ${h==="store"?"fa-shopping-cart":h==="goToNormal"?"fa-home":"fa-gamepad"} mr-2`}),d.buttonText]}),d.showReplay&&h!=="replay"&&S.jsxs(Kt,{onClick:e,variant:"secondary",fullWidth:!0,className:"border-emerald-400/50 text-emerald-200 hover:bg-emerald-500/10",children:[S.jsx("i",{className:"fas fa-sync-alt mr-2"}),"Jugar de Nuevo"]}),d.showGoToNormal&&r&&S.jsxs(Kt,{onClick:r,variant:"secondary",fullWidth:!0,className:"border-blue-400/50 text-blue-200 hover:bg-blue-500/10",children:[S.jsx("i",{className:"fas fa-home mr-2"}),"Volver al Men"]})]}),!a&&S.jsxs("div",{className:"mt-4 text-xs text-green-300/80 flex items-center justify-center gap-1.5",children:[S.jsx("i",{className:"fas fa-lightbulb"}),S.jsx("span",{children:"Los packs premium incluyen cientos de frases adicionales"})]})]})]})})},mM=({isVisible:n,onViewStore:e,onClose:t})=>S.jsx(br,{isVisible:n,onClose:t,children:S.jsxs("div",{className:"bg-gradient-to-b from-purple-900 to-gray-900 rounded-lg p-3 shadow-xl space-y-4 max-w-sm mx-auto",children:[S.jsxs("div",{className:"text-center space-y-1",children:[S.jsx("div",{className:"text-3xl",children:""}),S.jsx("h2",{className:"text-lg font-bold text-white",children:"Partida Offline Completada!"})]}),S.jsx("div",{className:"bg-purple-800/40 rounded-lg p-2 border border-purple-500/50",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xl font-bold text-purple-200",children:"15/15"}),S.jsx("div",{className:"text-xs text-purple-300",children:"Frases completadas"})]})}),S.jsxs("div",{className:"text-center",children:[S.jsxs("p",{className:"text-gray-200 text-sm",children:["Completaste tu ",S.jsx("strong",{className:"text-purple-300",children:"partida offline diaria"})]}),S.jsxs("p",{className:"text-xs text-gray-400",children:["Limitada a ",S.jsx("strong",{children:"15 frases"})," por estar sin conexin."]})]}),S.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[S.jsx("div",{className:"text-center text-xs font-bold text-gray-300 mb-1",children:"Modos"}),S.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[S.jsx("div",{className:"bg-red-900/30 border border-red-500/50 rounded p-1",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-lg",children:""}),S.jsx("div",{className:"text-xs font-bold text-red-200",children:"Gratis"}),S.jsxs("div",{className:"text-[10px] text-red-300",children:[S.jsx("div",{children:"1/da"}),S.jsx("div",{children:"15 frases"}),S.jsx("div",{children:"Con anuncios"})]})]})}),S.jsx("div",{className:"bg-gradient-to-br from-yellow-900/40 to-orange-900/40 border border-yellow-500/70 rounded p-1",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-lg",children:""}),S.jsx("div",{className:"text-xs font-bold text-yellow-200",children:"Sin Anuncios"}),S.jsxs("div",{className:"text-[10px] text-yellow-300",children:[S.jsx("div",{children:" offline"}),S.jsx("div",{children:"30 frases"}),S.jsx("div",{children:"Sin anuncios"})]})]})})]})]}),S.jsx("div",{className:"bg-gradient-to-r from-yellow-900/60 to-orange-900/60 border border-yellow-500/70 rounded-lg p-2",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-lg",children:""}),S.jsx("h3",{className:"font-bold text-yellow-200 text-sm",children:"Juegas sin internet?"}),S.jsxs("p",{className:"text-xs text-yellow-300",children:["Desbloquea el ",S.jsx("strong",{children:"Pack Sin Anuncios"})," para jugar ",S.jsx("strong",{children:"ilimitado"})," sin conexin"]}),S.jsxs("div",{className:"flex items-center justify-center gap-1 text-[10px] text-yellow-400",children:[S.jsx("span",{children:""}),S.jsx("span",{children:"30 frases"}),S.jsx("span",{children:""}),S.jsx("span",{children:"Sin lmite"}),S.jsx("span",{children:""}),S.jsx("span",{children:"Sin anuncios"}),S.jsx("span",{children:""})]})]})}),S.jsx("div",{children:S.jsx(Kt,{onClick:t,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 font-bold text-base py-2",children:"Volver al Inicio"})}),S.jsx("div",{className:"text-center text-[10px] text-gray-500 mt-1",children:" Tu lmite offline se renueva cada 24h"})]})}),pM=({navigate:n,hasPremium:e,hasRemoveAds:t,includeAdult:r,adultOnly:a,ownedPackIds:l=[],storeProducts:c=[]})=>{const d=l.length>0,[h,m]=te.useState([]),[g,_]=te.useState(null),[v,T]=te.useState(!0),[I,A]=te.useState(null),[C,L]=te.useState(!1),[x,U]=te.useState(null),[z,$]=te.useState(!1),[se,D]=te.useState(null),[P,N]=te.useState(!1),[M,B]=te.useState(!0),[G,k]=te.useState(!1),[Ve,tt]=te.useState(!1),[ee,he]=te.useState(!1),[Ie,Le]=te.useState(!1),[Ge,j]=te.useState(!1);te.useEffect(()=>{if(g&&(console.log("[GameScreen]  Nueva frase cargada:",{text:g.text.substring(0,50)+"...",isPremium:g.isPremium,isAdult:g.isAdult,packIds:g.packIds,hasPackIds:!!g.packIds&&g.packIds.length>0}),g.packIds&&g.packIds.length>0)){console.log("[GameScreen]  Frase pertenece a packs:",g.packIds),console.log("[GameScreen]  Total productos cargados:",c.length);const ve=c.find(Ae=>{var Se;return(Se=g.packIds)==null?void 0:Se.includes(Ae.productId)});console.log("[GameScreen]  Producto matching encontrado:",ve?{productId:ve.productId,title:ve.title,packTag:ve.packTag}:"NINGUNO")}},[g,c]);const K=()=>a?"adult-only":r?"all-categories":"regular";te.useEffect(()=>{(async()=>{try{T(!0),A(null),M&&a&&(await new Promise(me=>setTimeout(me,100)),B(!1));const Ae=await xt.checkConnection(!0);let Se=!1;if(console.log("[GameScreen]  Verificacin de conexin:",Ae?"ONLINE":"OFFLINE"),!Ae){const me=await xt.canPlayOffline(t,!0);console.log("[GameScreen]  Puede jugar offline?:",me.allowed,"- Razn:",me.reason),me.allowed?(console.log("[GameScreen]  Activando modo offline al cargar frases"),xt.getOfflineGameData().currentGameStarted||xt.markOfflineGameStarted(),he(!0),Se=!0):(console.log("[GameScreen]  No puede jugar offline - canPlayOffline.allowed = false"),console.log("[GameScreen]  Razn completa:",me.reason))}const ze=await EA(e,!!r,l);console.log("[GameScreen]  Resumen de frases obtenidas:"),console.log("[GameScreen] - Total frases fetch: ",ze.length),console.log("[GameScreen] - Modo adultOnly:",a),console.log("[GameScreen] - Packs adquiridos (ownedPackIds):",l);const it={};if(ze.forEach(me=>{me.packIds&&me.packIds.length>0&&me.packIds.forEach(ge=>{it[ge]||(it[ge]={total:0,adult:0,nonAdult:0}),it[ge].total++,me.isAdult?it[ge].adult++:it[ge].nonAdult++})}),console.log("[GameScreen]  Frases por pack:",it),console.log('[GameScreen]  Pack "starter_pack" encontrado:',l.includes("starter_pack")),l.includes("starter_pack")){const me=ze.filter(re=>{var ye;return(ye=re.packIds)==null?void 0:ye.includes("starter_pack")}),ge=me.filter(re=>re.isAdult);console.log("[GameScreen]  Pack starter_pack (bienvenida):"),console.log("[GameScreen]   - Total frases: ",me.length),console.log("[GameScreen]   - Frases +18: ",ge.length),console.log("[GameScreen]   - Frases normales: ",me.length-ge.length)}const Rt=a?ze.filter(me=>me.isAdult):ze;if(console.log("[GameScreen]  Frases despus de filtro adultOnly:",Rt.length),a){const me={};Rt.forEach(ge=>{ge.packIds&&ge.packIds.length>0&&ge.packIds.forEach(re=>{me[re]=(me[re]||0)+1})}),console.log("[GameScreen]  Frases +18 por pack (despus de filtro):",me)}if(Rt.length===0)if(a){if(N(!0),!a)try{const me=c.filter(re=>re.type!=="remove_ads"&&re.type!=="premium_phrases").map(re=>re.productId),ge=me.length>0&&me.every(re=>Array.isArray(l)?l.includes(re):!1)}catch(me){console.warn("[GameScreen] No se pudo desbloquear logro completista:",me)}T(!1);return}else{A("No se encontraron frases. Intntalo ms tarde.");return}m(Rt),rl.setDemoPhrases(Rt);try{await rl.initialize()}catch(me){console.warn("[GameScreen] Advertencia inicializando demo premium:",me)}const et=K(),we=l.includes("starter");await zt.initializeSession(et,Rt,e,t,we,l);try{const{playTimeTrackingService:me}=await Yt(async()=>{const{playTimeTrackingService:ge}=await import("./playTimeTrackingService-Br-3YliA.js");return{playTimeTrackingService:ge}},[]);await me.trackGameStart(),console.log("[GameScreen]  Sesin de juego registrada para tracking de patrones")}catch(me){console.error("[GameScreen]  Error registrando sesin de juego:",me)}Se?(console.log("[GameScreen]  Activando modo offline en gameSessionService..."),await zt.activateOfflineMode(t),console.log("[GameScreen]  Modo offline activado en la sesin con lmite:",t?"30 frases (con remove_ads)":"15 frases (sin remove_ads)"),j(!0)):console.log("[GameScreen]  offlineModeActive = false, NO se activar modo offline en gameSessionService");const _e=await zt.getNextPhrase();_e!=null&&_e.phrase&&_(_e.phrase)}catch(Ae){A("No se pudieron cargar las frases. Revisa tu conexin."),console.error("[GameScreen] Error cargando frases:",Ae)}finally{T(!1)}})()},[e,r,a,l]),te.useEffect(()=>{console.log("[GameScreen]  Iniciando monitoreo de conexin offline");const ve=()=>{console.log("[GameScreen]  CONEXIN PERDIDA - Mostrando modal"),ee||k(!0)},Ae=async()=>{console.log("[GameScreen]  CONEXIN RESTAURADA"),k(!1),ee&&(zt.deactivateOfflineMode(),he(!1));try{console.log("[GameScreen]  Recargando anuncios tras recuperar conexin..."),await wr.retryLoadAdsAfterConnectionRestored()}catch(Se){console.warn("[GameScreen]  Error recargando anuncios:",Se)}};return xt.startConnectionMonitoring(ve,Ae),()=>{console.log("[GameScreen]  Deteniendo monitoreo de conexin"),xt.stopConnectionMonitoring(),ee&&xt.hasActiveOfflineGame()&&(console.log("[GameScreen]  Partida offline en curso detectada al cerrar - marcando como usada (anti-fraude)"),xt.markOfflineGameCompleted())}},[ee]);const ue=te.useCallback(async()=>{try{const ve=await zt.getNextPhrase();if(console.log("[GameScreen]  Resultado getNextPhrase:",{isOfflineLimitReached:ve.isOfflineLimitReached,isOfflineMode:ee,hasRemoveAds:t,isEndOfPartida:ve.isEndOfPartida}),ve.isOfflineLimitReached&&ee&&!t){console.log("[GameScreen]  Lmite de partida offline alcanzado (15 frases) - Usuario sin remove_ads"),xt.markOfflineGameCompleted(),await zt.deactivateOfflineMode(),he(!1),j(!0),tt(!0);return}if(ve.needsCompletionModal){console.log("[GameScreen]  Mostrando modal de completitud"),iw({isPremium:e,isAdult:a||!1}),N(!0);return}if(ve.phrase)_(ve.phrase);else if(!ve.isEndOfPartida){console.log("[GameScreen]  Pool agotado, reiniciando automticamente para replay"),await zt.startNewPartida();const Ae=zt.getCurrentPhrase();Ae!=null&&Ae.phrase&&_(Ae.phrase);return}if(ve.isEndOfPartida&&ve.stats){if(console.log("[GameScreen]  Fin de partida alcanzado:",ve.stats),ve.isOfflineLimitReached&&!t){j(!0),tt(!0);return}try{if(zt.hasCompletedAvailableContent()){console.log("[GameScreen]  Contenido 100% completado - mostrando CompletionModal"),iw({isPremium:e,isAdult:a||!1}),N(!0);return}}catch(Ae){console.warn("[GameScreen] No se pudo verificar completitud al final de partida:",Ae)}z&&(await rl.completePartida(),$(!1),D(null),await zt.deactivateDemoMode(),console.log("[GameScreen] Demo partida completada")),U(ve.stats),ve.stats&&Vk({phrasesPlayed:ve.stats.phrasesInPartida,duration:ve.stats.partidaDuration,includeAdult:r||!1}),j(!1),L(!0)}}catch(ve){if(console.error("[GameScreen] Error obteniendo siguiente frase:",ve),ve instanceof Error&&ve.message.includes("No hay frases disponibles")){console.log("[GameScreen]  Reiniciando pool tras error de frases agotadas");try{await zt.startNewPartida();const Ae=zt.getCurrentPhrase();Ae!=null&&Ae.phrase&&_(Ae.phrase)}catch(Ae){console.error("[GameScreen] Error al reiniciar pool:",Ae),A("Error obteniendo la siguiente frase.")}}else A("Error obteniendo la siguiente frase.")}},[z]),pe=async()=>{var ve,Ae;try{if(L(!1),T(!0),A(null),j(!1),console.log("[GameScreen]  Iniciando nueva partida..."),console.log("[GameScreen] Modo: adultOnly="+a+", includeAdult="+r),!await xt.checkConnection(!0)){if(!(await xt.canPlayOffline(t)).allowed){console.log("[GameScreen]  Bloqueado por lmite offline. Mostrando modal de lmites."),Le(!0),k(!0),T(!1);return}xt.markOfflineGameStarted(),await zt.activateOfflineMode(t),he(!0)}Uk({includeAdult:r||!1,adultOnly:a||!1,hasPremium:e}),await zt.startNewPartida(),console.log("[GameScreen]  Nueva partida iniciada, obteniendo primera frase...");const ze=zt.getCurrentPhrase();console.log("[GameScreen] Resultado getCurrentPhrase:",{hasPhrase:!!(ze!=null&&ze.phrase),phraseText:(Ae=(ve=ze==null?void 0:ze.phrase)==null?void 0:ve.text)==null?void 0:Ae.substring(0,50)}),ze!=null&&ze.phrase?_(ze.phrase):console.warn("[GameScreen]  No se obtuvo frase despus de startNewPartida")}catch(Se){console.error("[GameScreen]  Error iniciando nueva partida:",Se),console.error("[GameScreen] Error stack:",Se instanceof Error?Se.stack:"No stack"),A("Error iniciando nueva partida.")}finally{T(!1)}},Pe=async()=>{L(!1),$(!0),await zt.activateDemoMode();try{await rl.startDemoPartida()}catch(Ae){console.warn("[GameScreen] Advertencia consumiendo demo al inicio:",Ae)}await zt.startNewPartida();const ve=zt.getCurrentPhrase();ve!=null&&ve.phrase&&_(ve.phrase),console.log("[GameScreen]  Modo demo activado - frases demo mezcladas en partida normal")},je=()=>{try{sessionStorage.setItem("return_to_endgame","1")}catch{}L(!1),n(yt.Store)},nt=()=>{L(!1),n(yt.Home)},We=()=>{try{sessionStorage.setItem("return_to_completion","1")}catch{}N(!1),n(yt.Store)},Ke=async()=>{N(!1);try{if(!await xt.checkConnection(!0)){if(!(await xt.canPlayOffline(t)).allowed){console.log("[GameScreen]  Bloqueado por lmite offline al continuar. Mostrando modal."),k(!0);return}xt.markOfflineGameStarted(),await zt.activateOfflineMode(t),he(!0)}await zt.startNewPartida();const Ae=zt.getCurrentPhrase();Ae!=null&&Ae.phrase&&_(Ae.phrase)}catch(ve){console.error("[GameScreen] Error continuando despus de completitud:",ve),A("Error reiniciando el juego.")}},Ze=async()=>{console.log("[GameScreen]  Iniciando partida offline...");try{const ve=await xt.canPlayOffline(t);if(!ve.allowed){alert(ve.reason||"No puedes iniciar partida offline"),k(!1);return}xt.markOfflineGameStarted(),await zt.activateOfflineMode(t),he(!0),k(!1),console.log("[GameScreen]  Partida offline iniciada - lmite:",t?30:15,"frases")}catch(ve){console.error("[GameScreen] Error iniciando partida offline:",ve),alert("Error iniciando partida offline")}},Vt=async()=>{if(console.log("[GameScreen]  Usuario confirm conexin restaurada"),await xt.checkConnection(!0)){console.log("[GameScreen]  Conexin verificada - cerrando modal"),k(!1),ee&&(await zt.deactivateOfflineMode(),he(!1));try{console.log("[GameScreen]  Recargando anuncios tras recuperar conexin..."),await wr.retryLoadAdsAfterConnectionRestored()}catch(Ae){console.warn("[GameScreen]  Error recargando anuncios:",Ae)}}else console.log("[GameScreen]  An sin conexin"),alert("An no hay conexin a internet. Verifica tu WiFi o datos mviles.")},Wt=()=>{tt(!1),n(yt.Store)},Rn=()=>{tt(!1),n(yt.Home)},yn=()=>{N(!1);try{zt.clearSession("adult-only")}catch{}n(yt.Home)},Te=()=>(g==null?void 0:g.text)||"";te.useEffect(()=>{try{if(sessionStorage.getItem("return_to_endgame")==="1"){try{sessionStorage.setItem("suppress_endgame_ad_once","1")}catch{}const Se=zt.getSessionStats();Se&&(U(Se),L(!0)),sessionStorage.removeItem("return_to_endgame")}sessionStorage.getItem("return_to_completion")==="1"&&(N(!0),sessionStorage.removeItem("return_to_completion"))}catch{}},[]);const oe=()=>{if(v)return S.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[S.jsx("i",{className:"fas fa-spinner fa-spin text-5xl text-cyan-400"}),S.jsx("p",{className:"mt-4 text-slate-300",children:"Cargando frases..."})]});if(I)return S.jsx("p",{className:"text-center text-red-400",children:I});const ve=Te();return ve?S.jsxs("div",{className:"text-center text-2xl md:text-3xl font-semibold leading-relaxed animate-pop-in",children:[S.jsx("span",{className:"text-slate-400",children:"Yo nunca..."}),S.jsx("br",{}),S.jsx("span",{className:"text-white drop-shadow-lg",children:ve}),S.jsxs("div",{className:"mt-4 flex justify-center space-x-2",children:[(g==null?void 0:g.isPremium)&&!z&&S.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-yellow-400 to-amber-500 text-amber-900 shadow-lg",children:[S.jsx("i",{className:"fas fa-star mr-1 text-xs"}),"Premium"]}),!z&&!(g!=null&&g.isPremium)&&(g==null?void 0:g.packIds)&&g.packIds.length>0&&(()=>{var Se;const Ae=c.find(ze=>{var it;return((it=g.packIds)==null?void 0:it.includes(ze.productId))&&!!ze.packTag});if(Ae!=null&&Ae.packTag){const ze=Ae.icon||"fas fa-box",it=(Se=Ae.color)!=null&&Se.startsWith("bg-")?Ae.color:"",Rt=!it&&Ae.color?{background:Ae.color,color:"#fff"}:void 0;return S.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium shadow-lg ${it}`.trim(),style:Rt,children:[S.jsx("i",{className:`${ze} mr-1 text-xs`}),Ae.packTag]})}return null})(),z&&(g==null?void 0:g.isDemo)&&S.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-orange-400 to-pink-500 text-white shadow-lg",children:[S.jsx("i",{className:"fas fa-star mr-1 text-xs"}),"Frase premium"]}),z&&S.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-purple-500 to-indigo-500 text-white shadow-lg",children:[S.jsx("i",{className:"fas fa-play mr-1 text-xs"}),"Modo Demo"]})]})]}):(console.log("[GameScreen]  No hay frase actual, intentando reiniciar pool"),zt.startNewPartida().then(()=>{const Ae=zt.getCurrentPhrase();Ae!=null&&Ae.phrase&&_(Ae.phrase)}),S.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[S.jsx("i",{className:"fas fa-spinner fa-spin text-5xl text-cyan-400"}),S.jsx("p",{className:"mt-4 text-slate-300",children:"Preparando frases..."})]}))},Ue=()=>{k(!1),Ie&&(L(!0),Le(!1))};return S.jsxs("div",{className:`relative overflow-hidden flex flex-col h-screen w-full p-4 ${a&&M?"screen-slide-in":"animate-slide-in-bounce"}`,style:{paddingTop:"calc(env(safe-area-inset-top) + 1rem)",willChange:a&&M?"transform, opacity":"auto",transform:"translateZ(0)"},children:[S.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none","aria-hidden":"true",children:[a?S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"absolute -top-16 -left-16 w-72 h-72 bg-red-500/20 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute -bottom-20 -right-16 w-80 h-80 bg-pink-600/18 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[36rem] h-[36rem] bg-red-600/12 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-red-950/12 via-pink-950/8 to-red-950/18"})]}):S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"absolute -top-16 -left-16 w-72 h-72 bg-cyan-500/20 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute -bottom-20 -right-16 w-80 h-80 bg-pink-500/20 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[36rem] h-[36rem] bg-violet-500/10 rounded-full blur-3xl"})]}),S.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(120% 120% at 50% 30%, rgba(255,255,255,0.04) 0%, rgba(0,0,0,0.35) 70%)",opacity:.25}})]}),S.jsx("div",{className:"absolute left-4",style:{top:"calc(env(safe-area-inset-top) + 1rem)"},children:S.jsx("button",{onClick:()=>n(yt.Home),className:"text-slate-400 hover:text-white transition-colors",children:S.jsx("i",{className:"fas fa-arrow-left fa-lg"})})}),S.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 text-center",children:[oe(),S.jsx("div",{className:"w-full max-w-xs mt-8",children:S.jsxs(Kt,{onClick:ue,disabled:!g&&!se,fullWidth:!0,size:"large",variant:a?"secondary":"primary",className:a?"fire-button !bg-gradient-to-r !from-red-500 !to-pink-600 hover:!from-red-600 hover:!to-pink-700 !border-red-500/50 !text-white !shadow-lg !shadow-pink-500/30":"",children:[S.jsx("i",{className:"fas fa-forward mr-2"}),"Siguiente"]})})]}),C&&x&&!Ve&&S.jsx(hM,{isVisible:C,stats:x,onNewGame:pe,onDemoActivated:Pe,onBuyPremium:je,onGoHome:nt,hasPremium:e,hasRemoveAds:t,includeAdult:r,adultOnly:a,wasOfflineGame:Ge}),P&&S.jsx(fM,{isVisible:P,hasPremium:e,onGoToStore:We,onContinuePlaying:Ke,onGoToNormalMode:a?yn:void 0,content:a?{icon:"fa-fire",title:"Enhorabuena bebedor!",subtitle:"100% de contenido +18 completado",message:d?"Has visto todas las frases +18! Puedes seguir jugando para revivirlas o ir al modo normal.":"Has completado todas las frases +18 gratuitas! Compra packs premium para desbloquear ms frases +18, o cambia al modo normal para disfrutar de muchas ms frases gratuitas.",showStoreButton:!d,showReplay:!0,showGoToNormal:!0,buttonText:d?"Volver a Jugar":"Ver Tienda",primaryAction:d?"replay":"store"}:void 0}),S.jsx(JA,{isOpen:G,onStartOfflineGame:Ze,onConnectionRestored:Vt,onClose:Ue,hasRemoveAds:t}),S.jsx(mM,{isVisible:Ve,onViewStore:Wt,onClose:Rn})]})},lw="device_id";async function gM(){const n=(await on.get({key:lw})).value;if(n)return n;const e=(()=>{const t=globalThis.crypto;if(t&&typeof t.randomUUID=="function")return t.randomUUID();const r=Math.random().toString(16).slice(2);return`${Date.now()}_${r}_${Math.random().toString(16).slice(2)}`})();return await on.set({key:lw,value:e}),e}const el=er("App",{web:()=>Yt(()=>import("./web-B1PxkZjE.js"),[]).then(n=>new n.AppWeb)}),uf=()=>typeof window<"u"&&window.CdvPurchase?window.CdvPurchase.store:null,eR=()=>typeof window<"u"&&window.CdvPurchase?window.CdvPurchase.Platform:null,yM=()=>new Promise(n=>{if(Ne.getPlatform()==="web"){console.log("[waitForCordovaReady] Platform web, resolviendo inmediatamente"),n();return}if(window.cordova){console.log("[waitForCordovaReady]  Cordova ya est disponible"),n();return}console.log("[waitForCordovaReady]  Esperando evento deviceready..."),document.addEventListener("deviceready",()=>{console.log("[waitForCordovaReady]  deviceready disparado, Cordova listo"),n()},{once:!0}),setTimeout(()=>{console.warn("[waitForCordovaReady]  Timeout esperando deviceready"),n()},1e4)}),_M=async()=>{if(!Ut)return console.error("[ensureAuth] Firebase Auth no disponible"),!1;try{return Ut.currentUser?console.log("[ensureAuth]  Usuario ya autenticado:",Ut.currentUser.uid):(console.log("[ensureAuth]  Iniciando sesin annima..."),await sf(Ut),console.log("[ensureAuth]  Usuario annimo creado")),!0}catch(n){return console.error("[ensureAuth]  Error en autenticacin:",n),!1}};let cw=!1,Rc=null,pg=new Set;const gg=async n=>{var e,t;try{if(!n)return!1;if(pg.has(n))return!0;const r=uf(),a=eR();if(!r||!a)return!1;const c=Ne.getPlatform()==="ios"?a.APPLE_APPSTORE:a.GOOGLE_PLAY;r.register({id:n,type:r.NON_CONSUMABLE,platform:c}),pg.add(n);try{(e=r.refresh)==null||e.call(r),(t=r.update)==null||t.call(r)}catch{}return await new Promise(d=>setTimeout(d,600)),!0}catch(r){return console.warn("[ensureProductRegistered]  No se pudo registrar",n,r),!1}},tR=async()=>{if(Rc)return console.log("[initializeStore]  Ya hay una inicializacin en curso, esperando..."),Rc;if(cw)return console.log("[initializeStore]  Store ya inicializado"),Promise.resolve();Rc=(async()=>{var d;console.log("[initializeStore]  Iniciando inicializacin del store..."),await yM();try{const h=Ne.getPlatform(),m=!!window.cordova,g=!!window.CdvPurchase;console.log("[initializeStore]  Plataforma:",h,"| cordova=",m,"| CdvPurchase=",g)}catch(h){console.log("[initializeStore]  No se pudo loguear plataforma:",h)}const n=uf();if(!n)throw new Error("Plugin In-App Purchase no disponible");const e=eR();if(!e)throw new Error("CdvPurchase.Platform no disponible");const t=Ne.getPlatform(),r=t==="ios"?e.APPLE_APPSTORE:e.GOOGLE_PLAY;try{n.when&&n.when("approved",h=>{var m;try{const g=(h==null?void 0:h.acknowledged)??((m=h==null?void 0:h.transaction)==null?void 0:m.acknowledged);(g===!1||g===void 0)&&(typeof h.finish=="function"?h.finish():typeof n.finish=="function"&&n.finish(h),console.log("[initializeStore]  Acknowledge aplicado a compra restaurada"))}catch(g){console.warn("[initializeStore]  Error reconociendo compra restaurada:",g)}})}catch(h){console.warn("[initializeStore]  No se pudo configurar listener global approved:",h)}console.log("[initializeStore]  Registrando productos...");const a=["remove_ads"],l=pg;for(const h of a)try{n.register({id:h,type:n.NON_CONSUMABLE,platform:r}),l.add(h),console.log("[initializeStore]  Registrado base:",h)}catch(m){console.warn("[initializeStore]  Error registrando base",h,m)}try{const m=(await Sy()||[]).filter(_=>!((_==null?void 0:_.isActive)===!1||!(_!=null&&_.productId)));let g=m.filter(_=>{const v=Array.isArray(_==null?void 0:_.platforms)?_.platforms:null,T=v?v.map(A=>String(A||"").toLowerCase().trim()).filter(A=>!!A):null,I=String((_==null?void 0:_.platform)||"").toLowerCase().trim();return T&&T.length>0?T.includes(t):!I||I==="both"?!0:I===t});t==="ios"&&g.length===0&&(g=m);for(const _ of g){const v=String(_.productId);if(!l.has(v))try{const T=n,I=String((_==null?void 0:_.type)||"").toLowerCase().trim(),A=I==="consumable"?T.CONSUMABLE??T.NON_CONSUMABLE??n.NON_CONSUMABLE:I==="subscription"?T.PAID_SUBSCRIPTION??T.SUBSCRIPTION??T.NON_CONSUMABLE??n.NON_CONSUMABLE:T.NON_CONSUMABLE??n.NON_CONSUMABLE;n.register({id:v,type:A,platform:r}),l.add(v),console.log("[initializeStore]  Registrado dinmico:",v,"type:",_.type||"non_consumable")}catch(T){console.warn("[initializeStore]  Error registrando dinmico",v,T)}}}catch(h){console.warn("[initializeStore]  No se pudieron cargar productos dinmicos de Firestore:",h)}console.log("[initializeStore]  Productos registrados (total):",l.size),n.verbosity=n.DEBUG,console.log("[initializeStore]  Llamando a store.initialize()..."),await n.initialize([r]),console.log("[initializeStore]  store.initialize() completado"),console.log("[initializeStore]  Esperando store.ready()..."),await new Promise((h,m)=>{let g=!1;const _=()=>{g||(g=!0,console.log("[initializeStore]  store.ready() completado"),h())},v=T=>{g||(g=!0,console.error("[initializeStore]  Error en store.ready():",T),m(T))};n.ready(_),n.error(v),setTimeout(()=>{g||(g=!0,console.error("[initializeStore]  Timeout en store.ready()"),m(new Error("Timeout esperando store.ready()")))},2e4)}),console.log("[initializeStore]  Sincronizando con la tienda...");try{if(typeof n.restorePurchases=="function"){await n.restorePurchases(),console.log("[initializeStore]  Sincronizacin completada");try{(d=n.refresh)==null||d.call(n),await new Promise(h=>setTimeout(h,1500))}catch{}}else console.warn("[initializeStore]  store.restorePurchases() no disponible")}catch(h){console.warn("[initializeStore]  Error en restorePurchases():",h)}console.log("[initializeStore]  Esperando que se carguen los productos..."),await new Promise(h=>{let m=!1;const g=()=>{m||(m=!0,console.log("[initializeStore]  Productos cargados (evento updated)"),h())};n.when&&n.when("updated",g),setTimeout(()=>{m||(m=!0,console.log("[initializeStore]  Timeout esperando updated"),h())},1e4)}),console.log("[initializeStore]  Forzando actualizacin final...");try{n.update(),await new Promise(h=>setTimeout(h,2e3))}catch(h){console.warn("[initializeStore]  Error en store.update():",h)}console.log("[initializeStore]  Verificando productos cargados...");const c=n.products||[];console.log("[initializeStore] Total productos en store:",c.length),c.forEach(h=>{console.log("[initializeStore] Producto:",{id:h==null?void 0:h.id,title:h==null?void 0:h.title,state:h==null?void 0:h.state,canPurchase:h==null?void 0:h.canPurchase,price:h==null?void 0:h.price,owned:h==null?void 0:h.owned})}),c.length===0&&(console.warn("[initializeStore]  No se cargaron productos desde la tienda"),console.warn("[initializeStore] Verifica:"),console.warn("  1. Los IDs de producto en Console (Google Play / App Store)"),console.warn("  2. Que la app est publicada (al menos en prueba interna)"),console.warn("  3. Que el packageName/bundleId coincida"),console.warn("  4. Que los productos estn activos y aprobados")),cw=!0,console.log("[initializeStore]  Inicializacin completa")})();try{await Rc}finally{Rc=null}},uw=async n=>{console.log("[buyProduct]  Iniciando compra de:",n);const e=Ne.getPlatform();if(e!=="android"&&e!=="ios")throw new Error("Las compras solo estn disponibles en dispositivos mviles (Android/iOS).");try{const a=!!window.cordova,l=!!window.CdvPurchase;console.log("[buyProduct]  Entorno:",{platform:e,cordova:a,CdvPurchase:l})}catch(a){console.log("[buyProduct]  No se pudo obtener estado del entorno:",a)}await tR();const t=uf();if(!t)throw new Error("Plugin In-App Purchase no disponible");await gg(n),console.log("[buyProduct]  Verificando compra previa...");let r=t.get(n);if(!r)try{await gg(n),r=t.get(n)}catch{}if(!r){const a=e==="ios"?"App Store Connect":"Google Play Console";throw new Error(`Producto ${n} no encontrado. Verifica que est configurado en ${a}.`)}if(console.log("[buyProduct]  Producto encontrado:",{id:r.id,title:r.title,state:r.state,owned:r.owned,canPurchase:r.canPurchase,price:r.price}),r.owned)throw Object.assign(new Error('Ya posees este producto. Intenta "Restaurar compras".'),{code:"ITEM_ALREADY_OWNED",alreadyOwned:!0});if(!r.canPurchase){console.log("[buyProduct]  Producto no disponible para compra. Intentando store.update()...");try{await t.update();const a=t.get(n);if(console.log("[buyProduct]  Estado tras update():",{id:a==null?void 0:a.id,state:a==null?void 0:a.state,canPurchase:a==null?void 0:a.canPurchase,price:a==null?void 0:a.price}),!(a!=null&&a.canPurchase))throw new Error("Este producto no est disponible para compra en este momento.")}catch(a){throw console.log("[buyProduct]  Error en store.update():",a),new Error("Este producto no est disponible para compra en este momento.")}}return console.log("[buyProduct]  Iniciando proceso de compra..."),new Promise((a,l)=>{var T,I;let c=!1,d;const h=()=>{var A,C;d&&clearTimeout(d),(A=t.off)==null||A.call(t,"approved",_),(C=t.off)==null||C.call(t,"error",v)},m=A=>{c||(c=!0,h(),a(A))},g=A=>{c||(c=!0,h(),l(A))},_=async A=>{var L,x,U,z,$;console.log("[buyProduct]  Compra aprobada:",A);let C=!1;try{typeof A.finish=="function"?A.finish():typeof t.finish=="function"&&t.finish(A),C=!0,console.log("[buyProduct]  Transaccin finalizada (acknowledged)")}catch(se){console.warn("[buyProduct]  Error finalizando (acknowledge):",se)}try{(L=t.update)==null||L.call(t)}catch{}try{let se=((x=A==null?void 0:A.transaction)==null?void 0:x.purchaseToken)||(A==null?void 0:A.purchaseToken)||((U=A==null?void 0:A.nativePurchase)==null?void 0:U.purchaseToken)||((z=A==null?void 0:A.transaction)==null?void 0:z.id)||"";if(!se)console.warn("[buyProduct]  No se pudo obtener el token de compra");else{if(console.log("[buyProduct]  Token obtenido"),!await _M()||!yl)throw new Error("No se pudo autenticar");console.log("[buyProduct]  Validando en servidor...");const N=await yy(yl,"validatePurchase")({productId:n,purchaseToken:se,packageName:"com.mrodr.yonunca"});console.log("[buyProduct]  Validacin exitosa:",N.data),m({productId:n,validated:!0,finishSuccess:C,orderId:($=N.data)==null?void 0:$.orderId});return}}catch(se){console.warn("[buyProduct]  Validacin de servidor fallida o no disponible:",se)}m({productId:n,validated:!1,finishSuccess:C})},v=async A=>{console.error("[buyProduct]  Error en compra:",A);const C=(A==null?void 0:A.code)||(A==null?void 0:A.errorCode),L=(A==null?void 0:A.message)||String(A);if(C===7||L.includes("ITEM_ALREADY_OWNED")){console.log("[buyProduct]  Producto ya comprado, restaurando...");try{const x=await Zc();if(n==="remove_ads"&&x.hasRemoveAds||Array.isArray(x.ownedPackIds)&&x.ownedPackIds.includes(n)){m({productId:n,alreadyOwned:!0,restored:!0});return}}catch(x){console.error("[buyProduct] Error restaurando:",x)}g(Object.assign(new Error('Ya posees este producto. Intenta "Restaurar compras".'),{code:"ITEM_ALREADY_OWNED"}));return}if(C===1||L.includes("USER_CANCELED")){g(Object.assign(new Error("Compra cancelada"),{code:"USER_CANCELED"}));return}g(A)};t.when&&t.when("approved",_),(T=t.error)==null||T.call(t,v),d=setTimeout(()=>{c||g(new Error("Timeout: La compra tard demasiado"))},6e4);try{const A=(I=r.getOffer)==null?void 0:I.call(r);A?t.order(A):t.order(r),console.log("[buyProduct]  Orden iniciada")}catch(A){g(A)}})},Zc=async n=>{var I;console.log("[restorePurchases]  Iniciando restauracin modular...");const e=Ne.getPlatform();if(e!=="android"&&e!=="ios")return{hasRemoveAds:!1,hasPremium:!1,purchases:[],ownedPackIds:[]};await tR();const t=uf();if(!t)throw new Error("Plugin In-App Purchase no disponible");const r=(n==null?void 0:n.removeAdsId)||"remove_ads",a=(n==null?void 0:n.storeProducts)||[],l=(n==null?void 0:n.productConfigs)||[],c=new Set,d=new Set([r]);l.forEach(A=>{var C,L;(C=A==null?void 0:A.affectsState)!=null&&C.hasPremium&&A.productId&&c.add(A.productId),((L=A==null?void 0:A.affectsState)==null?void 0:L.showAds)===!1&&A.productId&&d.add(A.productId)}),a.forEach(A=>{A!=null&&A.grantsPremium&&A.productId&&c.add(A.productId),A!=null&&A.grantsRemoveAds&&A.productId&&d.add(A.productId)});let h=new Set;d.forEach(A=>h.add(A)),c.forEach(A=>h.add(A)),l&&l.length>0&&l.forEach(A=>{A.productId&&(h.add(A.productId),console.log(`[restorePurchases]  Agregando productId modular: ${A.productId}`))}),a.length>0&&a.forEach(A=>{A.productId&&!h.has(A.productId)&&(h.add(A.productId),console.log(`[restorePurchases]  Agregando productId de storeProducts: ${A.productId}`))}),await Promise.allSettled(Array.from(h).map(A=>gg(A))),console.log("[restorePurchases]  Sincronizando con la tienda...");try{typeof t.restorePurchases=="function"&&(await t.restorePurchases(),console.log("[restorePurchases]  Sincronizacin completada"),await new Promise(A=>setTimeout(A,2e3)))}catch(A){console.warn("[restorePurchases]  Error en restorePurchases():",A)}try{(I=t.refresh)==null||I.call(t),await new Promise(A=>setTimeout(A,2e3))}catch(A){console.warn("[restorePurchases]  Error en refresh():",A)}try{t.update(),await new Promise(A=>setTimeout(A,1e3))}catch(A){console.warn("[restorePurchases]  Error en update():",A)}const m=A=>{var C;try{const L=t.get(A);if(!L)return console.log("[restorePurchases] ",A,"no encontrado"),!1;const x=D=>String(D??"").toLowerCase(),U=x(((C=L==null?void 0:L.state)==null?void 0:C.name)??(L==null?void 0:L.state)),z=[];L!=null&&L.transaction&&z.push(L.transaction),Array.isArray(L==null?void 0:L.transactions)&&z.push(...L.transactions),Array.isArray(L==null?void 0:L.ownedTransactions)&&z.push(...L.ownedTransactions);const $=z.some(D=>{const P=x((D==null?void 0:D.state)??(D==null?void 0:D.transactionState)??(D==null?void 0:D.purchaseState)??(D==null?void 0:D.status));return P.includes("owned")||P.includes("purchased")||P.includes("approved")||P.includes("finished")||P.includes("restored")}),se=!!(L.owned===!0||U.includes("owned")||U.includes("approved")||U.includes("purchased")||U.includes("finished")||U.includes("restored")||$);return console.log("[restorePurchases]",A,"- owned:",se),se}catch(L){return console.error("[restorePurchases] Error verificando",A,":",L),!1}},g=Array.from(d).some(A=>m(A)),_=Array.from(c).some(A=>m(A)),v=[];g&&v.push({productId:r,type:"remove_ads"});const T=[];if(l&&l.length>0)for(const A of l)A.productId&&!d.has(A.productId)&&m(A.productId)&&!T.includes(A.productId)&&(T.push(A.productId),v.push({productId:A.productId,type:"pack"}),console.log(`[restorePurchases]  Pack dinmico comprado: ${A.productId}`));for(const A of a)A.productId&&!T.includes(A.productId)&&!d.has(A.productId)&&m(A.productId)&&(T.push(A.productId),v.push({productId:A.productId,type:"pack"}),console.log(`[restorePurchases]  Pack comprado: ${A.productId}`));return console.log("[restorePurchases]  Resultado modular:",{hasRemoveAds:g,hasPremium:_,ownedPackIds:T,purchases:v.length,dynamicPacksDetected:(l==null?void 0:l.length)||0}),{hasRemoveAds:g,hasPremium:_,purchases:v,ownedPackIds:T}},vM=async n=>{var r;const e=(n==null?void 0:n.delayMs)??1500,t=(n==null?void 0:n.silent)??!1;t||console.log(`[autoRestorePurchases]  Esperando ${e}ms para permitir que servidor registre compra...`),await new Promise(a=>setTimeout(a,e)),t||console.log("[autoRestorePurchases]  Iniciando restauracin automtica de compras...");try{const a=await Zc(n);return t||console.log("[autoRestorePurchases]  Restauracin automtica completada:",{hasRemoveAds:a.hasRemoveAds,hasPremium:a.hasPremium,packCount:((r=a.ownedPackIds)==null?void 0:r.length)||0}),a}catch(a){return console.warn("[autoRestorePurchases]  Error en restauracin automtica:",a),{hasRemoveAds:!1,hasPremium:!1,ownedPackIds:[],purchases:[],error:a}}};class EM{constructor(){De(this,"configs",new Map)}register(e){console.log(`[ProductConfigManager]  Registrando producto: ${e.productId} (${e.type})`),this.configs.set(e.productId,e)}registerBatch(e){console.log(`[ProductConfigManager]  Registrando ${e.length} productos`),e.forEach(t=>this.register(t))}get(e){return this.configs.get(e)}getAll(){return Array.from(this.configs.values())}getAllProductIds(){return Array.from(this.configs.keys())}getByType(e){return Array.from(this.configs.values()).filter(t=>t.type===e)}executeCallbacks(e){console.log(`[ProductConfigManager]  Ejecutando ${e.length} callbacks`),e.forEach(({productId:t,callback:r})=>{try{console.log(`[ProductConfigManager]  Ejecutando callback para: ${t}`),r()}catch(a){console.error(`[ProductConfigManager]  Error ejecutando callback para ${t}:`,a)}})}clear(){this.configs.clear(),console.log("[ProductConfigManager]  Configuracin limpiada")}}const eu=new EM,SM=n=>{console.log("[initializeDefaultProducts]  Inicializando productos por defecto (solo especiales)"),eu.registerBatch([{productId:"remove_ads",type:"remove_ads",callbacks:{onOwned:n.onRemoveAdsPurchased},affectsState:{showAds:!1}}])},wM=(n,e)=>{console.log(`[addDynamicProductsFromFirestore]  Agregando ${n.length} packs desde Firestore`);const t=n.filter(r=>!(r.productId==="remove_ads"||r.isActive===!1)).map(r=>{const a={ownedPackIds:!0};return r.grantsPremium&&(a.hasPremium=!0),r.grantsRemoveAds&&(a.showAds=!1),{productId:r.productId,type:"pack",callbacks:{onOwned:()=>{console.log(`[DynamicProduct]  Pack comprado: ${r.productId}`),e!=null&&e.onPackPurchased&&e.onPackPurchased(r.productId)}},affectsState:a}});t.length>0&&eu.registerBatch(t)},Ya=class Ya{constructor(){De(this,"environment","pro")}static getInstance(){return Ya.instance||(Ya.instance=new Ya),Ya.instance}async initialize(e){this.environment=e,console.log(`[AppEnvironment] Inicializado con ambiente: ${e}`)}getEnvironment(){return this.environment}isProduction(){return this.environment==="pro"}isPreProduction(){return this.environment==="pre"}filterProductsByEnvironment(e){return e.filter(t=>{const r=(t==null?void 0:t.environment)||"both";return this.isProduction()?r==="both"||r==="pro":(this.isPreProduction(),!0)})}getLabel(){return this.isProduction()?" PRO":" PRE"}getDescription(){return this.isProduction()?"Compilacin de Produccin":"Compilacin de Testing/Pre-Produccin"}};De(Ya,"instance");let yg=Ya;const _g=yg.getInstance(),dw=({endDate:n,large:e=!1,bare:t=!1,className:r})=>{const[a,l]=te.useState(null);return te.useEffect(()=>{const c=()=>{const h=Date.now(),g=new Date(n).getTime()-h;if(g<=0){l({days:0,hours:0,minutes:0,seconds:0});return}const _=Math.floor(g/(1e3*60*60*24)),v=Math.floor(g%(1e3*60*60*24)/(1e3*60*60)),T=Math.floor(g%(1e3*60*60)/(1e3*60)),I=Math.floor(g%(1e3*60)/1e3);l({days:_,hours:v,minutes:T,seconds:I})};c();const d=setInterval(c,1e3);return()=>clearInterval(d)},[n]),!a||a.days===0&&a.hours===0&&a.minutes===0&&a.seconds===0?null:e?S.jsx("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded p-1.5 shadow-md border border-purple-500/20",children:S.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:a.days})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Das"})]}),S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:String(a.hours).padStart(2,"0")})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Hrs"})]}),S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:String(a.minutes).padStart(2,"0")})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Min"})]}),S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:String(a.seconds).padStart(2,"0")})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Seg"})]})]})}):t?S.jsxs("span",{className:r||"text-[10px] sm:text-xs whitespace-nowrap font-bold",children:[a.days>0&&`${a.days} dias `,String(a.hours).padStart(2,"0"),":",String(a.minutes).padStart(2,"0"),":",String(a.seconds).padStart(2,"0")]}):S.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-gradient-to-r from-pink-600 via-red-500 to-orange-500 text-white px-2.5 py-1 rounded-md shadow-lg border border-pink-400/30",children:[S.jsx("i",{className:"fas fa-fire text-yellow-200 text-xs"}),S.jsxs("span",{className:"text-[10px] sm:text-xs font-bold whitespace-nowrap",children:["Termina en ",a.days>0&&`${a.days}d `,String(a.hours).padStart(2,"0"),":",String(a.minutes).padStart(2,"0"),":",String(a.seconds).padStart(2,"0")]})]})},hw=({icon:n,title:e,description:t,price:r,onClick:a,disabled:l,disabledText:c,discountPercent:d,discountReason:h,benefits:m,badge:g,isPopular:_,soldOut:v,comingSoon:T,promoEndDate:I,owned:A,productType:C,isAdultPack:L,originalPriceDisplay:x})=>{if(T&&I)return S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"absolute -top-3 -right-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold px-2.5 py-1 rounded-full shadow-lg z-10 badge-bounce",children:g||"PRONTO!"}),S.jsx("div",{className:"relative rounded-xl p-0.5 transition-all overflow-hidden",style:{borderRadius:"0.75rem",backgroundImage:"linear-gradient(to bottom right, #7c3aed, #db2777)"},children:S.jsxs("div",{className:"rounded-xl p-2 sm:p-3 bg-gradient-to-br from-slate-900 via-indigo-900/1 to-slate-900 shadow-sm ring-2 ring-indigo-800/3 relative overflow-hidden",style:{backgroundImage:"linear-gradient(135deg, rgba(31, 22, 58, 0.90), rgba(168, 85, 247, 0.25), rgba(236, 72, 153, 0.22))"},children:[S.jsx("div",{className:"absolute inset-0 opacity-10",children:S.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(139, 92, 246, 0.3) 10px, rgba(139, 92, 246, 0.3) 20px)"}})}),S.jsxs("div",{className:"relative z-10",children:[S.jsxs("div",{className:"flex items-start gap-1.5 mb-1.5",children:[S.jsx("div",{className:"flex-shrink-0 text-purple-300 text-2xl sm:text-3xl drop-shadow-md",children:S.jsx("i",{className:n})}),S.jsxs("div",{className:"flex-grow",children:[S.jsx("h3",{className:"text-base sm:text-lg font-bold text-white leading-tight mb-0.5",children:e}),S.jsx("p",{className:"text-slate-300 text-xs leading-snug",children:t})]})]}),S.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg p-1 mb-1.5 text-center shadow",children:S.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[S.jsx("i",{className:"fas fa-rocket text-yellow-200 text-xs sm:text-sm"}),S.jsx("span",{className:"text-white font-black text-xs sm:text-sm tracking-wide",children:"PRXIMAMENTE"}),S.jsx(dw,{endDate:I,bare:!0,className:"text-white text-[10px] sm:text-xs font-bold tracking-wide whitespace-nowrap"})]})}),m&&m.length>0&&S.jsx("ul",{className:"space-y-1 mb-1.5",children:m.map((Le,Ge)=>S.jsxs("li",{className:"flex items-start gap-1.5 text-slate-300 text-xs sm:text-sm",children:[S.jsx("i",{className:"fas fa-check-circle text-purple-300 mt-0.5 flex-shrink-0 text-xs"}),S.jsx("span",{children:Le})]},Ge))})]})]})})]});const U=!!A,z=!!v&&!U,$=!z&&d&&d>0&&!U,se=I?new Date(I).getTime():0,D=Date.now(),P=!z&&!!I&&se>D&&!U,N=!z&&d&&d>0&&!U,M=!z&&!U&&!d&&g&&g!=="PREMIUM",B=z||U||c&&/Agotado|Ya es tuyo!/i.test(c),G=U||z,k=$?"text-2xl sm:text-3xl":"text-3xl sm:text-4xl",Ve=$?"text-base sm:text-lg":"text-lg sm:text-xl",tt=$?"text-xs":"text-xs sm:text-sm",ee=!G&&!$&&!P,he=!G&&!$&&!P,Ie=U?"linear-gradient(to bottom right, #7eff7eff, #1b7200ff)":z?"linear-gradient(to bottom right, #ff938fff, #720000ff)":$?"linear-gradient(to bottom right, #fff7ed, #fde68a, #f59e0b, #b45309)":"linear-gradient(135deg, #10edfdff, #22dcf8ff, #007db8ff)";return S.jsxs("div",{className:"relative",children:[N&&S.jsxs("div",{className:"absolute -top-3 -right-3 bg-gradient-to-r from-yellow-300 via-amber-400 to-amber-600 text-white text-sm font-bold px-3 py-1 rounded-full shadow z-10 badge-bounce",children:["-",d,"%"]}),M&&S.jsx("div",{className:"absolute -top-3 -right-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow z-10 badge-bounce",children:g}),S.jsx("div",{className:`relative rounded-xl p-0.5 transition-all ${!l&&!G?"hover:scale-[1.005]":""} ${A?"opacity-60":""}`,style:{borderRadius:"0.75rem",backgroundImage:Ie},children:S.jsxs("div",{className:`rounded-xl flex flex-col transition-all shadow-sm h-full ${z?"bg-red-950/90":"bg-slate-800"} relative overflow-hidden ${he?"justify-center px-3 sm:px-4 pt-2 pb-3 sm:pt-2 sm:pb-4":"p-3 sm:p-4"}`,style:{backgroundImage:$?"linear-gradient(to bottom right, rgba(0, 0, 0, 0.16), rgba(0, 0, 0, 0.24)), linear-gradient(to bottom right, rgba(255, 247, 237, 0.12), rgba(253, 230, 138, 0.18), rgba(245, 158, 11, 0.22), rgba(180, 83, 9, 0.20))":z?"linear-gradient(135deg, rgba(255, 68, 68, 0.75), rgba(155, 0, 0, 0.7), rgba(0, 0, 0, 0.8))":void 0},children:[G&&S.jsx("div",{className:`absolute inset-0 ${z?"bg-black/60":"bg-black/45"} rounded-xl z-10 pointer-events-none`}),z&&S.jsx("div",{className:"absolute top-2 right-2 z-20 pointer-events-none",children:S.jsx("div",{className:"bg-red-700/90 text-white px-2 py-0.5 rounded-md shadow-md border border-red-500",children:S.jsx("span",{className:"text-xs font-semibold tracking-wide flex items-center gap-1",children:" Agotado"})})}),U&&S.jsx("div",{className:"absolute top-2 right-2 z-20 pointer-events-none",children:S.jsx("div",{className:"bg-green-700/90 text-white px-2 py-0.5 rounded-md shadow-md border border-green-500",children:S.jsx("span",{className:"text-xs font-semibold tracking-wide flex items-center gap-1",children:" Adquirido"})})}),S.jsxs("div",{className:`flex items-start gap-2 sm:gap-3 ${he?"":"mb-2 sm:mb-3"} relative z-20 ${he?"my-0":""}`,children:[S.jsx("div",{className:`flex-shrink-0 ${$?"text-amber-300":"text-cyan-300"} ${k} drop-shadow-md`,children:S.jsx("i",{className:`${n} ${$?"gradient-white-gold":"text-cyan-300"} opacity-95 drop-shadow-md`})}),S.jsxs("div",{className:"flex-grow",children:[S.jsx("h3",{className:`${Ve} font-bold text-white leading-tight m-0`,children:e}),S.jsx("p",{className:`${$?"text-amber-200":"text-cyan-300"} ${tt} ${he?"":"mt-0.5 sm:mt-1"} leading-snug m-0`,children:t})]}),ee&&S.jsx("div",{className:"flex-shrink-0 ml-2",children:S.jsx(Kt,{onClick:a,variant:"primary",shimmerVariant:"default",className:"px-3 sm:px-5 py-1.5 sm:py-2.5 text-sm sm:text-base font-bold text-white ring-1 ring-white/20 shadow-md hover:shadow-lg whitespace-nowrap bg-blue-700 hover:bg-blue-800",children:fw(r,d)})})]}),!G&&m&&m.length>0&&S.jsx("ul",{className:`space-y-1 sm:space-y-1.5 ${he?"mb-0 mt-0":"mb-2 sm:mb-2.5"}`,children:m.map((Le,Ge)=>S.jsxs("li",{className:"flex items-start gap-1.5 sm:gap-2 text-slate-300 text-xs sm:text-sm",children:[S.jsx("i",{className:"fas fa-check-circle text-green-300 mt-0.5 flex-shrink-0 text-xs sm:text-sm"}),S.jsx("span",{children:Le})]},Ge))}),!G&&(()=>{const Le=d&&d>0&&!!h||P;return Le||$?S.jsxs("div",{className:`flex items-center ${Le?"justify-between":"justify-end"} gap-2 sm:gap-3 mt-auto`,children:[Le&&S.jsxs("div",{className:"flex flex-col",children:[d&&d>0&&h&&S.jsx("p",{className:`text-xs ${$?"text-amber-200":"text-cyan-300"} font-semibold`,children:h}),P&&S.jsx(dw,{endDate:I,bare:!0,className:`text-[10px] sm:text-xs font-bold ${$?"text-amber-200":"text-cyan-300"} mt-0.5`})]}),S.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-auto",children:[(()=>{const j=TM({originalPriceDisplay:x,discountPercent:d},r);return j&&!l?S.jsx("span",{className:"text-red-500 text-sm sm:text-base font-bold line-through",children:j}):null})(),!l&&$&&S.jsx(Kt,{onClick:a,variant:"custom",shimmerVariant:"default",className:"px-3 sm:px-5 py-1.5 sm:py-2.5 text-sm sm:text-base font-bold text-white ring-1 ring-white/20 shadow-md hover:shadow-lg whitespace-nowrap gold-shimmer-bg hover:brightness-110",children:fw(r,d)}),l&&!B&&S.jsx("p",{className:"text-xs sm:text-sm font-bold text-green-300 text-center py-1.5 sm:py-2 px-3 sm:px-4 bg-green-500/15 rounded-lg whitespace-nowrap",children:c||"No disponible"})]})]}):null})()]})})]})},fw=(n,e)=>{if(!n)return"";const t=n.trim().toLowerCase();if(t.includes("gratis"))return"GRATIS";const r=t.replace(/[^0-9.,-]/g,"").replace(",","."),a=r?parseFloat(r):NaN;return!isNaN(a)&&a===0||typeof e=="number"&&e>=100?"GRATIS":n},mw=n=>{const e=typeof(n==null?void 0:n.priceDisplay)=="string"?n.priceDisplay.trim():"";if(e){const a=e.toLowerCase().trim();return a==="0"||a==="0"||a==="0,00"||a==="0.00"||a==="gratis"?"GRATIS":e}const t=typeof(n==null?void 0:n.price)=="number"?n.price:void 0;if(typeof t=="number"){if(t<=0||typeof(n==null?void 0:n.discountPercent)=="number"&&n.discountPercent>=100||(n==null?void 0:n.isFree)===!0)return"GRATIS";try{return new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(t)}catch{return`${t.toFixed(2).replace(".",",")} `}}const r=String((n==null?void 0:n.price)||"").trim();return r||""},bM=(n,e)=>{if(typeof n!="string"||!n||e<=0)return"";const t=n.match(/^([^0-9.,]*)([0-9.,]+)(.*)$/);if(!t)return"";const[,r,a,l]=t,c=parseFloat(a.replace(",","."));if(isNaN(c))return"";const h=(c/(1-e/100)).toFixed(2).replace(".",",");return`${r}${h}${l}`},TM=(n,e)=>{const t=typeof(n==null?void 0:n.originalPriceDisplay)=="string"?n.originalPriceDisplay.trim():"";return t||typeof(n==null?void 0:n.discountPercent)=="number"&&n.discountPercent>0&&bM(e,n.discountPercent)||""};function AM({navigate:n,onPurchaseRemoveAds:e,onPurchasePremium:t,onPurchasePack:r,showAds:a,hasPremium:l,ownedPackIds:c,enableRemoveAdsPurchase:d=!0,enablePremiumPurchase:h=!0,deepLinkAction:m}){const g=Ne.getPlatform()==="ios",[_,v]=te.useState(!1),[T,I]=te.useState(!1),[A,C]=te.useState(null),[L,x]=te.useState([]),[U,z]=te.useState(!1),[$,se]=te.useState(!1),[D,P]=te.useState(null),[N,M]=te.useState(gt.Info),[B,G]=te.useState(!1),[k,Ve]=te.useState(!1),[tt,ee]=te.useState(""),[he,Ie]=te.useState(null),[Le,Ge]=te.useState(!1),[j,K]=te.useState(null),[ue,pe]=te.useState(null),[Pe,je]=te.useState(!1),[nt,We]=te.useState(null),[Ke,Ze]=te.useState(!1),[Vt,Wt]=te.useState(!1),[Rn,yn]=te.useState(!1),Te=te.useRef(null),oe=(we,_e)=>{P(we),M(_e),we.toLowerCase().includes("integridad")&&G(!0)},Ue=()=>{P(null),G(!1)};te.useEffect(()=>{try{new URLSearchParams(window.location.search).get("help")==="1"&&Wt(!0)}catch{}},[]),te.useEffect(()=>{if(!(m!=null&&m.nonce)||Te.current===m.nonce||!m.packId||!L||L.length===0)return;const we=L.find(_e=>(_e==null?void 0:_e.productId)===m.packId);we&&(Te.current=m.nonce,Ie(we),K(null),ee(m.promoCode??""),we.requiresPromoCode===!0&&m.openRedeem!==!1&&Ve(!0))},[m,L]),te.useEffect(()=>{Fk();const we=async()=>{try{console.log("[StoreScreen]  Iniciando carga de productos desde Firestore..."),console.log("[StoreScreen]  Forzando recarga de configuracin para obtener ltimos cambios..."),await wA();const _e=await Sy();console.log("[StoreScreen]  Productos obtenidos:",_e.length,"productos"),console.log("[StoreScreen]  Productos completos:",JSON.stringify(_e,null,2));const me=_e.filter(re=>{const ye=Ne.getPlatform(),$e=Array.isArray(re.platforms)?re.platforms:null,qe=$e?$e.map(oi=>String(oi||"").toLowerCase().trim()).filter(oi=>!!oi):null,It=String(re.platform||"").toLowerCase().trim(),_t=qe&&qe.length>0?!!(qe.includes(ye)||ye==="web"&&qe.includes("android")):!It||It==="both"||It===ye||ye==="web"&&It==="android",Fe=re.isActive!==!1,Et=_g.getEnvironment(),ai=re.environment||"both";return _t&&Fe&&(Et==="pre"||ai==="both"||ai===Et)});console.log("[StoreScreen]  Productos filtrados (activos + android + ambiente):",me.length),console.log(`[StoreScreen]  Ambiente actual: ${_g.getEnvironment().toUpperCase()}`);try{for(const re of me){if(console.log(`[StoreScreen]  Procesando producto: ${re.title}, soldOut inicial: ${re.soldOut}`),(!re.discountPercent||re.discountPercent===0)&&(re.discountPercent=void 0,re.discountReason=""),re.promoEndDate){const ye=new Date(re.promoEndDate);new Date>ye&&(re.discountPercent=void 0,re.discountReason="")}if(re.isFree===!0&&re.requiresPromoCode===!0){console.log(`[StoreScreen]  Cargando cdigos promo para: ${re.productId}`);const ye=await RA(re.productId);console.log(`[StoreScreen]  Stats: total=${ye.total}, available=${ye.available}, assigned=${ye.assigned}`),(ye.available<=0||re.soldOut)&&(console.log(`[StoreScreen]  Marcando como AGOTADO (cdigos disponibles: ${ye.available}, soldOut manual: ${re.soldOut})`),re.soldOut=!0),re.promoStats=ye}}}catch(re){console.warn("[StoreScreen] Error cargando cdigos promo:",re)}const ge=me.sort((re,ye)=>{if(re.soldOut&&!ye.soldOut)return 1;if(!re.soldOut&&ye.soldOut)return-1;const $e=re.order??999,qe=ye.order??999;return $e-qe});x(ge)}catch(_e){console.error("[StoreScreen]  ERROR cargando productos de tienda:",_e),console.error("[StoreScreen] Stack trace:",_e==null?void 0:_e.stack),oe("Error al cargar los productos. Intenta ms tarde.",gt.Error)}finally{console.log("[StoreScreen]  Marcando purchasesRestored=true"),z(!0)}};console.log("[StoreScreen]  Componente montado, iniciando carga"),we()},[]);const ve=async(we,_e)=>{var me;try{console.log("[StoreScreen]  Iniciando compra de producto:",_e),console.log("[StoreScreen] Llamando a buyProduct...");const ge=L.find(ye=>ye.productId===_e);jk(_e,(ge==null?void 0:ge.type)||"unknown");const re=await uw(_e);if(console.log("[StoreScreen]  Compra completada exitosamente:",JSON.stringify(re)),re&&(re.validated||re.finishSuccess||re.alreadyOwned||re.restored)){try{console.log("[StoreScreen] Logro desbloqueado: Por fin alguien paga!")}catch(ye){console.warn("[StoreScreen] No se pudo desbloquear logro Por fin alguien paga!:",ye)}if(_e==="remove_ads"||(ge==null?void 0:ge.type)==="remove_ads")try{console.log("[StoreScreen] Logro desbloqueado: Hroe del Silencio")}catch(ye){console.warn("[StoreScreen] No se pudo desbloquear logro Hroe del Silencio:",ye)}try{const ye=L.filter(qe=>qe.type!=="remove_ads"&&qe.type!=="premium_phrases").map(qe=>qe.productId);ye.length>0&&ye.every(qe=>Array.isArray(c)?c.includes(qe):!1)&&console.log("[StoreScreen] Logro desbloqueado: Hombre de negocios")}catch(ye){console.warn("[StoreScreen] No se pudo desbloquear logro Hombre de negocios:",ye)}if(console.log("[StoreScreen]  Compra finalizada/validada, ejecutando callback de accin..."),Gd({productId:_e,productType:(ge==null?void 0:ge.type)||"unknown",price:(ge==null?void 0:ge.price)||0,currency:"EUR"}),Gk({productId:_e,productType:(ge==null?void 0:ge.type)||"unknown",price:(ge==null?void 0:ge.price)||0,currency:"EUR"}),_e==="premium_phrases"||(ge==null?void 0:ge.type)==="premium_phrases"){console.log("[StoreScreen]  Compra de premium detectada, verificando cach de frases...");try{const{phraseCache:ye}=await Yt(async()=>{const{phraseCache:qe}=await Promise.resolve().then(()=>Ki);return{phraseCache:qe}},void 0);ye.premiumPhrases.length>0?console.log("[StoreScreen]  Frases premium ya estn en cach, omitiendo descarga"):(console.log("[StoreScreen]  No hay frases premium en cach, descargando..."),await ul(!0),console.log("[StoreScreen]  Frases premium descargadas correctamente"))}catch(ye){console.warn("[StoreScreen]  Error verificando/actualizando cach de frases:",ye)}}if(r&&(ge!=null&&ge.productId)&&(console.log("[StoreScreen]  Pack comprado:",ge.productId),r(ge.productId),window.optimizedCache&&typeof window.optimizedCache.invalidateUserCache=="function"&&window.optimizedCache.invalidateUserCache(((me=auth.currentUser)==null?void 0:me.uid)||"")),we(),re.alreadyOwned||re.restored?oe(" Producto restaurado exitosamente. Ya lo tenas comprado!",gt.Success):re.validated?oe(" Compra realizada con xito! Sincronizando...",gt.Success):re.finishSuccess&&oe(" Compra finalizada. Sincronizando...",gt.Success),re.validated||re.finishSuccess){console.log("[StoreScreen]  Iniciando restauracin automtica post-compra...");try{const ye=Ne.getPlatform(),$e=Fe=>{const Et=Array.isArray(Fe==null?void 0:Fe.platforms)?Fe.platforms:null,ai=Et?Et.map(oi=>String(oi||"").toLowerCase().trim()).filter(oi=>!!oi):null,Ei=String((Fe==null?void 0:Fe.platform)||"").toLowerCase().trim();return ai&&ai.length>0?!!(ai.includes(ye)||ye==="web"&&ai.includes("android")):!Ei||Ei==="both"||Ei===ye||ye==="web"&&Ei==="android"},qe=L.find(Fe=>Fe.type==="remove_ads"&&$e(Fe)),It=L.find(Fe=>Fe.type==="premium_phrases"&&$e(Fe)),_t=eu.getAll();vM({removeAdsId:qe==null?void 0:qe.productId,premiumId:It==null?void 0:It.productId,storeProducts:L,productConfigs:_t,delayMs:1500,silent:!0}).then(Fe=>{Fe.hasRemoveAds&&e(),Fe.hasPremium&&t(),Fe.ownedPackIds&&Fe.ownedPackIds.length>0&&r&&Fe.ownedPackIds.forEach(Et=>r(Et)),console.log("[StoreScreen]  Restauracin automtica completada")}).catch(Fe=>{console.warn("[StoreScreen]  Error en restauracin automtica:",Fe)})}catch(ye){console.warn("[StoreScreen]  Error iniciando restauracin automtica:",ye)}}re.finishSuccess||(console.warn("[StoreScreen]  La transaccin no se pudo finalizar completamente"),setTimeout(async()=>{try{console.log("[StoreScreen]  Ejecutando restauracin de respaldo (finalizacin incompleta)..."),await et()}catch(ye){console.warn("[StoreScreen]  Error en restauracin de respaldo:",ye)}},4e3))}else{console.warn("[StoreScreen]  Compra completada pero sin validacin");try{console.log("[StoreScreen]  Intentando restauracin automtica tras compra sin validacin...");const ye=await Zc();if(ye.hasRemoveAds&&e(),ye.hasPremium){t();try{const{phraseCache:$e}=await Yt(async()=>{const{phraseCache:It}=await Promise.resolve().then(()=>Ki);return{phraseCache:It}},void 0);$e.premiumPhrases.length>0||await ul(!0)}catch{}}ye.hasRemoveAds||ye.hasPremium?oe(" Compra activada automticamente tras verificacin local.",gt.Success):oe(' Compra procesada. Si no aparece activada, intenta "Restaurar compras" en unos segundos.',gt.Warning)}catch{oe(' Compra procesada. Si no aparece activada, intenta "Restaurar compras" en unos segundos.',gt.Warning)}}console.log("[StoreScreen]  Compra procesada correctamente")}catch(ge){console.error("[StoreScreen]  ERROR en compra:",ge),console.error("[StoreScreen] Error message:",ge==null?void 0:ge.message),console.error("[StoreScreen] Error stack:",ge==null?void 0:ge.stack),console.error("[StoreScreen] Error completo:",JSON.stringify(ge,Object.getOwnPropertyNames(ge)));const re=String((ge==null?void 0:ge.message)||String(ge)),ye=ge==null?void 0:ge.code;ye==="ITEM_ALREADY_OWNED"||re.includes("already owned")||re.includes("Ya posees")?oe('Ya posees este producto. Si no aparece activado, usa el botn "Restaurar compras".',gt.Warning):ye==="USER_CANCELED"||re.includes("canceled")||re.includes("cancelled")?oe("Compra cancelada",gt.Info):ye==="SERVICE_UNAVAILABLE"||re.includes("service unavailable")||re.includes("no disponible")?oe("El servicio de la tienda no est disponible temporalmente. Intenta ms tarde.",gt.Error):ye==="BILLING_UNAVAILABLE"||re.includes("billing unavailable")||re.includes("facturacin")?oe("Las compras no estn disponibles en este dispositivo o regin.",gt.Error):ye==="ITEM_UNAVAILABLE"||re.includes("item unavailable")||re.includes("producto no est disponible")?oe("Este producto no est disponible para compra. Verifica tu conexin e intenta ms tarde.",gt.Error):ye==="DEVELOPER_ERROR"||re.includes("developer error")||re.includes("configuracin")?oe("Error de configuracin del sistema. Contacta al soporte tcnico.",gt.Error):re.includes("Timeout")||re.includes("tard")?oe('La compra tard mucho tiempo. Si ya pagaste, intenta "Restaurar compras" en unos minutos.',gt.Warning):re.includes("Plugin")||re.includes("no est")?oe("Error del sistema de compras. Asegrate de estar usando la app desde Google Play Store.",gt.Error):re.includes("autenticar")||re.includes("auth")?oe("Error de autenticacin. Intenta cerrar y abrir la app nuevamente.",gt.Error):oe("Error en la compra: "+re,gt.Error)}},Ae=async we=>{try{if(c&&c.includes(we.productId)){oe(" Ya tienes este pack adquirido",gt.Success),r&&r(we.productId);return}console.log("[StoreScreen]  Adquiriendo pack gratuito:",we.productId),oe(` ${we.title} adquirido con xito!`,gt.Success),r&&r(we.productId),Gd({productId:we.productId,productType:we.type||"other",price:0,currency:"EUR"})}catch(_e){console.error("[StoreScreen] Error adquiriendo pack gratuito:",_e),oe("Error inesperado. Intntalo de nuevo.",gt.Error)}},Se=we=>{Ie(we),ee(""),K(null),Ve(!0)},ze=async()=>{try{if(!he)return;K(null),Ze(!0);const we=he.productId;if(he.requiresPromoCode){const Fe=await ug(we),Et=(tt||"").trim(),ai=Et.replace(/\s+/g,"").toLowerCase();if(!Fe.map(ji=>(ji||"").replace(/\s+/g,"").toLowerCase()).includes(ai)){K("Cdigo no vlido."),Ze(!1);return}console.log("[StoreScreen]  Cdigo encontrado, intentando adquirir...");try{Ve(!1),oe(` ${he.title} adquirido con xito!`,gt.Success),We(Et),r&&r(we),Gd({productId:we,productType:he.type||"other",price:0,currency:"EUR"})}catch(ji){console.error("[StoreScreen] Error adquiriendo pack con cdigo:",ji),K("Error inesperado. Intntalo de nuevo."),Ve(!0)}Ze(!1);return}const me=await ug(we),re=(tt||"").trim().replace(/\s+/g,"").toLowerCase(),$e=me.map(Fe=>(Fe||"").replace(/\s+/g,"").toLowerCase()).includes(re),qe=$e?me.find(Fe=>(Fe||"").replace(/\s+/g,"").toLowerCase()===re)||re:null;if(!$e){K("Cdigo no vlido."),Ze(!1);return}const It=`starter_code_assigned_${we}`,_t=localStorage.getItem(It);if(_t){K(`Cdigo ya asignado en este dispositivo: ${_t}`),Ze(!1);return}Ze(!1),Ge(!0),localStorage.setItem(It,qe||re);try{await TA(we,qe||re)}catch(Fe){console.warn("[StoreScreen] No se pudo registrar uso del cdigo de entrada:",Fe)}Ve(!1),oe(` ${he.title} adquirido con xito!`,gt.Success),r&&r(we),Gd({productId:we,productType:he.type||"other",price:0,currency:"EUR"}),Ge(!1)}catch(we){console.error("[StoreScreen] error confirmPromoEntry",we),K("Error al solicitar cdigo. Intenta de nuevo ms tarde.")}finally{Ge(!1)}},it=te.useMemo(()=>{const we=L||[];if(!we.length)return we;const _e=[],me=[],ge=[],re=ye=>{const $e=Number(ye==null?void 0:ye.order);return Number.isFinite($e)?$e:9999};for(const ye of we){if(!(ye.type!=="remove_ads"&&ye.type!=="premium_phrases")){_e.push(ye);continue}(c&&Array.isArray(c)?c.includes(ye.productId):!1)?ge.push(ye):me.push(ye)}return _e.sort((ye,$e)=>re(ye)-re($e)),me.sort((ye,$e)=>re(ye)-re($e)),ge.sort((ye,$e)=>re(ye)-re($e)),[..._e,...me,...ge]},[L,c]),Rt=async()=>{if(!(!ue||Pe)){je(!0);try{const we=await uw(ue);we&&(we.validated||we.finishSuccess||we.alreadyOwned||we.restored)?(Ve(!1),oe(" Compra gratis activada y validada! Disfruta del pack.",gt.Success)):oe(' Compra procesada. Si no aparece activada, usa "Restaurar compras" en unos minutos.',gt.Warning)}catch(we){const _e=String((we==null?void 0:we.message)||String(we));oe("Error en la compra: "+_e,gt.Error)}finally{je(!1),pe(null)}}};te.useEffect(()=>{if(!ue||Ne.getPlatform()!=="android")return;let we,_e=!1;const me=ge=>{ge.isActive&&!_e&&(_e=!0,Rt())};try{we=el.addListener("appStateChange",me)}catch(ge){console.warn("[StoreScreen] No se pudo agregar listener de app state:",ge)}return()=>{try{we&&we.remove&&we.remove()}catch{}}},[ue]);const et=async()=>{var we;if(!$){se(!0);try{console.log("[StoreScreen]  Iniciando restauracin manual de compras...");const _e=Ne.getPlatform(),me=qe=>{const It=Array.isArray(qe==null?void 0:qe.platforms)?qe.platforms:null,_t=It?It.map(Et=>String(Et||"").toLowerCase().trim()).filter(Et=>!!Et):null,Fe=String((qe==null?void 0:qe.platform)||"").toLowerCase().trim();return _t&&_t.length>0?!!(_t.includes(_e)||_e==="web"&&_t.includes("android")):!Fe||Fe==="both"||Fe===_e||_e==="web"&&Fe==="android"},ge=L.find(qe=>qe.type==="remove_ads"&&me(qe)),re=L.find(qe=>qe.type==="premium_phrases"&&me(qe)),ye=eu.getAll();console.log("[StoreScreen]  Configuracin de productos registrada:",ye.length);const $e=await Zc({removeAdsId:ge==null?void 0:ge.productId,storeProducts:L,productConfigs:ye});if(console.log("[StoreScreen]  Restauracin completada:",$e),$e.hasRemoveAds||$e.hasPremium||$e.ownedPackIds&&$e.ownedPackIds.length>0){const qe=($e.hasRemoveAds?1:0)+($e.hasPremium?1:0)+(((we=$e.ownedPackIds)==null?void 0:we.length)||0);if(zk(qe),$e.hasRemoveAds&&e(),$e.hasPremium){t(),console.log("[StoreScreen]  Premium restaurado, verificando cach de frases...");try{const{phraseCache:_t}=await Yt(async()=>{const{phraseCache:Et}=await Promise.resolve().then(()=>Ki);return{phraseCache:Et}},void 0);_t.premiumPhrases.length>0?console.log("[StoreScreen]  Frases premium ya estn en cach, omitiendo descarga"):(console.log("[StoreScreen]  No hay frases premium en cach, descargando..."),await ul(!0),console.log("[StoreScreen]  Frases premium descargadas correctamente"))}catch(_t){console.warn("[StoreScreen]  Error verificando/actualizando cach de frases:",_t)}}if($e.ownedPackIds&&$e.ownedPackIds.length>0&&r)for(const _t of $e.ownedPackIds)r(_t);const It=[];$e.hasRemoveAds&&It.push("Sin anuncios"),$e.hasPremium&&It.push("Frases premium"),$e.ownedPackIds&&$e.ownedPackIds.length>0&&It.push(`${$e.ownedPackIds.length} pack(s)`),oe(` Compras restauradas con xito!

Productos: ${It.join(", ")}`,gt.Success)}else oe("No se encontraron compras para restaurar.",gt.Info)}catch(_e){console.error("[StoreScreen]  Error en restauracin:",_e);const me=_e.message||_e.toString();me.includes("play store")||me.includes("google play")?oe("Error del sistema de compras. Asegrate de estar usando la app desde Google Play Store.",gt.Error):me.includes("autenticar")||me.includes("auth")?oe("Error de autenticacin. Intenta iniciar sesin nuevamente.",gt.Error):me.includes("red")||me.includes("conexin")||me.includes("network")?oe("Error de conexin. Verifica tu conexin a internet e intenta nuevamente.",gt.Error):oe("Error restaurando compras: "+me,gt.Error)}finally{se(!1)}}};return S.jsxs("div",{className:"relative overflow-hidden flex flex-col w-full min-h-screen animate-fadeIn",children:[B&&D&&S.jsx(br,{isVisible:!0,onClose:Ue,children:S.jsxs("div",{className:"bg-slate-800/95 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-red-700 text-center",children:[S.jsx("div",{className:"text-2xl text-red-400 mb-2",children:S.jsx("i",{className:"fas fa-shield-alt"})}),S.jsx("div",{className:"text-lg font-bold text-red-300 mb-2",children:"Error de integridad"}),S.jsx("div",{className:"text-white mb-4 whitespace-pre-line",children:D}),S.jsx("button",{className:"mt-2 px-4 py-2 bg-red-600 text-white rounded shadow",onClick:Ue,children:"Cerrar"})]})}),D&&!B&&S.jsx("div",{className:`fixed top-4 left-1/2 z-50 -translate-x-1/2 px-4 py-2 rounded shadow-lg font-semibold ${N===gt.Error?"bg-red-600 text-white":N===gt.Success?"bg-green-600 text-white":"bg-slate-700 text-white"}`,onClick:Ue,style:{cursor:"pointer"},children:D}),k&&S.jsx(br,{isVisible:!0,onClose:()=>Ve(!1),children:S.jsxs("div",{className:"bg-slate-800/95 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-slate-700 text-center max-w-md mx-auto",children:[S.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:(he==null?void 0:he.title)||"Pack especial"}),S.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Introduce tu cdigo promocional para desbloquear este contenido"}),S.jsx("input",{type:"text",value:tt,onChange:we=>ee(we.target.value),placeholder:"Cdigo promocional",className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg border border-slate-600 focus:border-cyan-500 focus:outline-none mb-2"}),j&&S.jsx("p",{className:"text-red-400 text-sm mb-4",children:j}),S.jsxs("div",{className:"flex gap-3",children:[S.jsx("button",{onClick:()=>Ve(!1),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition",children:"Cancelar"}),S.jsx("button",{onClick:ze,disabled:Ke||Le||!tt.trim(),className:"flex-1 px-4 py-2 bg-gradient-to-r from-cyan-500 to-pink-500 hover:from-cyan-600 hover:to-pink-600 text-white font-bold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:Ke||Le?"Validando...":"Confirmar"})]})]})}),S.jsxs("div",{className:"flex-1 w-full max-w-2xl mx-auto px-5 sm:px-4 md:px-0 py-6",children:[S.jsxs("div",{className:"relative mb-6 pt-[calc(env(safe-area-inset-top)+0.75rem)]",children:[S.jsx("button",{onClick:()=>{try{const we=(()=>{try{const _e=sessionStorage.getItem("return_to_endgame")==="1",me=sessionStorage.getItem("return_to_completion")==="1";return _e||me}catch{return!1}})();n(we?yt.Game:yt.Home)}catch(we){console.log("Fallo al navegar, intentando historial...",we),window.history.length>1&&window.history.back()}},className:"absolute left-0 text-white text-2xl",children:S.jsx("i",{className:"fas fa-arrow-left"})}),S.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-center mt-3",children:[S.jsx("i",{className:"fas fa-store mr-3 gold-shimmer text-4xl md:text-5xl"}),S.jsx("span",{className:"gold-shimmer text-4xl md:text-5xl",children:"Tienda"})]}),S.jsx("p",{className:"text-center gold-static text-base md:text-lg mt-2",children:"Desbloquea todo el potencial!"})]}),S.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5 sm:gap-6",children:it.length===0?S.jsx("div",{className:"col-span-2 text-center text-slate-400",children:"No hay productos disponibles."}):(()=>{const we=[],_e=[];return it.forEach(me=>{(me.type==="remove_ads"?!a:me.type==="premium_phrases"?!!l:Array.isArray(c)?c.includes(me.productId):!1)?_e.push(me):we.push(me)}),S.jsxs(S.Fragment,{children:[we.map(me=>{const ge=mw(me),re=!1,ye=me.soldOut?()=>{}:me.requiresPromoCode===!0?()=>Se(me):me.isFree===!0?()=>Ae(me):()=>ve(()=>{me.type==="remove_ads"?e():me.type==="premium_phrases"?t():r&&r(me.productId)},me.productId);return S.jsx(hw,{...me,price:ge,onClick:ye,owned:re,productType:me.type},me.productId)}),_e.length>0&&S.jsx("div",{className:"col-span-1 sm:col-span-2 my-4",children:S.jsxs("button",{onClick:()=>yn(!Rn),className:"w-full flex items-center gap-3 py-3 px-4 bg-slate-800/60 hover:bg-slate-800/80 rounded-lg border border-slate-700/50 transition-all group",children:[S.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-slate-600 to-slate-500"}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("i",{className:"fas fa-check-circle text-green-400 text-sm group-hover:text-green-300 transition-colors"}),S.jsxs("span",{className:"text-slate-400 group-hover:text-slate-300 text-sm font-semibold transition-colors",children:["Mis packs adquiridos (",_e.length,")"]}),S.jsx("i",{className:`fas fa-chevron-${Rn?"up":"down"} text-slate-400 group-hover:text-slate-300 text-xs transition-all`})]}),S.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-500 via-slate-600 to-transparent"})]})}),Rn&&_e.map(me=>{const ge=mw(me),re=!0,ye=()=>{};return S.jsx(hw,{...me,price:ge,onClick:ye,owned:re,productType:me.type},me.productId)})]})})()}),S.jsxs("div",{className:"mt-3 flex items-center justify-center bg-slate-700/40 text-slate-200 rounded-lg px-3 py-2 ring-1 ring-white/10",children:[S.jsx("i",{className:"fas fa-lock text-green-300 mr-2"}),S.jsx("span",{className:"text-xs sm:text-sm",children:g?"Pago seguro con Apple Pay":"Pago seguro con Google Play"}),S.jsx("i",{className:`fab ${g?"fa-apple-pay":"fa-google-play"} text-green-300 ml-2`})]}),S.jsx("div",{className:"flex justify-center mt-4",children:S.jsxs("button",{className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-200 font-bold py-2 px-6 rounded-lg shadow transition-all text-base",onClick:()=>Wt(!0),children:[S.jsx("i",{className:"fas fa-question-circle"}),"Ayuda"]})}),Vt&&S.jsx(br,{onClose:()=>Wt(!1),isVisible:!0,children:S.jsxs("div",{className:"bg-slate-800/95 backdrop-blur-sm rounded-xl p-6 shadow-2xl border border-slate-700 relative max-w-md mx-auto text-center",children:[S.jsx("h2",{className:"text-xl font-bold text-slate-100 mb-4",children:"Centro de ayuda y soporte"}),S.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[S.jsxs("button",{className:"flex items-center gap-2 bg-gradient-to-r from-cyan-500 to-pink-500 hover:from-cyan-600 hover:to-pink-600 text-white font-bold py-2 px-5 rounded-lg shadow-lg transition-all text-base disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>{et(),Wt(!1)},type:"button",disabled:$,children:[S.jsx("i",{className:"fas fa-sync-alt"}),"Restaurar mis compras"]}),S.jsx("span",{className:"text-xs text-slate-400 text-center max-w-xs",children:"Si has cambiado de mvil, reinstalado la app o no ves tus compras activas, pulsa aqu para recuperarlas automticamente."}),S.jsxs("a",{href:"mailto:sinami.studio22@gmail.com?subject=%5BYoNunca%5D%20Problema%20en%20compras",className:"flex items-center gap-2 bg-slate-700 hover:bg-slate-600 text-slate-200 font-bold py-2 px-5 rounded-lg shadow transition-all text-base",style:{textDecoration:"none"},target:"_blank",rel:"noopener noreferrer",children:[S.jsx("i",{className:"fas fa-envelope"}),"Contactar soporte compras"]}),S.jsxs("button",{className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-lg shadow transition-all text-base mt-2",style:{textDecoration:"none"},onClick:async()=>{let we=A;if(!we)try{we=await gM(),C(we)}catch{}const _e=`https://miguelrs01.github.io/yo-nunca-app-web/delete-account.html${we?`?deviceId=${encodeURIComponent(we)}`:""}`;window.open(_e,"_blank")},type:"button",children:[S.jsx("i",{className:"fas fa-user-slash"}),"Eliminar mi cuenta"]}),S.jsx("span",{className:"text-xs text-slate-400 text-center max-w-xs mt-1 block",children:`Si accedes desde la app, tu identificador se rellenar automticamente. Si accedes desde la web, te solicitar el siguiente identificador de dispositivo${A?`: ${A}`:""}`})]}),S.jsx("button",{className:"absolute top-3 right-3 text-slate-400 hover:text-slate-200 transition",onClick:()=>Wt(!1),"aria-label":"Cerrar ayuda",children:S.jsx("i",{className:"fas fa-times"})})]})})]})]})}const RM=({onClose:n})=>{const[e,t]=te.useState(""),[r,a]=te.useState(!1),[l,c]=te.useState(""),[d,h]=te.useState(!1),m=async g=>{if(g.preventDefault(),e.trim().length<10){c("La frase debe tener al menos 10 caracteres.");return}c(""),a(!0);try{await SA(e),Bk(),h(!0),setTimeout(()=>{n()},2e3)}catch{c("No se pudo enviar la sugerencia. Intntalo de nuevo."),a(!1)}};return S.jsx(br,{onClose:n,children:S.jsx("div",{className:"p-6",children:d?S.jsxs("div",{className:"text-center",children:[S.jsx("i",{className:"fas fa-check-circle text-5xl text-green-400 mb-4"}),S.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Gracias!"}),S.jsx("p",{className:"text-slate-300",children:"Tu sugerencia ha sido enviada para revisin."})]}):S.jsxs(S.Fragment,{children:[S.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Sugerir una Frase"}),S.jsx("p",{className:"text-slate-400 mb-6",children:"Tienes una idea genial? Comprtela con nosotros! Si es aprobada, aparecer en el juego."}),S.jsxs("form",{onSubmit:m,children:[S.jsxs("div",{className:"relative",children:[S.jsx("span",{className:"absolute left-4 top-3 text-slate-400",children:"Yo nunca..."}),S.jsx("input",{type:"text",value:e,onChange:g=>t(g.target.value),placeholder:"he hecho...",className:"w-full bg-slate-700 border border-slate-600 rounded-md py-3 pr-4 pl-36 focus:ring-2 focus:ring-cyan-400 focus:outline-none transition",disabled:r})]}),l&&S.jsx("p",{className:"text-red-400 text-sm mt-2",children:l}),S.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[S.jsx(Kt,{type:"button",variant:"secondary",onClick:n,disabled:r,children:"Cancelar"}),S.jsx(Kt,{type:"submit",disabled:r||e.trim()==="",children:r?S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Enviando..."]}):"Enviar Sugerencia"})]})]})]})})})},IM=({title:n,message:e,buttonText:t,onClose:r,showPlayStoreButton:a=!1,playStoreButtonText:l="Descargar App",playStoreUrl:c=""})=>{const d=async()=>{if(c)try{await ZA.open({url:c})}catch(h){console.error("[PopupModal] Error abriendo Play Store:",h),window.open(c,"_blank")}};return S.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 p-4",children:S.jsxs("div",{className:"bg-gradient-to-br from-purple-900 to-indigo-900 rounded-2xl shadow-2xl max-w-md w-full p-6 border-2 border-purple-500",children:[n&&S.jsx("h2",{className:"text-2xl font-bold text-white mb-4 text-center",children:n}),e&&S.jsx("p",{className:"text-gray-200 mb-6 text-center leading-relaxed whitespace-pre-line",children:e}),S.jsxs("div",{className:"space-y-3",children:[a&&c&&S.jsxs("button",{onClick:d,className:`w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold py-3 px-6 rounded-lg \r
                                     hover:from-green-600 hover:to-emerald-700 transition-all duration-200 \r
                                     shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center justify-center gap-2`,children:[S.jsx("i",{className:"fab fa-google-play text-xl"}),l]}),S.jsx("button",{onClick:r,className:`w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white font-semibold py-3 px-6 rounded-lg 
                                 hover:from-pink-600 hover:to-purple-700 transition-all duration-200 
                                 shadow-lg hover:shadow-xl transform hover:scale-105 `,children:t})]})]})})},PM=()=>{const n=te.useRef(null);return te.useEffect(()=>{let e=!0;const t=async()=>{try{if(Ne.getPlatform()!=="web")await wr.showBanner();else if(n.current&&n.current.childNodes.length===0){console.log(" [AdBanner] Intentando cargar anuncio Adsterra en Web/PWA");const a=document.createElement("div");a.id="container-d1be381615b05e0228eda82b64bf0b8a",a.style.width="100%",a.style.height="100%",n.current.appendChild(a),console.log(" [AdBanner] Contenedor Adsterra creado");const l=document.createElement("script");l.async=!0,l.dataset.cfasync="false",l.src="https://pl28337203.effectivegatecpm.com/d1be381615b05e0228eda82b64bf0b8a/invoke.js",l.onload=()=>console.log(" [AdBanner] Script Adsterra cargado"),l.onerror=()=>console.error(" [AdBanner] Error cargando script Adsterra"),n.current.appendChild(l)}else console.log(" [AdBanner] Contenedor Adsterra ya existe o referencia null")}catch(a){console.error("Error al cargar el anuncio:",a)}};t();const r=()=>{e&&Ne.getPlatform()!=="web"?wr.showBanner():e&&Ne.getPlatform()==="web"&&n.current&&n.current.childNodes.length===0&&(console.log(" [AdBanner] Reconexin detectada, reintentando carga Adsterra"),t())};return window.addEventListener("online",r),()=>{e=!1,wr.hideBanner().catch(()=>{}),window.removeEventListener("online",r)}},[]),Ne.getPlatform()==="web"?S.jsx("div",{ref:n,style:{width:"100%",height:"60px",maxHeight:"60px",position:"fixed",bottom:0,left:0,zIndex:1e3}}):null},pw="yo_nunca_device_id",gw="yo_nunca_firebase_uid",yw=()=>{const n=Ne.getPlatform(),e=Ne.isNativePlatform(),t=[];t.push(n),t.push(e?"native":"web"),typeof window<"u"&&window.screen&&(t.push(`${window.screen.width}x${window.screen.height}`),t.push(`${window.screen.colorDepth}`),t.push(`${window.devicePixelRatio||1}`)),typeof navigator<"u"&&(t.push(navigator.userAgent),t.push(navigator.language||"es"),t.push(`${navigator.hardwareConcurrency||0}`));try{t.push(Intl.DateTimeFormat().resolvedOptions().timeZone)}catch{t.push("UTC")}const r=t.join("|");return CM(r)},CM=n=>{let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return Math.abs(e).toString(36)},Iy=()=>{try{const n=localStorage.getItem(pw);if(n)return console.log("[DeviceService]  Device ID encontrado en storage:",n),n;const e=yw();return console.log("[DeviceService]  Nuevo Device ID generado:",e),localStorage.setItem(pw,e),e}catch(n){return console.error("[DeviceService]  Error obteniendo Device ID:",n),yw()}},NM=()=>{try{const n=Iy(),e=`${gw}_${n}`;let t=localStorage.getItem(e);return t||(t=localStorage.getItem(gw)),t?console.log("[DeviceService]  Firebase UID encontrado para dispositivo:",t):console.log("[DeviceService]  No hay Firebase UID guardado para este dispositivo"),t}catch(n){return console.error("[DeviceService]  Error obteniendo Firebase UID:",n),null}},OM=()=>({platform:Ne.getPlatform(),isNative:Ne.isNativePlatform(),deviceId:Iy(),storedFirebaseUid:NM(),screen:typeof window<"u"&&window.screen?{width:window.screen.width,height:window.screen.height,colorDepth:window.screen.colorDepth,pixelRatio:window.devicePixelRatio}:null,userAgent:typeof navigator<"u"?navigator.userAgent:"unknown"}),Hd="1.0.0",Op=1440*60*1e3,xM=5*1024*1024,Ic="yo_nunca_cache_";class DM{constructor(){De(this,"memoryCache",new Map);De(this,"stats",{totalSize:0,itemCount:0,hitRate:0,hits:0,misses:0,lastCleanup:Date.now()})}async incrementDataVersion(){try{if(!Ft)return;const e=At(st,"consolidated","metadata");await da(e,{dataVersion:Date.now(),lastUpdate:Xc()},{merge:!0}),console.log("[OptimizedCache]  Data version incremented")}catch(e){console.error("[OptimizedCache]  Error incrementing data version:",e)}}setMemoryCache(e,t,r){const a=JSON.stringify(t),l=new Blob([a]).size;this.memoryCache.set(e,{data:t,metadata:r,size:l}),this.stats.itemCount=this.memoryCache.size,console.log(`[OptimizedCache]  Memory cached: ${e} (${(l/1024).toFixed(2)} KB)`)}getMemoryCache(e){const t=this.memoryCache.get(e);return t?Date.now()-t.metadata.timestamp>Op?(this.memoryCache.delete(e),this.stats.misses++,console.log(`[OptimizedCache]  Memory cache expired: ${e}`),null):(this.stats.hits++,t):(this.stats.misses++,null)}setLocalStorage(e,t,r){try{const a=Ic+e,l={data:t,metadata:r,size:0},c=JSON.stringify(l),d=new Blob([c]).size;return d>xM?(console.warn(`[OptimizedCache]  Data too large for localStorage: ${e} (${(d/1024).toFixed(2)} KB)`),!1):(l.size=d,localStorage.setItem(a,JSON.stringify(l)),this.stats.totalSize+=d,console.log(`[OptimizedCache]  localStorage saved: ${e} (${(d/1024).toFixed(2)} KB)`),!0)}catch(a){return console.error("[OptimizedCache]  Error saving to localStorage:",a),this.cleanExpiredCache(),!1}}getLocalStorage(e){try{const t=Ic+e,r=localStorage.getItem(t);if(!r)return this.stats.misses++,null;const a=JSON.parse(r);return a.metadata.version!==Hd?(localStorage.removeItem(t),this.stats.misses++,console.log(`[OptimizedCache]  Version mismatch: ${e}`),null):Date.now()-a.metadata.timestamp>Op?(localStorage.removeItem(t),this.stats.misses++,console.log(`[OptimizedCache]  localStorage cache expired: ${e}`),null):(this.stats.hits++,a)}catch(t){return console.error("[OptimizedCache]  Error reading from localStorage:",t),this.stats.misses++,null}}async loadPhrases(e,t,r=!1){const a=`phrases_${e}`,l="[OptimizedCache:Phrases]";if(console.log(`${l}  Loading phrases for user: ${e}`),console.log(`${l}  Owned packs: [${t.join(", ")}]`),console.log(`${l}  Force refresh: ${r}`),!r){const m=this.getMemoryCache(a);if(m){const g=Object.keys(m.data.packPhrases);if(t.length===g.length&&t.every(v=>g.includes(v)))return console.log(`${l}  Memory cache HIT (0 reads)`),m.data;console.log(`${l}  Memory cache packs mismatch`)}}if(!r){const m=this.getLocalStorage(a);if(m){const g=Object.keys(m.data.packPhrases);if(t.length===g.length&&t.every(v=>g.includes(v)))return console.log(`${l}  localStorage cache HIT (0 reads)`),this.setMemoryCache(a,m.data,m.metadata),m.data;console.log(`${l}  localStorage cache packs mismatch`)}}console.log(`${l}  Fetching from Firestore (selective download)`);const c=Date.now();let d=0;const h={freePhrases:[],packPhrases:{},adultPhrases:[],allPhrases:[]};try{if(!Ft)return console.warn(`${l}  Firebase disabled, returning empty data`),h;const m=At(st,"consolidated","phrases_free"),g=await vn(m);if(d++,g.exists()){const I=g.data().phrases||[];h.freePhrases=I.filter(A=>!A.packIds||A.packIds.length===0||A.isDemo===!0),h.allPhrases.push(...h.freePhrases),console.log(`${l}  Free phrases loaded: ${h.freePhrases.length}`)}for(const T of t)if(T!=="remove_ads")try{const I=At(st,"consolidated",`phrases_pack_${T}`),A=await vn(I);if(d++,A.exists()){const L=A.data().phrases||[];h.packPhrases[T]=L,h.allPhrases.push(...L),console.log(`${l}  Pack ${T} loaded: ${L.length} phrases`)}else console.warn(`${l}  Pack document not found: ${T}`)}catch(I){console.error(`${l}  Error loading pack ${T}:`,I)}h.adultPhrases=h.allPhrases.filter(T=>T.isAdult===!0);const _=Date.now()-c;console.log(`${l}  Firestore load complete:`),console.log(`${l}    - Reads: ${d}`),console.log(`${l}    - Time: ${_}ms`),console.log(`${l}    - Total phrases: ${h.allPhrases.length}`),console.log(`${l}    - Free: ${h.freePhrases.length}`),console.log(`${l}    - Packs: ${Object.keys(h.packPhrases).length}`),console.log(`${l}    - Adult: ${h.adultPhrases.length}`);const v={version:Hd,timestamp:Date.now(),dataVersion:Date.now(),userId:e,ownedPacks:t};return this.setMemoryCache(a,h,v),this.setLocalStorage(a,h,v),h}catch(m){return console.error(`${l}  Error loading phrases:`,m),h}}async loadAppConfig(e=!1){const t="app_config",r="[OptimizedCache:Config]";if(console.log(`${r}  Loading app config`),!e){const a=this.getMemoryCache(t);if(a)return console.log(`${r}  Memory cache HIT (0 reads)`),a.data}if(!e){const a=this.getLocalStorage(t);if(a)return console.log(`${r}  localStorage cache HIT (0 reads)`),this.setMemoryCache(t,a.data,a.metadata),a.data}console.log(`${r}  Fetching from Firestore`);try{if(!Ft)return null;const a=At(st,"consolidated","app_config"),l=await vn(a);if(!l.exists())return console.warn(`${r}  Config document not found`),null;const c=l.data();console.log(`${r}  Config loaded (1 read)`);const d={version:Hd,timestamp:Date.now(),dataVersion:Date.now(),ownedPacks:[]};return this.setMemoryCache(t,c,d),this.setLocalStorage(t,c,d),c}catch(a){return console.error(`${r}  Error loading config:`,a),null}}async loadUserPacks(e){const t="[OptimizedCache:UserPacks]";try{if(!Ft)return[];console.log(`${t}  Fetching user packs for: ${e}`);const r=At(st,"userPacks",e),a=await vn(r);if(!a.exists())return console.log(`${t}  No packs found for user`),[];const c=a.data().packs||[];return console.log(`${t}  User packs loaded: [${c.join(", ")}] (1 read, ~100 bytes)`),c}catch(r){return console.error(`${t}  Error loading user packs:`,r),[]}}invalidateUserCache(e){const t=`phrases_${e}`;this.memoryCache.delete(t);const r=Ic+t;localStorage.removeItem(r),console.log(`[OptimizedCache]  Cache invalidated for user: ${e}`)}invalidateAllCache(){this.memoryCache.clear(),Object.keys(localStorage).forEach(t=>{t.startsWith(Ic)&&localStorage.removeItem(t)}),console.log("[OptimizedCache]  All cache invalidated")}cleanExpiredCache(){const e="[OptimizedCache:Cleanup]";console.log(`${e}  Starting cache cleanup`);let t=0;const r=Date.now();Object.keys(localStorage).forEach(l=>{if(l.startsWith(Ic))try{const c=localStorage.getItem(l);if(!c)return;const d=JSON.parse(c);(r-d.metadata.timestamp>Op||d.metadata.version!==Hd)&&(localStorage.removeItem(l),t++)}catch{localStorage.removeItem(l),t++}}),this.stats.lastCleanup=r,console.log(`${e}  Cleanup complete: ${t} items removed`)}getStats(){return this.stats.hitRate=this.stats.hits+this.stats.misses>0?this.stats.hits/(this.stats.hits+this.stats.misses)*100:0,{...this.stats}}resetStats(){this.stats.hits=0,this.stats.misses=0,this.stats.hitRate=0}printStats(){const e=this.getStats();console.log("========================================"),console.log("OPTIMIZED CACHE STATISTICS"),console.log("========================================"),console.log(`Hit Rate: ${e.hitRate.toFixed(2)}%`),console.log(`Hits: ${e.hits}`),console.log(`Misses: ${e.misses}`),console.log(`Memory Items: ${e.itemCount}`),console.log(`Total Size: ${(e.totalSize/1024).toFixed(2)} KB`),console.log(`Last Cleanup: ${new Date(e.lastCleanup).toLocaleString()}`),console.log("========================================")}}const Py=new DM;Py.cleanExpiredCache();setInterval(()=>{Py.cleanExpiredCache()},3600*1e3);const Ha=async(n,e)=>{try{const t=Iy();return await Py.loadPhrases(t,e,n)}catch(t){return console.error("[updatePhraseCache]  Error actualizando cache:",t),null}},Wo=er("PushNotifications",{});var _w;(function(n){n[n.Sunday=1]="Sunday",n[n.Monday=2]="Monday",n[n.Tuesday=3]="Tuesday",n[n.Wednesday=4]="Wednesday",n[n.Thursday=5]="Thursday",n[n.Friday=6]="Friday",n[n.Saturday=7]="Saturday"})(_w||(_w={}));const fr=er("LocalNotifications",{web:()=>Yt(()=>import("./web-DSCA9fef.js"),[]).then(n=>new n.LocalNotificationsWeb)}),$d="usage_sessions",qd=1001,Yd=1002;class kM{constructor(){De(this,"sessions",[]);De(this,"initialized",!1)}async initialize(){if(this.initialized){console.log("[UsageTracker] Ya inicializado");return}if(!Ne.isNativePlatform()){console.log("[UsageTracker] No disponible en web");return}try{console.log("[UsageTracker]  Inicializando...");const{value:e}=await on.get({key:$d});if(e&&(this.sessions=JSON.parse(e),console.log("[UsageTracker] Sesiones cargadas:",this.sessions.length)),(await fr.checkPermissions()).display!=="granted"&&(await fr.requestPermissions()).display!=="granted"){console.warn("[UsageTracker]  Permisos de notificaciones locales denegados");return}this.registerLocalNotificationListeners(),this.initialized=!0,console.log("[UsageTracker]  Inicializado correctamente"),await this.analyzeAndSchedule()}catch(e){console.error("[UsageTracker]  Error inicializando:",e)}}registerLocalNotificationListeners(){fr.addListener("localNotificationActionPerformed",async e=>{console.log("[UsageTracker]  Notificacin local tocada:",e.notification.id),await this.cancelAllNotifications(),await this.trackSession()})}async trackSession(){this.initialized||await this.initialize();const e=new Date,t={timestamp:e.getTime(),dayOfWeek:e.getDay(),hour:e.getHours()};this.sessions.push(t),this.sessions.length>50&&(this.sessions=this.sessions.slice(-50)),await on.set({key:$d,value:JSON.stringify(this.sessions)}),console.log("[UsageTracker]  Sesin registrada:",{day:this.getDayName(t.dayOfWeek),hour:`${t.hour}:00`}),await this.cancelAllNotifications(),await this.analyzeAndSchedule()}async analyzeAndSchedule(){if(this.sessions.length<5){console.log("[UsageTracker]  Pocas sesiones para analizar patrones (mnimo 5)"),await this.scheduleComebackNotification();return}const e={};this.sessions.forEach(a=>{const l=`${a.dayOfWeek}-${a.hour}`;e[l]=(e[l]||0)+1});let t="",r=0;if(Object.entries(e).forEach(([a,l])=>{l>r&&(r=l,t=a)}),r>=3){const[a,l]=t.split("-"),c=parseInt(a),d=parseInt(l);console.log(`[UsageTracker]  Patrn detectado: ${this.getDayName(c)} a las ${d}:00 (${r} veces)`),await this.scheduleSmartNotification(c,d)}else console.log("[UsageTracker]  Sin patrn claro detectado an"),await this.scheduleComebackNotification()}async scheduleSmartNotification(e,t){try{let r=t,a=30,l=e;t===0?(r=23,a=30,l=e===0?6:e-1):r=t-1,console.log("[UsageTracker]  Programando notificacin inteligente:"),console.log(`   Da: ${this.getDayName(l)} a las ${r}:${a}`),await fr.cancel({notifications:[{id:qd},{id:Yd}]}),await fr.schedule({notifications:[{id:qd,title:" Ya casi es tu hora!",body:"Con ganas de un Yo Nunca? Entra y descubre nuevas frases ",schedule:{on:{weekday:l+1,hour:r,minute:a},allowWhileIdle:!0,repeats:!0},sound:void 0,actionTypeId:"",extra:{type:"smart_pattern"}}]}),console.log("[UsageTracker]  Notificacin inteligente programada correctamente")}catch(r){console.error("[UsageTracker]  Error programando notificacin inteligente:",r)}}async scheduleComebackNotification(){try{console.log("[UsageTracker]  Programando notificacin de recordatorio..."),await fr.cancel({notifications:[{id:qd},{id:Yd}]});const e=new Date;e.setHours(e.getHours()+24),await fr.schedule({notifications:[{id:Yd,title:" Te echamos de menos!",body:"Volvemos a jugar? Hay nuevos desafos esperndote ",schedule:{at:e,allowWhileIdle:!0},sound:void 0,actionTypeId:"",extra:{type:"comeback"}}]}),console.log("[UsageTracker]  Notificacin de recordatorio programada")}catch(e){console.error("[UsageTracker]  Error programando notificacin de recordatorio:",e)}}async cancelAllNotifications(){try{const e=await fr.getPending();e.notifications.length>0&&(await fr.cancel({notifications:[{id:qd},{id:Yd}]}),console.log("[UsageTracker]  Notificaciones canceladas:",e.notifications.length))}catch(e){console.error("[UsageTracker]  Error cancelando notificaciones:",e)}}async getPendingNotifications(){try{const e=await fr.getPending();return console.log("[UsageTracker]  Notificaciones pendientes:",e.notifications),e.notifications}catch(e){return console.error("[UsageTracker]  Error obteniendo pendientes:",e),[]}}async clearAllData(){try{this.sessions=[],await on.remove({key:$d}),await this.cancelAllNotifications(),console.log("[UsageTracker]  Todos los datos limpiados")}catch(e){console.error("[UsageTracker]  Error limpiando datos:",e)}}async simulateData(){console.log("[UsageTracker]  Simulando datos de prueba...");const e=[];for(let t=0;t<5;t++)e.push({timestamp:Date.now()-t*24*60*60*1e3,dayOfWeek:4,hour:22});this.sessions=e,await on.set({key:$d,value:JSON.stringify(this.sessions)}),console.log("[UsageTracker]  Datos simulados:",e.length,"sesiones"),await this.analyzeAndSchedule()}getDayName(e){return["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"][e]}getUsageStats(){if(this.sessions.length===0)return{totalSessions:0,message:"Sin datos an"};const e={};this.sessions.forEach(a=>{e[a.hour]=(e[a.hour]||0)+1});let t=0,r=0;return Object.entries(e).forEach(([a,l])=>{l>r&&(r=l,t=parseInt(a))}),{totalSessions:this.sessions.length,favoriteHour:`${t}:00`,message:`Has jugado ${this.sessions.length} veces. Tu hora favorita es a las ${t}:00`}}}const xc=new kM;class MM{constructor(){De(this,"initialized",!1);De(this,"currentToken",null);De(this,"deviceId",null)}async initialize(){if(this.initialized){X.info("[Push] Ya inicializado");return}if(!Ne.isNativePlatform()){X.info("[Push] No disponible en web");return}try{if(X.info("[Push]  Inicializando FCM..."),!await this.requestPermissions()){X.warn("[Push]  Permisos denegados");return}this.registerListeners(),await Wo.register(),this.initialized=!0,X.info("[Push]  FCM inicializado correctamente")}catch(e){X.error("[Push]  Error inicializando:",e)}}async requestPermissions(){try{const e=await Wo.requestPermissions();return e.receive==="granted"?(X.info("[Push]  Permisos concedidos"),!0):(X.warn("[Push]  Permisos no concedidos:",e.receive),!1)}catch(e){return X.error("[Push]  Error solicitando permisos:",e),!1}}registerListeners(){Wo.addListener("registration",async e=>{X.info("[Push]  Token FCM recibido:",e.value),this.currentToken=e.value,await this.saveTokenToFirestore(e.value)}),Wo.addListener("registrationError",e=>{X.error("[Push]  Error en registro:",e)}),Wo.addListener("pushNotificationReceived",e=>{X.info("[Push]  Notificacin recibida (foreground):",e)}),Wo.addListener("pushNotificationActionPerformed",async e=>{X.info("[Push]  Notificacin PUSH tocada:",e);const t=e.notification.data;await this.trackNotificationOpen(t),await xc.trackSession()})}async saveTokenToFirestore(e){try{const t=Ut.currentUser;if(!t){X.warn("[Push]  Usuario no autenticado, no se puede guardar token");return}this.deviceId=await this.getDeviceId();const r=Ne.getPlatform();X.info("[Push]  Guardando token en Firestore..."),X.info("[Push] UserID:",t.uid),X.info("[Push] DeviceID:",this.deviceId),X.info("[Push] Platform:",r);const a=At(st,"consolidated","user_tokens"),l=await vn(a),c={fcmToken:e,platform:r,lastActive:Dt.now(),notificationsEnabled:!0,appVersion:"1.0.0"};l.exists()?await Tc(a,{[`tokens.${t.uid}.${this.deviceId}`]:c}):await da(a,{tokens:{[t.uid]:{[this.deviceId]:c}}}),X.info("[Push]  Token FCM guardado exitosamente")}catch(t){X.error("[Push]  Error guardando token:",t)}}async trackNotificationOpen(e){try{const t=Ut.currentUser;if(!t||!this.deviceId)return;const r=At(st,"consolidated","user_tokens");await Tc(r,{[`tokens.${t.uid}.${this.deviceId}.lastActive`]:Dt.now(),[`tokens.${t.uid}.${this.deviceId}.lastNotificationOpened`]:Dt.now()}),X.info("[Push]  Apertura de notificacin registrada")}catch(t){X.error("[Push]  Error registrando apertura:",t)}}async getDeviceId(){try{const e=localStorage.getItem("device_id");if(e)return e;const t=Ne.getPlatform(),r=Date.now(),a=Math.random().toString(36).substr(2,9),l=`${t}_${r}_${a}`;return localStorage.setItem("device_id",l),X.info("[Push] Nuevo Device ID generado:",l),l}catch{return`${Ne.getPlatform()}_${Date.now()}`}}async removeToken(){try{const e=Ut.currentUser;if(!e||!this.deviceId){X.warn("[Push] No hay token para eliminar");return}X.info("[Push]  Eliminando token FCM...");const t=At(st,"consolidated","user_tokens");await Tc(t,{[`tokens.${e.uid}.${this.deviceId}`]:null}),this.currentToken=null,X.info("[Push]  Token FCM eliminado")}catch(e){X.error("[Push]  Error eliminando token:",e)}}async setNotificationsEnabled(e){try{const t=Ut.currentUser;if(!t||!this.deviceId)return;const r=At(st,"consolidated","user_tokens");await Tc(r,{[`tokens.${t.uid}.${this.deviceId}.notificationsEnabled`]:e}),X.info("[Push]  Notificaciones PUSH",e?"habilitadas":"deshabilitadas")}catch(t){X.error("[Push]  Error actualizando estado:",t)}}async updateLastActive(){try{const e=Ut.currentUser;if(!e||!this.deviceId)return;const t=At(st,"consolidated","user_tokens");await Tc(t,{[`tokens.${e.uid}.${this.deviceId}.lastActive`]:Dt.now()}),X.info("[Push]  ltima actividad actualizada")}catch(e){X.error("[Push]  Error actualizando actividad:",e)}}getCurrentToken(){return this.currentToken}isInitialized(){return this.initialized}getDeviceIdSync(){return this.deviceId}}const vw=new MM,xp="1.1.021";YI();const LM=()=>{const[n,e]=te.useState(yt.Home),[t,r]=te.useState(!1),[a,l]=te.useState(!0),[c,d]=te.useState(!1),[h,m]=te.useState([]),[g,_]=te.useState([]),[v,T]=te.useState(!1),[I,A]=te.useState(!1),[C,L]=te.useState(!1),[x,U]=te.useState(null),[z,$]=te.useState(void 0),[se,D]=te.useState("Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."),[P,N]=te.useState(!1),[M,B]=te.useState({title:"",message:"",buttonText:"Entendido"}),[G,k]=te.useState(null),Ve=te.useRef(!1),tt=te.useRef(!1),ee=te.useRef(yt.Home);te.useEffect(()=>{Ve.current=P},[P]),te.useEffect(()=>{tt.current=t},[t]),te.useEffect(()=>{ee.current=n},[n]);const[he,Ie]=te.useState(!1),[Le,Ge]=te.useState([]),[j,K]=te.useState("Desconocido"),ue=(()=>{try{const Te="false";Te==null;const oe=String(Te).toLowerCase().trim();return oe==="true"||oe==="1"||oe==="yes"}catch{return!1}})();te.useEffect(()=>{const Te=oe=>{Ge(Ue=>[oe,...Ue].slice(0,50))};return sE.addListener(Te),()=>sE.removeListener(Te)},[]);const pe=Te=>X.info(Te),Pe=async()=>{pe("Iniciando diagnstico...");try{let Te=Ut==null?void 0:Ut.currentUser;if(Te)pe(`Auth User: ${Te.uid}`);else{pe(" Usuario no logueado. Intentando login forzado...");try{const{signInAnonymously:oe}=await Yt(async()=>{const{signInAnonymously:ve}=await Promise.resolve().then(()=>MS);return{signInAnonymously:ve}},void 0);Te=(await oe(Ut)).user,pe(` Login forzado OK: ${Te.uid}`)}catch(oe){pe(` Login forzado FALL: ${oe.message}`)}}if(pe("Probando Firestore..."),typeof og=="function"){const oe=await og();oe.success?(pe(` Firestore OK: ${oe.message}`),K("Conectado")):(pe(` Firestore ERROR: ${oe.message} (${oe.code})`),K("Error: "+oe.code))}else pe(" testFirestoreConnection no es una funcin")}catch(Te){pe(` Excepcin Global: ${Te.message}`),K("Excepcin")}};te.useEffect(()=>{Ne.getPlatform()==="ios"&&setTimeout(Pe,5e3)},[]),te.useEffect(()=>{(async()=>{try{const{signInAnonymously:oe,onAuthStateChanged:Ue}=await Yt(async()=>{const{signInAnonymously:Se,onAuthStateChanged:ze}=await Promise.resolve().then(()=>MS);return{signInAnonymously:Se,onAuthStateChanged:ze}},void 0),{auth:ve}=await Yt(async()=>{const{auth:Se}=await Promise.resolve().then(()=>r2);return{auth:Se}},void 0),{Capacitor:Ae}=await Yt(async()=>{const{Capacitor:Se}=await Promise.resolve().then(()=>i2);return{Capacitor:Se}},void 0);X.info("[Auth]  Iniciando autenticacin..."),Ue(ve,Se=>{Se?(X.info(`[Auth]  Estado cambi: LOGUEADO (${Se.uid})`),pe(` Auth State: LOGUEADO (${Se.uid})`)):(X.info("[Auth]  Estado cambi: NO LOGUEADO"),pe(" Auth State: NO LOGUEADO"))});try{if(ve.currentUser)X.info("[Auth]  Ya autenticado en JS:",ve.currentUser.uid);else{X.info("[Auth]  No hay usuario, intentando signInAnonymously...");const Se=await oe(ve);X.info("[Auth]  Autenticacin JS exitosa:",Se.user.uid),localStorage.setItem("firebase_uid",Se.user.uid)}}catch(Se){X.error("[Auth]  Error en autenticacin JS:",Se.message),pe(` Auth Error: ${Se.message}`)}await je()}catch(oe){X.error("[Auth]  Error general en inicializacin:",oe.message),pe(` Init Error: ${oe.message}`)}})()},[]);const je=async()=>{try{if(X.info("[Notifications]  Inicializando servicios de notificaciones..."),!Ne.isNativePlatform()){X.info("[Notifications]  No disponible en web, saltando inicializacin");return}try{await vw.initialize(),X.info("[Notifications]  Push notifications (FCM) inicializadas")}catch(Te){X.error("[Notifications]  Error inicializando push notifications:",Te)}try{await xc.initialize(),X.info("[Notifications]  Usage Tracker inicializado"),await xc.trackSession(),X.info("[Notifications]  Primera sesin trackeada")}catch(Te){X.error("[Notifications]  Error inicializando Usage Tracker:",Te)}X.info("[Notifications]  Servicios de notificaciones listos")}catch(Te){X.error("[Notifications]  Error general inicializando notificaciones:",Te)}};te.useEffect(()=>{if(!Ne.isNativePlatform())return;const Te=async Ue=>{if(Ue.isActive){X.info("[App]  App pas a foreground");try{await vw.updateLastActive(),await xc.trackSession(),X.info("[App]  Actividad registrada")}catch(ve){X.warn("[App]  Error registrando actividad:",ve)}}},oe=el.addListener("appStateChange",Te);return()=>{oe.then(Ue=>Ue.remove()).catch(()=>{})}},[]),te.useEffect(()=>{(async()=>{await _g.initialize("pro"),X.info(`[App]  Ambiente inicializado: ${"pro".toUpperCase()}`),xi&&(Mk(xi),Lk(),X.info("[App]  Analytics inicializado"));const Ue=OM();X.info("[App]  Informacin del dispositivo:",Ue),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (no-auth) owned=[]"),await Ha(!1,[]),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (no-auth)"),await PA.loadCounters();try{X.info("[App] Inicializando AdService..."),await wr.initialize()?X.info("[App]  AdService inicializado correctamente"):X.warn("[App]  AdService no pudo inicializarse")}catch(ve){X.error("[App]  Error inicializando AdService:",ve)}})()},[]),te.useEffect(()=>{(async()=>{try{X.info("[PHRASE_FLOW][APP]  ownedPackIds change",h),Array.isArray(h)&&h.length>0?(h.length>0?(X.info("[PHRASE_FLOW][APP]  FULL reload (primera deteccin packs) owned=",h),await Ha(!0,h)):(X.info("[PHRASE_FLOW][APP]  updatePhraseCache (owned change) owned=",h),await Ha(!1,h)),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (owned change)")):X.info("[PHRASE_FLOW][APP]  ownedPackIds vaco; no actualizamos cache")}catch(Te){X.warn("[App]  Error sincronizando cach tras cambio de ownedPackIds:",Te)}})()},[h]),te.useEffect(()=>{(async()=>{try{X.info("[App]  Inicializando configuracin de productos..."),SM({onRemoveAdsPurchased:()=>{X.info("[App]  Remove Ads comprado"),l(!1)}});const{getStoreProducts:oe}=await Yt(async()=>{const{getStoreProducts:it}=await Promise.resolve().then(()=>Ki);return{getStoreProducts:it}},void 0),Ue=await oe();X.info("[App]  Productos cargados desde Firestore:",Ue.length),_(Ue),wM(Ue,{onPackPurchased:async it=>{X.info("[PHRASE_FLOW][APP]  onPackPurchased pack=",it),m(Rt=>{const et=Array.from(new Set([...Rt,it]));return X.info("[PHRASE_FLOW][APP]  Packs actualizados post-compra:",et),et}),X.info("[PHRASE_FLOW][APP]  Forzando actualizacin de cach post-compra"),await Ha(!1,[...h,it]),X.info("[PHRASE_FLOW][APP]  Cach actualizado post-compra")}});const ve=eu.getAll(),Ae=Ne.getPlatform(),Se=Ue.find(it=>{if((it==null?void 0:it.type)!=="remove_ads")return!1;const Rt=((it==null?void 0:it.platform)||"").toLowerCase().trim();return!Rt||Rt==="both"||Rt===Ae});X.info("[PHRASE_FLOW][APP]  restorePurchases inicio");const ze=await Zc({removeAdsId:Se==null?void 0:Se.productId,storeProducts:Ue,productConfigs:ve});if(ze){X.info("[PHRASE_FLOW][APP]  restorePurchases fin",ze);const{syncUserPacks:it,acquireFreePack:Rt}=await Yt(async()=>{const{syncUserPacks:re,acquireFreePack:ye}=await import("./userPacksService-Bq754732.js");return{syncUserPacks:re,acquireFreePack:ye}},[]);let et=[];try{et=await it()}catch(re){X.warn("[PHRASE_FLOW][APP]  syncUserPacks fall:",re)}const we=Array.isArray(ze.ownedPackIds)?ze.ownedPackIds:[],_e=Array.from(new Set([...we||[],...et||[]])),me=Ue.filter(re=>re.grantsPremium).map(re=>re.productId),ge=new Set;if(Ue.forEach(re=>{(re==null?void 0:re.type)==="remove_ads"&&(re!=null&&re.productId)&&ge.add(re.productId),re!=null&&re.grantsRemoveAds&&(re!=null&&re.productId)&&ge.add(re.productId)}),ze.hasRemoveAds&&l(!1),Array.from(ge).some(re=>_e.includes(re))&&l(!1),me.some(re=>_e.includes(re))&&d(!0),_e.length>0){X.info("[PHRASE_FLOW][APP]  setOwnedPackIds (merged restore)",_e),m(_e);try{X.info("[PHRASE_FLOW][APP]  updatePhraseCache (post-restore) owned=",_e),await Ha(!1,_e),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (post-restore)")}catch(re){X.warn("[PHRASE_FLOW][APP]  updatePhraseCache fallo (post-restore)",re)}}else X.warn("[PHRASE_FLOW][APP]  restore sin packs (IAP+UserPacks)");if(we.length>0)try{await Promise.allSettled(we.map(re=>Rt(re)))}catch(re){X.warn("[PHRASE_FLOW][APP]  persistencia de packs restaurados fall:",re)}}else X.warn("[PHRASE_FLOW][APP]  restorePurchases null/undefined")}catch(oe){X.warn("No se pudieron restaurar compras al iniciar:",oe)}})()},[]),te.useEffect(()=>{(async()=>{try{const[oe,Ue,ve,Ae,Se]=await Promise.all([(await Yt(async()=>{const{getFeatureFlags:et}=await Promise.resolve().then(()=>Ki);return{getFeatureFlags:et}},void 0)).getFeatureFlags(),(await Yt(async()=>{const{getAppSettings:et}=await Promise.resolve().then(()=>Ki);return{getAppSettings:et}},void 0)).getAppSettings(),(await Yt(async()=>{const{getPlayStoreUrl:et}=await Promise.resolve().then(()=>Ki);return{getPlayStoreUrl:et}},void 0)).getPlayStoreUrl(),(await Yt(async()=>{const{getWelcomeMessage:et}=await Promise.resolve().then(()=>Ki);return{getWelcomeMessage:et}},void 0)).getWelcomeMessage(),(await Yt(async()=>{const{getPopupConfig:et}=await Promise.resolve().then(()=>Ki);return{getPopupConfig:et}},void 0)).getPopupConfig()]);U(oe),$(ve||"https://play.google.com/store"),D(Ae),Se.enabled&&Se.title&&Se.message&&(B({title:Se.title,message:Se.message,buttonText:Se.buttonText,showPlayStoreButton:Se.showPlayStoreButton,playStoreButtonText:Se.playStoreButtonText,playStoreUrl:Se.playStoreUrl}),sessionStorage.getItem("popup_shown")||(N(!0),sessionStorage.setItem("popup_shown","true")));const ze=(Ne==null?void 0:Ne.getPlatform)&&Ne.getPlatform()||"web",it=ze==="android",Rt=ze==="ios";if(it&&Ue.required_update_version){const et=Ue.required_update_version;Ke(xp,et)&&L(!0)}if(Rt&&Ue.required_update_version){const et=Ue.required_update_version;Ke(xp,et)&&L(!0)}}catch(oe){X.error("Error cargando configuracin remota:",oe)}})()},[]);const nt=Te=>{try{const oe=new URL(Te);if((oe.protocol||"").replace(":","")!=="yonunca")return null;const ve=oe.searchParams.get("code")||oe.searchParams.get("promo")||void 0,Ae=oe.searchParams.get("redeem")!=="0";let Se=oe.searchParams.get("pack")||oe.searchParams.get("packId")||oe.searchParams.get("product")||void 0;const ze=(oe.host||"").trim(),it=new Set(["promo","store","event","pack","redeem"]);if(!Se){const Rt=(oe.pathname||"").split("/").filter(Boolean);Rt.length>0&&(Se=Rt[Rt.length-1])}return!Se&&ze&&!it.has(ze)&&(Se=ze),!Se&&(ze==="promo"||ze==="event")&&(Se="starter_pack"),Se?{packId:Se,promoCode:ve,openRedeem:Ae}:null}catch{return null}},We=te.useCallback(Te=>{if(C)return;const oe=nt(Te);oe&&(k({nonce:String(Date.now()),packId:oe.packId,promoCode:oe.promoCode,openRedeem:oe.openRedeem}),e(yt.Store),nw("Store"))},[C]);te.useEffect(()=>{if(!Ne.isNativePlatform())return;const Te=el.addListener("appUrlOpen",oe=>{oe!=null&&oe.url&&We(oe.url)});return el.getLaunchUrl().then(oe=>{const Ue=oe==null?void 0:oe.url;Ue&&We(Ue)}).catch(()=>{}),()=>{Te.then(oe=>oe.remove()).catch(()=>{})}},[We]),te.useEffect(()=>{n===yt.Home&&wr.hideBanner().catch(()=>{})},[n]);const Ke=(Te,oe)=>{const Ue=Se=>Se.trim().split(".").map(ze=>parseInt(ze.replace(/\D/g,""),10)||0),ve=Ue(Te),Ae=Ue(oe);for(let Se=0;Se<Math.max(ve.length,Ae.length);Se++){const ze=ve[Se]??0,it=Ae[Se]??0;if(ze<it)return!0;if(ze>it)return!1}return!1},Ze=te.useCallback(Te=>{if(C)return;e(Te);const oe={[yt.Home]:"Home",[yt.Game]:"Game",[yt.Store]:"Store"};nw(oe[Te]||"Unknown"),Te===yt.Game&&Ne.isNativePlatform()&&xc.trackSession().catch(Ue=>{X.warn("[App]  Error trackeando sesin al entrar a Game:",Ue)})},[C]),Vt=async()=>{l(!1);try{await wr.removeBanner(),console.log("Banner eliminado exitosamente")}catch(Te){console.warn("No se pudo eliminar el banner:",Te)}alert("Gracias! Los anuncios han sido eliminados."),e(yt.Home)},Wt=()=>{try{sessionStorage.removeItem("return_to_endgame"),sessionStorage.removeItem("return_to_completion")}catch{}d(!0),alert("Gracias! Has comprado el paquete de frases premium."),e(yt.Home)},Rn=async Te=>{X.info("[PHRASE_FLOW][APP] "),X.info("[PHRASE_FLOW][APP]  handlePurchasePack INICIO"),X.info("[PHRASE_FLOW][APP]  packId recibido:",Te),X.info("[PHRASE_FLOW][APP]  ownedPackIds ANTES:",h),X.info("[PHRASE_FLOW][APP] ");try{X.info("[PHRASE_FLOW][APP]  PASO 1: Actualizando ownedPackIds local (aadiendo pack)");const oe=[...h,Te];X.info("[PHRASE_FLOW][APP]  updatedPacks calculado:",oe),m(oe),X.info("[PHRASE_FLOW][APP]  setOwnedPackIds ejecutado con:",oe),X.info("[PHRASE_FLOW][APP]  PASO 3: Actualizando cach con nuevos packs..."),await Ha(!0,oe),X.info("[PHRASE_FLOW][APP]  Cach actualizado con nuevos packs"),X.info("[PHRASE_FLOW][APP] "),X.info("[PHRASE_FLOW][APP]  handlePurchasePack COMPLETADO EXITOSAMENTE "),X.info("[PHRASE_FLOW][APP]  ownedPackIds final:",oe),X.info("[PHRASE_FLOW][APP] ")}catch(oe){X.error("[PHRASE_FLOW][APP] "),X.error("[PHRASE_FLOW][APP]  ERROR en handlePurchasePack "),X.error("[PHRASE_FLOW][APP] Error:",oe),X.error("[PHRASE_FLOW][APP] Stack:",oe==null?void 0:oe.stack),X.error("[PHRASE_FLOW][APP] "),X.info("[PHRASE_FLOW][APP]  FALLBACK: actualizando estado local solo"),m(Ue=>{if(X.info("[PHRASE_FLOW][APP]  prev:",Ue),X.info("[PHRASE_FLOW][APP]  packId a agregar:",Te),!Ue.includes(Te)){const ve=[...Ue,Te];return X.info("[PHRASE_FLOW][APP]  updated (fallback):",ve),Ha(!0,ve).catch(Ae=>X.error("[PHRASE_FLOW][APP]  Error actualizando cach en fallback:",Ae)),ve}return X.info("[PHRASE_FLOW][APP]  Pack ya estaba en lista, sin cambios"),Ue})}};te.useEffect(()=>{try{if(((Ne==null?void 0:Ne.getPlatform)&&Ne.getPlatform()||"web")!=="android")return;const oe=async()=>{if(Ve.current){N(!1);return}if(tt.current){r(!1);return}const Ue=ee.current;try{if(Ue===yt.Store&&(sessionStorage.getItem("return_to_endgame")==="1"||sessionStorage.getItem("return_to_completion")==="1")){e(yt.Game);return}}catch{}if(Ue!==yt.Home){e(yt.Home);return}try{await el.minimizeApp()}catch{}};return el.addListener("backButton",oe),()=>{}}catch(Te){X.warn("[App] No se pudo registrar handler de botn atrs:",Te)}},[]);const yn=()=>{if(C)return S.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[S.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Actualizacin requerida"}),S.jsxs("p",{className:"text-slate-300 mb-2",children:["Tu versin (",xp,") es inferior a la mnima requerida."]}),S.jsx("p",{className:"text-slate-400 mb-6",children:"Actualiza desde Google Play para continuar."}),S.jsx("a",{href:z,className:"bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded",children:"Abrir Google Play"})]});switch(n){case yt.Game:return S.jsx("div",{style:{position:"relative",width:"100%",height:"100%"},children:S.jsx(pM,{navigate:Ze,hasPremium:c,hasRemoveAds:!a,includeAdult:v,adultOnly:I,ownedPackIds:h,storeProducts:g})});case yt.Store:return S.jsx(AM,{navigate:Ze,onPurchaseRemoveAds:Vt,onPurchasePremium:Wt,onPurchasePack:Rn,showAds:a,hasPremium:c,enableRemoveAdsPurchase:(x==null?void 0:x.enable_remove_ads_purchase)!==!1,enablePremiumPurchase:(x==null?void 0:x.enable_premium_purchase)!==!1,ownedPackIds:h,deepLinkAction:G||void 0});case yt.Home:default:return S.jsx(sM,{navigate:Ze,onSuggestClick:()=>r(!0),onStartGame:(Te,oe)=>{T(Te),A(oe)},disablePlay:(x==null?void 0:x.enable_play)===!1,disableStore:(x==null?void 0:x.enable_store)===!1,disableShare:(x==null?void 0:x.enable_share_button)===!1,disableAdultMode:(x==null?void 0:x.enable_adult_mode)===!1,welcomeMessage:se,hasPremium:c,hasRemoveAds:!a,ownedPackIds:h,playStoreUrl:z,appStoreUrl:"https://tiendaapple.com"})}};return S.jsxs("div",{className:"w-full min-h-screen relative",children:[yn(),ue&&S.jsx("div",{style:{position:"fixed",top:"40px",left:"10px",zIndex:9999,opacity:.8},children:S.jsxs("button",{onClick:()=>{Ie(!he),Pe()},style:{fontSize:"10px",padding:"5px",background:"red",color:"white",border:"none",borderRadius:"4px"},children:["DEBUG ",j]})}),ue&&he&&S.jsxs("div",{style:{position:"fixed",top:"80px",left:"10px",right:"10px",bottom:"10px",background:"rgba(0,0,0,0.9)",color:"#0f0",padding:"10px",zIndex:9999,overflowY:"auto",fontFamily:"monospace",fontSize:"12px",border:"1px solid #0f0"},children:[S.jsx("h3",{children:"Diagnstico Firebase"}),S.jsx("button",{onClick:()=>Ie(!1),style:{float:"right",color:"white"},children:"Cerrar"}),S.jsx("button",{onClick:Pe,style:{marginRight:"10px",color:"black",background:"#0f0"},children:"Re-Test"}),S.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},style:{marginRight:"10px",color:"white",background:"red"},children:"Reset App"}),S.jsx("hr",{}),S.jsx("div",{children:"Estado Auth:  No logueado"}),S.jsxs("div",{children:["Plataforma: ",Ne.getPlatform()]}),S.jsx("hr",{}),Le.map((Te,oe)=>S.jsx("div",{children:Te},oe))]}),t&&S.jsx(RM,{onClose:()=>r(!1)}),P&&S.jsx(IM,{title:M.title,message:M.message,buttonText:M.buttonText,showPlayStoreButton:M.showPlayStoreButton,playStoreButtonText:M.playStoreButtonText,playStoreUrl:M.playStoreUrl,onClose:()=>N(!1)}),a&&n!==yt.Home&&S.jsx(PM,{})]})},UM=async()=>{if(Ne.isNativePlatform())try{if(await Di.initialize({initializeForTesting:!0}),console.log("AdMob iniciado correctamente"),Ne.getPlatform()==="ios"){await Di.requestTrackingAuthorization();const n=await Di.trackingAuthorizationStatus();console.log("Tracking authorization status:",n)}}catch(n){console.error("Error inicializando AdMob:",n)}};UM().then(()=>{BI.createRoot(document.getElementById("root")).render(S.jsx(Sw.StrictMode,{children:S.jsx(LM,{})}))}).catch(n=>console.error("Error al iniciar la app:",n));export{qS as A,Ne as C,Ft as F,Dt as T,_y as W,Ut as a,st as b,Iy as c,At as d,m2 as e,p2 as f,vn as g,da as h,X as l,er as r,Xc as s,Tc as u};
