var OI=Object.defineProperty;var xI=(n,e,t)=>e in n?OI(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ke=(n,e,t)=>xI(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var we=function(n,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(g){try{m(r.next(g))}catch(_){c(_)}}function h(g){try{m(r.throw(g))}catch(_){c(_)}}function m(g){g.done?l(g.value):a(g.value).then(d,h)}m((r=r.apply(n,e||[])).next())})},H;(function(n){(function(r){r[r.SETUP=6777001]="SETUP",r[r.LOAD=6777002]="LOAD",r[r.PURCHASE=6777003]="PURCHASE",r[r.LOAD_RECEIPTS=6777004]="LOAD_RECEIPTS",r[r.CLIENT_INVALID=6777005]="CLIENT_INVALID",r[r.PAYMENT_CANCELLED=6777006]="PAYMENT_CANCELLED",r[r.PAYMENT_INVALID=6777007]="PAYMENT_INVALID",r[r.PAYMENT_NOT_ALLOWED=6777008]="PAYMENT_NOT_ALLOWED",r[r.UNKNOWN=6777010]="UNKNOWN",r[r.REFRESH_RECEIPTS=6777011]="REFRESH_RECEIPTS",r[r.INVALID_PRODUCT_ID=6777012]="INVALID_PRODUCT_ID",r[r.FINISH=6777013]="FINISH",r[r.COMMUNICATION=6777014]="COMMUNICATION",r[r.SUBSCRIPTIONS_NOT_AVAILABLE=6777015]="SUBSCRIPTIONS_NOT_AVAILABLE",r[r.MISSING_TOKEN=6777016]="MISSING_TOKEN",r[r.VERIFICATION_FAILED=6777017]="VERIFICATION_FAILED",r[r.BAD_RESPONSE=6777018]="BAD_RESPONSE",r[r.REFRESH=6777019]="REFRESH",r[r.PAYMENT_EXPIRED=6777020]="PAYMENT_EXPIRED",r[r.DOWNLOAD=6777021]="DOWNLOAD",r[r.SUBSCRIPTION_UPDATE_NOT_AVAILABLE=6777022]="SUBSCRIPTION_UPDATE_NOT_AVAILABLE",r[r.PRODUCT_NOT_AVAILABLE=6777023]="PRODUCT_NOT_AVAILABLE",r[r.CLOUD_SERVICE_PERMISSION_DENIED=6777024]="CLOUD_SERVICE_PERMISSION_DENIED",r[r.CLOUD_SERVICE_NETWORK_CONNECTION_FAILED=6777025]="CLOUD_SERVICE_NETWORK_CONNECTION_FAILED",r[r.CLOUD_SERVICE_REVOKED=6777026]="CLOUD_SERVICE_REVOKED",r[r.PRIVACY_ACKNOWLEDGEMENT_REQUIRED=6777027]="PRIVACY_ACKNOWLEDGEMENT_REQUIRED",r[r.UNAUTHORIZED_REQUEST_DATA=6777028]="UNAUTHORIZED_REQUEST_DATA",r[r.INVALID_OFFER_IDENTIFIER=6777029]="INVALID_OFFER_IDENTIFIER",r[r.INVALID_OFFER_PRICE=6777030]="INVALID_OFFER_PRICE",r[r.INVALID_SIGNATURE=6777031]="INVALID_SIGNATURE",r[r.MISSING_OFFER_PARAMS=6777032]="MISSING_OFFER_PARAMS",r[r.VALIDATOR_SUBSCRIPTION_EXPIRED=6778003]="VALIDATOR_SUBSCRIPTION_EXPIRED"})(n.ErrorCode||(n.ErrorCode={}));function t(r,a,l,c){return{isError:!0,code:r,message:a,platform:l,productId:c}}n.storeError=t})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.config=r,r.url||(r.url="https://validator.iaptic.com"),this.store=a??n.store,this.log=this.store.log.child("Iaptic")}get braintreeClientTokenProvider(){return r=>{this.log.info("Calling Braintree clientTokenProvider"),n.Utils.ajax(this.log,{url:`${this.config.url}/v3/braintree/client-token?appName=${this.config.appName}&apiKey=${this.config.apiKey}`,method:"POST",data:{applicationUsername:n.store.getApplicationUsername(),customerId:n.Braintree.customerId},success:a=>{this.log.info("clientTokenProvider success: "+JSON.stringify(a)),r(a.clientToken)},error:a=>{this.log.info("clientTokenProvider error: "+JSON.stringify(a)),r(n.storeError(a,"ERROR "+a,n.Platform.BRAINTREE,null))}})}}get appStoreDiscountEligibilityDeterminer(){let r;this.log.debug("AppStore eligibility determiner is listening..."),this.store.when().verified(c=>{c.platform===n.Platform.APPLE_APPSTORE&&(this.log.debug("Got a verified AppStore receipt."),r=c)},"appStoreDiscountEligibilityDeterminer_listening");const a=(c,d,h)=>{if(this.log.debug("AppStore eligibility determiner"),r)return this.log.debug("Using cached receipt"),h(l(r,d));const m=g=>{g.platform===n.Platform.APPLE_APPSTORE&&(this.log.debug("Receipt is verified, let's analyze the content and respond."),this.store.off(m),h(l(g,d)))};this.log.debug("Waiting for receipt"),this.store.when().verified(m,"appStoreDiscountEligibilityDeterminer_waiting")};return a.cacheReceipt=function(c){r=c},a;function l(c,d){const h=c.raw.ineligible_for_intro_price;return d.map(m=>{var g;return m.discountType==="Introductory"&&h&&h.find(_=>m.productId===_)?!1:m.discountType==="Subscription"?!!((g=c.raw.collection)===null||g===void 0?void 0:g.find(v=>v.id===m.productId)):!0})}}get validator(){return`${this.config.url}/v1/validate?appName=${this.config.appName}&apiKey=${this.config.apiKey}`}}n.Iaptic=e})(H||(H={}));var H;(function(n){let e;(function(c){c[c.QUIET=0]="QUIET",c[c.ERROR=1]="ERROR",c[c.WARNING=2]="WARNING",c[c.INFO=3]="INFO",c[c.DEBUG=4]="DEBUG"})(e=n.LogLevel||(n.LogLevel={}));class t{constructor(d,h=""){this.prefix="",this.store=d,this.prefix=h||"CdvPurchase"}child(d){return new t(this.store,this.prefix+"."+d)}error(d){l(this.store.verbosity,e.ERROR,this.prefix,d);try{throw new Error(a(d))}catch(h){l(this.store.verbosity,e.ERROR,this.prefix,h.stack)}}warn(d){l(this.store.verbosity,e.WARNING,this.prefix,d)}info(d){l(this.store.verbosity,e.INFO,this.prefix,d)}debug(d){l(this.store.verbosity,e.DEBUG,this.prefix,d)}logCallbackException(d,h){if(this.warn("A callback in '"+d+"' failed with an exception."),typeof h=="string")this.warn("           "+h);else if(h){const m=h;m.fileName&&this.warn("           "+m.fileName+":"+m.lineNumber),h.message&&this.warn("           "+h.message),h.stack&&this.warn("           "+h.stack)}}}t.console=window.console,n.Logger=t;const r=["QUIET","ERROR","WARNING","INFO","DEBUG"];function a(c){return typeof c!="string"&&(c=JSON.stringify(c)),c}function l(c,d,h,m){var g=c===!0?1:c;if(d>g)return;typeof m!="string"&&(m=JSON.stringify(m));const _=h?`[${h}] `:"",v=d===e.ERROR?(T=>t.console.error(T)):d===e.WARNING?(T=>t.console.warn(T)):(T=>t.console.log(T));r[d]?v(`${_}${r[d]}: ${m}`):v(`${_}${m}`)}})(H||(H={}));var H;(function(n){(function(e){e.nonEnumerable=(t,r,a)=>{if(a)return a.enumerable=!1,a;Object.defineProperty(t,r,{set(l){Object.defineProperty(this,r,{value:l,writable:!0,configurable:!0})},configurable:!0})}})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.className="Product",this.title="",this.description="",this.platform=r.platform,this.type=r.type,this.id=r.id,this.group=r.group,this.offers=[],Object.defineProperty(this,"pricing",{enumerable:!1,get:()=>{var l;return(l=this.offers[0])===null||l===void 0?void 0:l.pricingPhases[0]}}),Object.defineProperty(this,"canPurchase",{enumerable:!1,get:()=>a.canPurchase(this)}),Object.defineProperty(this,"owned",{enumerable:!1,get:()=>a.owned(this)})}get pricing(){var r;return(r=this.offers[0])===null||r===void 0?void 0:r.pricingPhases[0]}get canPurchase(){return!1}get owned(){return!1}getOffer(r=""){return r?this.offers.find(a=>a.id===r):this.offers[0]}addOffer(r){return this.getOffer(r.id)?this:(this.offers.push(r),this)}}n.Product=e})(H||(H={}));var H;(function(n){(function(e){function t(r){const a=[];for(let l in r)r.hasOwnProperty(l)&&a.push(r[l]);return a}e.objectValues=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(r){switch(r){case n.Platform.APPLE_APPSTORE:return"App Store";case n.Platform.GOOGLE_PLAY:return"Google Play";case n.Platform.WINDOWS_STORE:return"Windows Store";case n.Platform.BRAINTREE:return"Braintree";case n.Platform.TEST:return"Test";default:return r}}e.platformName=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.array=[]}get length(){return this.array.length}get(){return this.array.concat()}add(c){this.has(c)||this.array.push(c)}clear(){for(;this.array.length!==0;)this.array.pop()}has(c){return!!this.array.find(d=>d===c)}}e.ReceiptsToValidate=t;class r{constructor(c,d){this.receiptsToValidate=new t,this.verifiedReceipts=[],this.numRequests=0,this.numResponses=0,this.cache={},this.controller=c,this.log=d.child("Validator")}incrRequestsCounter(){this.numRequests=this.numRequests+1|0,this.log.debug(`Validation requests=${this.numRequests} responses=${this.numResponses}`)}incrResponsesCounter(){this.numResponses=this.numResponses+1|0,this.log.debug(`Validation requests=${this.numRequests} responses=${this.numResponses}`)}addVerifiedReceipt(c,d){for(const m of this.verifiedReceipts)if(m.platform===c.platform&&m.id===d.id)return this.log.debug("Updating existing receipt."),m.set(c,d),m;this.log.debug("Register a new verified receipt.");const h=new n.VerifiedReceipt(c,d,this.controller);return this.verifiedReceipts.push(h),h}add(c){this.log.debug("Schedule validation: "+JSON.stringify(c));const d=c instanceof n.Transaction?c.parentReceipt:c;this.receiptsToValidate.has(d)||(this.incrRequestsCounter(),this.receiptsToValidate.add(d))}run(){const c=this.receiptsToValidate.get();this.receiptsToValidate.clear();const d=h=>we(this,void 0,void 0,function*(){var m;const{receipt:g,payload:_}=h;this.incrResponsesCounter();try{const v=this.controller.adapters.find(g.platform);if(yield v==null?void 0:v.handleReceiptValidationResponse(g,_),_.ok){const T=this.addVerifiedReceipt(g,_.data);this.controller.verifiedCallbacks.trigger(T,"payload_ok")}else if(_.code===n.ErrorCode.VALIDATOR_SUBSCRIPTION_EXPIRED){const T=(m=g.lastTransaction())===null||m===void 0?void 0:m.transactionId,I=T?this.verifiedReceipts.find(A=>{var C;return((C=A.collection[0])===null||C===void 0?void 0:C.transactionId)===T}):void 0;I?(I==null||I.collection.forEach(A=>{A.transactionId===T&&(A.isExpired=!0)}),this.controller.verifiedCallbacks.trigger(I,"payload_expired")):this.controller.unverifiedCallbacks.trigger({receipt:g,payload:_},"no_verified_receipt")}else this.controller.unverifiedCallbacks.trigger({receipt:g,payload:_},"validator_error")}catch(v){this.log.error("Exception probably caused by an invalid response from the validator."+v.message),this.controller.unverifiedCallbacks.trigger({receipt:g,payload:{ok:!1,code:n.ErrorCode.VERIFICATION_FAILED,message:v.message}},"validator_exception")}});c.forEach(h=>this.runOnReceipt(h,d))}runOnReceipt(c,d){var h,m;return we(this,void 0,void 0,function*(){if(c.platform===n.Platform.TEST)return this.log.debug("Using Test Adapter mock verify function."),n.Test.Adapter.verify(c,d);if(!this.controller.validator){this.incrResponsesCounter(),d({receipt:c,payload:{ok:!0,data:{id:((m=(h=c.transactions)===null||h===void 0?void 0:h[0])===null||m===void 0?void 0:m.transactionId)||"unknown",latest_receipt:!0,transaction:{type:"test"}}}});return}const g=yield this.buildRequestBody(c);if(!g){this.incrResponsesCounter();return}if(typeof this.controller.validator=="function")return this.runValidatorFunction(this.controller.validator,c,g,d);const _=typeof this.controller.validator=="string"?{url:this.controller.validator,timeout:2e4}:this.controller.validator;return this.runValidatorRequest(_,c,g,d)})}runValidatorFunction(c,d,h,m){try{c(h,g=>m({receipt:d,payload:g}))}catch(g){this.log.warn("user provided validator function failed with error: "+(g==null?void 0:g.stack))}}buildRequestBody(c){var d,h,m;return we(this,void 0,void 0,function*(){const g=this.controller.adapters.find(c.platform),_=yield g==null?void 0:g.receiptValidationBody(c);if(_){if(_.additionalData=Object.assign(Object.assign({},(d=_.additionalData)!==null&&d!==void 0?d:{}),{applicationUsername:this.controller.getApplicationUsername()}),_.additionalData.applicationUsername||delete _.additionalData.applicationUsername,_.device=Object.assign(Object.assign({},(h=_.device)!==null&&h!==void 0?h:{}),n.Validator.Internal.getDeviceInfo(this.controller)),((m=_.offers)===null||m===void 0?void 0:m.length)===1){const v=_.offers[0];if(v.pricingPhases.length===1){const T=v.pricingPhases[0];_.currency=T.currency,_.priceMicros=T.priceMicros}else if(v.pricingPhases.length===2){const T=v.pricingPhases[1];_.currency=T.currency,_.priceMicros=T.priceMicros;const I=v.pricingPhases[0];_.introPriceMicros=I.priceMicros}}return _}})}removeExpiredCache(){const c=+new Date,d=[];for(const h in this.cache)this.cache[h].expires<c&&d.push(h);for(const h of d)delete this.cache[h]}runValidatorRequest(c,d,h,m){this.removeExpiredCache();const g=n.Utils.md5(JSON.stringify(h.transaction)),_=this.cache[g];if(_)return this.log.debug("validator cache hit, using cached response"),m({receipt:d,payload:_.payload});n.Utils.ajax(this.log.child("Ajax"),{url:c.url,method:"POST",customHeaders:c.headers,timeout:c.timeout,data:h,success:v=>{var T;if(this.log.debug("validator success, response: "+JSON.stringify(v)),!a(v))return m({receipt:d,payload:{ok:!1,code:n.ErrorCode.BAD_RESPONSE,message:"Validator responded with invalid data",data:{latest_receipt:(T=v==null?void 0:v.data)===null||T===void 0?void 0:T.latest_receipt}}});this.cache[g]={payload:v,expires:+new Date+12e4},m({receipt:d,payload:v})},error:(v,T,I)=>{var A="Error "+v+": "+T;this.log.debug("validator failed, response: "+JSON.stringify(A)),this.log.debug("body => "+JSON.stringify(I)),m({receipt:d,payload:{ok:!1,message:A,code:n.ErrorCode.COMMUNICATION,status:v,data:{}}})}})}}e.Validator=r;function a(l){return!!l&&typeof l=="object"&&"ok"in l&&typeof l.ok=="boolean"}})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.list=[]}add(a,l,c){l.forEach(d=>{if(a.info(""),!this.find(d.platform))switch(d.platform){case n.Platform.APPLE_APPSTORE:return this.list.push(new n.AppleAppStore.Adapter(c,d.options||{}));case n.Platform.GOOGLE_PLAY:return this.list.push(new n.GooglePlay.Adapter(c));case n.Platform.BRAINTREE:return d.options||a.error("Options missing for Braintree initialization. Use {platform: Platform.BRAINTREE, options: {...}} in your call to store.initialize"),this.list.push(new n.Braintree.Adapter(c,d.options));case n.Platform.TEST:return this.list.push(new n.Test.Adapter(c));default:return}})}initialize(a,l){return we(this,void 0,void 0,function*(){typeof a=="string"&&(a=[a]);const c=a.map(g=>typeof g=="string"?{platform:g}:g).filter(g=>!this.find(g.platform)),d=l.log.child("Adapters");d.info("Adding platforms: "+JSON.stringify(c)),this.add(d,c,l);const h=l.registeredProducts.byPlatform();return(yield Promise.all(c.map(g=>we(this,void 0,void 0,function*(){var _,v,T;const I=(T=(v=(_=h.filter(z=>z.platform===g.platform))===null||_===void 0?void 0:_[0])===null||v===void 0?void 0:v.products)!==null&&T!==void 0?T:[],A=this.find(g.platform);if(!A)return;if(d.info(`${A.name} initializing...`),!A.isSupported){d.info(`${A.name} is not supported.`);return}const C=yield A.initialize();if(A.ready=!0,d.info(`${A.name} initialized. ${C?JSON.stringify(C):""}`),C!=null&&C.code)return C;if(d.info(`${A.name} products: ${JSON.stringify(I)}`),I.length===0)return;let L=[],x=[];A.supportsParallelLoading?[L,x]=yield Promise.all([A.loadProducts(I),A.loadReceipts()]):(L=yield A.loadProducts(I),x=yield A.loadReceipts()),d.info(`${A.name} products loaded: ${JSON.stringify(L)}`);const U=L.filter(z=>z instanceof n.Product);return l.listener.productsUpdated(g.platform,U),d.info(`${A.name} receipts loaded: ${JSON.stringify(x)}`),L.filter(z=>"code"in z&&"message"in z)[0]})))).filter(g=>g)})}find(a){return this.list.filter(l=>l.id===a)[0]}findReady(a){return this.list.filter(l=>(!a||l.id===a)&&l.ready)[0]}}e.Adapters=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a,l){this.supportedPlatforms=[],this.platformWithReceiptsReady=[],this.lastTransactionState={},this.lastCallTimeForState={},this.updatedReceiptsToProcess=[],this.delegate=a,this.log=l.child("AdapterListener")}static makeTransactionToken(a){return a.platform+"|"+a.transactionId}setSupportedPlatforms(a){this.log.debug(`setSupportedPlatforms: ${a.join(",")} (${this.platformWithReceiptsReady.length} have their receipts ready)`),this.supportedPlatforms=a,this.supportedPlatforms.length===this.platformWithReceiptsReady.length&&(this.log.debug("triggering receiptsReady()"),this.delegate.receiptsReadyCallbacks.trigger(void 0,"adapterListener_setSupportedPlatforms"))}receiptsReady(a){if(this.supportedPlatforms.length>0&&this.platformWithReceiptsReady.length===this.supportedPlatforms.length){this.log.debug("receiptsReady: "+a+"(skipping)");return}this.platformWithReceiptsReady.indexOf(a)<0&&(this.platformWithReceiptsReady.push(a),this.log.debug(`receiptsReady: ${a} (${this.platformWithReceiptsReady.length}/${this.supportedPlatforms.length})`),this.platformWithReceiptsReady.length===this.supportedPlatforms.length&&(this.log.debug("triggering receiptsReady()"),this.delegate.receiptsReadyCallbacks.trigger(void 0,"adapterListener_receiptsReady")))}productsUpdated(a,l){l.forEach(c=>this.delegate.updatedCallbacks.trigger(c,"adapterListener_productsUpdated"))}receiptsUpdated(a,l){this.log.debug("receiptsUpdated: "+JSON.stringify(l.map(c=>({platform:c.platform,transactions:c.transactions}))));for(const c of l)this.updatedReceiptsToProcess.indexOf(c)<0&&this.updatedReceiptsToProcess.push(c);this.updatedReceiptsProcessor!==void 0&&clearTimeout(this.updatedReceiptsProcessor),this.updatedReceiptsProcessor=setTimeout(()=>{this._processUpdatedReceipts()},500)}_processUpdatedReceipts(){this.log.debug("processing "+this.updatedReceiptsToProcess.length+" updated receipts");const a=+new Date,l=this.updatedReceiptsToProcess;this.updatedReceiptsToProcess=[],l.forEach(c=>{this.delegate.updatedReceiptCallbacks.trigger(c,"adapterListener_receiptsUpdated"),c.transactions.forEach(d=>{var h;const m=t.makeTransactionToken(d),g=m+"@"+d.state,_=this.lastTransactionState[m];if(d.state===n.TransactionState.APPROVED){const v=(h=this.lastCallTimeForState[g])!==null&&h!==void 0?h:0;a-v>6e4?(this.lastCallTimeForState[g]=a,this.delegate.approvedCallbacks.trigger(d,"adapterListener_receiptsUpdated_approved")):this.log.debug(`Skipping ${g}, because it has been last called ${v>0?Math.round(a-v)+"ms ago ("+a+"-"+v+")":"never"}`)}else _!==d.state&&(d.state===n.TransactionState.INITIATED?(this.lastCallTimeForState[g]=a,this.delegate.initiatedCallbacks.trigger(d,"adapterListener_receiptsUpdated_initiated")):d.state===n.TransactionState.FINISHED?(this.lastCallTimeForState[g]=a,this.delegate.finishedCallbacks.trigger(d,"adapterListener_receiptsUpdated_finished")):d.state===n.TransactionState.PENDING&&(this.lastCallTimeForState[g]=a,this.delegate.pendingCallbacks.trigger(d,"adapterListener_receiptsUpdated_pending")));this.lastTransactionState[m]=d.state})})}}e.StoreAdapterListener=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a,l,c=!1){this.callbacks=[],this.numTriggers=0,this.logger=a,this.className=l,this.finalStateMode=c}push(a,l){if(this.finalStateMode&&this.numTriggers>0)a(this.lastTriggerArgument);else{for(const c of this.callbacks)if(c.callback===a)throw new Error("REGISTERING THE SAME CALLBACK TWICE? This is indicative of a bug in your integration.");this.callbacks.push({callback:a,callbackName:l})}}trigger(a,l){this.lastTriggerArgument=a,this.numTriggers++;const c=this.callbacks;this.finalStateMode&&(this.callbacks=[]),c.forEach(d=>{n.Utils.safeCall(this.logger,this.className,d.callback,a,d.callbackName,l)})}remove(a){this.callbacks=this.callbacks.filter(l=>l.callback!==a)}}e.Callbacks=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.isReady=!1,this.readyCallbacks=[],this.logger=a}add(a){if(this.isReady)return setTimeout(a,0);this.readyCallbacks.push(a)}trigger(a){this.isReady=!0,this.readyCallbacks.forEach(l=>n.Utils.safeCall(this.logger,"ready()",l,void 0,void 0,a)),this.readyCallbacks=[]}remove(a){this.readyCallbacks=this.readyCallbacks.filter(l=>l!==a)}}e.ReadyCallbacks=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){function t(a){return typeof a!="object"?!1:a.hasOwnProperty("platform")&&a.hasOwnProperty("id")&&a.hasOwnProperty("type")}class r{constructor(){this.list=[]}find(l,c){return this.list.find(d=>d.platform===l&&d.id===c)}add(l){const c=[],h=(Array.isArray(l)?l:[l]).filter(m=>!this.find(m.platform,m.id));for(const m of h)t(m)?this.list.push(m):c.push(n.storeError(n.ErrorCode.LOAD,'Invalid parameter to "register", expected "id", "type" and "platform". Got: '+JSON.stringify(m),null,null));return c}byPlatform(){const l={};return this.list.forEach(c=>{l[c.platform]=(l[c.platform]||[]).concat(c)}),Object.keys(l).map(c=>({platform:c,products:l[c]}))}}e.RegisteredProducts=r})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.monitors=[],this.isListening=!1,this.when=a}findMonitors(a){return this.monitors.filter(l=>l.transaction.platform===a.platform&&l.transaction.transactionId===a.transactionId)}startListening(){this.isListening||(this.isListening=!0,this.when.approved(a=>this.callOnChange(a),"transactionStateMonitors_callOnChange").finished(a=>this.callOnChange(a),"transactionStateMonitors_callOnChange"))}callOnChange(a){this.findMonitors(a).forEach(l=>{l.lastChange!==a.state&&(l.lastChange=a.state,l.onChange(a.state))})}start(a,l){this.startListening();const c=n.Utils.uuidv4();return this.monitors.push({monitorId:c,transaction:a,onChange:l,lastChange:a.state}),setTimeout(l,0,a.state),{transaction:a,stop:()=>this.stop(c)}}stop(a){this.monitors=this.monitors.filter(l=>l.monitorId!==a)}}e.TransactionStateMonitors=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.hasCalledReceiptsVerified=!1,this.controller=a,this.log=a.log.child("ReceiptsMonitor")}callReceiptsVerified(){this.hasCalledReceiptsVerified||(this.hasCalledReceiptsVerified=!0,this.log.info("receiptsVerified()"),this.controller.when().receiptsReady(()=>{setTimeout(()=>{this.controller.receiptsVerified()},0)},"receiptsMonitor_callReceiptsVerified"))}launch(){const a=()=>{this.log.debug(`check(${this.controller.numValidationResponses()}/${this.controller.numValidationRequests()})`),this.controller.numValidationRequests()===this.controller.numValidationResponses()&&(this.intervalChecker!==void 0&&(clearInterval(this.intervalChecker),this.intervalChecker=void 0),this.controller.off(a),this.callReceiptsVerified())};this.controller.when().verified(a,"receiptsMonitor_check").unverified(a,"receiptsMonitor_check").receiptsReady(()=>{this.log.debug("receiptsReady..."),(!this.controller.hasLocalReceipts()||!this.controller.hasValidator())&&setTimeout(()=>{a()},0),this.intervalChecker=setInterval(()=>{this.log.debug("keep checking every 10s..."),a()},1e4)},"receiptsMonitor_setup")}}e.ReceiptsMonitor=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a){this.activePurchases={},this.notifiedPurchases={},this.controller=a}launch(){this.interval=setInterval(()=>{var a,l;const c=+new Date;for(const d of this.controller.verifiedReceipts){const h=(a=t.GRACE_PERIOD_MS[d.platform])!==null&&a!==void 0?a:t.GRACE_PERIOD_MS.DEFAULT;for(const m of d.collection)if(m.expiryDate){const g=m.expiryDate+h,_=(l=m.transactionId)!==null&&l!==void 0?l:`${g}`;g>c&&(this.activePurchases[_]=!0),g<c&&this.activePurchases[_]&&!this.notifiedPurchases[_]&&(this.notifiedPurchases[_]=!0,this.controller.onVerifiedPurchaseExpired(m,d))}}},t.INTERVAL_MS)}}t.INTERVAL_MS=1e4,t.GRACE_PERIOD_MS={DEFAULT:6e4,"ios-appstore":6e4,"android-playstore":3e4},e.ExpiryMonitor=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){n.PLUGIN_VERSION="13.12.1";class e{constructor(){this.adapters=new n.Internal.Adapters,this.registeredProducts=new n.Internal.RegisteredProducts,this.log=new n.Logger(this),this.verbosity=n.LogLevel.ERROR,this._readyCallbacks=new n.Internal.ReadyCallbacks(this.log),this.updatedCallbacks=new n.Internal.Callbacks(this.log,"productUpdated()"),this.updatedReceiptsCallbacks=new n.Internal.Callbacks(this.log,"receiptUpdated()"),this.initiatedCallbacks=new n.Internal.Callbacks(this.log,"initiated()"),this.approvedCallbacks=new n.Internal.Callbacks(this.log,"approved()"),this.finishedCallbacks=new n.Internal.Callbacks(this.log,"finished()"),this.pendingCallbacks=new n.Internal.Callbacks(this.log,"pending()"),this.verifiedCallbacks=new n.Internal.Callbacks(this.log,"verified()"),this.unverifiedCallbacks=new n.Internal.Callbacks(this.log,"unverified()"),this.receiptsReadyCallbacks=new n.Internal.Callbacks(this.log,"receiptsReady()",!0),this.receiptsVerifiedCallbacks=new n.Internal.Callbacks(this.log,"receiptsVerified()",!0),this.errorCallbacks=new n.Internal.Callbacks(this.log,"error()"),this.initializedHasBeenCalled=!1,this.lastUpdate=0,this.minTimeBetweenUpdates=6e5,this.version=n.PLUGIN_VERSION;const r=this;this.listener=new n.Internal.StoreAdapterListener({updatedCallbacks:this.updatedCallbacks,updatedReceiptCallbacks:this.updatedReceiptsCallbacks,initiatedCallbacks:this.initiatedCallbacks,approvedCallbacks:this.approvedCallbacks,finishedCallbacks:this.finishedCallbacks,pendingCallbacks:this.pendingCallbacks,receiptsReadyCallbacks:this.receiptsReadyCallbacks},this.log),this.transactionStateMonitors=new n.Internal.TransactionStateMonitors(this.when()),this._validator=new n.Internal.Validator({adapters:this.adapters,getApplicationUsername:this.getApplicationUsername.bind(this),get localReceipts(){return r.localReceipts},get validator(){return r.validator},get validator_privacy_policy(){return r.validator_privacy_policy},verifiedCallbacks:this.verifiedCallbacks,unverifiedCallbacks:this.unverifiedCallbacks,finish:a=>this.finish(a)},this.log),new n.Internal.ReceiptsMonitor({hasLocalReceipts:()=>this.localReceipts.length>0,hasValidator:()=>!!this.validator,numValidationRequests:()=>this._validator.numRequests,numValidationResponses:()=>this._validator.numResponses,off:this.off.bind(this),when:this.when.bind(this),receiptsVerified:()=>{r.receiptsVerifiedCallbacks.trigger(void 0,"receipts_monitor_controller")},log:this.log}).launch(),this.expiryMonitor=new n.Internal.ExpiryMonitor({get verifiedReceipts(){return r.verifiedReceipts},onVerifiedPurchaseExpired(a,l){r.verify(l.sourceReceipt)}}),this.expiryMonitor.launch()}getAdapter(r){return this.adapters.find(r)}getApplicationUsername(){return this.applicationUsername instanceof Function?this.applicationUsername():this.applicationUsername}register(r){this.registeredProducts.add(r).forEach(l=>{n.store.errorCallbacks.trigger(l,"register_error"),this.log.error(l)})}initialize(r=[this.defaultPlatform()]){return we(this,void 0,void 0,function*(){if(this.initializedHasBeenCalled)return this.log.warn("store.initialized() has been called already."),[];this.log.info("initialize("+JSON.stringify(r)+") v"+n.PLUGIN_VERSION),this.initializedHasBeenCalled=!0,this.lastUpdate=+new Date;const a=this,l=this.adapters.initialize(r,{error:this.triggerError.bind(this),get verbosity(){return a.verbosity},getApplicationUsername(){return a.getApplicationUsername()},get listener(){return a.listener},get log(){return a.log},get registeredProducts(){return a.registeredProducts},apiDecorators:{canPurchase:this.canPurchase.bind(this),owned:this.owned.bind(this),finish:this.finish.bind(this),order:this.order.bind(this),verify:this.verify.bind(this)}});return l.then(()=>{this._readyCallbacks.trigger("initialize_promise_resolved"),this.listener.setSupportedPlatforms(this.adapters.list.filter(c=>c.isSupported).map(c=>c.id))}),l})}refresh(){throw new Error("use store.initialize() or store.update()")}update(){var r;return we(this,void 0,void 0,function*(){if(this.log.info("update()"),!this._readyCallbacks.isReady){this.log.warn("Do not call store.update() at startup! It is meant to reload the price of products (if needed) long after initialization.");return}const a=+new Date;if(this.lastUpdate>a-this.minTimeBetweenUpdates){this.log.info("Skipping store.update() as the last call occurred less than store.minTimeBetweenUpdates millis ago.");return}this.lastUpdate=a;for(const l of this.registeredProducts.byPlatform()){const c=yield(r=this.adapters.findReady(l.platform))===null||r===void 0?void 0:r.loadProducts(l.products);c==null||c.forEach(d=>{d instanceof n.Product&&this.updatedCallbacks.trigger(d,"update_has_loaded_products")})}})}ready(r){this._readyCallbacks.add(r)}get isReady(){return this._readyCallbacks.isReady}when(){const r={productUpdated:(a,l)=>(this.updatedCallbacks.push(a,l),r),receiptUpdated:(a,l)=>(this.updatedReceiptsCallbacks.push(a,l),r),updated:(a,l)=>(this.updatedCallbacks.push(a,l),this.updatedReceiptsCallbacks.push(a,l),r),approved:(a,l)=>(this.approvedCallbacks.push(a,l),r),initiated:(a,l)=>(this.initiatedCallbacks.push(a,l),r),pending:(a,l)=>(this.pendingCallbacks.push(a,l),r),finished:(a,l)=>(this.finishedCallbacks.push(a,l),r),verified:(a,l)=>(this.verifiedCallbacks.push(a,l),r),unverified:(a,l)=>(this.unverifiedCallbacks.push(a,l),r),receiptsReady:(a,l)=>(this.receiptsReadyCallbacks.push(a,l),r),receiptsVerified:(a,l)=>(this.receiptsVerifiedCallbacks.push(a,l),r)};return r}off(r){this.updatedCallbacks.remove(r),this.updatedReceiptsCallbacks.remove(r),this.approvedCallbacks.remove(r),this.finishedCallbacks.remove(r),this.pendingCallbacks.remove(r),this.verifiedCallbacks.remove(r),this.unverifiedCallbacks.remove(r),this.receiptsReadyCallbacks.remove(r),this.receiptsVerifiedCallbacks.remove(r),this.errorCallbacks.remove(r),this._readyCallbacks.remove(r)}monitor(r,a,l){return this.transactionStateMonitors.start(r,n.Utils.safeCallback(this.log,"monitor()",a,l,"transactionStateMonitors_stateChanged"))}get products(){return[].concat(...this.adapters.list.map(r=>r.products))}get(r,a){var l;return(l=this.adapters.findReady(a))===null||l===void 0?void 0:l.products.find(c=>c.id===r)}get localReceipts(){return[].concat(...this.adapters.list.map(r=>r.receipts))}get localTransactions(){const r=[];for(const a of this.localReceipts)r.push(...a.transactions);return r}get verifiedReceipts(){return this._validator.verifiedReceipts}get verifiedPurchases(){return n.Internal.VerifiedReceipts.getVerifiedPurchases(this.verifiedReceipts)}findInVerifiedReceipts(r){return n.Internal.VerifiedReceipts.find(this.verifiedReceipts,r)}findInLocalReceipts(r){return n.Internal.LocalReceipts.find(this.localReceipts,r)}canPurchase(r){const a=r instanceof n.Offer?this.get(r.productId,r.platform):r,l=this.adapters.findReady(r.platform);return l!=null&&l.checkSupport("order")?n.Internal.LocalReceipts.canPurchase(this.localReceipts,a):!1}owned(r){return n.Internal.owned({product:typeof r=="string"?{id:r}:r,verifiedReceipts:this.validator?this.verifiedReceipts:void 0,localReceipts:this.localReceipts})}order(r,a){return we(this,void 0,void 0,function*(){this.log.info(`order(${r.productId})`);const l=this.adapters.findReady(r.platform);if(!l)return n.storeError(n.ErrorCode.PAYMENT_NOT_ALLOWED,"Adapter not found or not ready ("+r.platform+")",r.platform,null);const c=yield l.order(r,a||{});return c&&"isError"in c&&n.store.triggerError(c),c})}requestPayment(r,a){var l,c,d,h,m;const g=this.adapters.findReady(r.platform);if(!g)return n.PaymentRequestPromise.failed(n.ErrorCode.PAYMENT_NOT_ALLOWED,"Adapter not found or not ready ("+r.platform+")",r.platform,null);if(!r.amountMicros){r.amountMicros=0;for(const v of r.items)r.amountMicros+=(c=(l=v==null?void 0:v.pricing)===null||l===void 0?void 0:l.priceMicros)!==null&&c!==void 0?c:0}if(r.currency)for(const v of r.items)if(!((h=v==null?void 0:v.pricing)===null||h===void 0)&&h.currency){if(r.currency!==v.pricing.currency)return n.PaymentRequestPromise.failed(n.ErrorCode.PAYMENT_INVALID,"Currencies do not match",r.platform,v.id)}else v!=null&&v.pricing&&(v.pricing.currency=r.currency);else for(const v of r.items)!((d=v==null?void 0:v.pricing)===null||d===void 0)&&d.currency&&(r.currency=v.pricing.currency);if(r.items.length===1){const v=r.items[0];v&&!v.pricing&&(v.pricing={priceMicros:(m=r.amountMicros)!==null&&m!==void 0?m:0,currency:r.currency})}const _=new n.PaymentRequestPromise;return g.requestPayment(r,a).then(v=>{if(_.trigger(v),v instanceof n.Transaction){const T=A=>{_.trigger(v),v.state===n.TransactionState.FINISHED&&I.stop()},I=this.monitor(v,T,"requestPayment_onStateChange")}}),_}checkSupport(r,a){const l=this.adapters.find(r);return l?l.checkSupport(a):!1}verify(r){return we(this,void 0,void 0,function*(){this.log.info(`verify(${r.className})`),this._validator.add(r),setTimeout(()=>this._validator.run(),200)})}finish(r){return we(this,void 0,void 0,function*(){this.log.info(`finish(${r.className})`),(r instanceof n.VerifiedReceipt?r.sourceReceipt.transactions:r instanceof n.Receipt?r.transactions:[r]).forEach(l=>{var c;(c=this.adapters.findReady(l.platform))===null||c===void 0||c.finish(l)})})}restorePurchases(){return we(this,void 0,void 0,function*(){let r;for(const a of this.adapters.list)a.ready&&(r=r??(yield a.restorePurchases()));return r})}manageSubscriptions(r){return we(this,void 0,void 0,function*(){this.log.info("manageSubscriptions()");const a=this.adapters.findReady(r);return a?a.manageSubscriptions():n.storeError(n.ErrorCode.SETUP,"Found no adapter ready to handle 'manageSubscription'",r??null,null)})}manageBilling(r){return we(this,void 0,void 0,function*(){this.log.info("manageBilling()");const a=this.adapters.findReady(r);return a?a.manageBilling():n.storeError(n.ErrorCode.SETUP,"Found no adapter ready to handle 'manageBilling'",r??null,null)})}defaultPlatform(){switch(n.Utils.platformId()){case"android":return n.Platform.GOOGLE_PLAY;case"ios":return n.Platform.APPLE_APPSTORE;default:return n.Platform.TEST}}error(r){this.errorCallbacks.push(r)}triggerError(r){this.errorCallbacks.trigger(r,"triggerError")}}n.Store=e})(H||(H={}));window.cordova?setTimeout(Xv,0):Xv();function Xv(){var n;console.log("Create CdvPurchase...");const e=(n=window.CdvPurchase)===null||n===void 0?void 0:n.store;window.CdvPurchase=H,e?window.CdvPurchase.store=e:window.CdvPurchase.store=new H.Store,Object.assign(window.CdvPurchase.store,H.LogLevel,H.ProductType,H.ErrorCode,H.Platform)}var H;(function(n){(function(e){e.CONSUMABLE="consumable",e.NON_CONSUMABLE="non consumable",e.FREE_SUBSCRIPTION="free subscription",e.PAID_SUBSCRIPTION="paid subscription",e.NON_RENEWING_SUBSCRIPTION="non renewing subscription",e.APPLICATION="application"})(n.ProductType||(n.ProductType={})),(function(e){e.NON_RECURRING="NON_RECURRING",e.FINITE_RECURRING="FINITE_RECURRING",e.INFINITE_RECURRING="INFINITE_RECURRING"})(n.RecurrenceMode||(n.RecurrenceMode={})),(function(e){e.PAY_AS_YOU_GO="PayAsYouGo",e.UP_FRONT="UpFront",e.FREE_TRIAL="FreeTrial"})(n.PaymentMode||(n.PaymentMode={})),(function(e){e.APPLE_APPSTORE="ios-appstore",e.GOOGLE_PLAY="android-playstore",e.WINDOWS_STORE="windows-store-transaction",e.BRAINTREE="braintree",e.TEST="test"})(n.Platform||(n.Platform={})),(function(e){e.INITIATED="initiated",e.PENDING="pending",e.APPROVED="approved",e.CANCELLED="cancelled",e.FINISHED="finished",e.UNKNOWN_STATE=""})(n.TransactionState||(n.TransactionState={})),(function(e){e.LAPSE="Lapse",e.RENEW="Renew"})(n.RenewalIntent||(n.RenewalIntent={})),(function(e){e.NOTIFIED="Notified",e.AGREED="Agreed"})(n.PriceConsentStatus||(n.PriceConsentStatus={})),(function(e){e.NOT_CANCELED="",e.DEVELOPER="Developer",e.SYSTEM="System",e.SYSTEM_REPLACED="System.Replaced",e.SYSTEM_PRODUCT_UNAVAILABLE="System.ProductUnavailable",e.SYSTEM_BILLING_ERROR="System.BillingError",e.SYSTEM_DELETED="System.Deleted",e.CUSTOMER="Customer",e.CUSTOMER_TECHNICAL_ISSUES="Customer.TechnicalIssues",e.CUSTOMER_PRICE_INCREASE="Customer.PriceIncrease",e.CUSTOMER_COST="Customer.Cost",e.CUSTOMER_FOUND_BETTER_APP="Customer.FoundBetterApp",e.CUSTOMER_NOT_USEFUL_ENOUGH="Customer.NotUsefulEnough",e.CUSTOMER_OTHER_REASON="Customer.OtherReason",e.UNKNOWN="Unknown"})(n.CancelationReason||(n.CancelationReason={}))})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.className="Offer",this.id=r.id,this.pricingPhases=r.pricingPhases,Object.defineProperty(this,"productId",{enumerable:!0,get:()=>r.product.id}),Object.defineProperty(this,"productType",{enumerable:!0,get:()=>r.product.type}),Object.defineProperty(this,"productGroup",{enumerable:!0,get:()=>r.product.group}),Object.defineProperty(this,"platform",{enumerable:!0,get:()=>r.product.platform}),Object.defineProperty(this,"order",{enumerable:!1,get:()=>l=>a.order(this,l)}),Object.defineProperty(this,"canPurchase",{enumerable:!1,get:()=>a.canPurchase(this)})}get productId(){return""}get productType(){return n.ProductType.APPLICATION}get productGroup(){}get platform(){return n.Platform.TEST}order(r){return we(this,void 0,void 0,function*(){})}get canPurchase(){return!1}}n.Offer=e})(H||(H={}));var H;(function(n){class e{constructor(){this.failedCallbacks=new n.Internal.PromiseLike,this.initiatedCallbacks=new n.Internal.PromiseLike,this.approvedCallbacks=new n.Internal.PromiseLike,this.finishedCallbacks=new n.Internal.PromiseLike,this.cancelledCallback=new n.Internal.PromiseLike}failed(r){return this.failedCallbacks.push(r),this}initiated(r){return this.initiatedCallbacks.push(r),this}approved(r){return this.approvedCallbacks.push(r),this}finished(r){return this.finishedCallbacks.push(r),this}cancelled(r){return this.cancelledCallback.push(r),this}trigger(r){if(!r)this.cancelledCallback.resolve();else if("isError"in r)this.failedCallbacks.resolve(r);else switch(r.state){case n.TransactionState.INITIATED:this.initiatedCallbacks.resolve(r);break;case n.TransactionState.APPROVED:this.approvedCallbacks.resolve(r);break;case n.TransactionState.FINISHED:this.finishedCallbacks.resolve(r);break}return this}static failed(r,a,l,c){return new e().trigger(n.storeError(r,a,l,c))}static cancelled(){return new e().trigger()}static initiated(r){return new e().trigger(r)}}n.PaymentRequestPromise=e})(H||(H={}));var H;(function(n){class e{constructor(r,a){this.className="Receipt",this.transactions=[],this.platform=r,Object.defineProperty(this,"verify",{enumerable:!1,get(){return()=>a.verify(this)}}),Object.defineProperty(this,"finish",{enumerable:!1,get(){return()=>a.finish(this)}})}verify(){return we(this,void 0,void 0,function*(){})}finish(){return we(this,void 0,void 0,function*(){})}hasTransaction(r){return!!this.transactions.find(a=>a===r)}lastTransaction(){return this.transactions[this.transactions.length-1]}}n.Receipt=e})(H||(H={}));var H;(function(n){class e{constructor(r,a,l){this.className="Transaction",this.transactionId="",this.state=n.TransactionState.UNKNOWN_STATE,this.products=[],this.platform=r,Object.defineProperty(this,"finish",{enumerable:!1,get(){return()=>l.finish(this)}}),Object.defineProperty(this,"verify",{enumerable:!1,get(){return()=>l.verify(this)}}),Object.defineProperty(this,"parentReceipt",{enumerable:!1,get(){return a}})}finish(){return we(this,void 0,void 0,function*(){})}verify(){return we(this,void 0,void 0,function*(){})}get parentReceipt(){return{}}}n.Transaction=e})(H||(H={}));var H;(function(n){(function(e){class t{static find(a,l){var c,d;if(!l)return;let h;for(const m of a)if(!(l.platform&&m.platform!==l.platform))for(const g of m.transactions)for(const _ of g.products)_.id===l.id&&(!h||((c=g.purchaseDate)!==null&&c!==void 0?c:0)<((d=h.purchaseDate)!==null&&d!==void 0?d:1))&&(h=g);return h}static isOwned(a,l){if(!l)return!1;const c=t.find(a,l);return!c||c.isConsumed||c.isPending?!1:c.expirationDate?c.expirationDate.getTime()>+new Date:!0}static canPurchase(a,l){if(!l)return!1;const c=t.find(a,l);return!c||c.isConsumed?!0:c.expirationDate?c.expirationDate.getTime()<=+new Date:!0}}e.LocalReceipts=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){function t(r){return r.verifiedReceipts!==void 0?e.VerifiedReceipts.isOwned(r.verifiedReceipts,r.product):r.localReceipts!==void 0?e.LocalReceipts.isOwned(r.localReceipts,r.product):!1}e.owned=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.resolved=!1,this.callbacks=[]}push(a){this.resolved?setTimeout(a,0,this.resolvedArgument):this.callbacks.push(a)}resolve(a){this.resolved||(this.resolved=!0,this.resolvedArgument=a,this.callbacks.forEach(l=>setTimeout(l,0,a)),this.callbacks=[])}}e.PromiseLike=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(a=5e3,l=12e4){this.maxTimeout=12e4,this.minTimeout=5e3,this.retryTimeout=5e3,this.retries=[],this.minTimeout=a,this.maxTimeout=l,this.retryTimeout=a,document.addEventListener("online",()=>{const c=this.retries;this.retries=[],this.retryTimeout=this.minTimeout;for(var d=0;d<c.length;++d)clearTimeout(c[d].tid),c[d].fn.call(this)},!1)}retry(a){var l=setTimeout(()=>{this.retries=this.retries.filter(function(c){return l!==c.tid}),a()},this.retryTimeout);this.retries.push({tid:l,fn:a}),this.retryTimeout*=2,this.retryTimeout>this.maxTimeout&&(this.retryTimeout=this.maxTimeout)}}e.Retry=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){class t{static find(a,l){var c,d;if(!l)return;let h;for(const m of a)if(!(l.platform&&m.platform!==l.platform))for(const g of m.collection)g.id===l.id&&((c=h==null?void 0:h.purchaseDate)!==null&&c!==void 0?c:0)<((d=g.purchaseDate)!==null&&d!==void 0?d:1)&&(h=g);return h}static isOwned(a,l){if(!l)return!1;const c=t.find(a,l);return!c||c!=null&&c.isExpired?!1:c!=null&&c.expiryDate?c.expiryDate>+new Date:!0}static getVerifiedPurchases(a){var l,c,d,h;const m={};for(const g of a)for(const _ of g.collection){const v=g.platform+":"+_.id,T=m[v];(!T||T&&((c=(l=T.lastRenewalDate)!==null&&l!==void 0?l:T.purchaseDate)!==null&&c!==void 0?c:0)<((h=(d=_.lastRenewalDate)!==null&&d!==void 0?d:_.purchaseDate)!==null&&h!==void 0?h:0))&&(m[v]=Object.assign(Object.assign({},_),{platform:g.platform}))}return Object.keys(m).map(g=>m[g])}}e.VerifiedReceipts=t})(n.Internal||(n.Internal={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){t.Name="name",t.EmailAddress="emailAddress",t.PhoneNumber="phoneNumber",t.PostalAddress="postalAddress",t.PhoneticName="phoneticName"})(e.ContactField||(e.ContactField={})),(function(t){t.Amex="Amex",t.Barcode="Barcode",t.CartesBancaires="CartesBancaires",t.ChinaUnionPay="ChinaUnionPay",t.Dankort="Dankort",t.Discover="Discover",t.Eftpos="Eftpos",t.Electron="Electron",t.Elo="Elo",t.Girocard="Girocard",t.IDCredit="IDCredit",t.Interac="Interac",t.JCB="JCB",t.Mada="Mada",t.Maestro="Maestro",t.MasterCard="MasterCard",t.Mir="Mir",t.Nanaco="Nanaco",t.PrivateLabel="PrivateLabel",t.QuicPay="QuicPay",t.Suica="Suica",t.Visa="Visa",t.VPay="VPay",t.Waon="Waon"})(e.PaymentNetwork||(e.PaymentNetwork={})),(function(t){t.ThreeDS="3DS",t.EMV="EMV",t.Credit="Credit",t.Debit="Debit"})(e.MerchantCapability||(e.MerchantCapability={}))})(n.ApplePay||(n.ApplePay={}))})(H||(H={}));var H;(function(n){(function(e){function t(l){return`virtual.${l}`}class r{constructor(c,d){var h,m;this.id=n.Platform.APPLE_APPSTORE,this.name="AppStore",this.ready=!1,this._canMakePayments=!1,this.forceReceiptReload=!1,this._products=[],this.validProducts={},this._paymentMonitor=()=>{},this.supportsParallelLoading=!0,this._appStoreReceiptLoading=!1,this._appStoreReceiptCallbacks=[],this.context=c,this.bridge=new e.Bridge.Bridge,this.log=c.log.child("AppleAppStore"),this.discountEligibilityDeterminer=d.discountEligibilityDeterminer,this.needAppReceipt=(h=d.needAppReceipt)!==null&&h!==void 0?h:!0,this.autoFinish=(m=d.autoFinish)!==null&&m!==void 0?m:!1,this.pseudoReceipt=new n.Receipt(n.Platform.APPLE_APPSTORE,this.context.apiDecorators),this.receiptsUpdated=n.Utils.createDebouncer(()=>{this._receiptsUpdated()},300)}get products(){return this._products}getProduct(c){return this._products.find(d=>d.id===c)}get receipts(){return this.isSupported?(this._receipt?[this._receipt]:[]).concat(this.pseudoReceipt?this.pseudoReceipt:[]):[]}addValidProducts(c,d){d.forEach(h=>{const m=c.find(g=>g.id===h.id);m&&(this.validProducts[h.id]=Object.assign(Object.assign({},h),m))})}get isSupported(){return n.Utils.platformId()==="ios"}upsertTransactionInProgress(c,d){const h=t(c);return new Promise(m=>{const g=this.pseudoReceipt.transactions.find(_=>_.transactionId===h);if(g)g.state=d,g.refresh(c),m(g);else{const _=new e.SKTransaction(n.Platform.APPLE_APPSTORE,this.pseudoReceipt,this.context.apiDecorators);_.state=d,_.transactionId=h,_.refresh(c),this.pseudoReceipt.transactions.push(_),m(_)}})}removeTransactionInProgress(c){const d=t(c);this.pseudoReceipt.transactions=this.pseudoReceipt.transactions.filter(h=>h.transactionId!==d)}upsertTransaction(c,d,h){return we(this,void 0,void 0,function*(){return new Promise(m=>{this.initializeAppReceipt(()=>{var g;if(!this._receipt){this.log.warn("Failed to load the application receipt, cannot proceed with handling the purchase");return}const _=(g=this._receipt)===null||g===void 0?void 0:g.transactions.find(v=>v.transactionId===d);if(_)_.state=h,_.refresh(c),m(_);else{const v=new e.SKTransaction(n.Platform.APPLE_APPSTORE,this._receipt,this.context.apiDecorators);v.state=h,v.transactionId=d,v.refresh(c),this._receipt.transactions.push(v),m(v)}})})})}removeTransaction(c){this._receipt&&(this._receipt.transactions=this._receipt.transactions.filter(d=>d.transactionId!==c))}_receiptsUpdated(){this._receipt?(this.log.debug("receipt updated and ready."),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this._receipt,this.pseudoReceipt]),this.context.listener.receiptsReady(n.Platform.APPLE_APPSTORE)):(this.log.debug("receipt updated."),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt]))}setPaymentMonitor(c){this._paymentMonitor=c}callPaymentMonitor(c,d,h){this._paymentMonitor(c)}initialize(){return new Promise(c=>{this.log.info("bridge.init");const d=this.log.child("Bridge");this.bridge.init({autoFinish:this.autoFinish,debug:this.context.verbosity===n.LogLevel.DEBUG,log:h=>d.debug(h),error:(h,m,g)=>{if(this.log.error("ERROR: "+h+" - "+m),h===n.ErrorCode.PAYMENT_CANCELLED){this.callPaymentMonitor("cancelled",n.ErrorCode.PAYMENT_CANCELLED,m);return}else this.context.error(a(h,m,(g==null?void 0:g.productId)||null))},ready:()=>{this.log.info("ready")},purchased:(h,m,g,_,v)=>we(this,void 0,void 0,function*(){this.log.info("purchase: id:"+h+" product:"+m+" originalTransaction:"+g+" - date:"+_+" - discount:"+v),(yield this.upsertTransaction(m,h,n.TransactionState.APPROVED)).refresh(m,g,_,v),this.removeTransactionInProgress(m),this.receiptsUpdated.call(),this.callPaymentMonitor("purchased")}),purchaseEnqueued:(h,m)=>we(this,void 0,void 0,function*(){this.log.info("purchaseEnqueued: "+h+" - "+m),yield this.upsertTransactionInProgress(h,n.TransactionState.INITIATED),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt])}),purchaseFailed:(h,m,g)=>{this.log.info("purchaseFailed: "+h+" - "+m+" - "+g),this.removeTransactionInProgress(h),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt]),this.callPaymentMonitor("failed",m,g)},purchasing:h=>we(this,void 0,void 0,function*(){this.log.info("purchasing: "+h),yield this.upsertTransactionInProgress(h,n.TransactionState.INITIATED),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt])}),deferred:h=>we(this,void 0,void 0,function*(){this.log.info("deferred: "+h),yield this.upsertTransactionInProgress(h,n.TransactionState.PENDING),this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[this.pseudoReceipt]),this.callPaymentMonitor("deferred")}),finished:(h,m)=>we(this,void 0,void 0,function*(){yield this.receiptsUpdated.wait(),this.log.info("finish: "+h+" - "+m),this.removeTransactionInProgress(m),yield this.upsertTransaction(m,h,n.TransactionState.FINISHED),this.receiptsUpdated.call()}),restored:(h,m)=>we(this,void 0,void 0,function*(){this.log.info("restore: "+h+" - "+m),yield this.upsertTransaction(m,h,n.TransactionState.APPROVED),this.receiptsUpdated.call()}),receiptsRefreshed:h=>{this.log.info("receiptsRefreshed"),this._receipt&&this._receipt.refresh(h,this.needAppReceipt,this.context.apiDecorators)},restoreFailed:h=>{this.log.info("restoreFailed: "+h),this.onRestoreCompleted&&(this.onRestoreCompleted(a(h,"Restore purchases failed",null)),this.onRestoreCompleted=void 0)},restoreCompleted:()=>{this.log.info("restoreCompleted"),this.onRestoreCompleted&&(this.onRestoreCompleted(void 0),this.onRestoreCompleted=void 0)}},()=>we(this,void 0,void 0,function*(){this.log.info("bridge.init done"),yield this.canMakePayments(),c(void 0)}),(h,m)=>{this.log.info("bridge.init failed: "+h+" - "+m),c(a(h,m,null))})})}loadReceipts(){return new Promise(c=>{setTimeout(()=>{this.initializeAppReceipt(()=>{this.receiptsUpdated.call(),this._receipt?c([this._receipt,this.pseudoReceipt]):c([this.pseudoReceipt])})},300)})}canMakePayments(){return we(this,void 0,void 0,function*(){return new Promise(c=>{this.bridge.canMakePayments(()=>{this._canMakePayments=!0,c(!0)},d=>{this.log.warn(`canMakePayments: ${d}`),this._canMakePayments=!1,c(!1)})})})}initializeAppReceipt(c){return we(this,void 0,void 0,function*(){if(this._receipt)return this.log.debug("initializeAppReceipt() => already initialized."),c(void 0);if(this._appStoreReceiptCallbacks.push(c),this._appStoreReceiptLoading){this.log.debug("initializeAppReceipt() => already loading.");return}this._appStoreReceiptLoading=!0;const d=yield this.loadAppStoreReceipt(),h=m=>{const g=this._appStoreReceiptCallbacks;this._appStoreReceiptCallbacks=[],g.forEach(_=>{_(m)})};if(!(d!=null&&d.appStoreReceipt)){this.log.warn("no appStoreReceipt"),this._appStoreReceiptLoading=!1,h(a(n.ErrorCode.REFRESH,"No appStoreReceipt",null));return}this._receipt=new e.SKApplicationReceipt(d,this.needAppReceipt,this.context.apiDecorators),h(void 0)})}prepareReceipt(c){c!=null&&c.appStoreReceipt&&(this._receipt?this._receipt.refresh(c,this.needAppReceipt,this.context.apiDecorators):this._receipt=new e.SKApplicationReceipt(c,this.needAppReceipt,this.context.apiDecorators))}loadAppStoreReceipt(){return we(this,void 0,void 0,function*(){let c=!1;return new Promise(d=>{var h;if(!((h=this.bridge.appStoreReceipt)===null||h===void 0)&&h.appStoreReceipt&&!this.forceReceiptReload)return this.log.debug("using cached appstore receipt"),d(this.bridge.appStoreReceipt);this.log.debug("loading appstore receipt..."),this.forceReceiptReload=!1,this.bridge.loadReceipts(m=>{this.log.debug("appstore receipt loaded"),c||d(m),c=!0},(m,g)=>{this.log.warn("Failed to load appStoreReceipt: "+m+" - "+g),c||d(void 0),c=!0}),setTimeout(function(){c||d(void 0),c=!0},5e3)}).then(d=>(this.context.listener.receiptsReady(n.Platform.APPLE_APPSTORE),d)).catch(d=>(this.context.listener.receiptsReady(n.Platform.APPLE_APPSTORE),d))})}loadEligibility(c){return we(this,void 0,void 0,function*(){if(this.log.debug("load eligibility: "+JSON.stringify(c)),!this.discountEligibilityDeterminer)return this.log.debug("No discount eligibility determiner, skipping..."),new e.Internal.DiscountEligibilities([],[]);const d=[];if(c.forEach(h=>{var m,g,_;(m=h.discounts)===null||m===void 0||m.forEach(v=>{d.push({productId:h.id,discountId:v.id,discountType:v.type})}),((_=(g=h.discounts)===null||g===void 0?void 0:g.length)!==null&&_!==void 0?_:0)===0&&h.introPrice&&d.push({productId:h.id,discountId:"intro",discountType:"Introductory"})}),d.length>0){const h=yield this.loadAppStoreReceipt();if(!h||!h.appStoreReceipt)return this.log.debug("no receipt, assuming introductory price are available."),new e.Internal.DiscountEligibilities(d,d.map(m=>m.discountType==="Introductory"));{this.log.debug("calling discount eligibility determiner.");const m=yield this.callDiscountEligibilityDeterminer(h,d);return this.log.debug("response: "+JSON.stringify(m)),new e.Internal.DiscountEligibilities(d,m)}}else return new e.Internal.DiscountEligibilities([],[])})}callDiscountEligibilityDeterminer(c,d){return new Promise(h=>{if(!this.discountEligibilityDeterminer)return h([]);this.discountEligibilityDeterminer(c,d,h)})}loadProducts(c){return new Promise(d=>{this.log.info("bridge.load"),this.bridge.load(c.map(h=>h.id),(h,m)=>we(this,void 0,void 0,function*(){this.log.info("bridge.loaded: "+JSON.stringify({validProducts:h,invalidProducts:m})),this.addValidProducts(c,h);const g=yield this.loadEligibility(h);this.log.info("eligibilities ready: "+JSON.stringify(g));const _=c.map(v=>{if(m.indexOf(v.id)>=0)return this.log.debug(`${v.id} is invalid`),a(n.ErrorCode.INVALID_PRODUCT_ID,"Product not found in AppStore. #400",v.id);{const T=h.find(A=>A.id===v.id);if(this.log.debug(`${v.id} is valid: ${JSON.stringify(T)}`),!T)return a(n.ErrorCode.INVALID_PRODUCT_ID,"Product not found in AppStore. #404",v.id);let I=this.getProduct(v.id);return I?(this.log.debug("refreshing existing product"),I==null||I.refresh(T,this.context.apiDecorators,g)):(this.log.debug("registering new product"),I=new e.SKProduct(T,v,this.context.apiDecorators,g),this._products.push(I)),I}});this.log.debug(`Products loaded: ${JSON.stringify(_)}`),d(_)}),(h,m)=>c.map(g=>a(h,m,null)))})}order(c,d){return we(this,void 0,void 0,function*(){let h=!1;return new Promise(m=>{var g;const _=C=>{h||(this.setPaymentMonitor(()=>{}),h=!0,m(C))};this.log.info("order");const v=c.id!==e.DEFAULT_OFFER_ID?c.id:void 0,T=(g=d==null?void 0:d.appStore)===null||g===void 0?void 0:g.discount;if(v&&!T)return _(a(n.ErrorCode.MISSING_OFFER_PARAMS,"Missing additionalData.appStore.discount when ordering a discount offer",c.productId));if(v&&(T==null?void 0:T.id)!==v)return _(a(n.ErrorCode.INVALID_OFFER_IDENTIFIER,"Offer identifier does not match additionalData.appStore.discount.id",c.productId));this.setPaymentMonitor((C,L,x)=>{if(this.log.info("order.paymentMonitor => "+C+" "+(L??"")+" "+(x??"")),!h)switch(C){case"cancelled":_(a(L??n.ErrorCode.PAYMENT_CANCELLED,x??"The user cancelled the order.",c.productId));break;case"failed":setTimeout(()=>{_(a(L??n.ErrorCode.PURCHASE,x??"Purchase failed",c.productId))},500);break;case"purchased":case"deferred":_(void 0);break}});const I=()=>{this.log.info("order.success")},A=()=>{this.log.info("order.error"),_(a(n.ErrorCode.PURCHASE,"Failed to place order",c.productId))};this.forceReceiptReload=!0,this.bridge.purchase(c.productId,1,this.context.getApplicationUsername(),T,I,A)})})}finish(c){return new Promise(d=>{if(this.log.info("finish("+c.transactionId+")"),c.transactionId===e.APPLICATION_VIRTUAL_TRANSACTION_ID||c.transactionId===t(c.products[0].id))return c.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[c.parentReceipt]),d(void 0);const h=()=>{c.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[c.parentReceipt]),d(void 0)},m=g=>{var _,v;g!=null&&g.includes("[#CdvPurchase:100]")?h():d(a(n.ErrorCode.FINISH,"Failed to finish transaction",(v=(_=c.products[0])===null||_===void 0?void 0:_.id)!==null&&v!==void 0?v:null))};this.bridge.finish(c.transactionId,h,m)})}refreshReceipt(){return new Promise(c=>{const d=m=>{c(m)},h=(m,g)=>{c(a(m,g,null))};this.bridge.refreshReceipts(d,h)})}receiptValidationBody(c){return we(this,void 0,void 0,function*(){if(c.platform!==n.Platform.APPLE_APPSTORE||c!==this._receipt)return;const d=c;let h=d.nativeData;if(this.forceReceiptReload){const g=yield this.loadAppStoreReceipt();this.forceReceiptReload=!1,g&&(h=g,this.prepareReceipt(g))}if(!d.nativeData.appStoreReceipt){this.log.info("Cannot prepare the receipt validation body, because appStoreReceipt is missing. Refreshing...");const g=yield this.refreshReceipt();if(!g||"isError"in g){this.log.warn("Failed to refresh receipt, cannot run receipt validation."),g&&this.log.error(g);return}this.log.info("Receipt refreshed."),h=g}const m=d.transactions.slice(-1)[0];return{id:h.bundleIdentifier,type:n.ProductType.APPLICATION,products:n.Utils.objectValues(this.validProducts).map(g=>new e.SKProduct(g,g,this.context.apiDecorators,{isEligible:()=>!0})),transaction:{type:"ios-appstore",id:m==null?void 0:m.transactionId,appStoreReceipt:h.appStoreReceipt}}})}handleReceiptValidationResponse(c,d){var h,m;return we(this,void 0,void 0,function*(){let g=!1;if(d.ok){const _=(h=d.data)===null||h===void 0?void 0:h.transaction;(_==null?void 0:_.type)==="ios-appstore"&&"original_application_version"in _&&((m=this._receipt)===null||m===void 0||m.transactions.forEach(v=>{v.transactionId===e.APPLICATION_VIRTUAL_TRANSACTION_ID&&_.original_purchase_date_ms&&(v.purchaseDate=new Date(parseInt(_.original_purchase_date_ms)),g=!0)}))}g&&this.context.listener.receiptsUpdated(n.Platform.APPLE_APPSTORE,[c])})}requestPayment(c,d){return we(this,void 0,void 0,function*(){return a(n.ErrorCode.UNKNOWN,"requestPayment not supported",null)})}manageSubscriptions(){return we(this,void 0,void 0,function*(){this.bridge.manageSubscriptions()})}manageBilling(){return we(this,void 0,void 0,function*(){this.bridge.manageBilling()})}checkSupport(c){return c==="order"?this._canMakePayments:["order","manageBilling","manageSubscriptions"].indexOf(c)>=0}restorePurchases(){return new Promise(c=>{this.onRestoreCompleted=d=>{this.onRestoreCompleted=void 0,this.bridge.refreshReceipts(h=>{c(d)},(h,m)=>{c(d||a(h,m,null))})},this.forceReceiptReload=!0,this.bridge.restore()})}presentCodeRedemptionSheet(){return new Promise(c=>{this.bridge.presentCodeRedemptionSheet(c)})}}e.Adapter=r;function a(l,c,d){return n.storeError(l,c,n.Platform.APPLE_APPSTORE,d)}})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){const r=h=>{};let a=r;function l(h,m,g,_){window.cordova.exec(g,_,"InAppPurchase",h,m)}function c(h,m,...g){if(h)try{h.apply(this,g)}catch(_){a("exception in "+m+': "'+_+'"')}}class d{constructor(){this.transactionsForProduct={},this.initialized=!1,this.registeredProducts=[],this.needRestoreNotification=!1,this.pendingUpdates=[],this.onPurchased=!1,this.onFailed=!1,this.onRestored=!1,window.storekit=this,this.options={error:r,ready:r,purchased:r,purchaseEnqueued:r,purchasing:r,purchaseFailed:r,deferred:r,finished:r,restored:r,receiptsRefreshed:r,restoreFailed:r,restoreCompleted:r}}init(m,g,_){this.options={error:m.error||r,ready:m.ready||r,purchased:m.purchased||r,purchaseEnqueued:m.purchaseEnqueued||r,purchasing:m.purchasing||r,purchaseFailed:m.purchaseFailed||r,deferred:m.deferred||r,finished:m.finished||r,restored:m.restored||r,receiptsRefreshed:m.receiptsRefreshed||r,restoreFailed:m.restoreFailed||r,restoreCompleted:m.restoreCompleted||r},m.debug&&(l("debug",[],r,r),a=m.log||function(I){console.log("[CdvPurchase.AppAppStore.Bridge] "+I)}),m.autoFinish&&l("autoFinish",[],r,r),l("setup",[],()=>{a("setup ok"),c(this.options.ready,"options.ready"),c(g,"init.success"),this.initialized=!0,setTimeout(()=>this.processPendingTransactions(),50)},I=>{a("setup failed"),c(_,"init.error",n.ErrorCode.SETUP,"Setup failed: "+I)})}processPendingTransactions(){a("processing pending transactions"),l("processPendingTransactions",[],()=>{this.finalizeTransactionUpdates()},void 0)}purchase(m,g,_,v,T,I){g=g|0||1;const A=this.options;if(this.registeredProducts.indexOf(m)<0){const x="Purchasing "+m+" failed.  Ensure the product was loaded first with Bridge.load(...)!";a(x),typeof A.error=="function"&&c(A.error,"options.error",n.ErrorCode.PURCHASE,"Trying to purchase a unknown product.",{productId:m,quantity:g});return}l("purchase",[m,g,_,v||{}],()=>{a("Purchase enqueued "+m),typeof A.purchaseEnqueued=="function"&&c(A.purchaseEnqueued,"options.purchaseEnqueued",m,g),c(T,"purchase.success")},()=>{const x="Purchase failed: "+m;a(x),typeof A.error=="function"&&c(A.error,"options.error",n.ErrorCode.PURCHASE,x,{productId:m,quantity:g}),c(I,"purchase.error")})}canMakePayments(m,g){return l("canMakePayments",[],m,g)}restore(m){this.needRestoreNotification=!0,l("restoreCompletedTransactions",[],m,m)}manageSubscriptions(m){l("manageSubscriptions",[],m,m)}manageBilling(m){l("manageBilling",[],m,m)}presentCodeRedemptionSheet(m){l("presentCodeRedemptionSheet",[],m,m)}load(m,g,_){const v=this.options;if(typeof m=="string"&&(m=[m]),!m)c(g,"load.success",[],[]);else if(!m.length)c(g,"load.success",[],[]);else{if(typeof m[0]!="string"){const A="invalid productIds given to store.load: "+JSON.stringify(m);a(A),c(v.error,"options.error",n.ErrorCode.LOAD,A),c(_,"load.error",n.ErrorCode.LOAD,A);return}a("load "+JSON.stringify(m));const T=A=>{const C=A[0],L=A[1];a("load ok: { valid:"+JSON.stringify(C)+" invalid:"+JSON.stringify(L)+" }"),c(g,"load.success",C,L)},I=A=>{a("load failed"),a(A);const C="Load failed: "+A;c(v.error,"options.error",n.ErrorCode.LOAD,C),c(_,"load.error",n.ErrorCode.LOAD,C)};this.registeredProducts=this.registeredProducts.concat(m),l("load",[m],T,I)}}finish(m,g,_){l("finishTransaction",[m],g,_)}finalizeTransactionUpdates(){for(let m=0;m<this.pendingUpdates.length;++m){const g=this.pendingUpdates[m];this.transactionUpdated(g.state,g.errorCode,g.errorText,g.transactionIdentifier,g.productId,g.transactionReceipt,g.originalTransactionIdentifier,g.transactionDate,g.discountId)}this.pendingUpdates=[]}lastTransactionUpdated(){}transactionUpdated(m,g,_,v,T,I,A,C,L){if(!this.initialized){this.pendingUpdates.push({state:m,errorCode:g,errorText:_,transactionIdentifier:v,productId:T,transactionReceipt:I,originalTransactionIdentifier:A,transactionDate:C,discountId:L});return}switch(a("transaction updated:"+v+" state:"+m+" product:"+T),T&&v&&(this.transactionsForProduct[T]?this.transactionsForProduct[T].push(v):this.transactionsForProduct[T]=[v]),m){case"PaymentTransactionStatePurchasing":c(this.options.purchasing,"options.purchasing",T);return;case"PaymentTransactionStatePurchased":c(this.options.purchased,"options.purchase",v,T,A,C,L);return;case"PaymentTransactionStateDeferred":c(this.options.deferred,"options.deferred",T);return;case"PaymentTransactionStateFailed":c(this.options.purchaseFailed,"options.purchaseFailed",T,g||n.ErrorCode.UNKNOWN,_||"ERROR"),c(this.options.error,"options.error",g||n.ErrorCode.UNKNOWN,_||"ERROR",{productId:T});return;case"PaymentTransactionStateRestored":c(this.options.restored,"options.restore",v,T);return;case"PaymentTransactionStateFinished":c(this.options.finished,"options.finish",v,T);return}}restoreCompletedTransactionsFinished(){this.needRestoreNotification&&(this.needRestoreNotification=!1,c(this.options.restoreCompleted,"options.restoreCompleted"))}restoreCompletedTransactionsFailed(m){this.needRestoreNotification&&(this.needRestoreNotification=!1,c(this.options.restoreFailed,"options.restoreFailed",m))}parseReceiptArgs(m){const g=m[0],_=m[1],v=m[2],T=m[3],I=m[4];return a("infoPlist: "+_+","+v+","+T+","+I),{appStoreReceipt:g,bundleIdentifier:_,bundleShortVersion:v,bundleNumericVersion:T,bundleSignature:I}}refreshReceipts(m,g){const _=T=>{const I=this.parseReceiptArgs(T);this.appStoreReceipt=I,c(this.options.receiptsRefreshed,"options.receiptsRefreshed",I),c(m,"refreshReceipts.success",I)},v=T=>{a("refresh receipt failed: "+T),T.includes("(@AMSErrorDomain:100)")&&a('authentication failed, indicated by the string "(@AMSErrorDomain:100)"'),c(this.options.error,"options.error",n.ErrorCode.REFRESH_RECEIPTS,"Failed to refresh receipt: "+T),c(g,"refreshReceipts.error",n.ErrorCode.REFRESH_RECEIPTS,"Failed to refresh receipt: "+T)};this.appStoreReceipt=null,a("refreshing appStoreReceipt"),l("appStoreRefreshReceipt",[],_,v)}loadReceipts(m,g){const _=T=>{const I=this.parseReceiptArgs(T);this.appStoreReceipt=I,c(m,"loadReceipts.callback",I)},v=T=>{};a("loading appStoreReceipt"),l("appStoreReceipt",[],_,v)}}t.Bridge=d})(e.Bridge||(e.Bridge={}))})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){class r{constructor(l,c){this.request=l,this.response=c}isEligible(l,c,d){var h;for(let m=0;m<this.request.length;++m){const g=this.request[m];if(g.productId===l&&g.discountId===d&&g.discountType===c)return(h=this.response[m])!==null&&h!==void 0?h:!1}return!0}}t.DiscountEligibilities=r})(e.Internal||(e.Internal={}))})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){e.DEFAULT_OFFER_ID="$";class t extends n.Offer{constructor(l,c){super(l,c),this.offerType=l.offerType}}e.SKOffer=t;class r extends n.Product{constructor(l,c,d,h){super(c,d),this.raw=l,this.refresh(l,d,h)}removeIneligibleDiscounts(l){this.offers=this.offers.filter(c=>{const d=c;return d.offerType==="Default"?!0:l.isEligible(this.id,d.offerType,c.id)})}refresh(l,c,d){var h;this.raw=l,this.title=l.title,this.description=l.description,this.countryCode=l.countryCode,l.group&&(this.group=l.group),this.removeIneligibleDiscounts(d);const m={price:l.price,priceMicros:l.priceMicros,currency:l.currency,billingPeriod:_(l.billingPeriod,l.billingPeriodUnit),paymentMode:this.type===n.ProductType.PAID_SUBSCRIPTION?n.PaymentMode.PAY_AS_YOU_GO:n.PaymentMode.UP_FRONT,recurrenceMode:this.type===n.ProductType.PAID_SUBSCRIPTION?n.RecurrenceMode.INFINITE_RECURRING:n.RecurrenceMode.NON_RECURRING};if((h=l.discounts)===null||h===void 0||h.forEach(v=>{if(d.isEligible(l.id,v.type,v.id)){const T=[],I=v.paymentMode===n.PaymentMode.PAY_AS_YOU_GO?v.period:1,A=v.paymentMode===n.PaymentMode.PAY_AS_YOU_GO?1:v.period,C={price:v.price,priceMicros:v.priceMicros,currency:l.currency,billingPeriod:_(A,v.periodUnit),billingCycles:I,paymentMode:v.paymentMode,recurrenceMode:n.RecurrenceMode.FINITE_RECURRING};T.push(C),T.push(m),this.addOffer(new t({id:v.id,product:this,pricingPhases:T,offerType:v.type},c))}}),!g(this)){const v=[];if(l.introPrice&&l.introPriceMicros!==void 0&&d.isEligible(l.id,"Introductory","intro")){const T={price:l.introPrice,priceMicros:l.introPriceMicros,currency:l.currency,billingPeriod:_(l.introPricePeriod,l.introPricePeriodUnit),paymentMode:l.introPricePaymentMode,recurrenceMode:n.RecurrenceMode.FINITE_RECURRING,billingCycles:1};v.push(T)}v.push(m),this.addOffer(new t({id:e.DEFAULT_OFFER_ID,product:this,pricingPhases:v,offerType:"Default"},c))}function g(v){return v.offers.filter(T=>{const I=T;return I.offerType==="Introductory"||I.offerType==="Default"&&I.pricingPhases.length>1}).length>0}function _(v,T){if(v&&T)return`P${v}${T[0]}`}}}e.SKProduct=r})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){e.APPLICATION_VIRTUAL_TRANSACTION_ID="appstore.application";class t extends n.Receipt{constructor(l,c,d){super(n.Platform.APPLE_APPSTORE,d),this.nativeData=l,this.refresh(this.nativeData,c,d)}refresh(l,c,d){if(this.nativeData=l,c){if(this.transactions.find(g=>g.transactionId===e.APPLICATION_VIRTUAL_TRANSACTION_ID))return;const m=new n.Transaction(n.Platform.APPLE_APPSTORE,this,d);m.transactionId=e.APPLICATION_VIRTUAL_TRANSACTION_ID,m.state=n.TransactionState.APPROVED,m.products.push({id:l.bundleIdentifier}),this.transactions.push(m)}}}e.SKApplicationReceipt=t;class r extends n.Transaction{refresh(l,c,d,h){l&&(this.products=[{id:l,offerId:h}]),c&&(this.originalTransactionId=c),d&&(this.purchaseDate=new Date(+d))}}e.SKTransaction=r})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.CANCELED="1",r.BILLING_ERROR="2",r.PRICE_INCREASE="3",r.PRODUCT_NOT_AVAILABLE="4",r.UNKNOWN="5"})(t.AppleExpirationIntent||(t.AppleExpirationIntent={}))})(e.VerifyReceipt||(e.VerifyReceipt={}))})(n.AppleAppStore||(n.AppleAppStore={}))})(H||(H={}));var H;(function(n){(function(e){class t extends n.Receipt{constructor(g,_,v){var T,I,A;super(n.Platform.BRAINTREE,v);const C=new n.Transaction(n.Platform.BRAINTREE,this,v);C.purchaseDate=new Date,C.products=((T=g.items)===null||T===void 0?void 0:T.filter(L=>L).map(L=>({id:(L==null?void 0:L.id)||""})))||[],C.state=n.TransactionState.APPROVED,C.transactionId=(A=(I=_.paymentMethodNonce)===null||I===void 0?void 0:I.nonce)!==null&&A!==void 0?A:`UNKNOWN_${_.paymentMethodType}_${_.paymentDescription}`,this.transactions=[C],this.dropInResult=_,this.paymentRequest=g,this.refresh(g,_,v)}refresh(g,_,v){var T,I;this.dropInResult=_,this.paymentRequest=g;const A=new n.Transaction(n.Platform.BRAINTREE,this,v);A.products=g.items.filter(C=>C).map(C=>({id:(C==null?void 0:C.id)||""})),A.state=n.TransactionState.APPROVED,A.transactionId=(I=(T=_.paymentMethodNonce)===null||T===void 0?void 0:T.nonce)!==null&&I!==void 0?I:`UNKNOWN_${_.paymentMethodType}_${_.paymentDescription}`,A.amountMicros=g.amountMicros,A.currency=g.currency,this.transactions=[A]}}e.BraintreeReceipt=t;class r{constructor(g,_){this.id=n.Platform.BRAINTREE,this.name="BrainTree",this.ready=!1,this.products=[],this._receipts=[],this.supportsParallelLoading=!1,this.context=g,this.log=g.log.child("Braintree"),this.options=_}get receipts(){return this._receipts}get isSupported(){return e.IosBridge.Bridge.isSupported()||e.AndroidBridge.Bridge.isSupported()}initialize(){return new Promise(g=>{if(this.log.info("initialize()"),e.IosBridge.Bridge.isSupported())this.log.info("instantiating ios bridge..."),this.iosBridge=new e.IosBridge.Bridge(this.log,_=>{this.options.tokenizationKey?_(this.options.tokenizationKey):this.options.clientTokenProvider?this.options.clientTokenProvider(_):_(h(n.ErrorCode.CLIENT_INVALID,"Braintree iOS Bridge requires a clientTokenProvider or tokenizationKey"))},this.options.applePay),this.iosBridge.initialize(this.context,g);else if(e.AndroidBridge.Bridge.isSupported()&&!this.androidBridge){this.log.info("instantiating android bridge..."),this.androidBridge=new e.AndroidBridge.Bridge(this.log),this.log.info("calling android bridge -> initialize...");const _=this.options.tokenizationKey?this.options.tokenizationKey:this.options.clientTokenProvider?this.options.clientTokenProvider:"";this.androidBridge.initialize(_,g)}else this.log.info("platform not supported..."),g(void 0);this.context.listener.receiptsReady(n.Platform.BRAINTREE)})}loadProducts(g){return we(this,void 0,void 0,function*(){return g.map(_=>h(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"N/A"))})}loadReceipts(){return we(this,void 0,void 0,function*(){return this.context.listener.receiptsReady(n.Platform.BRAINTREE),[]})}order(g){return we(this,void 0,void 0,function*(){return h(n.ErrorCode.UNKNOWN,"N/A: Not implemented with Braintree")})}finish(g){return we(this,void 0,void 0,function*(){g.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.TEST,[g.parentReceipt])})}manageSubscriptions(){return we(this,void 0,void 0,function*(){this.log.info("N/A: manageSubscriptions() is not available with Braintree")})}manageBilling(){return we(this,void 0,void 0,function*(){this.log.info("N/A: manageBilling() is not available with Braintree")})}launchDropIn(g,_){return we(this,void 0,void 0,function*(){return this.androidBridge?this.androidBridge.launchDropIn(_):this.iosBridge?this.iosBridge.launchDropIn(g,_):h(n.ErrorCode.PURCHASE,"Braintree is not available")})}requestPayment(g,_){var v,T,I,A,C,L,x,U,z;return we(this,void 0,void 0,function*(){this.log.info("requestPayment()"+JSON.stringify(g));const $=((v=_==null?void 0:_.braintree)===null||v===void 0?void 0:v.dropInRequest)||{};if((yield e.IosBridge.ApplePayPlugin.isSupported(this.log))||(this.log.info("Apple Pay is not supported."),$.applePayDisabled=!0),this.options.googlePay||$.googlePayRequest){const N=Object.assign(Object.assign({},(T=this.options.googlePay)!==null&&T!==void 0?T:{}),(I=$.googlePayRequest)!==null&&I!==void 0?I:{});N.transactionInfo||(N.transactionInfo={currencyCode:(A=g.currency)!==null&&A!==void 0?A:"",totalPrice:((C=g.amountMicros)!==null&&C!==void 0?C:0)/1e6,totalPriceStatus:e.GooglePay.TotalPriceStatus.FINAL}),$.googlePayRequest=N}if(this.options.threeDSecure||$.threeDSecureRequest){const N=Object.assign(Object.assign({},(L=this.options.threeDSecure)!==null&&L!==void 0?L:{}),(x=$.threeDSecureRequest)!==null&&x!==void 0?x:{});N.amount||(N.amount=a((U=g.amountMicros)!==null&&U!==void 0?U:0)),!N.billingAddress&&g.billingAddress&&(N.billingAddress={givenName:g.billingAddress.givenName,surname:g.billingAddress.surname,countryCodeAlpha2:g.billingAddress.countryCode,postalCode:g.billingAddress.postalCode,locality:g.billingAddress.locality,streetAddress:g.billingAddress.streetAddress1,extendedAddress:g.billingAddress.streetAddress2,line3:g.billingAddress.streetAddress3,phoneNumber:g.billingAddress.phoneNumber,region:g.billingAddress.region}),N.email||(N.email=g.email),$.threeDSecureRequest=N}const se=yield this.launchDropIn(g,$);if(!c(se))return d(this.log,se);const D=se;if(this.log.info("launchDropIn success: "+JSON.stringify({paymentRequest:g,dropInResult:D})),!(!((z=D.paymentMethodNonce)===null||z===void 0)&&z.nonce))return h(n.ErrorCode.BAD_RESPONSE,"launchDropIn returned no paymentMethodNonce");let P=this._receipts.find(N=>{var M,B;return((M=N.dropInResult.paymentMethodNonce)===null||M===void 0?void 0:M.nonce)===((B=D.paymentMethodNonce)===null||B===void 0?void 0:B.nonce)});return P?P.refresh(g,D,this.context.apiDecorators):(P=new t(g,D,this.context.apiDecorators),this.receipts.push(P)),this.context.listener.receiptsUpdated(n.Platform.BRAINTREE,[P]),P.transactions[0]})}receiptValidationBody(g){var _,v,T,I,A;return we(this,void 0,void 0,function*(){if(!l(g)){this.log.error("Unexpected error, expecting a BraintreeReceipt: "+JSON.stringify(g));return}return this.log.info("create receiptValidationBody for: "+JSON.stringify(g)),{id:(T=(v=(_=g.paymentRequest.items)===null||_===void 0?void 0:_[0])===null||v===void 0?void 0:v.id)!==null&&T!==void 0?T:"unknown",type:n.ProductType.CONSUMABLE,priceMicros:g.paymentRequest.amountMicros,currency:g.paymentRequest.currency,products:[],transaction:{type:n.Platform.BRAINTREE,deviceData:g.dropInResult.deviceData,id:"nonce",paymentMethodNonce:(A=(I=g.dropInResult.paymentMethodNonce)===null||I===void 0?void 0:I.nonce)!==null&&A!==void 0?A:"",paymentDescription:g.dropInResult.paymentDescription,paymentMethodType:g.dropInResult.paymentMethodType}}})}handleReceiptValidationResponse(g,_){var v;return we(this,void 0,void 0,function*(){if(this.log.info("receipt validation response: "+JSON.stringify(_)),_!=null&&_.data&&"transaction"in _.data&&_.data.transaction.type==="braintree"){const T=(v=_.data.transaction.data.transaction)===null||v===void 0?void 0:v.customer.id;T&&!e.customerId&&(this.log.info("customerId updated: "+T),e.customerId=T)}})}checkSupport(g){return g==="requestPayment"}restorePurchases(){return we(this,void 0,void 0,function*(){})}}e.Adapter=r;function a(m){const g=""+m/1e4;return(g.slice(0,-2)||"0")+"."+(g.slice(-2,-1)||"0")+(g.slice(-1)||"0")}function l(m){return m.platform===n.Platform.BRAINTREE}const c=m=>!!m&&!("code"in m&&"message"in m),d=(m,g)=>{if(g){if(g.code===n.ErrorCode.PAYMENT_CANCELLED){m.info("User cancelled the payment request");return}return m.warn("launchDropIn failed: "+JSON.stringify(g)),g}else return m.warn("launchDropIn failed: no response"),h(n.ErrorCode.BAD_RESPONSE,"Braintree failed to launch drop in")};function h(m,g){return n.storeError(m,g,n.Platform.BRAINTREE,null)}e.braintreeError=h})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){const t="BraintreePlugin";(function(r){class a{constructor(c){this.log=c.child("AndroidBridge")}listener(c){this.log.debug("listener: "+JSON.stringify(c)),!(!c||!c.type)&&(c.type==="getClientToken"?this.getClientToken():c.type)}initialize(c,d){try{if(typeof c=="string"){const m=c;this.clientTokenProvider=g=>{g(m)}}else this.clientTokenProvider=c;this.log.info("exec.setListener()");const h=this.listener.bind(this);window.cordova.exec(h,null,t,"setListener",[]),d(void 0)}catch(h){this.log.warn("initialization failed: "+(h==null?void 0:h.message)),d(e.braintreeError(n.ErrorCode.SETUP,"Failed to initialize Braintree Android Bridge: "+(h==null?void 0:h.message)))}}getClientToken(){this.log.info("getClientToken()"),this.clientTokenProvider?(this.log.debug("clientTokenProvider set, calling."),this.clientTokenProvider(c=>{typeof c=="string"?window.cordova.exec(null,null,t,"onClientTokenSuccess",[c]):window.cordova.exec(null,null,t,"onClientTokenFailure",[c.code,c.message])})):(this.log.debug("clientTokenProvider not set, retrying later..."),setTimeout(()=>this.getClientToken(),1e3))}static isSupported(){return n.Utils.platformId()==="android"}isApplePaySupported(){return we(this,void 0,void 0,function*(){return!1})}launchDropIn(c){return new Promise(d=>{window.cordova.exec(h=>{this.log.info("dropInSuccess: "+JSON.stringify(h)),d(h)},h=>{this.log.info("dropInFailure: "+h);const m=h.split("|")[0],g=h.split("|").slice(1).join("");d(m==="UserCanceledException"?e.braintreeError(n.ErrorCode.PAYMENT_CANCELLED,g):m==="AuthorizationException"?e.braintreeError(n.ErrorCode.UNAUTHORIZED_REQUEST_DATA,g):e.braintreeError(n.ErrorCode.UNKNOWN,h))},t,"launchDropIn",[c])})}}r.Bridge=a})(e.AndroidBridge||(e.AndroidBridge={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){const r="BraintreeApplePayPlugin";class a{static get(){return window.CdvPurchaseBraintreeApplePay}static requestPayment(c){return new Promise(d=>{var h;if(!((h=a.get())===null||h===void 0)&&h.installed){const m=_=>{d(_)},g=_=>{const v=_??"payment request failed";d(e.braintreeError(n.ErrorCode.PURCHASE,"Braintree+ApplePay ERROR: "+v))};window.cordova.exec(m,g,r,"presentDropInPaymentUI",[c])}else return d(e.braintreeError(n.ErrorCode.SETUP,"cordova-plugin-purchase-braintree-applepay does not appear to be installed."))})}static isSupported(c){return new Promise(d=>{var h;if(n.Utils.platformId()!=="ios")return c.info("BraintreeApplePayPlugin is only available for ios."),d(!1);if(!(!((h=a.get())===null||h===void 0)&&h.installed))return c.info("BraintreeApplePayPlugin does not appear to be installed."),d(!1);try{window.cordova.exec(m=>{d(m)},()=>{c.info("BraintreeApplePayPlugin is not available."),d(!1)},r,"isApplePaySupported",[])}catch{c.info("BraintreeApplePayPlugin is not installed."),d(!1)}})}}t.ApplePayPlugin=a})(e.IosBridge||(e.IosBridge={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){class r{constructor(l,c,d){this.log=l.child("IosBridge"),this.clientTokenProvider=c,this.applePayOptions=d}initialize(l,c){window.cordova.exec(null,null,"BraintreePlugin","setVerbosity",[l.verbosity]),window.cordova.exec(d=>this.log.debug("(Native) "+d),null,"BraintreePlugin","setLogger",[]),setTimeout(()=>c(void 0),0)}continueDropInForApplePay(l,c,d){var h,m,g,_,v,T,I,A,C;return we(this,void 0,void 0,function*(){const L=((m=(h=this.applePayOptions)===null||h===void 0?void 0:h.preparePaymentRequest)===null||m===void 0?void 0:m.call(h,l))||{merchantCapabilities:[n.ApplePay.MerchantCapability.ThreeDS]};if(!L.paymentSummaryItems){const U=l.items.filter($=>$).map(($,se)=>{var D,P,N;return{type:"final",label:($==null?void 0:$.title)||($==null?void 0:$.id)||`Item #${se+1}`,amount:`${Math.round(((N=(P=(D=$==null?void 0:$.pricing)===null||D===void 0?void 0:D.priceMicros)!==null&&P!==void 0?P:l.amountMicros)!==null&&N!==void 0?N:0)/1e4)/100}`}}),z={type:"final",label:(_=(g=this.applePayOptions)===null||g===void 0?void 0:g.companyName)!==null&&_!==void 0?_:"Total",amount:`${Math.round(((v=l.amountMicros)!==null&&v!==void 0?v:0)/1e4)/100}`};L.paymentSummaryItems=[...U,z]}const x=yield t.ApplePayPlugin.requestPayment(L);return this.log.info("Result from Apple Pay: "+JSON.stringify(x)),"isError"in x?x:x.userCancelled?e.braintreeError(n.ErrorCode.PAYMENT_CANCELLED,"User cancelled the payment request"):{paymentMethodNonce:{isDefault:!1,nonce:(I=(T=x.applePayCardNonce)===null||T===void 0?void 0:T.nonce)!==null&&I!==void 0?I:"",type:(C=(A=x.applePayCardNonce)===null||A===void 0?void 0:A.type)!==null&&C!==void 0?C:""},paymentMethodType:d.paymentMethodType,deviceData:d.deviceData,paymentDescription:d.paymentDescription}})}launchDropIn(l,c){return new Promise(d=>we(this,void 0,void 0,function*(){const h=g=>{this.log.info("dropInSuccess: "+JSON.stringify(g)),g.paymentMethodType===e.DropIn.PaymentMethod.APPLE_PAY?(this.log.info("it's an ApplePay request, we have to process it."),this.continueDropInForApplePay(l,c,g).then(d)):d(g)},m=g=>{this.log.info("dropInFailure: "+g);const[_,v]=g.split("|");d(_==="UserCanceledException"?e.braintreeError(n.ErrorCode.PAYMENT_CANCELLED,v):e.braintreeError(n.ErrorCode.UNKNOWN,"ERROR "+_+": "+v))};this.clientTokenProvider(g=>{typeof g=="string"?window.cordova.exec(h,m,"BraintreePlugin","launchDropIn",[g,c]):d(g)})}))}braintreePlugin(){return window.CdvPurchaseBraintree}static isSupported(){return n.Utils.platformId()==="ios"}}t.Bridge=r})(e.IosBridge||(e.IosBridge={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r[r.DISABLED=0]="DISABLED",r[r.OPTIONAL=1]="OPTIONAL",r[r.REQUIRED=2]="REQUIRED"})(t.CardFormFieldStatus||(t.CardFormFieldStatus={}))})(e.DropIn||(e.DropIn={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.GOOGLE_PAY="GOOGLE_PAY",r.LASER="LASER",r.UK_MAESTRO="UK_MAESTRO",r.SWITCH="SWITCH",r.SOLOR="SOLO",r.APPLE_PAY="APPLE_PAY",r.AMEX="AMEX",r.DINERS_CLUB="DINERS_CLUB",r.DISCOVER="DISCOVER",r.JCB="JCB",r.MAESTRO="MAESTRO",r.MASTERCARD="MASTERCARD",r.PAYPAL="PAYPAL",r.VISA="VISA",r.VENMO="VENMO",r.UNIONPAY="UNIONPAY",r.HIPER="HIPER",r.HIPERCARD="HIPERCARD",r.UNKNOWN="UNKNOWN"})(t.PaymentMethod||(t.PaymentMethod={}))})(e.DropIn||(e.DropIn={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r[r.MIN=0]="MIN",r[r.FULL=1]="FULL"})(t.BillingAddressFormat||(t.BillingAddressFormat={})),(function(r){r[r.NOT_CURRENTLY_KNOWN=1]="NOT_CURRENTLY_KNOWN",r[r.ESTIMATED=2]="ESTIMATED",r[r.FINAL=3]="FINAL"})(t.TotalPriceStatus||(t.TotalPriceStatus={}))})(e.GooglePay||(e.GooglePay={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.UNSPECIFIED="00",r.CREDIT="01",r.DEBIT="02"})(t.AccountType||(t.AccountType={})),(function(r){r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.SAME_DAY=1]="SAME_DAY",r[r.EXPEDITED=2]="EXPEDITED",r[r.PRIORITY=3]="PRIORITY",r[r.GROUND=4]="GROUND",r[r.ELECTRONIC_DELIVERY=5]="ELECTRONIC_DELIVERY",r[r.SHIP_TO_STORE=6]="SHIP_TO_STORE"})(t.ShippingMethod||(t.ShippingMethod={})),(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2"})(t.Version||(t.Version={}))})(e.ThreeDSecure||(e.ThreeDSecure={}))})(n.Braintree||(n.Braintree={}))})(H||(H={}));var H;(function(n){(function(e){class t extends n.Transaction{constructor(d,h,m){super(n.Platform.GOOGLE_PLAY,h,m),this.nativePurchase=d,this.refresh(d,!0)}static toState(d,h,m,g){switch(h){case e.Bridge.PurchaseState.PENDING:return n.TransactionState.INITIATED;case e.Bridge.PurchaseState.PURCHASED:return g?n.TransactionState.FINISHED:m?n.TransactionState.APPROVED:d?n.TransactionState.INITIATED:n.TransactionState.APPROVED;case e.Bridge.PurchaseState.UNSPECIFIED_STATE:return n.TransactionState.UNKNOWN_STATE}}refresh(d,h){var m,g;this.nativePurchase=d,this.transactionId=`${d.orderId||d.purchaseToken}`,this.purchaseId=`${d.purchaseToken}`,this.products=d.productIds.map(_=>({id:_})),d.purchaseTime&&(this.purchaseDate=new Date(d.purchaseTime)),this.isPending=d.getPurchaseState===e.Bridge.PurchaseState.PENDING,typeof d.acknowledged<"u"&&(this.isAcknowledged=d.acknowledged),typeof d.consumed<"u"&&(this.isConsumed=d.consumed),typeof d.autoRenewing<"u"&&(this.renewalIntent=d.autoRenewing?n.RenewalIntent.RENEW:n.RenewalIntent.LAPSE),this.state=t.toState(h??!1,d.getPurchaseState,(m=this.isAcknowledged)!==null&&m!==void 0?m:!1,(g=this.isConsumed)!==null&&g!==void 0?g:!1)}}e.Transaction=t;class r extends n.Receipt{constructor(d,h){super(n.Platform.GOOGLE_PLAY,h),this.transactions=[new t(d,this,h)],this.purchaseToken=d.purchaseToken,this.orderId=d.orderId}refreshPurchase(d){var h;(h=this.transactions[0])===null||h===void 0||h.refresh(d),this.orderId=d.orderId}}e.Receipt=r;class a{constructor(d,h=1e3*3600*24){if(this.id=n.Platform.GOOGLE_PLAY,this.name="GooglePlay",this.ready=!1,this.supportsParallelLoading=!1,this._receipts=[],this.bridge=new e.Bridge.Bridge,this.initialized=!1,this.retry=new n.Internal.Retry,this.autoRefreshIntervalMillis=0,a._instance)throw new Error("GooglePlay adapter already initialized");this._products=new e.Products(d.apiDecorators),this.autoRefreshIntervalMillis=h,this.context=d,this.log=d.log.child("GooglePlay"),a._instance=this}get products(){return this._products.products}get receipts(){return this._receipts}get isSupported(){return n.Utils.platformId()==="android"}initialize(){return we(this,void 0,void 0,function*(){return this.log.info("Initialize"),this.initializationPromise?this.initializationPromise:this.initializationPromise=new Promise(d=>{const h=this.log.child("Bridge"),m={onSetPurchases:this.onSetPurchases.bind(this),onPurchasesUpdated:this.onPurchasesUpdated.bind(this),onPurchaseConsumed:this.onPurchaseConsumed.bind(this),showLog:this.context.verbosity>=n.LogLevel.DEBUG,log:v=>h.info(v)},g=()=>{this.log.debug("Ready"),this.autoRefreshIntervalMillis>0&&window.setInterval(()=>this.getPurchases(),this.autoRefreshIntervalMillis),d(void 0)},_=v=>{this.initialized=!1,this.context.error(l(n.ErrorCode.SETUP,"Init failed - "+v,null)),this.retry.retry(()=>this.initialize())};this.bridge.init(g,_,m)})})}getSkusOf(d){const h=[],m=[];for(const g of d)g.type===n.ProductType.PAID_SUBSCRIPTION?m.push(g.id):h.push(g.id);return{inAppSkus:h,subsSkus:m}}loadReceipts(){return new Promise(d=>{this.getPurchases().then(h=>{d(this._receipts)})})}loadProducts(d){return new Promise(h=>{this.log.debug("Load: "+JSON.stringify(d));const m=_=>{if(this.log.debug("Loaded: "+JSON.stringify(_)),!Array.isArray(_)){const T=`Invalid product list received: ${JSON.stringify(_)}, retrying later...`;this.log.warn(T),this.retry.retry(g),this.context.error(l(n.ErrorCode.LOAD,T,null));return}const v=d.map(T=>{const I=_.find(A=>A.productId===T.id);return I&&I.productId?this._products.addProduct(T,I):l(n.ErrorCode.INVALID_PRODUCT_ID,`Product with id ${T.id} not found.`,T.id)});h(v)},g=()=>{const{inAppSkus:_,subsSkus:v}=this.getSkusOf(d);this.log.debug("getAvailableProducts: "+JSON.stringify(_)+" | "+JSON.stringify(v)),this.bridge.getAvailableProducts(_,v,m,T=>{this.retry.retry(g),this.context.error(l(n.ErrorCode.LOAD,"Loading product info failed - "+T+" - retrying later...",null))})};g()})}finish(d){return new Promise(h=>{const m=()=>{d.state!==n.TransactionState.FINISHED&&(d.state=n.TransactionState.FINISHED,this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[d.parentReceipt])),h(void 0)},g=d.products[0];if(!g)return h(l(n.ErrorCode.FINISH,"Cannot finish a transaction with no product",null));const _=this._products.getProduct(g.id);if(!_)return h(l(n.ErrorCode.FINISH,"Cannot finish transaction, unknown product "+g.id,g.id));const v=this._receipts.find(I=>I.hasTransaction(d));if(!v)return h(l(n.ErrorCode.FINISH,"Cannot finish transaction, linked receipt not found.",_.id));if(!v.purchaseToken)return h(l(n.ErrorCode.FINISH,"Cannot finish transaction, linked receipt contains no purchaseToken.",_.id));const T=(I,A)=>h(l(A||n.ErrorCode.UNKNOWN,I,_.id));if(_.type===n.ProductType.NON_RENEWING_SUBSCRIPTION||_.type===n.ProductType.CONSUMABLE){if(!d.isConsumed)return this.bridge.consumePurchase(m,T,v.purchaseToken)}else if(!d.isAcknowledged)return this.bridge.acknowledgePurchase(m,T,v.purchaseToken);h(void 0)})}onPurchaseConsumed(d){this.log.debug("onPurchaseConsumed: "+d.orderId),d.acknowledged=!0,d.consumed=!0,this.onPurchasesUpdated([d])}onPurchasesUpdated(d){this.log.debug("onPurchaseUpdated: "+d.map(h=>h.orderId).join(", ")),d.forEach(h=>{const m=this.receipts.find(g=>g.purchaseToken===h.purchaseToken);if(m)m.refreshPurchase(h),this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[m]);else{const g=new r(h,this.context.apiDecorators);this.receipts.push(g),this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[g]),g.transactions[0].state===n.TransactionState.INITIATED&&!g.transactions[0].isPending&&(g.refreshPurchase(h),this.context.listener.receiptsUpdated(n.Platform.GOOGLE_PLAY,[g]))}})}onSetPurchases(d){this.log.debug("onSetPurchases: "+JSON.stringify(d)),this.onPurchasesUpdated(d),this.context.listener.receiptsReady(n.Platform.GOOGLE_PLAY)}onPriceChangeConfirmationResult(d){}getPurchases(){return new Promise(d=>{this.log.debug("getPurchases");const h=()=>{this.log.debug("getPurchases success"),setTimeout(()=>d(void 0),0)},m=(g,_)=>{this.log.warn("getPurchases failed: "+g+" ("+_+")"),setTimeout(()=>d(l(_||n.ErrorCode.UNKNOWN,g,null)),0)};this.bridge.getPurchases(h,m)})}order(d,h){return we(this,void 0,void 0,function*(){return new Promise(m=>{this.log.info("Order - "+JSON.stringify(d));const g=()=>m(void 0),_=(v,T)=>{this.log.warn("Order failed: "+JSON.stringify({message:v,code:T})),m(l(T??n.ErrorCode.UNKNOWN,v,d.productId))};if(d.productType===n.ProductType.PAID_SUBSCRIPTION){const v="token"in d?d.productId+"@"+d.token:d.productId,T=this.findOldPurchaseToken(d.productId,d.productGroup);T&&(h.googlePlay?h.googlePlay.oldPurchaseToken||(h.googlePlay.oldPurchaseToken=T):h.googlePlay={oldPurchaseToken:T}),this.bridge.subscribe(g,_,v,h)}else this.bridge.buy(g,_,d.productId,h)})})}findOldPurchaseToken(d,h){if(!h)return;const m=this._receipts.find(g=>!!g.transactions.find(_=>!!_.products.find(v=>{const T=this._products.getProduct(v.id);return!T||!n.Internal.LocalReceipts.isOwned([g],T)?!1:v.id===d||h&&T.group===h})));return m==null?void 0:m.purchaseToken}receiptValidationBody(d){var h;return we(this,void 0,void 0,function*(){const m=d.transactions[0];if(!m)return;const g=(h=m.products[0])===null||h===void 0?void 0:h.id;if(!g)return;const _=this._products.getProduct(g);if(!_)return;const v=m.nativePurchase;return{id:g,type:_.type,offers:_.offers,products:this._products.products,transaction:{type:n.Platform.GOOGLE_PLAY,id:d.transactions[0].transactionId,purchaseToken:v.purchaseToken,signature:v.signature,receipt:v.receipt}}})}handleReceiptValidationResponse(d,h){var m;return we(this,void 0,void 0,function*(){if(h!=null&&h.ok){const g=(m=h==null?void 0:h.data)===null||m===void 0?void 0:m.transaction;if((g==null?void 0:g.type)!==n.Platform.GOOGLE_PLAY)return;g.kind}})}requestPayment(d,h){return we(this,void 0,void 0,function*(){return l(n.ErrorCode.UNKNOWN,"requestPayment not supported",null)})}manageSubscriptions(){return we(this,void 0,void 0,function*(){this.bridge.manageSubscriptions()})}manageBilling(){return we(this,void 0,void 0,function*(){this.bridge.manageBilling()})}checkSupport(d){return["order","manageBilling","manageSubscriptions"].indexOf(d)>=0}restorePurchases(){return new Promise(d=>{this.bridge.getPurchases(()=>d(void 0),(h,m)=>{this.log.warn("getPurchases() failed: "+(m??"ERROR")+": "+h),d(l(m??n.ErrorCode.UNKNOWN,h,null))})})}}a.trimProductTitles=!0,e.Adapter=a;function l(c,d,h){return n.storeError(c,d,n.Platform.GOOGLE_PLAY,h)}})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.FINITE_RECURRING="FINITE_RECURRING",r.INFINITE_RECURRING="INFINITE_RECURRING",r.NON_RECURRING="NON_RECURRING"})(t.RecurrenceMode||(t.RecurrenceMode={}))})(e.Bridge||(e.Bridge={}))})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){t.IMMEDIATE_WITH_TIME_PRORATION="IMMEDIATE_WITH_TIME_PRORATION",t.IMMEDIATE_AND_CHARGE_PRORATED_PRICE="IMMEDIATE_AND_CHARGE_PRORATED_PRICE",t.IMMEDIATE_WITHOUT_PRORATION="IMMEDIATE_WITHOUT_PRORATION",t.DEFERRED="DEFERRED",t.IMMEDIATE_AND_CHARGE_FULL_PRICE="IMMEDIATE_AND_CHARGE_FULL_PRICE"})(e.ProrationMode||(e.ProrationMode={})),(function(t){t.WITH_TIME_PRORATION="IMMEDIATE_WITH_TIME_PRORATION",t.CHARGE_PRORATED_PRICE="IMMEDIATE_AND_CHARGE_PRORATED_PRICE",t.WITHOUT_PRORATION="IMMEDIATE_WITHOUT_PRORATION",t.DEFERRED="DEFERRED",t.CHARGE_FULL_PRICE="IMMEDIATE_AND_CHARGE_FULL_PRICE"})(e.ReplacementMode||(e.ReplacementMode={})),(function(t){let r=function(m){console.log("InAppBilling[js]: "+m)};(function(h){h[h.UNSPECIFIED_STATE=0]="UNSPECIFIED_STATE",h[h.PURCHASED=1]="PURCHASED",h[h.PENDING=2]="PENDING"})(t.PurchaseState||(t.PurchaseState={}));class a{constructor(){this.options={}}init(m,g,_){_||(_={}),_.log&&(r=_.log),this.options={showLog:_.showLog!==!1,onPurchaseConsumed:_.onPurchaseConsumed,onPurchasesUpdated:_.onPurchasesUpdated,onSetPurchases:_.onSetPurchases},this.options.showLog&&r("setup ok");const v=this.listener.bind(this);window.cordova.exec(v,function(T){},"InAppBillingPlugin","setListener",[]),window.cordova.exec(m,l(g),"InAppBillingPlugin","init",[])}load(m,g,_,v,T){if(typeof _<"u"&&(typeof _=="string"&&(_=[_]),_.length>0)){if(typeof _[0]!="string"){var I="invalid productIds: "+JSON.stringify(_);this.options.showLog&&r(I),g(I,n.ErrorCode.INVALID_PRODUCT_ID);return}this.options.showLog&&r("load "+JSON.stringify(_))}window.cordova.exec(m,l(g),"InAppBillingPlugin","load",[_,v,T])}listener(m){this.options.showLog&&r("listener: "+JSON.stringify(m)),!(!m||!m.type)&&(m.type==="setPurchases"&&this.options.onSetPurchases&&this.options.onSetPurchases(m.data.purchases),m.type==="purchasesUpdated"&&this.options.onPurchasesUpdated&&this.options.onPurchasesUpdated(m.data.purchases),m.type==="purchaseConsumed"&&this.options.onPurchaseConsumed&&this.options.onPurchaseConsumed(m.data.purchase),m.type==="onPriceChangeConfirmationResultOK"&&this.options.onPriceChangeConfirmationResult&&this.options.onPriceChangeConfirmationResult("OK"),m.type==="onPriceChangeConfirmationResultUserCanceled"&&this.options.onPriceChangeConfirmationResult&&this.options.onPriceChangeConfirmationResult("UserCanceled"),m.type==="onPriceChangeConfirmationResultUnknownSku"&&this.options.onPriceChangeConfirmationResult&&this.options.onPriceChangeConfirmationResult("UnknownProduct"))}getPurchases(m,g){return this.options.showLog&&r("getPurchases()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","getPurchases",["null"])}buy(m,g,_,v){return this.options.showLog&&r("buy()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","buy",[_,d(v)])}subscribe(m,g,_,v){var T;return this.options.showLog&&r("subscribe()"),!((T=v.googlePlay)===null||T===void 0)&&T.oldPurchaseToken&&this.options.showLog&&r("subscribe() -> upgrading from an old purchase"),window.cordova.exec(m,l(g),"InAppBillingPlugin","subscribe",[_,d(v)])}consumePurchase(m,g,_){return this.options.showLog&&r("consumePurchase()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","consumePurchase",[_])}acknowledgePurchase(m,g,_){return this.options.showLog&&r("acknowledgePurchase()"),window.cordova.exec(m,l(g),"InAppBillingPlugin","acknowledgePurchase",[_])}getAvailableProducts(m,g,_,v){return this.options.showLog&&r("getAvailableProducts()"),window.cordova.exec(_,l(v),"InAppBillingPlugin","getAvailableProducts",[m,g])}manageSubscriptions(){return window.cordova.exec(function(){},function(){},"InAppBillingPlugin","manageSubscriptions",[])}manageBilling(){return window.cordova.exec(function(){},function(){},"InAppBillingPlugin","manageBilling",[])}launchPriceChangeConfirmationFlow(m){return window.cordova.exec(function(){},function(){},"InAppBillingPlugin","launchPriceChangeConfirmationFlow",[m])}}t.Bridge=a;function l(h){return function(m){if(!h)return;const g=typeof m=="string"?m.split("|"):[];if(g.length>1&&/^[-+]?(\d+)$/.test(g[0])){var _=g[0],v=g[1];h(v,+_)}else h(m)}}function c(h){return h&&h.constructor===Object?h:{}}function d(h){const m=c(h==null?void 0:h.googlePlay);return!m.accountId&&(h!=null&&h.applicationUsername)&&(m.accountId=n.Utils.md5(h.applicationUsername)),m}})(e.Bridge||(e.Bridge={}))})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){class t extends n.Product{}e.GProduct=t;class r extends n.Offer{constructor(){super(...arguments),this.type="inapp"}}e.InAppOffer=r;class a extends n.Offer{constructor(d,h){super(d,h),this.type="subs",this.tags=d.tags,this.token=d.token}}e.SubscriptionOffer=a;class l{constructor(d){this.products=[],this.offers=[],this.decorator=d}getProduct(d){return this.products.find(h=>h.id===d)}getOffer(d){return this.offers.find(h=>h.id===d)}addProduct(d,h){const m=this.getProduct(d.id),g=m??new t(d,this.decorator);return g.title=h.title||h.name||g.title,e.Adapter.trimProductTitles&&(g.title=g.title.replace(/ \(.*\)$/,"")),g.description=h.description||g.description,"product_format"in h&&h.product_format==="v12.0"?h.product_type==="subs"?this.onSubsV12Loaded(g,h):this.onInAppLoaded(g,h):this.onInAppLoaded(g,h),m||this.products.push(g),g}onSubsV12Loaded(d,h){h.offers.forEach(g=>{const _=g.pricing_phases.slice(-1)[0];if((_==null?void 0:_.recurrence_mode)===n.RecurrenceMode.FINITE_RECURRING){const T=m(g.base_plan_id);T&&T!==g&&g.pricing_phases.push(...T.pricing_phases)}const v=this.iabSubsOfferV12Loaded(d,h,g);d.addOffer(v)});function m(g){if(!g)return null;for(const _ of h.offers)if(_.base_plan_id===g&&!_.offer_id)return _;return null}return d}makeOfferId(d,h){return h.base_plan_id?h.offer_id?d+"@"+h.base_plan_id+"@"+h.offer_id:d+"@"+h.base_plan_id:d+"@"+h.token}iabSubsOfferV12Loaded(d,h,m){const g=this.makeOfferId(h.productId,m),_=this.getOffer(g),v=m.pricing_phases.map(T=>this.toPricingPhase(T));if(_)return _.pricingPhases=v,_;{const T=new a({id:g,product:d,pricingPhases:v,token:m.token,tags:m.tags},this.decorator);return this.offers.push(T),T}}onInAppLoaded(d,h){var m,g,_,v;const T=this.getOffer(h.productId),I=[{price:(g=(m=h.formatted_price)!==null&&m!==void 0?m:h.price)!==null&&g!==void 0?g:`${((_=h.price_amount_micros)!==null&&_!==void 0?_:0)/1e6} ${h.price_currency_code}`,priceMicros:(v=h.price_amount_micros)!==null&&v!==void 0?v:0,currency:h.price_currency_code,recurrenceMode:n.RecurrenceMode.NON_RECURRING}];if(T)T.pricingPhases=I,d.offers=[T];else{const A=new r({id:h.productId,product:d,pricingPhases:I},this.decorator);this.offers.push(A),d.offers=[A]}return d}toPaymentMode(d){return d.price_amount_micros===0?n.PaymentMode.FREE_TRIAL:d.recurrence_mode===e.Bridge.RecurrenceMode.NON_RECURRING?n.PaymentMode.UP_FRONT:n.PaymentMode.PAY_AS_YOU_GO}toRecurrenceMode(d){switch(d){case e.Bridge.RecurrenceMode.FINITE_RECURRING:return n.RecurrenceMode.FINITE_RECURRING;case e.Bridge.RecurrenceMode.INFINITE_RECURRING:return n.RecurrenceMode.INFINITE_RECURRING;case e.Bridge.RecurrenceMode.NON_RECURRING:return n.RecurrenceMode.NON_RECURRING}}toPricingPhase(d){return{price:d.formatted_price,priceMicros:d.price_amount_micros,currency:d.price_currency_code,billingPeriod:d.billing_period,billingCycles:d.billing_cycle_count,recurrenceMode:this.toRecurrenceMode(d.recurrence_mode),paymentMode:this.toPaymentMode(d)}}}e.Products=l})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){(function(r){r.SUBSCRIPTION_NO_LONGER_AVAILABLE="subscriptionPurchaseNoLongerAvailable",r.PURCHASE_TOKEN_NO_LONGER_VALID="purchaseTokenNoLongerValid"})(t.GoogleErrorReason||(t.GoogleErrorReason={})),(function(r){r[r.GONE=410]="GONE"})(t.ErrorCode||(t.ErrorCode={}))})(e.PublisherAPI||(e.PublisherAPI={}))})(n.GooglePlay||(n.GooglePlay={}))})(H||(H={}));var H;(function(n){(function(e){const t=n.Platform.TEST;let r=[];function a(d){d.products.forEach(h=>{var m,g,_,v;const T=r.find(A=>h.id===A.id),I={id:h.id,purchaseDate:(m=d.purchaseDate)===null||m===void 0?void 0:m.getTime(),expiryDate:(g=d.expirationDate)===null||g===void 0?void 0:g.getTime(),lastRenewalDate:(_=d.lastRenewalDate)===null||_===void 0?void 0:_.getTime(),renewalIntent:d.renewalIntent,renewalIntentChangeDate:(v=d.renewalIntentChangeDate)===null||v===void 0?void 0:v.getTime()};T?Object.assign(T,I):r.push(I)})}class l{constructor(h){this.id=n.Platform.TEST,this.name="Test",this.ready=!1,this.products=[],this.receipts=[],this.supportsParallelLoading=!0,this.context=h,this.log=h.log.child("Test")}get isSupported(){return!0}initialize(){return we(this,void 0,void 0,function*(){})}loadReceipts(){return we(this,void 0,void 0,function*(){return new Promise(h=>{setTimeout(()=>{this.context.listener.receiptsReady(n.Platform.TEST),h(this.receipts)},600)})})}loadProducts(h){return we(this,void 0,void 0,function*(){return h.map(m=>{if(!e.testProductsArray.find(v=>v.id===m.id&&v.type===m.type))return c(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"This product is not available",m.id);const g=this.products.find(v=>v.id===m.id);if(g)return g;m.id===e.testProducts.PAID_SUBSCRIPTION_ACTIVE.id&&setTimeout(()=>{this.reportActiveSubscription()},500);const _=e.initTestProduct(m.id,this.context.apiDecorators);return _?(this.products.push(_),this.context.listener.productsUpdated(n.Platform.TEST,[_]),_):c(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"Could not load this product",m.id)})})}order(h){return we(this,void 0,void 0,function*(){if(h.id.indexOf("-fail-")>0)return c(n.ErrorCode.PURCHASE,"Purchase failed.",h.productId);const m=this.products.find(T=>T.id===h.productId);if(!n.Internal.LocalReceipts.canPurchase(this.receipts,m))return c(n.ErrorCode.PURCHASE,"Product already owned",h.productId);const g=prompt(`Do you want to purchase ${h.productId} for ${h.pricingPhases[0].price}?
Enter "Y" to confirm.
Enter "E" to fail with an error.Anything else to cancel.`);if((g==null?void 0:g.toUpperCase())==="E")return c(n.ErrorCode.PURCHASE,"Purchase failed",h.productId);if((g==null?void 0:g.toUpperCase())!=="Y")return c(n.ErrorCode.PAYMENT_CANCELLED,"Purchase flow has been cancelled by the user",h.productId);const _=new n.Receipt(t,this.context.apiDecorators),v=new n.Transaction(t,_,this.context.apiDecorators);_.transactions=[v],v.products=[{id:h.productId,offerId:h.id}],v.state=n.TransactionState.APPROVED,v.purchaseDate=new Date,v.transactionId=h.productId+"-"+new Date().getTime(),v.isAcknowledged=!1,h.productType===n.ProductType.PAID_SUBSCRIPTION&&(v.expirationDate=new Date(+new Date+6048e5),v.renewalIntent=n.RenewalIntent.RENEW),a(v),this.receipts.push(_),this.context.listener.receiptsUpdated(n.Platform.TEST,[_])})}finish(h){return new Promise(m=>{setTimeout(()=>{h.state=n.TransactionState.FINISHED,h.isAcknowledged=!0,a(h);const g=this.products.find(v=>h.products[0].id===v.id);(g==null?void 0:g.type)===n.ProductType.CONSUMABLE&&(h.isConsumed=!0);const _=this.receipts.filter(v=>v.hasTransaction(h));this.context.listener.receiptsUpdated(t,_),m(void 0)},500)})}receiptValidationBody(h){return we(this,void 0,void 0,function*(){})}handleReceiptValidationResponse(h,m){return we(this,void 0,void 0,function*(){})}requestPayment(h,m){var g;return we(this,void 0,void 0,function*(){yield n.Utils.asyncDelay(100);const _=prompt(`Mock payment of ${((g=h.amountMicros)!==null&&g!==void 0?g:0)/1e6} ${h.currency}. Enter "Y" to confirm. Enter "E" to trigger an error.`);if((_==null?void 0:_.toUpperCase())==="E")return c(n.ErrorCode.PAYMENT_NOT_ALLOWED,"Payment not allowed",null);if((_==null?void 0:_.toUpperCase())!=="Y")return;const v=new n.Receipt(t,this.context.apiDecorators),T=new n.Transaction(n.Platform.TEST,v,this.context.apiDecorators);return T.purchaseDate=new Date,T.products=h.items.filter(I=>I).map(I=>({id:(I==null?void 0:I.id)||""})),T.state=n.TransactionState.APPROVED,T.transactionId="payment-"+new Date().getTime(),T.amountMicros=h.amountMicros,T.currency=h.currency,v.transactions=[T],this.receipts.push(v),setTimeout(()=>{this.context.listener.receiptsUpdated(t,[v])},400),T})}manageSubscriptions(){return we(this,void 0,void 0,function*(){alert("Pseudo subscription management interface. Close it when you are done.")})}manageBilling(){return we(this,void 0,void 0,function*(){alert("Pseudo billing management interface. Close it when you are done.")})}reportActiveSubscription(){if(this.receipts.find(T=>T.transactions[0].transactionId===_(1)))return;const h=2*6e4,m=new n.Receipt(t,this.context.apiDecorators),g=T=>{var I,A;const C=new n.Transaction(t,m,this.context.apiDecorators);C.products=[{id:e.testProducts.PAID_SUBSCRIPTION_ACTIVE.id,offerId:e.testProducts.PAID_SUBSCRIPTION_ACTIVE.extra.offerId}],C.state=n.TransactionState.APPROVED,C.transactionId=_(T),C.isAcknowledged=T==1,C.renewalIntent=n.RenewalIntent.RENEW;const L=+(((A=(I=m==null?void 0:m.transactions)===null||I===void 0?void 0:I[0])===null||A===void 0?void 0:A.purchaseDate)||new Date);return C.purchaseDate=new Date(L),C.lastRenewalDate=new Date(L+h*(T-1)),C.expirationDate=new Date(L+h*T),a(C),C};m.transactions.push(g(1)),this.receipts.push(m),this.context.listener.receiptsUpdated(n.Platform.TEST,[m]);function _(T){return"test-active-subscription-transaction-"+T}let v=1;setInterval(()=>{this.log.info("auto-renewing the mock subscription"),v+=1,m.transactions.push(g(v)),this.context.listener.receiptsUpdated(n.Platform.TEST,[m])},h)}static verify(h,m){setTimeout(()=>{var g,_;m({receipt:h,payload:{ok:!0,data:{id:(_=(g=h.transactions[0])===null||g===void 0?void 0:g.products[0])===null||_===void 0?void 0:_.id,latest_receipt:!0,transaction:{type:"test"},collection:r}}})},500)}checkSupport(h){return!0}restorePurchases(){return we(this,void 0,void 0,function*(){})}}e.Adapter=l;function c(d,h,m){return n.storeError(d,h,n.Platform.TEST,m)}})(n.Test||(n.Test={}))})(H||(H={}));var H;(function(n){(function(e){const t=n.Platform.TEST;e.testProducts={CONSUMABLE:{platform:t,id:"test-consumable",type:n.ProductType.CONSUMABLE},CONSUMABLE_FAILING:{platform:t,id:"test-consumable-fail",type:n.ProductType.CONSUMABLE},NON_CONSUMABLE:{platform:t,id:"test-non-consumable",type:n.ProductType.NON_CONSUMABLE},PAID_SUBSCRIPTION:{platform:t,id:"test-subscription",type:n.ProductType.PAID_SUBSCRIPTION},PAID_SUBSCRIPTION_ACTIVE:{platform:t,id:"test-subscription-active",type:n.ProductType.PAID_SUBSCRIPTION,extra:{offerId:"test-paid-subscription-active-offer1"}}},e.testProductsArray=n.Utils.objectValues(e.testProducts);function r(a,l){const c=Object.keys(e.testProducts).find(h=>e.testProducts[h]&&e.testProducts[h].id===a);if(!c)return;const d=new n.Product(e.testProducts[c],l);switch(c){case"CONSUMABLE":d.title="Test Consumable",d.description="A consumable product that you can purchase",d.addOffer(new n.Offer({id:"test-consumable-offer1",pricingPhases:[{price:"$4.99",currency:"USD",priceMicros:499e4,paymentMode:n.PaymentMode.UP_FRONT,recurrenceMode:n.RecurrenceMode.NON_RECURRING}],product:d},l));break;case"CONSUMABLE_FAILING":d.title="Failing Consumable",d.description="A consumable product that cannot be purchased",d.addOffer(new n.Offer({id:"test-consumable-fail-offer1",pricingPhases:[{price:"$1.99",currency:"USD",priceMicros:199e4,paymentMode:n.PaymentMode.UP_FRONT,recurrenceMode:n.RecurrenceMode.NON_RECURRING}],product:d},l));break;case"NON_CONSUMABLE":d.title="Non Consumable",d.description="A non consumable product",d.addOffer(new n.Offer({id:"test-non-consumable-offer1",pricingPhases:[{price:"$9.99",currency:"USD",priceMicros:999e4,paymentMode:n.PaymentMode.UP_FRONT,recurrenceMode:n.RecurrenceMode.NON_RECURRING}],product:d},l));break;case"PAID_SUBSCRIPTION":d.title="A subscription product",d.description="An auto-renewing paid subscription with a trial period",d.addOffer(new n.Offer({id:"test-paid-subscription-offer1",product:d,pricingPhases:[{price:"$0.00",currency:"USD",priceMicros:0,paymentMode:n.PaymentMode.FREE_TRIAL,recurrenceMode:n.RecurrenceMode.FINITE_RECURRING,billingCycles:3,billingPeriod:"P1W"},{price:"$4.99",currency:"USD",priceMicros:499e4,paymentMode:n.PaymentMode.PAY_AS_YOU_GO,recurrenceMode:n.RecurrenceMode.INFINITE_RECURRING,billingPeriod:"P1M"}]},l));break;case"PAID_SUBSCRIPTION_ACTIVE":d.title="An owned subscription product",d.description="An active paid subscription",d.addOffer(new n.Offer({id:e.testProducts.PAID_SUBSCRIPTION_ACTIVE.extra.offerId,product:d,pricingPhases:[{price:"$19.99",currency:"USD",priceMicros:1999e4,paymentMode:n.PaymentMode.PAY_AS_YOU_GO,recurrenceMode:n.RecurrenceMode.INFINITE_RECURRING,billingPeriod:"P1Y"}]},l));break;default:const h=c;throw new Error(`Unhandled enum case: ${h}`)}return d}e.initTestProduct=r})(n.Test||(n.Test={}))})(H||(H={}));var H;(function(n){(function(e){class t{constructor(){this.id=n.Platform.WINDOWS_STORE,this.name="WindowsStore",this.ready=!1,this.supportsParallelLoading=!1,this.products=[],this.receipts=[]}initialize(){return we(this,void 0,void 0,function*(){})}get isSupported(){return!1}loadProducts(l){return we(this,void 0,void 0,function*(){return l.map(c=>r(n.ErrorCode.PRODUCT_NOT_AVAILABLE,"TODO",c.id))})}loadReceipts(){return we(this,void 0,void 0,function*(){return[]})}order(l){return we(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"TODO: Not implemented",l.productId)})}finish(l){return we(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"TODO: Not implemented",null)})}handleReceiptValidationResponse(l,c){return we(this,void 0,void 0,function*(){})}receiptValidationBody(l){return we(this,void 0,void 0,function*(){})}requestPayment(l,c){return we(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"requestPayment not supported",null)})}manageSubscriptions(){return we(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"manageSubscriptions not supported",null)})}manageBilling(){return we(this,void 0,void 0,function*(){return r(n.ErrorCode.UNKNOWN,"manageBilling not supported",null)})}checkSupport(l){return!1}restorePurchases(){return we(this,void 0,void 0,function*(){})}}e.Adapter=t;function r(a,l,c){return n.storeError(a,l,n.Platform.WINDOWS_STORE,c)}})(n.WindowsStore||(n.WindowsStore={}))})(H||(H={}));var H;(function(n){(function(e){let t;(function(l){l.HTTP_REQUEST_TIMEOUT=408})(t=e.Ajax||(e.Ajax={}));function r(l,c){if(typeof window<"u"&&window.cordova&&window.cordova.plugin&&window.cordova.plugin.http)return a(l,c);var d=function(){},h=new XMLHttpRequest;c.timeout&&(h.timeout=c.timeout,h.ontimeout=function(){l.warn("ajax -> request to "+c.url+" timeout"),e.callExternal(l,"ajax.error",c.error,t.HTTP_REQUEST_TIMEOUT,"Timeout")}),h.open(c.method||"POST",c.url,!0),h.onreadystatechange=function(){try{h.readyState===4&&(h.status===200?e.callExternal(l,"ajax.success",c.success,JSON.parse(h.responseText)):(l.warn("ajax -> request to "+c.url+" failed with status "+h.status+" ("+h.statusText+")"),e.callExternal(l,"ajax.error",c.error,h.status,h.statusText)))}catch(g){l.warn("ajax -> request to "+c.url+" failed with an exception: "+g.message),c.error&&c.error(417,g.message,null)}h.readyState===4&&e.callExternal(l,"ajax.done",d)};const m=c.customHeaders;return m&&Object.keys(m).forEach(function(g){l.debug("ajax -> adding custom header: "+g),h.setRequestHeader(g,m[g])}),h.setRequestHeader("Accept","application/json"),l.debug("ajax -> send request to "+c.url),c.data?(h.setRequestHeader("Content-Type","application/json;charset=UTF-8"),h.send(JSON.stringify(c.data))):h.send(),{done:function(g){return d=g,this}}}e.ajax=r;function a(l,c){let d=function(){};const h={method:(c.method||"get").toLowerCase(),data:c.data,serializer:"json"};c.customHeaders&&(l.debug("ajax[http] -> adding custom headers: "+JSON.stringify(c.customHeaders)),h.headers=c.customHeaders),l.debug("ajax[http] -> send request to "+c.url);const m=g=>{try{g.status==200?e.callExternal(l,"ajax.success",c.success,JSON.parse(g.data)):(l.warn("ajax[http] -> request to "+c.url+" failed with status "+g.status+" ("+g.error+")"),e.callExternal(l,"ajax.error",c.error,g.status,g.error))}catch(_){l.warn("ajax[http] -> request to "+c.url+" failed with an exception: "+_.message),c.error&&e.callExternal(l,"ajax.error",c.error,417,_.message)}e.callExternal(l,"ajax.done",d)};return window.cordova.plugin.http.sendRequest(c.url,h,m,m),{done:function(g){return d=g,this}}}})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(r,a,l,...c){try{const d=Array.prototype.slice.call(arguments,3);l&&l.apply(n.store,d)}catch(d){r.logCallbackException(a,d)}}e.callExternal=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(c,d){return setTimeout(c,d)}e.delay=t;function r(c,d){return a(c,d).call}e.debounce=r;function a(c,d){let h=null,m=[];const g=function(v,T){const I=m;m=[],h=null,c(),I.forEach(A=>A())};return{call:function(){h&&window.clearTimeout(h),h=setTimeout(g,d)},wait:()=>new Promise(v=>{h?m.push(v):v()})}}e.createDebouncer=a;function l(c){return new Promise(d=>setTimeout(d,c))}e.asyncDelay=l})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(a){switch(r(a)){case n.RecurrenceMode.FINITE_RECURRING:return`${a.billingCycles}x ${e.formatDurationEN(a.billingPeriod)}`;case n.RecurrenceMode.NON_RECURRING:return"for "+e.formatDurationEN(a.billingPeriod);default:return"every "+e.formatDurationEN(a.billingPeriod,{omitOne:!0})}}e.formatBillingCycleEN=t;function r(a){var l;const c=(l=a.billingCycles)!==null&&l!==void 0?l:0;if(a.recurrenceMode===n.RecurrenceMode.FINITE_RECURRING){if(c==1)return n.RecurrenceMode.NON_RECURRING;if(c<=0)return n.RecurrenceMode.INFINITE_RECURRING}return a.recurrenceMode}})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(r,a){if(!r)return"";const l=r.length,c=r.slice(1,l-1);if(c==="1")return a!=null&&a.omitOne?{D:"day",W:"week",M:"month",Y:"year"}[r[l-1]]||r[l-1]:{D:"1 day",W:"1 week",M:"1 month",Y:"1 year"}[r[l-1]]||r[l-1];{const d={D:"days",W:"weeks",M:"months",Y:"years"}[r[l-1]]||r[l-1];return`${c} ${d}`}}e.formatDurationEN=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){const t="0123456789abcdef".split("");function r(A){for(var C="",L=0;L<4;L++)C+=t[A>>8*L+4&15]+t[A>>8*L&15];return C}function a(A){const C=[];for(var L=A.length,x=0;x<L;x++)C.push(r(A[x]));return C.join("")}function l(A,C){return A+C&4294967295}function c(A,C,L,x,U,z,$){function se(P,N,M){return l(P<<N|P>>>32-N,M)}function D(P,N,M,B){return l(l(N,P),l(M,B))}return se(D(A,C,x,z),U,L)}var d=function(A,C,L,x,U,z,$,se){return c(L&x|~L&U,C,L,z,$,se)},h=function(A,C,L,x,U,z,$,se){return c(L&U|x&~U,C,L,z,$,se)},m=function(A,C,L,x,U,z,$,se){return c(L^x^U,C,L,z,$,se)},g=function(A,C,L,x,U,z,$,se){return c(x^(L|~U),C,L,z,$,se)};function _(A,C,L){L||(L=l);let x=A[0],U=A[1],z=A[2],$=A[3];var se=d.bind(null,L);x=se(x,U,z,$,C[0],7,-680876936),$=se($,x,U,z,C[1],12,-389564586),z=se(z,$,x,U,C[2],17,606105819),U=se(U,z,$,x,C[3],22,-1044525330),x=se(x,U,z,$,C[4],7,-176418897),$=se($,x,U,z,C[5],12,1200080426),z=se(z,$,x,U,C[6],17,-1473231341),U=se(U,z,$,x,C[7],22,-45705983),x=se(x,U,z,$,C[8],7,1770035416),$=se($,x,U,z,C[9],12,-1958414417),z=se(z,$,x,U,C[10],17,-42063),U=se(U,z,$,x,C[11],22,-1990404162),x=se(x,U,z,$,C[12],7,1804603682),$=se($,x,U,z,C[13],12,-40341101),z=se(z,$,x,U,C[14],17,-1502002290),U=se(U,z,$,x,C[15],22,1236535329);var D=h.bind(null,L);x=D(x,U,z,$,C[1],5,-165796510),$=D($,x,U,z,C[6],9,-1069501632),z=D(z,$,x,U,C[11],14,643717713),U=D(U,z,$,x,C[0],20,-373897302),x=D(x,U,z,$,C[5],5,-701558691),$=D($,x,U,z,C[10],9,38016083),z=D(z,$,x,U,C[15],14,-660478335),U=D(U,z,$,x,C[4],20,-405537848),x=D(x,U,z,$,C[9],5,568446438),$=D($,x,U,z,C[14],9,-1019803690),z=D(z,$,x,U,C[3],14,-187363961),U=D(U,z,$,x,C[8],20,1163531501),x=D(x,U,z,$,C[13],5,-1444681467),$=D($,x,U,z,C[2],9,-51403784),z=D(z,$,x,U,C[7],14,1735328473),U=D(U,z,$,x,C[12],20,-1926607734);var P=m.bind(null,L);x=P(x,U,z,$,C[5],4,-378558),$=P($,x,U,z,C[8],11,-2022574463),z=P(z,$,x,U,C[11],16,1839030562),U=P(U,z,$,x,C[14],23,-35309556),x=P(x,U,z,$,C[1],4,-1530992060),$=P($,x,U,z,C[4],11,1272893353),z=P(z,$,x,U,C[7],16,-155497632),U=P(U,z,$,x,C[10],23,-1094730640),x=P(x,U,z,$,C[13],4,681279174),$=P($,x,U,z,C[0],11,-358537222),z=P(z,$,x,U,C[3],16,-722521979),U=P(U,z,$,x,C[6],23,76029189),x=P(x,U,z,$,C[9],4,-640364487),$=P($,x,U,z,C[12],11,-421815835),z=P(z,$,x,U,C[15],16,530742520),U=P(U,z,$,x,C[2],23,-995338651);var N=g.bind(null,L);x=N(x,U,z,$,C[0],6,-198630844),$=N($,x,U,z,C[7],10,1126891415),z=N(z,$,x,U,C[14],15,-1416354905),U=N(U,z,$,x,C[5],21,-57434055),x=N(x,U,z,$,C[12],6,1700485571),$=N($,x,U,z,C[3],10,-1894986606),z=N(z,$,x,U,C[10],15,-1051523),U=N(U,z,$,x,C[1],21,-2054922799),x=N(x,U,z,$,C[8],6,1873313359),$=N($,x,U,z,C[15],10,-30611744),z=N(z,$,x,U,C[6],15,-1560198380),U=N(U,z,$,x,C[13],21,1309151649),x=N(x,U,z,$,C[4],6,-145523070),$=N($,x,U,z,C[11],10,-1120210379),z=N(z,$,x,U,C[2],15,718787259),U=N(U,z,$,x,C[9],21,-343485551),A[0]=L(x,A[0]),A[1]=L(U,A[1]),A[2]=L(z,A[2]),A[3]=L($,A[3])}function v(A){for(var C=[],L=0;L<64;L+=4)C[L>>2]=A.charCodeAt(L)+(A.charCodeAt(L+1)<<8)+(A.charCodeAt(L+2)<<16)+(A.charCodeAt(L+3)<<24);return C}function T(A,C){let L;const x=A.length,U=[1732584193,-271733879,-1732584194,271733878];for(L=64;L<=x;L+=64)_(U,v(A.substring(L-64,L)),C);const z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$=(A=A.substring(L-64)).length;let se;for(se=0;se<$;se++)z[se>>2]|=A.charCodeAt(se)<<(se%4<<3);if(z[se>>2]|=128<<(se%4<<3),se>55)for(_(U,z,C),se=16;se--;)z[se]=0;return z[14]=8*x,_(U,z,C),U}function I(A){if(!A)return"";let C;return a(T("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(C=function(L,x){const U=(65535&L)+(65535&x);return(L>>16)+(x>>16)+(U>>16)<<16|65535&U}),a(T(A,C))}e.md5=I})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(){var r,a,l;return!((r=window.cordova)===null||r===void 0)&&r.platformId?(a=window.cordova)===null||a===void 0?void 0:a.platformId:!((l=window.Capacitor)===null||l===void 0)&&l.getPlatform?window.Capacitor.getPlatform():"web"}e.platformId=t})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(a,l,c,d,h){return function(m){r(a,l,c,m,d,h)}}e.safeCallback=t;function r(a,l,c,d,h,m){c&&(h||(h=c.name||"#"+e.md5(c.toString())),setTimeout(()=>{try{a.debug(`Calling callback: type=${l} name=${h} reason=${m}`),c(d)}catch(g){a.error(`Error in callback: type=${l} name=${h} reason=${m}`),a.debug(c.toString());const _=g;"message"in _&&a.error(_.message),"fileName"in g&&a.error("in "+g.fileName+":"+g.lineNumber),"stack"in _&&a.error(_.stack)}},0))}e.safeCall=r})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){function t(){return window.crypto||window.msCrypto}function r(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,function(a){return(a^t().getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16)})}e.uuidv4=r})(n.Utils||(n.Utils={}))})(H||(H={}));var H;(function(n){(function(e){(function(t){function r(d){return Object.prototype.toString.call(d)==="[object Array]"}function a(d){return Object.prototype.toString.call(d)==="[object Object]"}function l(d){return typeof d.validator_privacy_policy=="string"?d.validator_privacy_policy.split(","):r(d.validator_privacy_policy)?d.validator_privacy_policy:["analytics","support","fraud"]}function c(d){const h=l(d);function m(I){return h.indexOf(I)>=0}const g={plugin:"cordova-plugin-purchase/"+n.PLUGIN_VERSION},_=window,v=a(_.device)?_.device:{};if(m("analytics")||m("support")){const I=_.Ionic||_.ionic;I&&I.version&&(g.ionic=I.version),v.cordova&&(g.cordova=v.cordova),v.model&&(g.model=v.model),v.platform&&(g.platform=v.platform),v.version&&(g.version=v.version),v.manufacturer&&(g.manufacturer=v.manufacturer)}if(m("tracking")&&(v.serial&&(g.serial=v.serial),v.uuid&&(g.uuid=v.uuid)),v.isVirtual&&(g.isVirtual=v.isVirtual),m("fraud")){var T="";v.serial?T="serial:"+v.serial:v.uuid?T="uuid:"+v.uuid:(v.model&&(T+="/"+v.model),v.manufacturer&&(T="/"+v.manufacturer)),T&&(g.fingerprint=n.Utils.md5(T))}return g}t.getDeviceInfo=c})(e.Internal||(e.Internal={}))})(n.Validator||(n.Validator={}))})(H||(H={}));var H;(function(n){(function(e){e.Request||(e.Request={})})(n.Validator||(n.Validator={}))})(H||(H={}));var H;(function(n){class e{constructor(r,a,l){var c;this.className="VerifiedReceipt",this.id=a.id,this.sourceReceipt=r,this.collection=(c=a.collection)!==null&&c!==void 0?c:[],this.latestReceipt=a.latest_receipt,this.nativeTransactions=[a.transaction],this.warning=a.warning,this.validationDate=a.date?new Date(a.date):new Date,Object.defineProperty(this,"raw",{enumerable:!1,get(){return a}}),Object.defineProperty(this,"finish",{enumerable:!1,get(){return()=>l.finish(this)}})}get platform(){return this.sourceReceipt.platform}get raw(){return{}}set(r,a){var l;this.id=a.id,this.sourceReceipt=r,this.collection=(l=a.collection)!==null&&l!==void 0?l:[],this.latestReceipt=a.latest_receipt,this.nativeTransactions=[a.transaction],this.warning=a.warning}finish(){return we(this,void 0,void 0,function*(){})}}n.VerifiedReceipt=e})(H||(H={}));function Tw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var dp={exports:{}},bc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function DI(){if(Jv)return bc;Jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:n,type:r,key:c,ref:a!==void 0?a:null,props:l}}return bc.Fragment=e,bc.jsx=t,bc.jsxs=t,bc}var Zv;function kI(){return Zv||(Zv=1,dp.exports=DI()),dp.exports}var S=kI(),hp={exports:{}},Qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eE;function MI(){if(eE)return Qe;eE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),v=Symbol.iterator;function T(j){return j===null||typeof j!="object"?null:(j=v&&j[v]||j["@@iterator"],typeof j=="function"?j:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,C={};function L(j,K,ue){this.props=j,this.context=K,this.refs=C,this.updater=ue||I}L.prototype.isReactComponent={},L.prototype.setState=function(j,K){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,K,"setState")},L.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function x(){}x.prototype=L.prototype;function U(j,K,ue){this.props=j,this.context=K,this.refs=C,this.updater=ue||I}var z=U.prototype=new x;z.constructor=U,A(z,L.prototype),z.isPureReactComponent=!0;var $=Array.isArray;function se(){}var D={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function N(j,K,ue){var pe=ue.ref;return{$$typeof:n,type:j,key:K,ref:pe!==void 0?pe:null,props:ue}}function M(j,K){return N(j.type,K,j.props)}function B(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function G(j){var K={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(ue){return K[ue]})}var k=/\/+/g;function Ve(j,K){return typeof j=="object"&&j!==null&&j.key!=null?G(""+j.key):K.toString(36)}function et(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(se,se):(j.status="pending",j.then(function(K){j.status==="pending"&&(j.status="fulfilled",j.value=K)},function(K){j.status==="pending"&&(j.status="rejected",j.reason=K)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function te(j,K,ue,pe,Pe){var ze=typeof j;(ze==="undefined"||ze==="boolean")&&(j=null);var tt=!1;if(j===null)tt=!0;else switch(ze){case"bigint":case"string":case"number":tt=!0;break;case"object":switch(j.$$typeof){case n:case e:tt=!0;break;case g:return tt=j._init,te(tt(j._payload),K,ue,pe,Pe)}}if(tt)return Pe=Pe(j),tt=pe===""?"."+Ve(j,0):pe,$(Pe)?(ue="",tt!=null&&(ue=tt.replace(k,"$&/")+"/"),te(Pe,K,ue,"",function(Je){return Je})):Pe!=null&&(B(Pe)&&(Pe=M(Pe,ue+(Pe.key==null||j&&j.key===Pe.key?"":(""+Pe.key).replace(k,"$&/")+"/")+tt)),K.push(Pe)),1;tt=0;var Mt=pe===""?".":pe+":";if($(j))for(var vt=0;vt<j.length;vt++)pe=j[vt],ze=Mt+Ve(pe,vt),tt+=te(pe,K,ue,ze,Pe);else if(vt=T(j),typeof vt=="function")for(j=vt.call(j),vt=0;!(pe=j.next()).done;)pe=pe.value,ze=Mt+Ve(pe,vt++),tt+=te(pe,K,ue,ze,Pe);else if(ze==="object"){if(typeof j.then=="function")return te(et(j),K,ue,pe,Pe);throw K=String(j),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return tt}function he(j,K,ue){if(j==null)return j;var pe=[],Pe=0;return te(j,pe,"","",function(ze){return K.call(ue,ze,Pe++)}),pe}function Ie(j){if(j._status===-1){var K=j._result;K=K(),K.then(function(ue){(j._status===0||j._status===-1)&&(j._status=1,j._result=ue)},function(ue){(j._status===0||j._status===-1)&&(j._status=2,j._result=ue)}),j._status===-1&&(j._status=0,j._result=K)}if(j._status===1)return j._result.default;throw j._result}var je=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},Ke={map:he,forEach:function(j,K,ue){he(j,function(){K.apply(this,arguments)},ue)},count:function(j){var K=0;return he(j,function(){K++}),K},toArray:function(j){return he(j,function(K){return K})||[]},only:function(j){if(!B(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return Qe.Activity=_,Qe.Children=Ke,Qe.Component=L,Qe.Fragment=t,Qe.Profiler=a,Qe.PureComponent=U,Qe.StrictMode=r,Qe.Suspense=h,Qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Qe.__COMPILER_RUNTIME={__proto__:null,c:function(j){return D.H.useMemoCache(j)}},Qe.cache=function(j){return function(){return j.apply(null,arguments)}},Qe.cacheSignal=function(){return null},Qe.cloneElement=function(j,K,ue){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var pe=A({},j.props),Pe=j.key;if(K!=null)for(ze in K.key!==void 0&&(Pe=""+K.key),K)!P.call(K,ze)||ze==="key"||ze==="__self"||ze==="__source"||ze==="ref"&&K.ref===void 0||(pe[ze]=K[ze]);var ze=arguments.length-2;if(ze===1)pe.children=ue;else if(1<ze){for(var tt=Array(ze),Mt=0;Mt<ze;Mt++)tt[Mt]=arguments[Mt+2];pe.children=tt}return N(j.type,Pe,pe)},Qe.createContext=function(j){return j={$$typeof:c,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:l,_context:j},j},Qe.createElement=function(j,K,ue){var pe,Pe={},ze=null;if(K!=null)for(pe in K.key!==void 0&&(ze=""+K.key),K)P.call(K,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(Pe[pe]=K[pe]);var tt=arguments.length-2;if(tt===1)Pe.children=ue;else if(1<tt){for(var Mt=Array(tt),vt=0;vt<tt;vt++)Mt[vt]=arguments[vt+2];Pe.children=Mt}if(j&&j.defaultProps)for(pe in tt=j.defaultProps,tt)Pe[pe]===void 0&&(Pe[pe]=tt[pe]);return N(j,ze,Pe)},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function(j){return{$$typeof:d,render:j}},Qe.isValidElement=B,Qe.lazy=function(j){return{$$typeof:g,_payload:{_status:-1,_result:j},_init:Ie}},Qe.memo=function(j,K){return{$$typeof:m,type:j,compare:K===void 0?null:K}},Qe.startTransition=function(j){var K=D.T,ue={};D.T=ue;try{var pe=j(),Pe=D.S;Pe!==null&&Pe(ue,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(se,je)}catch(ze){je(ze)}finally{K!==null&&ue.types!==null&&(K.types=ue.types),D.T=K}},Qe.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Qe.use=function(j){return D.H.use(j)},Qe.useActionState=function(j,K,ue){return D.H.useActionState(j,K,ue)},Qe.useCallback=function(j,K){return D.H.useCallback(j,K)},Qe.useContext=function(j){return D.H.useContext(j)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function(j,K){return D.H.useDeferredValue(j,K)},Qe.useEffect=function(j,K){return D.H.useEffect(j,K)},Qe.useEffectEvent=function(j){return D.H.useEffectEvent(j)},Qe.useId=function(){return D.H.useId()},Qe.useImperativeHandle=function(j,K,ue){return D.H.useImperativeHandle(j,K,ue)},Qe.useInsertionEffect=function(j,K){return D.H.useInsertionEffect(j,K)},Qe.useLayoutEffect=function(j,K){return D.H.useLayoutEffect(j,K)},Qe.useMemo=function(j,K){return D.H.useMemo(j,K)},Qe.useOptimistic=function(j,K){return D.H.useOptimistic(j,K)},Qe.useReducer=function(j,K,ue){return D.H.useReducer(j,K,ue)},Qe.useRef=function(j){return D.H.useRef(j)},Qe.useState=function(j){return D.H.useState(j)},Qe.useSyncExternalStore=function(j,K,ue){return D.H.useSyncExternalStore(j,K,ue)},Qe.useTransition=function(){return D.H.useTransition()},Qe.version="19.2.3",Qe}var tE;function Sg(){return tE||(tE=1,hp.exports=MI()),hp.exports}var ee=Sg();const wg=Tw(ee);var fp={exports:{}},Tc={},mp={exports:{}},pp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nE;function LI(){return nE||(nE=1,(function(n){function e(te,he){var Ie=te.length;te.push(he);e:for(;0<Ie;){var je=Ie-1>>>1,Ke=te[je];if(0<a(Ke,he))te[je]=he,te[Ie]=Ke,Ie=je;else break e}}function t(te){return te.length===0?null:te[0]}function r(te){if(te.length===0)return null;var he=te[0],Ie=te.pop();if(Ie!==he){te[0]=Ie;e:for(var je=0,Ke=te.length,j=Ke>>>1;je<j;){var K=2*(je+1)-1,ue=te[K],pe=K+1,Pe=te[pe];if(0>a(ue,Ie))pe<Ke&&0>a(Pe,ue)?(te[je]=Pe,te[pe]=Ie,je=pe):(te[je]=ue,te[K]=Ie,je=K);else if(pe<Ke&&0>a(Pe,Ie))te[je]=Pe,te[pe]=Ie,je=pe;else break e}}return he}function a(te,he){var Ie=te.sortIndex-he.sortIndex;return Ie!==0?Ie:te.id-he.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var h=[],m=[],g=1,_=null,v=3,T=!1,I=!1,A=!1,C=!1,L=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function z(te){for(var he=t(m);he!==null;){if(he.callback===null)r(m);else if(he.startTime<=te)r(m),he.sortIndex=he.expirationTime,e(h,he);else break;he=t(m)}}function $(te){if(A=!1,z(te),!I)if(t(h)!==null)I=!0,se||(se=!0,G());else{var he=t(m);he!==null&&et($,he.startTime-te)}}var se=!1,D=-1,P=5,N=-1;function M(){return C?!0:!(n.unstable_now()-N<P)}function B(){if(C=!1,se){var te=n.unstable_now();N=te;var he=!0;try{e:{I=!1,A&&(A=!1,x(D),D=-1),T=!0;var Ie=v;try{t:{for(z(te),_=t(h);_!==null&&!(_.expirationTime>te&&M());){var je=_.callback;if(typeof je=="function"){_.callback=null,v=_.priorityLevel;var Ke=je(_.expirationTime<=te);if(te=n.unstable_now(),typeof Ke=="function"){_.callback=Ke,z(te),he=!0;break t}_===t(h)&&r(h),z(te)}else r(h);_=t(h)}if(_!==null)he=!0;else{var j=t(m);j!==null&&et($,j.startTime-te),he=!1}}break e}finally{_=null,v=Ie,T=!1}he=void 0}}finally{he?G():se=!1}}}var G;if(typeof U=="function")G=function(){U(B)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,Ve=k.port2;k.port1.onmessage=B,G=function(){Ve.postMessage(null)}}else G=function(){L(B,0)};function et(te,he){D=L(function(){te(n.unstable_now())},he)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(te){switch(v){case 1:case 2:case 3:var he=3;break;default:he=v}var Ie=v;v=he;try{return te()}finally{v=Ie}},n.unstable_requestPaint=function(){C=!0},n.unstable_runWithPriority=function(te,he){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var Ie=v;v=te;try{return he()}finally{v=Ie}},n.unstable_scheduleCallback=function(te,he,Ie){var je=n.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?je+Ie:je):Ie=je,te){case 1:var Ke=-1;break;case 2:Ke=250;break;case 5:Ke=1073741823;break;case 4:Ke=1e4;break;default:Ke=5e3}return Ke=Ie+Ke,te={id:g++,callback:he,priorityLevel:te,startTime:Ie,expirationTime:Ke,sortIndex:-1},Ie>je?(te.sortIndex=Ie,e(m,te),t(h)===null&&te===t(m)&&(A?(x(D),D=-1):A=!0,et($,Ie-je))):(te.sortIndex=Ke,e(h,te),I||T||(I=!0,se||(se=!0,G()))),te},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(te){var he=v;return function(){var Ie=v;v=he;try{return te.apply(this,arguments)}finally{v=Ie}}}})(pp)),pp}var iE;function UI(){return iE||(iE=1,mp.exports=LI()),mp.exports}var gp={exports:{}},Un={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rE;function VI(){if(rE)return Un;rE=1;var n=Sg();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(h,m,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:_==null?null:""+_,children:h,containerInfo:m,implementation:g}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Un.createPortal=function(h,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(h,m,null,g)},Un.flushSync=function(h){var m=c.T,g=r.p;try{if(c.T=null,r.p=2,h)return h()}finally{c.T=m,r.p=g,r.d.f()}},Un.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(h,m))},Un.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Un.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var g=m.as,_=d(g,m.crossOrigin),v=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;g==="style"?r.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:v,fetchPriority:T}):g==="script"&&r.d.X(h,{crossOrigin:_,integrity:v,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Un.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var g=d(m.as,m.crossOrigin);r.d.M(h,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(h)},Un.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var g=m.as,_=d(g,m.crossOrigin);r.d.L(h,g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Un.preloadModule=function(h,m){if(typeof h=="string")if(m){var g=d(m.as,m.crossOrigin);r.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(h)},Un.requestFormReset=function(h){r.d.r(h)},Un.unstable_batchedUpdates=function(h,m){return h(m)},Un.useFormState=function(h,m,g){return c.H.useFormState(h,m,g)},Un.useFormStatus=function(){return c.H.useHostTransitionStatus()},Un.version="19.2.3",Un}var sE;function jI(){if(sE)return gp.exports;sE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gp.exports=VI(),gp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aE;function zI(){if(aE)return Tc;aE=1;var n=UI(),e=Sg(),t=jI();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var s=i,o=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(o=s.return),i=s.return;while(i)}return s.tag===3?o:null}function c(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function h(i){if(l(i)!==i)throw Error(r(188))}function m(i){var s=i.alternate;if(!s){if(s=l(i),s===null)throw Error(r(188));return s!==i?null:i}for(var o=i,u=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(u=p.return,u!==null){o=u;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return h(p),i;if(y===u)return h(p),s;y=y.sibling}throw Error(r(188))}if(o.return!==u.return)o=p,u=y;else{for(var w=!1,R=p.child;R;){if(R===o){w=!0,o=p,u=y;break}if(R===u){w=!0,u=p,o=y;break}R=R.sibling}if(!w){for(R=y.child;R;){if(R===o){w=!0,o=y,u=p;break}if(R===u){w=!0,u=y,o=p;break}R=R.sibling}if(!w)throw Error(r(189))}}if(o.alternate!==u)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?i:s}function g(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=g(i),s!==null)return s;i=i.sibling}return null}var _=Object.assign,v=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),U=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function G(i){return i===null||typeof i!="object"?null:(i=B&&i[B]||i["@@iterator"],typeof i=="function"?i:null)}var k=Symbol.for("react.client.reference");function Ve(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===k?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case A:return"Fragment";case L:return"Profiler";case C:return"StrictMode";case $:return"Suspense";case se:return"SuspenseList";case N:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case I:return"Portal";case U:return i.displayName||"Context";case x:return(i._context.displayName||"Context")+".Consumer";case z:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return s=i.displayName||null,s!==null?s:Ve(i.type)||"Memo";case P:s=i._payload,i=i._init;try{return Ve(i(s))}catch{}}return null}var et=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},je=[],Ke=-1;function j(i){return{current:i}}function K(i){0>Ke||(i.current=je[Ke],je[Ke]=null,Ke--)}function ue(i,s){Ke++,je[Ke]=i.current,i.current=s}var pe=j(null),Pe=j(null),ze=j(null),tt=j(null);function Mt(i,s){switch(ue(ze,s),ue(Pe,i),ue(pe,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?Ev(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=Ev(s),i=Sv(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}K(pe),ue(pe,i)}function vt(){K(pe),K(Pe),K(ze)}function Je(i){i.memoizedState!==null&&ue(tt,i);var s=pe.current,o=Sv(s,i.type);s!==o&&(ue(Pe,i),ue(pe,o))}function Rt(i){Pe.current===i&&(K(pe),K(Pe)),tt.current===i&&(K(tt),vc._currentValue=Ie)}var ot,Ft;function Xt(i){if(ot===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);ot=s&&s[1]||"",Ft=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ot+i+Ft}var Re=!1;function oe(i,s){if(!i||Re)return"";Re=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(ne){var Z=ne}Reflect.construct(i,[],de)}else{try{de.call()}catch(ne){Z=ne}i.call(de.prototype)}}else{try{throw Error()}catch(ne){Z=ne}(de=i())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(ne){if(ne&&Z&&typeof ne.stack=="string")return[ne.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),w=y[0],R=y[1];if(w&&R){var V=w.split(`
`),J=R.split(`
`);for(p=u=0;u<V.length&&!V[u].includes("DetermineComponentFrameRoot");)u++;for(;p<J.length&&!J[p].includes("DetermineComponentFrameRoot");)p++;if(u===V.length||p===J.length)for(u=V.length-1,p=J.length-1;1<=u&&0<=p&&V[u]!==J[p];)p--;for(;1<=u&&0<=p;u--,p--)if(V[u]!==J[p]){if(u!==1||p!==1)do if(u--,p--,0>p||V[u]!==J[p]){var ae=`
`+V[u].replace(" at new "," at ");return i.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",i.displayName)),ae}while(1<=u&&0<=p);break}}}finally{Re=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?Xt(o):""}function De(i,s){switch(i.tag){case 26:case 27:case 5:return Xt(i.type);case 16:return Xt("Lazy");case 13:return i.child!==s&&s!==null?Xt("Suspense Fallback"):Xt("Suspense");case 19:return Xt("SuspenseList");case 0:case 15:return oe(i.type,!1);case 11:return oe(i.type.render,!1);case 1:return oe(i.type,!0);case 31:return Xt("Activity");default:return""}}function Ee(i){try{var s="",o=null;do s+=De(i,o),o=i,i=i.return;while(i);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Te=Object.prototype.hasOwnProperty,be=n.unstable_scheduleCallback,Ue=n.unstable_cancelCallback,He=n.unstable_shouldYield,It=n.unstable_requestPaint,Ze=n.unstable_now,Se=n.unstable_getCurrentPriorityLevel,_e=n.unstable_ImmediatePriority,me=n.unstable_UserBlockingPriority,ge=n.unstable_NormalPriority,re=n.unstable_LowPriority,ye=n.unstable_IdlePriority,$e=n.log,qe=n.unstable_setDisableYieldValue,Pt=null,yt=null;function Fe(i){if(typeof $e=="function"&&qe(i),yt&&typeof yt.setStrictMode=="function")try{yt.setStrictMode(Pt,i)}catch{}}var Et=Math.clz32?Math.clz32:oi,ai=Math.log,Ei=Math.LN2;function oi(i){return i>>>=0,i===0?32:31-(ai(i)/Ei|0)|0}var ji=256,tr=262144,cs=4194304;function zi(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Si(i,s,o){var u=i.pendingLanes;if(u===0)return 0;var p=0,y=i.suspendedLanes,w=i.pingedLanes;i=i.warmLanes;var R=u&134217727;return R!==0?(u=R&~y,u!==0?p=zi(u):(w&=R,w!==0?p=zi(w):o||(o=R&~i,o!==0&&(p=zi(o))))):(R=u&~y,R!==0?p=zi(R):w!==0?p=zi(w):o||(o=u&~i,o!==0&&(p=zi(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function us(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function co(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Al(){var i=cs;return cs<<=1,(cs&62914560)===0&&(cs=4194304),i}function Rr(i){for(var s=[],o=0;31>o;o++)s.push(i);return s}function ds(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function In(i,s,o,u,p,y){var w=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var R=i.entanglements,V=i.expirationTimes,J=i.hiddenUpdates;for(o=w&~o;0<o;){var ae=31-Et(o),de=1<<ae;R[ae]=0,V[ae]=-1;var Z=J[ae];if(Z!==null)for(J[ae]=null,ae=0;ae<Z.length;ae++){var ne=Z[ae];ne!==null&&(ne.lane&=-536870913)}o&=~de}u!==0&&Rl(i,u,0),y!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=y&~(w&~s))}function Rl(i,s,o){i.pendingLanes|=s,i.suspendedLanes&=~s;var u=31-Et(s);i.entangledLanes|=s,i.entanglements[u]=i.entanglements[u]|1073741824|o&261930}function hs(i,s){var o=i.entangledLanes|=s;for(i=i.entanglements;o;){var u=31-Et(o),p=1<<u;p&s|i[u]&s&&(i[u]|=s),o&=~p}}function fs(i,s){var o=s&-s;return o=(o&42)!==0?1:Il(o),(o&(i.suspendedLanes|s))!==0?0:o}function Il(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Pl(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ir(){var i=he.p;return i!==0?i:(i=window.event,i===void 0?32:Hv(i.type))}function mu(i,s){var o=he.p;try{return he.p=i,s()}finally{he.p=o}}var nr=Math.random().toString(36).slice(2),Zt="__reactFiber$"+nr,Pn="__reactProps$"+nr,ir="__reactContainer$"+nr,ms="__reactEvents$"+nr,rr="__reactListeners$"+nr,pu="__reactHandles$"+nr,Cl="__reactResources$"+nr,Pr="__reactMarker$"+nr;function ya(i){delete i[Zt],delete i[Pn],delete i[ms],delete i[rr],delete i[pu]}function Cr(i){var s=i[Zt];if(s)return s;for(var o=i.parentNode;o;){if(s=o[ir]||o[Zt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(i=Pv(i);i!==null;){if(o=i[Zt])return o;i=Pv(i)}return s}i=o,o=i.parentNode}return null}function Nr(i){if(i=i[Zt]||i[ir]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function _a(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function Bi(i){var s=i[Cl];return s||(s=i[Cl]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function an(i){i[Pr]=!0}var uo=new Set,ps={};function Bn(i,s){sr(i,s),sr(i+"Capture",s)}function sr(i,s){for(ps[i]=s,i=0;i<s.length;i++)uo.add(s[i])}var hf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nl={},Ol={};function gu(i){return Te.call(Ol,i)?!0:Te.call(Nl,i)?!1:hf.test(i)?Ol[i]=!0:(Nl[i]=!0,!1)}function gs(i,s,o){if(gu(s))if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+o)}}function ys(i,s,o){if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+o)}}function wi(i,s,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(s,o,""+u)}}function Fn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function yu(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ff(i,s,o){var u=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,y=u.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return p.call(this)},set:function(w){o=""+w,y.call(this,w)}}),Object.defineProperty(i,s,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function ho(i){if(!i._valueTracker){var s=yu(i)?"checked":"value";i._valueTracker=ff(i,s,""+i[s])}}function xl(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return i&&(u=yu(i)?i.checked?"true":"false":i.value),i=u,i!==o?(s.setValue(i),!0):!1}function fo(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Or=/[\n"\\]/g;function en(i){return i.replace(Or,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function _s(i,s,o,u,p,y,w,R){i.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?i.type=w:i.removeAttribute("type"),s!=null?w==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Fn(s)):i.value!==""+Fn(s)&&(i.value=""+Fn(s)):w!=="submit"&&w!=="reset"||i.removeAttribute("value"),s!=null?mo(i,w,Fn(s)):o!=null?mo(i,w,Fn(o)):u!=null&&i.removeAttribute("value"),p==null&&y!=null&&(i.defaultChecked=!!y),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?i.name=""+Fn(R):i.removeAttribute("name")}function va(i,s,o,u,p,y,w,R){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ho(i);return}o=o!=null?""+Fn(o):"",s=s!=null?""+Fn(s):o,R||s===i.value||(i.value=s),i.defaultValue=s}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=R?i.checked:!!u,i.defaultChecked=!!u,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.name=w),ho(i)}function mo(i,s,o){s==="number"&&fo(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function St(i,s,o,u){if(i=i.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<i.length;o++)p=s.hasOwnProperty("$"+i[o].value),i[o].selected!==p&&(i[o].selected=p),p&&u&&(i[o].defaultSelected=!0)}else{for(o=""+Fn(o),s=null,p=0;p<i.length;p++){if(i[p].value===o){i[p].selected=!0,u&&(i[p].defaultSelected=!0);return}s!==null||i[p].disabled||(s=i[p])}s!==null&&(s.selected=!0)}}function Ea(i,s,o){if(s!=null&&(s=""+Fn(s),s!==i.value&&(i.value=s),o==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=o!=null?""+Fn(o):""}function vs(i,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(r(92));if(et(u)){if(1<u.length)throw Error(r(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=Fn(s),i.defaultValue=o,u=i.textContent,u===o&&u!==""&&u!==null&&(i.value=u),ho(i)}function bi(i,s){if(s){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=s;return}}i.textContent=s}var mf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Dl(i,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":u?i.setProperty(s,o):typeof o!="number"||o===0||mf.has(s)?s==="float"?i.cssFloat=o:i[s]=(""+o).trim():i[s]=o+"px"}function _u(i,s,o){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var p in s)u=s[p],s.hasOwnProperty(p)&&o[p]!==u&&Dl(i,p,u)}else for(var y in s)s.hasOwnProperty(y)&&Dl(i,y,s[y])}function kl(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ar(i){return gf.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function wn(){}var po=null;function go(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var xr=null,li=null;function vu(i){var s=Nr(i);if(s&&(i=s.stateNode)){var o=i[Pn]||null;e:switch(i=s.stateNode,s.type){case"input":if(_s(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+en(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==i&&u.form===i.form){var p=u[Pn]||null;if(!p)throw Error(r(90));_s(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===i.form&&xl(u)}break e;case"textarea":Ea(i,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&St(i,!!o.multiple,s,!1)}}}var Ml=!1;function Eu(i,s,o){if(Ml)return i(s,o);Ml=!0;try{var u=i(s);return u}finally{if(Ml=!1,(xr!==null||li!==null)&&(gd(),xr&&(s=xr,i=li,li=xr=null,vu(s),i)))for(s=0;s<i.length;s++)vu(i[s])}}function Yn(i,s){var o=i.stateNode;if(o===null)return null;var u=o[Pn]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(r(231,s,typeof o));return o}var Fi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ll=!1;if(Fi)try{var or={};Object.defineProperty(or,"passive",{get:function(){Ll=!0}}),window.addEventListener("test",or,or),window.removeEventListener("test",or,or)}catch{Ll=!1}var ci=null,yo=null,lr=null;function Es(){if(lr)return lr;var i,s=yo,o=s.length,u,p="value"in ci?ci.value:ci.textContent,y=p.length;for(i=0;i<o&&s[i]===p[i];i++);var w=o-i;for(u=1;u<=w&&s[o-u]===p[y-u];u++);return lr=p.slice(i,1<u?1-u:void 0)}function Sa(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Ss(){return!0}function $t(){return!1}function Ln(i){function s(o,u,p,y,w){this._reactName=o,this._targetInst=p,this.type=u,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var R in i)i.hasOwnProperty(R)&&(o=i[R],this[R]=o?o(y):y[R]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ss:$t,this.isPropagationStopped=$t,this}return _(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ss)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ss)},persist:function(){},isPersistent:Ss}),s}var Dr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=Ln(Dr),ws=_({},Dr,{view:0,detail:0}),Su=Ln(ws),bs,_o,Gn,ba=_({},ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:As,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Gn&&(Gn&&i.type==="mousemove"?(bs=i.screenX-Gn.screenX,_o=i.screenY-Gn.screenY):_o=bs=0,Gn=i),bs)},movementY:function(i){return"movementY"in i?i.movementY:_o}}),wu=Ln(ba),Ta=_({},ba,{dataTransfer:0}),bu=Ln(Ta),Ul=_({},ws,{relatedTarget:0}),Ts=Ln(Ul),Tu=_({},Dr,{animationName:0,elapsedTime:0,pseudoElement:0}),vo=Ln(Tu),yf=_({},Dr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Au=Ln(yf),Aa=_({},Dr,{data:0}),Vl=Ln(Aa),Ru={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Iu(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=zl[i])?!!s[i]:!1}function As(){return Iu}var Pu=_({},ws,{key:function(i){if(i.key){var s=Ru[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Sa(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?jl[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:As,charCode:function(i){return i.type==="keypress"?Sa(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Sa(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Cu=Ln(Pu),kr=_({},ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bl=Ln(kr),Nu=_({},ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:As}),Ou=Ln(Nu),xu=_({},Dr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Eo=Ln(xu),Hn=_({},ba,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Du=Ln(Hn),ku=_({},Dr,{newState:0,oldState:0}),Rs=Ln(ku),f=[9,13,27,32],E=Fi&&"CompositionEvent"in window,b=null;Fi&&"documentMode"in document&&(b=document.documentMode);var O=Fi&&"TextEvent"in window&&!b,Y=Fi&&(!E||b&&8<b&&11>=b),ie=" ",ve=!1;function Ct(i,s){switch(i){case"keyup":return f.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dn(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var st=!1;function bn(i,s){switch(i){case"compositionend":return dn(s);case"keypress":return s.which!==32?null:(ve=!0,ie);case"textInput":return i=s.data,i===ie&&ve?null:i;default:return null}}function Tn(i,s){if(st)return i==="compositionend"||!E&&Ct(i,s)?(i=Es(),lr=yo=ci=null,st=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Y&&s.locale!=="ko"?null:s.data;default:return null}}var Is={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Is[i.type]:s==="textarea"}function Ra(i,s,o,u){xr?li?li.push(u):li=[u]:xr=u,s=bd(s,"onChange"),0<s.length&&(o=new wa("onChange","change",null,o,u),i.push({event:o,listeners:s}))}var Mr=null,Fl=null;function rR(i){mv(i,0)}function Mu(i){var s=_a(i);if(xl(s))return i}function Dy(i,s){if(i==="change")return s}var ky=!1;if(Fi){var _f;if(Fi){var vf="oninput"in document;if(!vf){var My=document.createElement("div");My.setAttribute("oninput","return;"),vf=typeof My.oninput=="function"}_f=vf}else _f=!1;ky=_f&&(!document.documentMode||9<document.documentMode)}function Ly(){Mr&&(Mr.detachEvent("onpropertychange",Uy),Fl=Mr=null)}function Uy(i){if(i.propertyName==="value"&&Mu(Fl)){var s=[];Ra(s,Fl,i,go(i)),Eu(rR,s)}}function sR(i,s,o){i==="focusin"?(Ly(),Mr=s,Fl=o,Mr.attachEvent("onpropertychange",Uy)):i==="focusout"&&Ly()}function aR(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Mu(Fl)}function oR(i,s){if(i==="click")return Mu(s)}function lR(i,s){if(i==="input"||i==="change")return Mu(s)}function cR(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var ui=typeof Object.is=="function"?Object.is:cR;function Gl(i,s){if(ui(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var o=Object.keys(i),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var p=o[u];if(!Te.call(s,p)||!ui(i[p],s[p]))return!1}return!0}function Vy(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function jy(i,s){var o=Vy(i);i=0;for(var u;o;){if(o.nodeType===3){if(u=i+o.textContent.length,i<=s&&u>=s)return{node:o,offset:s-i};i=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Vy(o)}}function zy(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?zy(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function By(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=fo(i.document);s instanceof i.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)i=s.contentWindow;else break;s=fo(i.document)}return s}function Ef(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var uR=Fi&&"documentMode"in document&&11>=document.documentMode,So=null,Sf=null,Hl=null,wf=!1;function Fy(i,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;wf||So==null||So!==fo(u)||(u=So,"selectionStart"in u&&Ef(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Hl&&Gl(Hl,u)||(Hl=u,u=bd(Sf,"onSelect"),0<u.length&&(s=new wa("onSelect","select",null,s,o),i.push({event:s,listeners:u}),s.target=So)))}function Ia(i,s){var o={};return o[i.toLowerCase()]=s.toLowerCase(),o["Webkit"+i]="webkit"+s,o["Moz"+i]="moz"+s,o}var wo={animationend:Ia("Animation","AnimationEnd"),animationiteration:Ia("Animation","AnimationIteration"),animationstart:Ia("Animation","AnimationStart"),transitionrun:Ia("Transition","TransitionRun"),transitionstart:Ia("Transition","TransitionStart"),transitioncancel:Ia("Transition","TransitionCancel"),transitionend:Ia("Transition","TransitionEnd")},bf={},Gy={};Fi&&(Gy=document.createElement("div").style,"AnimationEvent"in window||(delete wo.animationend.animation,delete wo.animationiteration.animation,delete wo.animationstart.animation),"TransitionEvent"in window||delete wo.transitionend.transition);function Pa(i){if(bf[i])return bf[i];if(!wo[i])return i;var s=wo[i],o;for(o in s)if(s.hasOwnProperty(o)&&o in Gy)return bf[i]=s[o];return i}var Hy=Pa("animationend"),$y=Pa("animationiteration"),qy=Pa("animationstart"),dR=Pa("transitionrun"),hR=Pa("transitionstart"),fR=Pa("transitioncancel"),Yy=Pa("transitionend"),Ky=new Map,Tf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tf.push("scrollEnd");function Gi(i,s){Ky.set(i,s),Bn(s,[i])}var Lu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ti=[],bo=0,Af=0;function Uu(){for(var i=bo,s=Af=bo=0;s<i;){var o=Ti[s];Ti[s++]=null;var u=Ti[s];Ti[s++]=null;var p=Ti[s];Ti[s++]=null;var y=Ti[s];if(Ti[s++]=null,u!==null&&p!==null){var w=u.pending;w===null?p.next=p:(p.next=w.next,w.next=p),u.pending=p}y!==0&&Wy(o,p,y)}}function Vu(i,s,o,u){Ti[bo++]=i,Ti[bo++]=s,Ti[bo++]=o,Ti[bo++]=u,Af|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function Rf(i,s,o,u){return Vu(i,s,o,u),ju(i)}function Ca(i,s){return Vu(i,null,null,s),ju(i)}function Wy(i,s,o){i.lanes|=o;var u=i.alternate;u!==null&&(u.lanes|=o);for(var p=!1,y=i.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(p=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,p&&s!==null&&(p=31-Et(o),i=y.hiddenUpdates,u=i[p],u===null?i[p]=[s]:u.push(s),s.lane=o|536870912),y):null}function ju(i){if(50<hc)throw hc=0,Mm=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var To={};function mR(i,s,o,u){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(i,s,o,u){return new mR(i,s,o,u)}function If(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Lr(i,s){var o=i.alternate;return o===null?(o=di(i.tag,s,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=s,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&65011712,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,s=i.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function Qy(i,s){i.flags&=65011714;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,s=o.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function zu(i,s,o,u,p,y){var w=0;if(u=i,typeof i=="function")If(i)&&(w=1);else if(typeof i=="string")w=vI(i,o,pe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case N:return i=di(31,o,s,p),i.elementType=N,i.lanes=y,i;case A:return Na(o.children,p,y,s);case C:w=8,p|=24;break;case L:return i=di(12,o,s,p|2),i.elementType=L,i.lanes=y,i;case $:return i=di(13,o,s,p),i.elementType=$,i.lanes=y,i;case se:return i=di(19,o,s,p),i.elementType=se,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case U:w=10;break e;case x:w=9;break e;case z:w=11;break e;case D:w=14;break e;case P:w=16,u=null;break e}w=29,o=Error(r(130,i===null?"null":typeof i,"")),u=null}return s=di(w,o,s,p),s.elementType=i,s.type=u,s.lanes=y,s}function Na(i,s,o,u){return i=di(7,i,u,s),i.lanes=o,i}function Pf(i,s,o){return i=di(6,i,null,s),i.lanes=o,i}function Xy(i){var s=di(18,null,null,0);return s.stateNode=i,s}function Cf(i,s,o){return s=di(4,i.children!==null?i.children:[],i.key,s),s.lanes=o,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Jy=new WeakMap;function Ai(i,s){if(typeof i=="object"&&i!==null){var o=Jy.get(i);return o!==void 0?o:(s={value:i,source:s,stack:Ee(s)},Jy.set(i,s),s)}return{value:i,source:s,stack:Ee(s)}}var Ao=[],Ro=0,Bu=null,$l=0,Ri=[],Ii=0,Ps=null,cr=1,ur="";function Ur(i,s){Ao[Ro++]=$l,Ao[Ro++]=Bu,Bu=i,$l=s}function Zy(i,s,o){Ri[Ii++]=cr,Ri[Ii++]=ur,Ri[Ii++]=Ps,Ps=i;var u=cr;i=ur;var p=32-Et(u)-1;u&=~(1<<p),o+=1;var y=32-Et(s)+p;if(30<y){var w=p-p%5;y=(u&(1<<w)-1).toString(32),u>>=w,p-=w,cr=1<<32-Et(s)+p|o<<p|u,ur=y+i}else cr=1<<y|o<<p|u,ur=i}function Nf(i){i.return!==null&&(Ur(i,1),Zy(i,1,0))}function Of(i){for(;i===Bu;)Bu=Ao[--Ro],Ao[Ro]=null,$l=Ao[--Ro],Ao[Ro]=null;for(;i===Ps;)Ps=Ri[--Ii],Ri[Ii]=null,ur=Ri[--Ii],Ri[Ii]=null,cr=Ri[--Ii],Ri[Ii]=null}function e_(i,s){Ri[Ii++]=cr,Ri[Ii++]=ur,Ri[Ii++]=Ps,cr=s.id,ur=s.overflow,Ps=i}var Cn=null,qt=null,mt=!1,Cs=null,Pi=!1,xf=Error(r(519));function Ns(i){var s=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ql(Ai(s,i)),xf}function t_(i){var s=i.stateNode,o=i.type,u=i.memoizedProps;switch(s[Zt]=i,s[Pn]=u,o){case"dialog":ct("cancel",s),ct("close",s);break;case"iframe":case"object":case"embed":ct("load",s);break;case"video":case"audio":for(o=0;o<mc.length;o++)ct(mc[o],s);break;case"source":ct("error",s);break;case"img":case"image":case"link":ct("error",s),ct("load",s);break;case"details":ct("toggle",s);break;case"input":ct("invalid",s),va(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":ct("invalid",s);break;case"textarea":ct("invalid",s),vs(s,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||_v(s.textContent,o)?(u.popover!=null&&(ct("beforetoggle",s),ct("toggle",s)),u.onScroll!=null&&ct("scroll",s),u.onScrollEnd!=null&&ct("scrollend",s),u.onClick!=null&&(s.onclick=wn),s=!0):s=!1,s||Ns(i,!0)}function n_(i){for(Cn=i.return;Cn;)switch(Cn.tag){case 5:case 31:case 13:Pi=!1;return;case 27:case 3:Pi=!0;return;default:Cn=Cn.return}}function Io(i){if(i!==Cn)return!1;if(!mt)return n_(i),mt=!0,!1;var s=i.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||Qm(i.type,i.memoizedProps)),o=!o),o&&qt&&Ns(i),n_(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));qt=Iv(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));qt=Iv(i)}else s===27?(s=qt,Hs(i.type)?(i=tp,tp=null,qt=i):qt=s):qt=Cn?Ni(i.stateNode.nextSibling):null;return!0}function Oa(){qt=Cn=null,mt=!1}function Df(){var i=Cs;return i!==null&&(Jn===null?Jn=i:Jn.push.apply(Jn,i),Cs=null),i}function ql(i){Cs===null?Cs=[i]:Cs.push(i)}var kf=j(null),xa=null,Vr=null;function Os(i,s,o){ue(kf,s._currentValue),s._currentValue=o}function jr(i){i._currentValue=kf.current,K(kf)}function Mf(i,s,o){for(;i!==null;){var u=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),i===o)break;i=i.return}}function Lf(i,s,o,u){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var y=p.dependencies;if(y!==null){var w=p.child;y=y.firstContext;e:for(;y!==null;){var R=y;y=p;for(var V=0;V<s.length;V++)if(R.context===s[V]){y.lanes|=o,R=y.alternate,R!==null&&(R.lanes|=o),Mf(y.return,o,i),u||(w=null);break e}y=R.next}}else if(p.tag===18){if(w=p.return,w===null)throw Error(r(341));w.lanes|=o,y=w.alternate,y!==null&&(y.lanes|=o),Mf(w,o,i),w=null}else w=p.child;if(w!==null)w.return=p;else for(w=p;w!==null;){if(w===i){w=null;break}if(p=w.sibling,p!==null){p.return=w.return,w=p;break}w=w.return}p=w}}function Po(i,s,o,u){i=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var w=p.alternate;if(w===null)throw Error(r(387));if(w=w.memoizedProps,w!==null){var R=p.type;ui(p.pendingProps.value,w.value)||(i!==null?i.push(R):i=[R])}}else if(p===tt.current){if(w=p.alternate,w===null)throw Error(r(387));w.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(vc):i=[vc])}p=p.return}i!==null&&Lf(s,i,o,u),s.flags|=262144}function Fu(i){for(i=i.firstContext;i!==null;){if(!ui(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Da(i){xa=i,Vr=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Nn(i){return i_(xa,i)}function Gu(i,s){return xa===null&&Da(i),i_(i,s)}function i_(i,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Vr===null){if(i===null)throw Error(r(308));Vr=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Vr=Vr.next=s;return o}var pR=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(o,u){i.push(u)}};this.abort=function(){s.aborted=!0,i.forEach(function(o){return o()})}},gR=n.unstable_scheduleCallback,yR=n.unstable_NormalPriority,hn={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new pR,data:new Map,refCount:0}}function Yl(i){i.refCount--,i.refCount===0&&gR(yR,function(){i.controller.abort()})}var Kl=null,Vf=0,Co=0,No=null;function _R(i,s){if(Kl===null){var o=Kl=[];Vf=0,Co=Bm(),No={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Vf++,s.then(r_,r_),s}function r_(){if(--Vf===0&&Kl!==null){No!==null&&(No.status="fulfilled");var i=Kl;Kl=null,Co=0,No=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function vR(i,s){var o=[],u={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return i.then(function(){u.status="fulfilled",u.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(u.status="rejected",u.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),u}var s_=te.S;te.S=function(i,s){F0=Ze(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&_R(i,s),s_!==null&&s_(i,s)};var ka=j(null);function jf(){var i=ka.current;return i!==null?i:zt.pooledCache}function Hu(i,s){s===null?ue(ka,ka.current):ue(ka,s.pool)}function a_(){var i=jf();return i===null?null:{parent:hn._currentValue,pool:i}}var Oo=Error(r(460)),zf=Error(r(474)),$u=Error(r(542)),qu={then:function(){}};function o_(i){return i=i.status,i==="fulfilled"||i==="rejected"}function l_(i,s,o){switch(o=i[o],o===void 0?i.push(s):o!==s&&(s.then(wn,wn),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,u_(i),i;default:if(typeof s.status=="string")s.then(wn,wn);else{if(i=zt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(u){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=u}},function(u){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,u_(i),i}throw La=s,Oo}}function Ma(i){try{var s=i._init;return s(i._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(La=o,Oo):o}}var La=null;function c_(){if(La===null)throw Error(r(459));var i=La;return La=null,i}function u_(i){if(i===Oo||i===$u)throw Error(r(483))}var xo=null,Wl=0;function Yu(i){var s=Wl;return Wl+=1,xo===null&&(xo=[]),l_(xo,i,s)}function Ql(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Ku(i,s){throw s.$$typeof===v?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function d_(i){function s(q,F){if(i){var Q=q.deletions;Q===null?(q.deletions=[F],q.flags|=16):Q.push(F)}}function o(q,F){if(!i)return null;for(;F!==null;)s(q,F),F=F.sibling;return null}function u(q){for(var F=new Map;q!==null;)q.key!==null?F.set(q.key,q):F.set(q.index,q),q=q.sibling;return F}function p(q,F){return q=Lr(q,F),q.index=0,q.sibling=null,q}function y(q,F,Q){return q.index=Q,i?(Q=q.alternate,Q!==null?(Q=Q.index,Q<F?(q.flags|=67108866,F):Q):(q.flags|=67108866,F)):(q.flags|=1048576,F)}function w(q){return i&&q.alternate===null&&(q.flags|=67108866),q}function R(q,F,Q,le){return F===null||F.tag!==6?(F=Pf(Q,q.mode,le),F.return=q,F):(F=p(F,Q),F.return=q,F)}function V(q,F,Q,le){var Me=Q.type;return Me===A?ae(q,F,Q.props.children,le,Q.key):F!==null&&(F.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===P&&Ma(Me)===F.type)?(F=p(F,Q.props),Ql(F,Q),F.return=q,F):(F=zu(Q.type,Q.key,Q.props,null,q.mode,le),Ql(F,Q),F.return=q,F)}function J(q,F,Q,le){return F===null||F.tag!==4||F.stateNode.containerInfo!==Q.containerInfo||F.stateNode.implementation!==Q.implementation?(F=Cf(Q,q.mode,le),F.return=q,F):(F=p(F,Q.children||[]),F.return=q,F)}function ae(q,F,Q,le,Me){return F===null||F.tag!==7?(F=Na(Q,q.mode,le,Me),F.return=q,F):(F=p(F,Q),F.return=q,F)}function de(q,F,Q){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=Pf(""+F,q.mode,Q),F.return=q,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case T:return Q=zu(F.type,F.key,F.props,null,q.mode,Q),Ql(Q,F),Q.return=q,Q;case I:return F=Cf(F,q.mode,Q),F.return=q,F;case P:return F=Ma(F),de(q,F,Q)}if(et(F)||G(F))return F=Na(F,q.mode,Q,null),F.return=q,F;if(typeof F.then=="function")return de(q,Yu(F),Q);if(F.$$typeof===U)return de(q,Gu(q,F),Q);Ku(q,F)}return null}function Z(q,F,Q,le){var Me=F!==null?F.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Me!==null?null:R(q,F,""+Q,le);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case T:return Q.key===Me?V(q,F,Q,le):null;case I:return Q.key===Me?J(q,F,Q,le):null;case P:return Q=Ma(Q),Z(q,F,Q,le)}if(et(Q)||G(Q))return Me!==null?null:ae(q,F,Q,le,null);if(typeof Q.then=="function")return Z(q,F,Yu(Q),le);if(Q.$$typeof===U)return Z(q,F,Gu(q,Q),le);Ku(q,Q)}return null}function ne(q,F,Q,le,Me){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return q=q.get(Q)||null,R(F,q,""+le,Me);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case T:return q=q.get(le.key===null?Q:le.key)||null,V(F,q,le,Me);case I:return q=q.get(le.key===null?Q:le.key)||null,J(F,q,le,Me);case P:return le=Ma(le),ne(q,F,Q,le,Me)}if(et(le)||G(le))return q=q.get(Q)||null,ae(F,q,le,Me,null);if(typeof le.then=="function")return ne(q,F,Q,Yu(le),Me);if(le.$$typeof===U)return ne(q,F,Q,Gu(F,le),Me);Ku(F,le)}return null}function Oe(q,F,Q,le){for(var Me=null,wt=null,xe=F,rt=F=0,dt=null;xe!==null&&rt<Q.length;rt++){xe.index>rt?(dt=xe,xe=null):dt=xe.sibling;var bt=Z(q,xe,Q[rt],le);if(bt===null){xe===null&&(xe=dt);break}i&&xe&&bt.alternate===null&&s(q,xe),F=y(bt,F,rt),wt===null?Me=bt:wt.sibling=bt,wt=bt,xe=dt}if(rt===Q.length)return o(q,xe),mt&&Ur(q,rt),Me;if(xe===null){for(;rt<Q.length;rt++)xe=de(q,Q[rt],le),xe!==null&&(F=y(xe,F,rt),wt===null?Me=xe:wt.sibling=xe,wt=xe);return mt&&Ur(q,rt),Me}for(xe=u(xe);rt<Q.length;rt++)dt=ne(xe,q,rt,Q[rt],le),dt!==null&&(i&&dt.alternate!==null&&xe.delete(dt.key===null?rt:dt.key),F=y(dt,F,rt),wt===null?Me=dt:wt.sibling=dt,wt=dt);return i&&xe.forEach(function(Ws){return s(q,Ws)}),mt&&Ur(q,rt),Me}function Be(q,F,Q,le){if(Q==null)throw Error(r(151));for(var Me=null,wt=null,xe=F,rt=F=0,dt=null,bt=Q.next();xe!==null&&!bt.done;rt++,bt=Q.next()){xe.index>rt?(dt=xe,xe=null):dt=xe.sibling;var Ws=Z(q,xe,bt.value,le);if(Ws===null){xe===null&&(xe=dt);break}i&&xe&&Ws.alternate===null&&s(q,xe),F=y(Ws,F,rt),wt===null?Me=Ws:wt.sibling=Ws,wt=Ws,xe=dt}if(bt.done)return o(q,xe),mt&&Ur(q,rt),Me;if(xe===null){for(;!bt.done;rt++,bt=Q.next())bt=de(q,bt.value,le),bt!==null&&(F=y(bt,F,rt),wt===null?Me=bt:wt.sibling=bt,wt=bt);return mt&&Ur(q,rt),Me}for(xe=u(xe);!bt.done;rt++,bt=Q.next())bt=ne(xe,q,rt,bt.value,le),bt!==null&&(i&&bt.alternate!==null&&xe.delete(bt.key===null?rt:bt.key),F=y(bt,F,rt),wt===null?Me=bt:wt.sibling=bt,wt=bt);return i&&xe.forEach(function(NI){return s(q,NI)}),mt&&Ur(q,rt),Me}function Vt(q,F,Q,le){if(typeof Q=="object"&&Q!==null&&Q.type===A&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case T:e:{for(var Me=Q.key;F!==null;){if(F.key===Me){if(Me=Q.type,Me===A){if(F.tag===7){o(q,F.sibling),le=p(F,Q.props.children),le.return=q,q=le;break e}}else if(F.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===P&&Ma(Me)===F.type){o(q,F.sibling),le=p(F,Q.props),Ql(le,Q),le.return=q,q=le;break e}o(q,F);break}else s(q,F);F=F.sibling}Q.type===A?(le=Na(Q.props.children,q.mode,le,Q.key),le.return=q,q=le):(le=zu(Q.type,Q.key,Q.props,null,q.mode,le),Ql(le,Q),le.return=q,q=le)}return w(q);case I:e:{for(Me=Q.key;F!==null;){if(F.key===Me)if(F.tag===4&&F.stateNode.containerInfo===Q.containerInfo&&F.stateNode.implementation===Q.implementation){o(q,F.sibling),le=p(F,Q.children||[]),le.return=q,q=le;break e}else{o(q,F);break}else s(q,F);F=F.sibling}le=Cf(Q,q.mode,le),le.return=q,q=le}return w(q);case P:return Q=Ma(Q),Vt(q,F,Q,le)}if(et(Q))return Oe(q,F,Q,le);if(G(Q)){if(Me=G(Q),typeof Me!="function")throw Error(r(150));return Q=Me.call(Q),Be(q,F,Q,le)}if(typeof Q.then=="function")return Vt(q,F,Yu(Q),le);if(Q.$$typeof===U)return Vt(q,F,Gu(q,Q),le);Ku(q,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,F!==null&&F.tag===6?(o(q,F.sibling),le=p(F,Q),le.return=q,q=le):(o(q,F),le=Pf(Q,q.mode,le),le.return=q,q=le),w(q)):o(q,F)}return function(q,F,Q,le){try{Wl=0;var Me=Vt(q,F,Q,le);return xo=null,Me}catch(xe){if(xe===Oo||xe===$u)throw xe;var wt=di(29,xe,null,q.mode);return wt.lanes=le,wt.return=q,wt}finally{}}}var Ua=d_(!0),h_=d_(!1),xs=!1;function Bf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ff(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ds(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ks(i,s,o){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(Tt&2)!==0){var p=u.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),u.pending=s,s=ju(i),Wy(i,null,o),s}return Vu(i,u,s,o),ju(i)}function Xl(i,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=i.pendingLanes,o|=u,s.lanes=o,hs(i,o)}}function Gf(i,s){var o=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=w:y=y.next=w,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=s:i.next=s,o.lastBaseUpdate=s}var Hf=!1;function Jl(){if(Hf){var i=No;if(i!==null)throw i}}function Zl(i,s,o,u){Hf=!1;var p=i.updateQueue;xs=!1;var y=p.firstBaseUpdate,w=p.lastBaseUpdate,R=p.shared.pending;if(R!==null){p.shared.pending=null;var V=R,J=V.next;V.next=null,w===null?y=J:w.next=J,w=V;var ae=i.alternate;ae!==null&&(ae=ae.updateQueue,R=ae.lastBaseUpdate,R!==w&&(R===null?ae.firstBaseUpdate=J:R.next=J,ae.lastBaseUpdate=V))}if(y!==null){var de=p.baseState;w=0,ae=J=V=null,R=y;do{var Z=R.lane&-536870913,ne=Z!==R.lane;if(ne?(ut&Z)===Z:(u&Z)===Z){Z!==0&&Z===Co&&(Hf=!0),ae!==null&&(ae=ae.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Oe=i,Be=R;Z=s;var Vt=o;switch(Be.tag){case 1:if(Oe=Be.payload,typeof Oe=="function"){de=Oe.call(Vt,de,Z);break e}de=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Be.payload,Z=typeof Oe=="function"?Oe.call(Vt,de,Z):Oe,Z==null)break e;de=_({},de,Z);break e;case 2:xs=!0}}Z=R.callback,Z!==null&&(i.flags|=64,ne&&(i.flags|=8192),ne=p.callbacks,ne===null?p.callbacks=[Z]:ne.push(Z))}else ne={lane:Z,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ae===null?(J=ae=ne,V=de):ae=ae.next=ne,w|=Z;if(R=R.next,R===null){if(R=p.shared.pending,R===null)break;ne=R,R=ne.next,ne.next=null,p.lastBaseUpdate=ne,p.shared.pending=null}}while(!0);ae===null&&(V=de),p.baseState=V,p.firstBaseUpdate=J,p.lastBaseUpdate=ae,y===null&&(p.shared.lanes=0),js|=w,i.lanes=w,i.memoizedState=de}}function f_(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function m_(i,s){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)f_(o[i],s)}var Do=j(null),Wu=j(0);function p_(i,s){i=Kr,ue(Wu,i),ue(Do,s),Kr=i|s.baseLanes}function $f(){ue(Wu,Kr),ue(Do,Do.current)}function qf(){Kr=Wu.current,K(Do),K(Wu)}var hi=j(null),Ci=null;function Ms(i){var s=i.alternate;ue(on,on.current&1),ue(hi,i),Ci===null&&(s===null||Do.current!==null||s.memoizedState!==null)&&(Ci=i)}function Yf(i){ue(on,on.current),ue(hi,i),Ci===null&&(Ci=i)}function g_(i){i.tag===22?(ue(on,on.current),ue(hi,i),Ci===null&&(Ci=i)):Ls()}function Ls(){ue(on,on.current),ue(hi,hi.current)}function fi(i){K(hi),Ci===i&&(Ci=null),K(on)}var on=j(0);function Qu(i){for(var s=i;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Zm(o)||ep(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var zr=0,nt=null,Lt=null,fn=null,Xu=!1,ko=!1,Va=!1,Ju=0,ec=0,Mo=null,ER=0;function tn(){throw Error(r(321))}function Kf(i,s){if(s===null)return!1;for(var o=0;o<s.length&&o<i.length;o++)if(!ui(i[o],s[o]))return!1;return!0}function Wf(i,s,o,u,p,y){return zr=y,nt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,te.H=i===null||i.memoizedState===null?Z_:um,Va=!1,y=o(u,p),Va=!1,ko&&(y=__(s,o,u,p)),y_(i),y}function y_(i){te.H=ic;var s=Lt!==null&&Lt.next!==null;if(zr=0,fn=Lt=nt=null,Xu=!1,ec=0,Mo=null,s)throw Error(r(300));i===null||mn||(i=i.dependencies,i!==null&&Fu(i)&&(mn=!0))}function __(i,s,o,u){nt=i;var p=0;do{if(ko&&(Mo=null),ec=0,ko=!1,25<=p)throw Error(r(301));if(p+=1,fn=Lt=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}te.H=e0,y=s(o,u)}while(ko);return y}function SR(){var i=te.H,s=i.useState()[0];return s=typeof s.then=="function"?tc(s):s,i=i.useState()[0],(Lt!==null?Lt.memoizedState:null)!==i&&(nt.flags|=1024),s}function Qf(){var i=Ju!==0;return Ju=0,i}function Xf(i,s,o){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~o}function Jf(i){if(Xu){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Xu=!1}zr=0,fn=Lt=nt=null,ko=!1,ec=Ju=0,Mo=null}function $n(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?nt.memoizedState=fn=i:fn=fn.next=i,fn}function ln(){if(Lt===null){var i=nt.alternate;i=i!==null?i.memoizedState:null}else i=Lt.next;var s=fn===null?nt.memoizedState:fn.next;if(s!==null)fn=s,Lt=i;else{if(i===null)throw nt.alternate===null?Error(r(467)):Error(r(310));Lt=i,i={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},fn===null?nt.memoizedState=fn=i:fn=fn.next=i}return fn}function Zu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(i){var s=ec;return ec+=1,Mo===null&&(Mo=[]),i=l_(Mo,i,s),s=nt,(fn===null?s.memoizedState:fn.next)===null&&(s=s.alternate,te.H=s===null||s.memoizedState===null?Z_:um),i}function ed(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return tc(i);if(i.$$typeof===U)return Nn(i)}throw Error(r(438,String(i)))}function Zf(i){var s=null,o=nt.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=nt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Zu(),nt.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(i),u=0;u<i;u++)o[u]=M;return s.index++,o}function Br(i,s){return typeof s=="function"?s(i):s}function td(i){var s=ln();return em(s,Lt,i)}function em(i,s,o){var u=i.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=o;var p=i.baseQueue,y=u.pending;if(y!==null){if(p!==null){var w=p.next;p.next=y.next,y.next=w}s.baseQueue=p=y,u.pending=null}if(y=i.baseState,p===null)i.memoizedState=y;else{s=p.next;var R=w=null,V=null,J=s,ae=!1;do{var de=J.lane&-536870913;if(de!==J.lane?(ut&de)===de:(zr&de)===de){var Z=J.revertLane;if(Z===0)V!==null&&(V=V.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),de===Co&&(ae=!0);else if((zr&Z)===Z){J=J.next,Z===Co&&(ae=!0);continue}else de={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},V===null?(R=V=de,w=y):V=V.next=de,nt.lanes|=Z,js|=Z;de=J.action,Va&&o(y,de),y=J.hasEagerState?J.eagerState:o(y,de)}else Z={lane:de,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},V===null?(R=V=Z,w=y):V=V.next=Z,nt.lanes|=de,js|=de;J=J.next}while(J!==null&&J!==s);if(V===null?w=y:V.next=R,!ui(y,i.memoizedState)&&(mn=!0,ae&&(o=No,o!==null)))throw o;i.memoizedState=y,i.baseState=w,i.baseQueue=V,u.lastRenderedState=y}return p===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function tm(i){var s=ln(),o=s.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=i;var u=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var w=p=p.next;do y=i(y,w.action),w=w.next;while(w!==p);ui(y,s.memoizedState)||(mn=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,u]}function v_(i,s,o){var u=nt,p=ln(),y=mt;if(y){if(o===void 0)throw Error(r(407));o=o()}else o=s();var w=!ui((Lt||p).memoizedState,o);if(w&&(p.memoizedState=o,mn=!0),p=p.queue,rm(w_.bind(null,u,p,i),[i]),p.getSnapshot!==s||w||fn!==null&&fn.memoizedState.tag&1){if(u.flags|=2048,Lo(9,{destroy:void 0},S_.bind(null,u,p,o,s),null),zt===null)throw Error(r(349));y||(zr&127)!==0||E_(u,s,o)}return o}function E_(i,s,o){i.flags|=16384,i={getSnapshot:s,value:o},s=nt.updateQueue,s===null?(s=Zu(),nt.updateQueue=s,s.stores=[i]):(o=s.stores,o===null?s.stores=[i]:o.push(i))}function S_(i,s,o,u){s.value=o,s.getSnapshot=u,b_(s)&&T_(i)}function w_(i,s,o){return o(function(){b_(s)&&T_(i)})}function b_(i){var s=i.getSnapshot;i=i.value;try{var o=s();return!ui(i,o)}catch{return!0}}function T_(i){var s=Ca(i,2);s!==null&&Zn(s,i,2)}function nm(i){var s=$n();if(typeof i=="function"){var o=i;if(i=o(),Va){Fe(!0);try{o()}finally{Fe(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Br,lastRenderedState:i},s}function A_(i,s,o,u){return i.baseState=o,em(i,Lt,typeof u=="function"?u:Br)}function wR(i,s,o,u,p){if(rd(i))throw Error(r(485));if(i=s.action,i!==null){var y={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};te.T!==null?o(!0):y.isTransition=!1,u(y),o=s.pending,o===null?(y.next=s.pending=y,R_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function R_(i,s){var o=s.action,u=s.payload,p=i.state;if(s.isTransition){var y=te.T,w={};te.T=w;try{var R=o(p,u),V=te.S;V!==null&&V(w,R),I_(i,s,R)}catch(J){im(i,s,J)}finally{y!==null&&w.types!==null&&(y.types=w.types),te.T=y}}else try{y=o(p,u),I_(i,s,y)}catch(J){im(i,s,J)}}function I_(i,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){P_(i,s,u)},function(u){return im(i,s,u)}):P_(i,s,o)}function P_(i,s,o){s.status="fulfilled",s.value=o,C_(s),i.state=o,s=i.pending,s!==null&&(o=s.next,o===s?i.pending=null:(o=o.next,s.next=o,R_(i,o)))}function im(i,s,o){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,C_(s),s=s.next;while(s!==u)}i.action=null}function C_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function N_(i,s){return s}function O_(i,s){if(mt){var o=zt.formState;if(o!==null){e:{var u=nt;if(mt){if(qt){t:{for(var p=qt,y=Pi;p.nodeType!==8;){if(!y){p=null;break t}if(p=Ni(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){qt=Ni(p.nextSibling),u=p.data==="F!";break e}}Ns(u)}u=!1}u&&(s=o[0])}}return o=$n(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:N_,lastRenderedState:s},o.queue=u,o=Q_.bind(null,nt,u),u.dispatch=o,u=nm(!1),y=cm.bind(null,nt,!1,u.queue),u=$n(),p={state:s,dispatch:null,action:i,pending:null},u.queue=p,o=wR.bind(null,nt,p,y,o),p.dispatch=o,u.memoizedState=i,[s,o,!1]}function x_(i){var s=ln();return D_(s,Lt,i)}function D_(i,s,o){if(s=em(i,s,N_)[0],i=td(Br)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=tc(s)}catch(w){throw w===Oo?$u:w}else u=s;s=ln();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(nt.flags|=2048,Lo(9,{destroy:void 0},bR.bind(null,p,o),null)),[u,y,i]}function bR(i,s){i.action=s}function k_(i){var s=ln(),o=Lt;if(o!==null)return D_(s,o,i);ln(),s=s.memoizedState,o=ln();var u=o.queue.dispatch;return o.memoizedState=i,[s,u,!1]}function Lo(i,s,o,u){return i={tag:i,create:o,deps:u,inst:s,next:null},s=nt.updateQueue,s===null&&(s=Zu(),nt.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=i.next=i:(u=o.next,o.next=i,i.next=u,s.lastEffect=i),i}function M_(){return ln().memoizedState}function nd(i,s,o,u){var p=$n();nt.flags|=i,p.memoizedState=Lo(1|s,{destroy:void 0},o,u===void 0?null:u)}function id(i,s,o,u){var p=ln();u=u===void 0?null:u;var y=p.memoizedState.inst;Lt!==null&&u!==null&&Kf(u,Lt.memoizedState.deps)?p.memoizedState=Lo(s,y,o,u):(nt.flags|=i,p.memoizedState=Lo(1|s,y,o,u))}function L_(i,s){nd(8390656,8,i,s)}function rm(i,s){id(2048,8,i,s)}function TR(i){nt.flags|=4;var s=nt.updateQueue;if(s===null)s=Zu(),nt.updateQueue=s,s.events=[i];else{var o=s.events;o===null?s.events=[i]:o.push(i)}}function U_(i){var s=ln().memoizedState;return TR({ref:s,nextImpl:i}),function(){if((Tt&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}function V_(i,s){return id(4,2,i,s)}function j_(i,s){return id(4,4,i,s)}function z_(i,s){if(typeof s=="function"){i=i();var o=s(i);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function B_(i,s,o){o=o!=null?o.concat([i]):null,id(4,4,z_.bind(null,s,i),o)}function sm(){}function F_(i,s){var o=ln();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&Kf(s,u[1])?u[0]:(o.memoizedState=[i,s],i)}function G_(i,s){var o=ln();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&Kf(s,u[1]))return u[0];if(u=i(),Va){Fe(!0);try{i()}finally{Fe(!1)}}return o.memoizedState=[u,s],u}function am(i,s,o){return o===void 0||(zr&1073741824)!==0&&(ut&261930)===0?i.memoizedState=s:(i.memoizedState=o,i=H0(),nt.lanes|=i,js|=i,o)}function H_(i,s,o,u){return ui(o,s)?o:Do.current!==null?(i=am(i,o,u),ui(i,s)||(mn=!0),i):(zr&42)===0||(zr&1073741824)!==0&&(ut&261930)===0?(mn=!0,i.memoizedState=o):(i=H0(),nt.lanes|=i,js|=i,s)}function $_(i,s,o,u,p){var y=he.p;he.p=y!==0&&8>y?y:8;var w=te.T,R={};te.T=R,cm(i,!1,s,o);try{var V=p(),J=te.S;if(J!==null&&J(R,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var ae=vR(V,u);nc(i,s,ae,gi(i))}else nc(i,s,u,gi(i))}catch(de){nc(i,s,{then:function(){},status:"rejected",reason:de},gi())}finally{he.p=y,w!==null&&R.types!==null&&(w.types=R.types),te.T=w}}function AR(){}function om(i,s,o,u){if(i.tag!==5)throw Error(r(476));var p=q_(i).queue;$_(i,p,s,Ie,o===null?AR:function(){return Y_(i),o(u)})}function q_(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Br,lastRenderedState:Ie},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Br,lastRenderedState:o},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Y_(i){var s=q_(i);s.next===null&&(s=i.alternate.memoizedState),nc(i,s.next.queue,{},gi())}function lm(){return Nn(vc)}function K_(){return ln().memoizedState}function W_(){return ln().memoizedState}function RR(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var o=gi();i=Ds(o);var u=ks(s,i,o);u!==null&&(Zn(u,s,o),Xl(u,s,o)),s={cache:Uf()},i.payload=s;return}s=s.return}}function IR(i,s,o){var u=gi();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},rd(i)?X_(s,o):(o=Rf(i,s,o,u),o!==null&&(Zn(o,i,u),J_(o,s,u)))}function Q_(i,s,o){var u=gi();nc(i,s,o,u)}function nc(i,s,o,u){var p={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(rd(i))X_(s,p);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var w=s.lastRenderedState,R=y(w,o);if(p.hasEagerState=!0,p.eagerState=R,ui(R,w))return Vu(i,s,p,0),zt===null&&Uu(),!1}catch{}finally{}if(o=Rf(i,s,p,u),o!==null)return Zn(o,i,u),J_(o,s,u),!0}return!1}function cm(i,s,o,u){if(u={lane:2,revertLane:Bm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},rd(i)){if(s)throw Error(r(479))}else s=Rf(i,o,u,2),s!==null&&Zn(s,i,2)}function rd(i){var s=i.alternate;return i===nt||s!==null&&s===nt}function X_(i,s){ko=Xu=!0;var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}function J_(i,s,o){if((o&4194048)!==0){var u=s.lanes;u&=i.pendingLanes,o|=u,s.lanes=o,hs(i,o)}}var ic={readContext:Nn,use:ed,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useLayoutEffect:tn,useInsertionEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useSyncExternalStore:tn,useId:tn,useHostTransitionStatus:tn,useFormState:tn,useActionState:tn,useOptimistic:tn,useMemoCache:tn,useCacheRefresh:tn};ic.useEffectEvent=tn;var Z_={readContext:Nn,use:ed,useCallback:function(i,s){return $n().memoizedState=[i,s===void 0?null:s],i},useContext:Nn,useEffect:L_,useImperativeHandle:function(i,s,o){o=o!=null?o.concat([i]):null,nd(4194308,4,z_.bind(null,s,i),o)},useLayoutEffect:function(i,s){return nd(4194308,4,i,s)},useInsertionEffect:function(i,s){nd(4,2,i,s)},useMemo:function(i,s){var o=$n();s=s===void 0?null:s;var u=i();if(Va){Fe(!0);try{i()}finally{Fe(!1)}}return o.memoizedState=[u,s],u},useReducer:function(i,s,o){var u=$n();if(o!==void 0){var p=o(s);if(Va){Fe(!0);try{o(s)}finally{Fe(!1)}}}else p=s;return u.memoizedState=u.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},u.queue=i,i=i.dispatch=IR.bind(null,nt,i),[u.memoizedState,i]},useRef:function(i){var s=$n();return i={current:i},s.memoizedState=i},useState:function(i){i=nm(i);var s=i.queue,o=Q_.bind(null,nt,s);return s.dispatch=o,[i.memoizedState,o]},useDebugValue:sm,useDeferredValue:function(i,s){var o=$n();return am(o,i,s)},useTransition:function(){var i=nm(!1);return i=$_.bind(null,nt,i.queue,!0,!1),$n().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,o){var u=nt,p=$n();if(mt){if(o===void 0)throw Error(r(407));o=o()}else{if(o=s(),zt===null)throw Error(r(349));(ut&127)!==0||E_(u,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,L_(w_.bind(null,u,y,i),[i]),u.flags|=2048,Lo(9,{destroy:void 0},S_.bind(null,u,y,o,s),null),o},useId:function(){var i=$n(),s=zt.identifierPrefix;if(mt){var o=ur,u=cr;o=(u&~(1<<32-Et(u)-1)).toString(32)+o,s="_"+s+"R_"+o,o=Ju++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=ER++,s="_"+s+"r_"+o.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:lm,useFormState:O_,useActionState:O_,useOptimistic:function(i){var s=$n();s.memoizedState=s.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=cm.bind(null,nt,!0,o),o.dispatch=s,[i,s]},useMemoCache:Zf,useCacheRefresh:function(){return $n().memoizedState=RR.bind(null,nt)},useEffectEvent:function(i){var s=$n(),o={impl:i};return s.memoizedState=o,function(){if((Tt&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},um={readContext:Nn,use:ed,useCallback:F_,useContext:Nn,useEffect:rm,useImperativeHandle:B_,useInsertionEffect:V_,useLayoutEffect:j_,useMemo:G_,useReducer:td,useRef:M_,useState:function(){return td(Br)},useDebugValue:sm,useDeferredValue:function(i,s){var o=ln();return H_(o,Lt.memoizedState,i,s)},useTransition:function(){var i=td(Br)[0],s=ln().memoizedState;return[typeof i=="boolean"?i:tc(i),s]},useSyncExternalStore:v_,useId:K_,useHostTransitionStatus:lm,useFormState:x_,useActionState:x_,useOptimistic:function(i,s){var o=ln();return A_(o,Lt,i,s)},useMemoCache:Zf,useCacheRefresh:W_};um.useEffectEvent=U_;var e0={readContext:Nn,use:ed,useCallback:F_,useContext:Nn,useEffect:rm,useImperativeHandle:B_,useInsertionEffect:V_,useLayoutEffect:j_,useMemo:G_,useReducer:tm,useRef:M_,useState:function(){return tm(Br)},useDebugValue:sm,useDeferredValue:function(i,s){var o=ln();return Lt===null?am(o,i,s):H_(o,Lt.memoizedState,i,s)},useTransition:function(){var i=tm(Br)[0],s=ln().memoizedState;return[typeof i=="boolean"?i:tc(i),s]},useSyncExternalStore:v_,useId:K_,useHostTransitionStatus:lm,useFormState:k_,useActionState:k_,useOptimistic:function(i,s){var o=ln();return Lt!==null?A_(o,Lt,i,s):(o.baseState=i,[i,o.queue.dispatch])},useMemoCache:Zf,useCacheRefresh:W_};e0.useEffectEvent=U_;function dm(i,s,o,u){s=i.memoizedState,o=o(u,s),o=o==null?s:_({},s,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var hm={enqueueSetState:function(i,s,o){i=i._reactInternals;var u=gi(),p=Ds(u);p.payload=s,o!=null&&(p.callback=o),s=ks(i,p,u),s!==null&&(Zn(s,i,u),Xl(s,i,u))},enqueueReplaceState:function(i,s,o){i=i._reactInternals;var u=gi(),p=Ds(u);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=ks(i,p,u),s!==null&&(Zn(s,i,u),Xl(s,i,u))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var o=gi(),u=Ds(o);u.tag=2,s!=null&&(u.callback=s),s=ks(i,u,o),s!==null&&(Zn(s,i,o),Xl(s,i,o))}};function t0(i,s,o,u,p,y,w){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,y,w):s.prototype&&s.prototype.isPureReactComponent?!Gl(o,u)||!Gl(p,y):!0}function n0(i,s,o,u){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==i&&hm.enqueueReplaceState(s,s.state,null)}function ja(i,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(i=i.defaultProps){o===s&&(o=_({},o));for(var p in i)o[p]===void 0&&(o[p]=i[p])}return o}function i0(i){Lu(i)}function r0(i){console.error(i)}function s0(i){Lu(i)}function sd(i,s){try{var o=i.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function a0(i,s,o){try{var u=i.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function fm(i,s,o){return o=Ds(o),o.tag=3,o.payload={element:null},o.callback=function(){sd(i,s)},o}function o0(i){return i=Ds(i),i.tag=3,i}function l0(i,s,o,u){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=u.value;i.payload=function(){return p(y)},i.callback=function(){a0(s,o,u)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(i.callback=function(){a0(s,o,u),typeof p!="function"&&(zs===null?zs=new Set([this]):zs.add(this));var R=u.stack;this.componentDidCatch(u.value,{componentStack:R!==null?R:""})})}function PR(i,s,o,u,p){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&Po(s,o,p,!0),o=hi.current,o!==null){switch(o.tag){case 31:case 13:return Ci===null?yd():o.alternate===null&&nn===0&&(nn=3),o.flags&=-257,o.flags|=65536,o.lanes=p,u===qu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),Vm(i,u,p)),!1;case 22:return o.flags|=65536,u===qu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),Vm(i,u,p)),!1}throw Error(r(435,o.tag))}return Vm(i,u,p),yd(),!1}if(mt)return s=hi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,u!==xf&&(i=Error(r(422),{cause:u}),ql(Ai(i,o)))):(u!==xf&&(s=Error(r(423),{cause:u}),ql(Ai(s,o))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,u=Ai(u,o),p=fm(i.stateNode,u,p),Gf(i,p),nn!==4&&(nn=2)),!1;var y=Error(r(520),{cause:u});if(y=Ai(y,o),dc===null?dc=[y]:dc.push(y),nn!==4&&(nn=2),s===null)return!0;u=Ai(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,i=p&-p,o.lanes|=i,i=fm(o.stateNode,u,i),Gf(o,i),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(zs===null||!zs.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=o0(p),l0(p,i,o,u),Gf(o,p),!1}o=o.return}while(o!==null);return!1}var mm=Error(r(461)),mn=!1;function On(i,s,o,u){s.child=i===null?h_(s,null,o,u):Ua(s,i.child,o,u)}function c0(i,s,o,u,p){o=o.render;var y=s.ref;if("ref"in u){var w={};for(var R in u)R!=="ref"&&(w[R]=u[R])}else w=u;return Da(s),u=Wf(i,s,o,w,y,p),R=Qf(),i!==null&&!mn?(Xf(i,s,p),Fr(i,s,p)):(mt&&R&&Nf(s),s.flags|=1,On(i,s,u,p),s.child)}function u0(i,s,o,u,p){if(i===null){var y=o.type;return typeof y=="function"&&!If(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,d0(i,s,y,u,p)):(i=zu(o.type,null,u,s,s.mode,p),i.ref=s.ref,i.return=s,s.child=i)}if(y=i.child,!wm(i,p)){var w=y.memoizedProps;if(o=o.compare,o=o!==null?o:Gl,o(w,u)&&i.ref===s.ref)return Fr(i,s,p)}return s.flags|=1,i=Lr(y,u),i.ref=s.ref,i.return=s,s.child=i}function d0(i,s,o,u,p){if(i!==null){var y=i.memoizedProps;if(Gl(y,u)&&i.ref===s.ref)if(mn=!1,s.pendingProps=u=y,wm(i,p))(i.flags&131072)!==0&&(mn=!0);else return s.lanes=i.lanes,Fr(i,s,p)}return pm(i,s,o,u,p)}function h0(i,s,o,u){var p=u.children,y=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,i!==null){for(u=s.child=i.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~y}else u=0,s.child=null;return f0(i,s,y,o,u)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Hu(s,y!==null?y.cachePool:null),y!==null?p_(s,y):$f(),g_(s);else return u=s.lanes=536870912,f0(i,s,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(Hu(s,y.cachePool),p_(s,y),Ls(),s.memoizedState=null):(i!==null&&Hu(s,null),$f(),Ls());return On(i,s,p,o),s.child}function rc(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function f0(i,s,o,u,p){var y=jf();return y=y===null?null:{parent:hn._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},i!==null&&Hu(s,null),$f(),g_(s),i!==null&&Po(i,s,u,!0),s.childLanes=p,null}function ad(i,s){return s=ld({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function m0(i,s,o){return Ua(s,i.child,null,o),i=ad(s,s.pendingProps),i.flags|=2,fi(s),s.memoizedState=null,i}function CR(i,s,o){var u=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(mt){if(u.mode==="hidden")return i=ad(s,u),s.lanes=536870912,rc(null,i);if(Yf(s),(i=qt)?(i=Rv(i,Pi),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Ps!==null?{id:cr,overflow:ur}:null,retryLane:536870912,hydrationErrors:null},o=Xy(i),o.return=s,s.child=o,Cn=s,qt=null)):i=null,i===null)throw Ns(s);return s.lanes=536870912,null}return ad(s,u)}var y=i.memoizedState;if(y!==null){var w=y.dehydrated;if(Yf(s),p)if(s.flags&256)s.flags&=-257,s=m0(i,s,o);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(r(558));else if(mn||Po(i,s,o,!1),p=(o&i.childLanes)!==0,mn||p){if(u=zt,u!==null&&(w=fs(u,o),w!==0&&w!==y.retryLane))throw y.retryLane=w,Ca(i,w),Zn(u,i,w),mm;yd(),s=m0(i,s,o)}else i=y.treeContext,qt=Ni(w.nextSibling),Cn=s,mt=!0,Cs=null,Pi=!1,i!==null&&e_(s,i),s=ad(s,u),s.flags|=4096;return s}return i=Lr(i.child,{mode:u.mode,children:u.children}),i.ref=s.ref,s.child=i,i.return=s,i}function od(i,s){var o=s.ref;if(o===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(i===null||i.ref!==o)&&(s.flags|=4194816)}}function pm(i,s,o,u,p){return Da(s),o=Wf(i,s,o,u,void 0,p),u=Qf(),i!==null&&!mn?(Xf(i,s,p),Fr(i,s,p)):(mt&&u&&Nf(s),s.flags|=1,On(i,s,o,p),s.child)}function p0(i,s,o,u,p,y){return Da(s),s.updateQueue=null,o=__(s,u,o,p),y_(i),u=Qf(),i!==null&&!mn?(Xf(i,s,y),Fr(i,s,y)):(mt&&u&&Nf(s),s.flags|=1,On(i,s,o,y),s.child)}function g0(i,s,o,u,p){if(Da(s),s.stateNode===null){var y=To,w=o.contextType;typeof w=="object"&&w!==null&&(y=Nn(w)),y=new o(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=hm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},Bf(s),w=o.contextType,y.context=typeof w=="object"&&w!==null?Nn(w):To,y.state=s.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(dm(s,o,w,u),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&hm.enqueueReplaceState(y,y.state,null),Zl(s,u,y,p),Jl(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(i===null){y=s.stateNode;var R=s.memoizedProps,V=ja(o,R);y.props=V;var J=y.context,ae=o.contextType;w=To,typeof ae=="object"&&ae!==null&&(w=Nn(ae));var de=o.getDerivedStateFromProps;ae=typeof de=="function"||typeof y.getSnapshotBeforeUpdate=="function",R=s.pendingProps!==R,ae||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(R||J!==w)&&n0(s,y,u,w),xs=!1;var Z=s.memoizedState;y.state=Z,Zl(s,u,y,p),Jl(),J=s.memoizedState,R||Z!==J||xs?(typeof de=="function"&&(dm(s,o,de,u),J=s.memoizedState),(V=xs||t0(s,o,V,u,Z,J,w))?(ae||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=J),y.props=u,y.state=J,y.context=w,u=V):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,Ff(i,s),w=s.memoizedProps,ae=ja(o,w),y.props=ae,de=s.pendingProps,Z=y.context,J=o.contextType,V=To,typeof J=="object"&&J!==null&&(V=Nn(J)),R=o.getDerivedStateFromProps,(J=typeof R=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==de||Z!==V)&&n0(s,y,u,V),xs=!1,Z=s.memoizedState,y.state=Z,Zl(s,u,y,p),Jl();var ne=s.memoizedState;w!==de||Z!==ne||xs||i!==null&&i.dependencies!==null&&Fu(i.dependencies)?(typeof R=="function"&&(dm(s,o,R,u),ne=s.memoizedState),(ae=xs||t0(s,o,ae,u,Z,ne,V)||i!==null&&i.dependencies!==null&&Fu(i.dependencies))?(J||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,ne,V),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,ne,V)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=ne),y.props=u,y.state=ne,y.context=V,u=ae):(typeof y.componentDidUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&Z===i.memoizedState||(s.flags|=1024),u=!1)}return y=u,od(i,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,i!==null&&u?(s.child=Ua(s,i.child,null,p),s.child=Ua(s,null,o,p)):On(i,s,o,p),s.memoizedState=y.state,i=s.child):i=Fr(i,s,p),i}function y0(i,s,o,u){return Oa(),s.flags|=256,On(i,s,o,u),s.child}var gm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ym(i){return{baseLanes:i,cachePool:a_()}}function _m(i,s,o){return i=i!==null?i.childLanes&~o:0,s&&(i|=pi),i}function _0(i,s,o){var u=s.pendingProps,p=!1,y=(s.flags&128)!==0,w;if((w=y)||(w=i!==null&&i.memoizedState===null?!1:(on.current&2)!==0),w&&(p=!0,s.flags&=-129),w=(s.flags&32)!==0,s.flags&=-33,i===null){if(mt){if(p?Ms(s):Ls(),(i=qt)?(i=Rv(i,Pi),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Ps!==null?{id:cr,overflow:ur}:null,retryLane:536870912,hydrationErrors:null},o=Xy(i),o.return=s,s.child=o,Cn=s,qt=null)):i=null,i===null)throw Ns(s);return ep(i)?s.lanes=32:s.lanes=536870912,null}var R=u.children;return u=u.fallback,p?(Ls(),p=s.mode,R=ld({mode:"hidden",children:R},p),u=Na(u,p,o,null),R.return=s,u.return=s,R.sibling=u,s.child=R,u=s.child,u.memoizedState=ym(o),u.childLanes=_m(i,w,o),s.memoizedState=gm,rc(null,u)):(Ms(s),vm(s,R))}var V=i.memoizedState;if(V!==null&&(R=V.dehydrated,R!==null)){if(y)s.flags&256?(Ms(s),s.flags&=-257,s=Em(i,s,o)):s.memoizedState!==null?(Ls(),s.child=i.child,s.flags|=128,s=null):(Ls(),R=u.fallback,p=s.mode,u=ld({mode:"visible",children:u.children},p),R=Na(R,p,o,null),R.flags|=2,u.return=s,R.return=s,u.sibling=R,s.child=u,Ua(s,i.child,null,o),u=s.child,u.memoizedState=ym(o),u.childLanes=_m(i,w,o),s.memoizedState=gm,s=rc(null,u));else if(Ms(s),ep(R)){if(w=R.nextSibling&&R.nextSibling.dataset,w)var J=w.dgst;w=J,u=Error(r(419)),u.stack="",u.digest=w,ql({value:u,source:null,stack:null}),s=Em(i,s,o)}else if(mn||Po(i,s,o,!1),w=(o&i.childLanes)!==0,mn||w){if(w=zt,w!==null&&(u=fs(w,o),u!==0&&u!==V.retryLane))throw V.retryLane=u,Ca(i,u),Zn(w,i,u),mm;Zm(R)||yd(),s=Em(i,s,o)}else Zm(R)?(s.flags|=192,s.child=i.child,s=null):(i=V.treeContext,qt=Ni(R.nextSibling),Cn=s,mt=!0,Cs=null,Pi=!1,i!==null&&e_(s,i),s=vm(s,u.children),s.flags|=4096);return s}return p?(Ls(),R=u.fallback,p=s.mode,V=i.child,J=V.sibling,u=Lr(V,{mode:"hidden",children:u.children}),u.subtreeFlags=V.subtreeFlags&65011712,J!==null?R=Lr(J,R):(R=Na(R,p,o,null),R.flags|=2),R.return=s,u.return=s,u.sibling=R,s.child=u,rc(null,u),u=s.child,R=i.child.memoizedState,R===null?R=ym(o):(p=R.cachePool,p!==null?(V=hn._currentValue,p=p.parent!==V?{parent:V,pool:V}:p):p=a_(),R={baseLanes:R.baseLanes|o,cachePool:p}),u.memoizedState=R,u.childLanes=_m(i,w,o),s.memoizedState=gm,rc(i.child,u)):(Ms(s),o=i.child,i=o.sibling,o=Lr(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,i!==null&&(w=s.deletions,w===null?(s.deletions=[i],s.flags|=16):w.push(i)),s.child=o,s.memoizedState=null,o)}function vm(i,s){return s=ld({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function ld(i,s){return i=di(22,i,null,s),i.lanes=0,i}function Em(i,s,o){return Ua(s,i.child,null,o),i=vm(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function v0(i,s,o){i.lanes|=s;var u=i.alternate;u!==null&&(u.lanes|=s),Mf(i.return,s,o)}function Sm(i,s,o,u,p,y){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:p,treeForkCount:y}:(w.isBackwards=s,w.rendering=null,w.renderingStartTime=0,w.last=u,w.tail=o,w.tailMode=p,w.treeForkCount=y)}function E0(i,s,o){var u=s.pendingProps,p=u.revealOrder,y=u.tail;u=u.children;var w=on.current,R=(w&2)!==0;if(R?(w=w&1|2,s.flags|=128):w&=1,ue(on,w),On(i,s,u,o),u=mt?$l:0,!R&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&v0(i,o,s);else if(i.tag===19)v0(i,o,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)i=o.alternate,i!==null&&Qu(i)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Sm(s,!1,p,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(i=p.alternate,i!==null&&Qu(i)===null){s.child=p;break}i=p.sibling,p.sibling=o,o=p,p=i}Sm(s,!0,o,null,y,u);break;case"together":Sm(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function Fr(i,s,o){if(i!==null&&(s.dependencies=i.dependencies),js|=s.lanes,(o&s.childLanes)===0)if(i!==null){if(Po(i,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,o=Lr(i,i.pendingProps),s.child=o,o.return=s;i.sibling!==null;)i=i.sibling,o=o.sibling=Lr(i,i.pendingProps),o.return=s;o.sibling=null}return s.child}function wm(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Fu(i)))}function NR(i,s,o){switch(s.tag){case 3:Mt(s,s.stateNode.containerInfo),Os(s,hn,i.memoizedState.cache),Oa();break;case 27:case 5:Je(s);break;case 4:Mt(s,s.stateNode.containerInfo);break;case 10:Os(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Yf(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(Ms(s),s.flags|=128,null):(o&s.child.childLanes)!==0?_0(i,s,o):(Ms(s),i=Fr(i,s,o),i!==null?i.sibling:null);Ms(s);break;case 19:var p=(i.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(Po(i,s,o,!1),u=(o&s.childLanes)!==0),p){if(u)return E0(i,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ue(on,on.current),u)break;return null;case 22:return s.lanes=0,h0(i,s,o,s.pendingProps);case 24:Os(s,hn,i.memoizedState.cache)}return Fr(i,s,o)}function S0(i,s,o){if(i!==null)if(i.memoizedProps!==s.pendingProps)mn=!0;else{if(!wm(i,o)&&(s.flags&128)===0)return mn=!1,NR(i,s,o);mn=(i.flags&131072)!==0}else mn=!1,mt&&(s.flags&1048576)!==0&&Zy(s,$l,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(i=Ma(s.elementType),s.type=i,typeof i=="function")If(i)?(u=ja(i,u),s.tag=1,s=g0(null,s,i,u,o)):(s.tag=0,s=pm(null,s,i,u,o));else{if(i!=null){var p=i.$$typeof;if(p===z){s.tag=11,s=c0(null,s,i,u,o);break e}else if(p===D){s.tag=14,s=u0(null,s,i,u,o);break e}}throw s=Ve(i)||i,Error(r(306,s,""))}}return s;case 0:return pm(i,s,s.type,s.pendingProps,o);case 1:return u=s.type,p=ja(u,s.pendingProps),g0(i,s,u,p,o);case 3:e:{if(Mt(s,s.stateNode.containerInfo),i===null)throw Error(r(387));u=s.pendingProps;var y=s.memoizedState;p=y.element,Ff(i,s),Zl(s,u,null,o);var w=s.memoizedState;if(u=w.cache,Os(s,hn,u),u!==y.cache&&Lf(s,[hn],o,!0),Jl(),u=w.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:w.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=y0(i,s,u,o);break e}else if(u!==p){p=Ai(Error(r(424)),s),ql(p),s=y0(i,s,u,o);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(qt=Ni(i.firstChild),Cn=s,mt=!0,Cs=null,Pi=!0,o=h_(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Oa(),u===p){s=Fr(i,s,o);break e}On(i,s,u,o)}s=s.child}return s;case 26:return od(i,s),i===null?(o=xv(s.type,null,s.pendingProps,null))?s.memoizedState=o:mt||(o=s.type,i=s.pendingProps,u=Td(ze.current).createElement(o),u[Zt]=s,u[Pn]=i,xn(u,o,i),an(u),s.stateNode=u):s.memoizedState=xv(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Je(s),i===null&&mt&&(u=s.stateNode=Cv(s.type,s.pendingProps,ze.current),Cn=s,Pi=!0,p=qt,Hs(s.type)?(tp=p,qt=Ni(u.firstChild)):qt=p),On(i,s,s.pendingProps.children,o),od(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&mt&&((p=u=qt)&&(u=aI(u,s.type,s.pendingProps,Pi),u!==null?(s.stateNode=u,Cn=s,qt=Ni(u.firstChild),Pi=!1,p=!0):p=!1),p||Ns(s)),Je(s),p=s.type,y=s.pendingProps,w=i!==null?i.memoizedProps:null,u=y.children,Qm(p,y)?u=null:w!==null&&Qm(p,w)&&(s.flags|=32),s.memoizedState!==null&&(p=Wf(i,s,SR,null,null,o),vc._currentValue=p),od(i,s),On(i,s,u,o),s.child;case 6:return i===null&&mt&&((i=o=qt)&&(o=oI(o,s.pendingProps,Pi),o!==null?(s.stateNode=o,Cn=s,qt=null,i=!0):i=!1),i||Ns(s)),null;case 13:return _0(i,s,o);case 4:return Mt(s,s.stateNode.containerInfo),u=s.pendingProps,i===null?s.child=Ua(s,null,u,o):On(i,s,u,o),s.child;case 11:return c0(i,s,s.type,s.pendingProps,o);case 7:return On(i,s,s.pendingProps,o),s.child;case 8:return On(i,s,s.pendingProps.children,o),s.child;case 12:return On(i,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,Os(s,s.type,u.value),On(i,s,u.children,o),s.child;case 9:return p=s.type._context,u=s.pendingProps.children,Da(s),p=Nn(p),u=u(p),s.flags|=1,On(i,s,u,o),s.child;case 14:return u0(i,s,s.type,s.pendingProps,o);case 15:return d0(i,s,s.type,s.pendingProps,o);case 19:return E0(i,s,o);case 31:return CR(i,s,o);case 22:return h0(i,s,o,s.pendingProps);case 24:return Da(s),u=Nn(hn),i===null?(p=jf(),p===null&&(p=zt,y=Uf(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:u,cache:p},Bf(s),Os(s,hn,p)):((i.lanes&o)!==0&&(Ff(i,s),Zl(s,null,null,o),Jl()),p=i.memoizedState,y=s.memoizedState,p.parent!==u?(p={parent:u,cache:u},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),Os(s,hn,u)):(u=y.cache,Os(s,hn,u),u!==p.cache&&Lf(s,[hn],o,!0))),On(i,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Gr(i){i.flags|=4}function bm(i,s,o,u,p){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(p&335544128)===p)if(i.stateNode.complete)i.flags|=8192;else if(K0())i.flags|=8192;else throw La=qu,zf}else i.flags&=-16777217}function w0(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Uv(s))if(K0())i.flags|=8192;else throw La=qu,zf}function cd(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Al():536870912,i.lanes|=s,zo|=s)}function sc(i,s){if(!mt)switch(i.tailMode){case"hidden":s=i.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function Yt(i){var s=i.alternate!==null&&i.alternate.child===i.child,o=0,u=0;if(s)for(var p=i.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=u,i.childLanes=o,s}function OR(i,s,o){var u=s.pendingProps;switch(Of(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(s),null;case 1:return Yt(s),null;case 3:return o=s.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),jr(hn),vt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Io(s)?Gr(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Df())),Yt(s),null;case 26:var p=s.type,y=s.memoizedState;return i===null?(Gr(s),y!==null?(Yt(s),w0(s,y)):(Yt(s),bm(s,p,null,u,o))):y?y!==i.memoizedState?(Gr(s),Yt(s),w0(s,y)):(Yt(s),s.flags&=-16777217):(i=i.memoizedProps,i!==u&&Gr(s),Yt(s),bm(s,p,i,u,o)),null;case 27:if(Rt(s),o=ze.current,p=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==u&&Gr(s);else{if(!u){if(s.stateNode===null)throw Error(r(166));return Yt(s),null}i=pe.current,Io(s)?t_(s):(i=Cv(p,u,o),s.stateNode=i,Gr(s))}return Yt(s),null;case 5:if(Rt(s),p=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==u&&Gr(s);else{if(!u){if(s.stateNode===null)throw Error(r(166));return Yt(s),null}if(y=pe.current,Io(s))t_(s);else{var w=Td(ze.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?w.createElement("select",{is:u.is}):w.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?w.createElement(p,{is:u.is}):w.createElement(p)}}y[Zt]=s,y[Pn]=u;e:for(w=s.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===s)break e;for(;w.sibling===null;){if(w.return===null||w.return===s)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}s.stateNode=y;e:switch(xn(y,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Gr(s)}}return Yt(s),bm(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,o),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==u&&Gr(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(r(166));if(i=ze.current,Io(s)){if(i=s.stateNode,o=s.memoizedProps,u=null,p=Cn,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}i[Zt]=s,i=!!(i.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||_v(i.nodeValue,o)),i||Ns(s,!0)}else i=Td(i).createTextNode(u),i[Zt]=s,s.stateNode=i}return Yt(s),null;case 31:if(o=s.memoizedState,i===null||i.memoizedState!==null){if(u=Io(s),o!==null){if(i===null){if(!u)throw Error(r(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[Zt]=s}else Oa(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Yt(s),i=!1}else o=Df(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=o),i=!0;if(!i)return s.flags&256?(fi(s),s):(fi(s),null);if((s.flags&128)!==0)throw Error(r(558))}return Yt(s),null;case 13:if(u=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Io(s),u!==null&&u.dehydrated!==null){if(i===null){if(!p)throw Error(r(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Zt]=s}else Oa(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Yt(s),p=!1}else p=Df(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(fi(s),s):(fi(s),null)}return fi(s),(s.flags&128)!==0?(s.lanes=o,s):(o=u!==null,i=i!==null&&i.memoizedState!==null,o&&(u=s.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==p&&(u.flags|=2048)),o!==i&&o&&(s.child.flags|=8192),cd(s,s.updateQueue),Yt(s),null);case 4:return vt(),i===null&&$m(s.stateNode.containerInfo),Yt(s),null;case 10:return jr(s.type),Yt(s),null;case 19:if(K(on),u=s.memoizedState,u===null)return Yt(s),null;if(p=(s.flags&128)!==0,y=u.rendering,y===null)if(p)sc(u,!1);else{if(nn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(y=Qu(i),y!==null){for(s.flags|=128,sc(u,!1),i=y.updateQueue,s.updateQueue=i,cd(s,i),s.subtreeFlags=0,i=o,o=s.child;o!==null;)Qy(o,i),o=o.sibling;return ue(on,on.current&1|2),mt&&Ur(s,u.treeForkCount),s.child}i=i.sibling}u.tail!==null&&Ze()>md&&(s.flags|=128,p=!0,sc(u,!1),s.lanes=4194304)}else{if(!p)if(i=Qu(y),i!==null){if(s.flags|=128,p=!0,i=i.updateQueue,s.updateQueue=i,cd(s,i),sc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!mt)return Yt(s),null}else 2*Ze()-u.renderingStartTime>md&&o!==536870912&&(s.flags|=128,p=!0,sc(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(i=u.last,i!==null?i.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(i=u.tail,u.rendering=i,u.tail=i.sibling,u.renderingStartTime=Ze(),i.sibling=null,o=on.current,ue(on,p?o&1|2:o&1),mt&&Ur(s,u.treeForkCount),i):(Yt(s),null);case 22:case 23:return fi(s),qf(),u=s.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&(Yt(s),s.subtreeFlags&6&&(s.flags|=8192)):Yt(s),o=s.updateQueue,o!==null&&cd(s,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),i!==null&&K(ka),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),jr(hn),Yt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function xR(i,s){switch(Of(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return jr(hn),vt(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Rt(s),null;case 31:if(s.memoizedState!==null){if(fi(s),s.alternate===null)throw Error(r(340));Oa()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(fi(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Oa()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return K(on),null;case 4:return vt(),null;case 10:return jr(s.type),null;case 22:case 23:return fi(s),qf(),i!==null&&K(ka),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return jr(hn),null;case 25:return null;default:return null}}function b0(i,s){switch(Of(s),s.tag){case 3:jr(hn),vt();break;case 26:case 27:case 5:Rt(s);break;case 4:vt();break;case 31:s.memoizedState!==null&&fi(s);break;case 13:fi(s);break;case 19:K(on);break;case 10:jr(s.type);break;case 22:case 23:fi(s),qf(),i!==null&&K(ka);break;case 24:jr(hn)}}function ac(i,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var p=u.next;o=p;do{if((o.tag&i)===i){u=void 0;var y=o.create,w=o.inst;u=y(),w.destroy=u}o=o.next}while(o!==p)}}catch(R){xt(s,s.return,R)}}function Us(i,s,o){try{var u=s.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&i)===i){var w=u.inst,R=w.destroy;if(R!==void 0){w.destroy=void 0,p=s;var V=o,J=R;try{J()}catch(ae){xt(p,V,ae)}}}u=u.next}while(u!==y)}}catch(ae){xt(s,s.return,ae)}}function T0(i){var s=i.updateQueue;if(s!==null){var o=i.stateNode;try{m_(s,o)}catch(u){xt(i,i.return,u)}}}function A0(i,s,o){o.props=ja(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(u){xt(i,s,u)}}function oc(i,s){try{var o=i.ref;if(o!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof o=="function"?i.refCleanup=o(u):o.current=u}}catch(p){xt(i,s,p)}}function dr(i,s){var o=i.ref,u=i.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(p){xt(i,s,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){xt(i,s,p)}else o.current=null}function R0(i){var s=i.type,o=i.memoizedProps,u=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(p){xt(i,i.return,p)}}function Tm(i,s,o){try{var u=i.stateNode;eI(u,i.type,o,s),u[Pn]=s}catch(p){xt(i,i.return,p)}}function I0(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Hs(i.type)||i.tag===4}function Am(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||I0(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Hs(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Rm(i,s,o){var u=i.tag;if(u===5||u===6)i=i.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(i,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(i),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=wn));else if(u!==4&&(u===27&&Hs(i.type)&&(o=i.stateNode,s=null),i=i.child,i!==null))for(Rm(i,s,o),i=i.sibling;i!==null;)Rm(i,s,o),i=i.sibling}function ud(i,s,o){var u=i.tag;if(u===5||u===6)i=i.stateNode,s?o.insertBefore(i,s):o.appendChild(i);else if(u!==4&&(u===27&&Hs(i.type)&&(o=i.stateNode),i=i.child,i!==null))for(ud(i,s,o),i=i.sibling;i!==null;)ud(i,s,o),i=i.sibling}function P0(i){var s=i.stateNode,o=i.memoizedProps;try{for(var u=i.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);xn(s,u,o),s[Zt]=i,s[Pn]=o}catch(y){xt(i,i.return,y)}}var Hr=!1,pn=!1,Im=!1,C0=typeof WeakSet=="function"?WeakSet:Set,An=null;function DR(i,s){if(i=i.containerInfo,Km=Od,i=By(i),Ef(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var p=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var w=0,R=-1,V=-1,J=0,ae=0,de=i,Z=null;t:for(;;){for(var ne;de!==o||p!==0&&de.nodeType!==3||(R=w+p),de!==y||u!==0&&de.nodeType!==3||(V=w+u),de.nodeType===3&&(w+=de.nodeValue.length),(ne=de.firstChild)!==null;)Z=de,de=ne;for(;;){if(de===i)break t;if(Z===o&&++J===p&&(R=w),Z===y&&++ae===u&&(V=w),(ne=de.nextSibling)!==null)break;de=Z,Z=de.parentNode}de=ne}o=R===-1||V===-1?null:{start:R,end:V}}else o=null}o=o||{start:0,end:0}}else o=null;for(Wm={focusedElem:i,selectionRange:o},Od=!1,An=s;An!==null;)if(s=An,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,An=i;else for(;An!==null;){switch(s=An,y=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(o=0;o<i.length;o++)p=i[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var Oe=ja(o.type,p);i=u.getSnapshotBeforeUpdate(Oe,y),u.__reactInternalSnapshotBeforeUpdate=i}catch(Be){xt(o,o.return,Be)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,o=i.nodeType,o===9)Jm(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Jm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,An=i;break}An=s.return}}function N0(i,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:qr(i,o),u&4&&ac(5,o);break;case 1:if(qr(i,o),u&4)if(i=o.stateNode,s===null)try{i.componentDidMount()}catch(w){xt(o,o.return,w)}else{var p=ja(o.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(p,s,i.__reactInternalSnapshotBeforeUpdate)}catch(w){xt(o,o.return,w)}}u&64&&T0(o),u&512&&oc(o,o.return);break;case 3:if(qr(i,o),u&64&&(i=o.updateQueue,i!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{m_(i,s)}catch(w){xt(o,o.return,w)}}break;case 27:s===null&&u&4&&P0(o);case 26:case 5:qr(i,o),s===null&&u&4&&R0(o),u&512&&oc(o,o.return);break;case 12:qr(i,o);break;case 31:qr(i,o),u&4&&D0(i,o);break;case 13:qr(i,o),u&4&&k0(i,o),u&64&&(i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(o=FR.bind(null,o),lI(i,o))));break;case 22:if(u=o.memoizedState!==null||Hr,!u){s=s!==null&&s.memoizedState!==null||pn,p=Hr;var y=pn;Hr=u,(pn=s)&&!y?Yr(i,o,(o.subtreeFlags&8772)!==0):qr(i,o),Hr=p,pn=y}break;case 30:break;default:qr(i,o)}}function O0(i){var s=i.alternate;s!==null&&(i.alternate=null,O0(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&ya(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Kt=null,Wn=!1;function $r(i,s,o){for(o=o.child;o!==null;)x0(i,s,o),o=o.sibling}function x0(i,s,o){if(yt&&typeof yt.onCommitFiberUnmount=="function")try{yt.onCommitFiberUnmount(Pt,o)}catch{}switch(o.tag){case 26:pn||dr(o,s),$r(i,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:pn||dr(o,s);var u=Kt,p=Wn;Hs(o.type)&&(Kt=o.stateNode,Wn=!1),$r(i,s,o),gc(o.stateNode),Kt=u,Wn=p;break;case 5:pn||dr(o,s);case 6:if(u=Kt,p=Wn,Kt=null,$r(i,s,o),Kt=u,Wn=p,Kt!==null)if(Wn)try{(Kt.nodeType===9?Kt.body:Kt.nodeName==="HTML"?Kt.ownerDocument.body:Kt).removeChild(o.stateNode)}catch(y){xt(o,s,y)}else try{Kt.removeChild(o.stateNode)}catch(y){xt(o,s,y)}break;case 18:Kt!==null&&(Wn?(i=Kt,Tv(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,o.stateNode),Ko(i)):Tv(Kt,o.stateNode));break;case 4:u=Kt,p=Wn,Kt=o.stateNode.containerInfo,Wn=!0,$r(i,s,o),Kt=u,Wn=p;break;case 0:case 11:case 14:case 15:Us(2,o,s),pn||Us(4,o,s),$r(i,s,o);break;case 1:pn||(dr(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&A0(o,s,u)),$r(i,s,o);break;case 21:$r(i,s,o);break;case 22:pn=(u=pn)||o.memoizedState!==null,$r(i,s,o),pn=u;break;default:$r(i,s,o)}}function D0(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Ko(i)}catch(o){xt(s,s.return,o)}}}function k0(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Ko(i)}catch(o){xt(s,s.return,o)}}function kR(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new C0),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new C0),s;default:throw Error(r(435,i.tag))}}function dd(i,s){var o=kR(i);s.forEach(function(u){if(!o.has(u)){o.add(u);var p=GR.bind(null,i,u);u.then(p,p)}})}function Qn(i,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var p=o[u],y=i,w=s,R=w;e:for(;R!==null;){switch(R.tag){case 27:if(Hs(R.type)){Kt=R.stateNode,Wn=!1;break e}break;case 5:Kt=R.stateNode,Wn=!1;break e;case 3:case 4:Kt=R.stateNode.containerInfo,Wn=!0;break e}R=R.return}if(Kt===null)throw Error(r(160));x0(y,w,p),Kt=null,Wn=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)M0(s,i),s=s.sibling}var Hi=null;function M0(i,s){var o=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Qn(s,i),Xn(i),u&4&&(Us(3,i,i.return),ac(3,i),Us(5,i,i.return));break;case 1:Qn(s,i),Xn(i),u&512&&(pn||o===null||dr(o,o.return)),u&64&&Hr&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var p=Hi;if(Qn(s,i),Xn(i),u&512&&(pn||o===null||dr(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=i.memoizedState,o===null)if(u===null)if(i.stateNode===null){e:{u=i.type,o=i.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Pr]||y[Zt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(u),p.head.insertBefore(y,p.querySelector("head > title"))),xn(y,u,o),y[Zt]=i,an(y),u=y;break e;case"link":var w=Mv("link","href",p).get(u+(o.href||""));if(w){for(var R=0;R<w.length;R++)if(y=w[R],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(R,1);break t}}y=p.createElement(u),xn(y,u,o),p.head.appendChild(y);break;case"meta":if(w=Mv("meta","content",p).get(u+(o.content||""))){for(R=0;R<w.length;R++)if(y=w[R],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(R,1);break t}}y=p.createElement(u),xn(y,u,o),p.head.appendChild(y);break;default:throw Error(r(468,u))}y[Zt]=i,an(y),u=y}i.stateNode=u}else Lv(p,i.type,i.stateNode);else i.stateNode=kv(p,u,i.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?Lv(p,i.type,i.stateNode):kv(p,u,i.memoizedProps)):u===null&&i.stateNode!==null&&Tm(i,i.memoizedProps,o.memoizedProps)}break;case 27:Qn(s,i),Xn(i),u&512&&(pn||o===null||dr(o,o.return)),o!==null&&u&4&&Tm(i,i.memoizedProps,o.memoizedProps);break;case 5:if(Qn(s,i),Xn(i),u&512&&(pn||o===null||dr(o,o.return)),i.flags&32){p=i.stateNode;try{bi(p,"")}catch(Oe){xt(i,i.return,Oe)}}u&4&&i.stateNode!=null&&(p=i.memoizedProps,Tm(i,p,o!==null?o.memoizedProps:p)),u&1024&&(Im=!0);break;case 6:if(Qn(s,i),Xn(i),u&4){if(i.stateNode===null)throw Error(r(162));u=i.memoizedProps,o=i.stateNode;try{o.nodeValue=u}catch(Oe){xt(i,i.return,Oe)}}break;case 3:if(Id=null,p=Hi,Hi=Ad(s.containerInfo),Qn(s,i),Hi=p,Xn(i),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Ko(s.containerInfo)}catch(Oe){xt(i,i.return,Oe)}Im&&(Im=!1,L0(i));break;case 4:u=Hi,Hi=Ad(i.stateNode.containerInfo),Qn(s,i),Xn(i),Hi=u;break;case 12:Qn(s,i),Xn(i);break;case 31:Qn(s,i),Xn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,dd(i,u)));break;case 13:Qn(s,i),Xn(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(fd=Ze()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,dd(i,u)));break;case 22:p=i.memoizedState!==null;var V=o!==null&&o.memoizedState!==null,J=Hr,ae=pn;if(Hr=J||p,pn=ae||V,Qn(s,i),pn=ae,Hr=J,Xn(i),u&8192)e:for(s=i.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||V||Hr||pn||za(i)),o=null,s=i;;){if(s.tag===5||s.tag===26){if(o===null){V=o=s;try{if(y=V.stateNode,p)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{R=V.stateNode;var de=V.memoizedProps.style,Z=de!=null&&de.hasOwnProperty("display")?de.display:null;R.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(Oe){xt(V,V.return,Oe)}}}else if(s.tag===6){if(o===null){V=s;try{V.stateNode.nodeValue=p?"":V.memoizedProps}catch(Oe){xt(V,V.return,Oe)}}}else if(s.tag===18){if(o===null){V=s;try{var ne=V.stateNode;p?Av(ne,!0):Av(V.stateNode,!1)}catch(Oe){xt(V,V.return,Oe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=i.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,dd(i,o))));break;case 19:Qn(s,i),Xn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,dd(i,u)));break;case 30:break;case 21:break;default:Qn(s,i),Xn(i)}}function Xn(i){var s=i.flags;if(s&2){try{for(var o,u=i.return;u!==null;){if(I0(u)){o=u;break}u=u.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var p=o.stateNode,y=Am(i);ud(i,y,p);break;case 5:var w=o.stateNode;o.flags&32&&(bi(w,""),o.flags&=-33);var R=Am(i);ud(i,R,w);break;case 3:case 4:var V=o.stateNode.containerInfo,J=Am(i);Rm(i,J,V);break;default:throw Error(r(161))}}catch(ae){xt(i,i.return,ae)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function L0(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;L0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function qr(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)N0(i,s.alternate,s),s=s.sibling}function za(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Us(4,s,s.return),za(s);break;case 1:dr(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&A0(s,s.return,o),za(s);break;case 27:gc(s.stateNode);case 26:case 5:dr(s,s.return),za(s);break;case 22:s.memoizedState===null&&za(s);break;case 30:za(s);break;default:za(s)}i=i.sibling}}function Yr(i,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,p=i,y=s,w=y.flags;switch(y.tag){case 0:case 11:case 15:Yr(p,y,o),ac(4,y);break;case 1:if(Yr(p,y,o),u=y,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(J){xt(u,u.return,J)}if(u=y,p=u.updateQueue,p!==null){var R=u.stateNode;try{var V=p.shared.hiddenCallbacks;if(V!==null)for(p.shared.hiddenCallbacks=null,p=0;p<V.length;p++)f_(V[p],R)}catch(J){xt(u,u.return,J)}}o&&w&64&&T0(y),oc(y,y.return);break;case 27:P0(y);case 26:case 5:Yr(p,y,o),o&&u===null&&w&4&&R0(y),oc(y,y.return);break;case 12:Yr(p,y,o);break;case 31:Yr(p,y,o),o&&w&4&&D0(p,y);break;case 13:Yr(p,y,o),o&&w&4&&k0(p,y);break;case 22:y.memoizedState===null&&Yr(p,y,o),oc(y,y.return);break;case 30:break;default:Yr(p,y,o)}s=s.sibling}}function Pm(i,s){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&Yl(o))}function Cm(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Yl(i))}function $i(i,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)U0(i,s,o,u),s=s.sibling}function U0(i,s,o,u){var p=s.flags;switch(s.tag){case 0:case 11:case 15:$i(i,s,o,u),p&2048&&ac(9,s);break;case 1:$i(i,s,o,u);break;case 3:$i(i,s,o,u),p&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Yl(i)));break;case 12:if(p&2048){$i(i,s,o,u),i=s.stateNode;try{var y=s.memoizedProps,w=y.id,R=y.onPostCommit;typeof R=="function"&&R(w,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(V){xt(s,s.return,V)}}else $i(i,s,o,u);break;case 31:$i(i,s,o,u);break;case 13:$i(i,s,o,u);break;case 23:break;case 22:y=s.stateNode,w=s.alternate,s.memoizedState!==null?y._visibility&2?$i(i,s,o,u):lc(i,s):y._visibility&2?$i(i,s,o,u):(y._visibility|=2,Uo(i,s,o,u,(s.subtreeFlags&10256)!==0||!1)),p&2048&&Pm(w,s);break;case 24:$i(i,s,o,u),p&2048&&Cm(s.alternate,s);break;default:$i(i,s,o,u)}}function Uo(i,s,o,u,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=i,w=s,R=o,V=u,J=w.flags;switch(w.tag){case 0:case 11:case 15:Uo(y,w,R,V,p),ac(8,w);break;case 23:break;case 22:var ae=w.stateNode;w.memoizedState!==null?ae._visibility&2?Uo(y,w,R,V,p):lc(y,w):(ae._visibility|=2,Uo(y,w,R,V,p)),p&&J&2048&&Pm(w.alternate,w);break;case 24:Uo(y,w,R,V,p),p&&J&2048&&Cm(w.alternate,w);break;default:Uo(y,w,R,V,p)}s=s.sibling}}function lc(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=i,u=s,p=u.flags;switch(u.tag){case 22:lc(o,u),p&2048&&Pm(u.alternate,u);break;case 24:lc(o,u),p&2048&&Cm(u.alternate,u);break;default:lc(o,u)}s=s.sibling}}var cc=8192;function Vo(i,s,o){if(i.subtreeFlags&cc)for(i=i.child;i!==null;)V0(i,s,o),i=i.sibling}function V0(i,s,o){switch(i.tag){case 26:Vo(i,s,o),i.flags&cc&&i.memoizedState!==null&&EI(o,Hi,i.memoizedState,i.memoizedProps);break;case 5:Vo(i,s,o);break;case 3:case 4:var u=Hi;Hi=Ad(i.stateNode.containerInfo),Vo(i,s,o),Hi=u;break;case 22:i.memoizedState===null&&(u=i.alternate,u!==null&&u.memoizedState!==null?(u=cc,cc=16777216,Vo(i,s,o),cc=u):Vo(i,s,o));break;default:Vo(i,s,o)}}function j0(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function uc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];An=u,B0(u,i)}j0(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)z0(i),i=i.sibling}function z0(i){switch(i.tag){case 0:case 11:case 15:uc(i),i.flags&2048&&Us(9,i,i.return);break;case 3:uc(i);break;case 12:uc(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,hd(i)):uc(i);break;default:uc(i)}}function hd(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];An=u,B0(u,i)}j0(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Us(8,s,s.return),hd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,hd(s));break;default:hd(s)}i=i.sibling}}function B0(i,s){for(;An!==null;){var o=An;switch(o.tag){case 0:case 11:case 15:Us(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Yl(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,An=u;else e:for(o=i;An!==null;){u=An;var p=u.sibling,y=u.return;if(O0(u),u===o){An=null;break e}if(p!==null){p.return=y,An=p;break e}An=y}}}var MR={getCacheForType:function(i){var s=Nn(hn),o=s.data.get(i);return o===void 0&&(o=i(),s.data.set(i,o)),o},cacheSignal:function(){return Nn(hn).controller.signal}},LR=typeof WeakMap=="function"?WeakMap:Map,Tt=0,zt=null,lt=null,ut=0,Ot=0,mi=null,Vs=!1,jo=!1,Nm=!1,Kr=0,nn=0,js=0,Ba=0,Om=0,pi=0,zo=0,dc=null,Jn=null,xm=!1,fd=0,F0=0,md=1/0,pd=null,zs=null,vn=0,Bs=null,Bo=null,Wr=0,Dm=0,km=null,G0=null,hc=0,Mm=null;function gi(){return(Tt&2)!==0&&ut!==0?ut&-ut:te.T!==null?Bm():Ir()}function H0(){if(pi===0)if((ut&536870912)===0||mt){var i=tr;tr<<=1,(tr&3932160)===0&&(tr=262144),pi=i}else pi=536870912;return i=hi.current,i!==null&&(i.flags|=32),pi}function Zn(i,s,o){(i===zt&&(Ot===2||Ot===9)||i.cancelPendingCommit!==null)&&(Fo(i,0),Fs(i,ut,pi,!1)),ds(i,o),((Tt&2)===0||i!==zt)&&(i===zt&&((Tt&2)===0&&(Ba|=o),nn===4&&Fs(i,ut,pi,!1)),hr(i))}function $0(i,s,o){if((Tt&6)!==0)throw Error(r(327));var u=!o&&(s&127)===0&&(s&i.expiredLanes)===0||us(i,s),p=u?jR(i,s):Um(i,s,!0),y=u;do{if(p===0){jo&&!u&&Fs(i,s,0,!1);break}else{if(o=i.current.alternate,y&&!UR(o)){p=Um(i,s,!1),y=!1;continue}if(p===2){if(y=s,i.errorRecoveryDisabledLanes&y)var w=0;else w=i.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){s=w;e:{var R=i;p=dc;var V=R.current.memoizedState.isDehydrated;if(V&&(Fo(R,w).flags|=256),w=Um(R,w,!1),w!==2){if(Nm&&!V){R.errorRecoveryDisabledLanes|=y,Ba|=y,p=4;break e}y=Jn,Jn=p,y!==null&&(Jn===null?Jn=y:Jn.push.apply(Jn,y))}p=w}if(y=!1,p!==2)continue}}if(p===1){Fo(i,0),Fs(i,s,0,!0);break}e:{switch(u=i,y=p,y){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:Fs(u,s,pi,!Vs);break e;case 2:Jn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(p=fd+300-Ze(),10<p)){if(Fs(u,s,pi,!Vs),Si(u,0,!0)!==0)break e;Wr=s,u.timeoutHandle=wv(q0.bind(null,u,o,Jn,pd,xm,s,pi,Ba,zo,Vs,y,"Throttled",-0,0),p);break e}q0(u,o,Jn,pd,xm,s,pi,Ba,zo,Vs,y,null,-0,0)}}break}while(!0);hr(i)}function q0(i,s,o,u,p,y,w,R,V,J,ae,de,Z,ne){if(i.timeoutHandle=-1,de=s.subtreeFlags,de&8192||(de&16785408)===16785408){de={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:wn},V0(s,y,de);var Oe=(y&62914560)===y?fd-Ze():(y&4194048)===y?F0-Ze():0;if(Oe=SI(de,Oe),Oe!==null){Wr=y,i.cancelPendingCommit=Oe(ev.bind(null,i,s,y,o,u,p,w,R,V,ae,de,null,Z,ne)),Fs(i,y,w,!J);return}}ev(i,s,y,o,u,p,w,R,V)}function UR(i){for(var s=i;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var p=o[u],y=p.getSnapshot;p=p.value;try{if(!ui(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Fs(i,s,o,u){s&=~Om,s&=~Ba,i.suspendedLanes|=s,i.pingedLanes&=~s,u&&(i.warmLanes|=s),u=i.expirationTimes;for(var p=s;0<p;){var y=31-Et(p),w=1<<y;u[y]=-1,p&=~w}o!==0&&Rl(i,o,s)}function gd(){return(Tt&6)===0?(fc(0),!1):!0}function Lm(){if(lt!==null){if(Ot===0)var i=lt.return;else i=lt,Vr=xa=null,Jf(i),xo=null,Wl=0,i=lt;for(;i!==null;)b0(i.alternate,i),i=i.return;lt=null}}function Fo(i,s){var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,iI(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),Wr=0,Lm(),zt=i,lt=o=Lr(i.current,null),ut=s,Ot=0,mi=null,Vs=!1,jo=us(i,s),Nm=!1,zo=pi=Om=Ba=js=nn=0,Jn=dc=null,xm=!1,(s&8)!==0&&(s|=s&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=s;0<u;){var p=31-Et(u),y=1<<p;s|=i[p],u&=~y}return Kr=s,Uu(),o}function Y0(i,s){nt=null,te.H=ic,s===Oo||s===$u?(s=c_(),Ot=3):s===zf?(s=c_(),Ot=4):Ot=s===mm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,mi=s,lt===null&&(nn=1,sd(i,Ai(s,i.current)))}function K0(){var i=hi.current;return i===null?!0:(ut&4194048)===ut?Ci===null:(ut&62914560)===ut||(ut&536870912)!==0?i===Ci:!1}function W0(){var i=te.H;return te.H=ic,i===null?ic:i}function Q0(){var i=te.A;return te.A=MR,i}function yd(){nn=4,Vs||(ut&4194048)!==ut&&hi.current!==null||(jo=!0),(js&134217727)===0&&(Ba&134217727)===0||zt===null||Fs(zt,ut,pi,!1)}function Um(i,s,o){var u=Tt;Tt|=2;var p=W0(),y=Q0();(zt!==i||ut!==s)&&(pd=null,Fo(i,s)),s=!1;var w=nn;e:do try{if(Ot!==0&&lt!==null){var R=lt,V=mi;switch(Ot){case 8:Lm(),w=6;break e;case 3:case 2:case 9:case 6:hi.current===null&&(s=!0);var J=Ot;if(Ot=0,mi=null,Go(i,R,V,J),o&&jo){w=0;break e}break;default:J=Ot,Ot=0,mi=null,Go(i,R,V,J)}}VR(),w=nn;break}catch(ae){Y0(i,ae)}while(!0);return s&&i.shellSuspendCounter++,Vr=xa=null,Tt=u,te.H=p,te.A=y,lt===null&&(zt=null,ut=0,Uu()),w}function VR(){for(;lt!==null;)X0(lt)}function jR(i,s){var o=Tt;Tt|=2;var u=W0(),p=Q0();zt!==i||ut!==s?(pd=null,md=Ze()+500,Fo(i,s)):jo=us(i,s);e:do try{if(Ot!==0&&lt!==null){s=lt;var y=mi;t:switch(Ot){case 1:Ot=0,mi=null,Go(i,s,y,1);break;case 2:case 9:if(o_(y)){Ot=0,mi=null,J0(s);break}s=function(){Ot!==2&&Ot!==9||zt!==i||(Ot=7),hr(i)},y.then(s,s);break e;case 3:Ot=7;break e;case 4:Ot=5;break e;case 7:o_(y)?(Ot=0,mi=null,J0(s)):(Ot=0,mi=null,Go(i,s,y,7));break;case 5:var w=null;switch(lt.tag){case 26:w=lt.memoizedState;case 5:case 27:var R=lt;if(w?Uv(w):R.stateNode.complete){Ot=0,mi=null;var V=R.sibling;if(V!==null)lt=V;else{var J=R.return;J!==null?(lt=J,_d(J)):lt=null}break t}}Ot=0,mi=null,Go(i,s,y,5);break;case 6:Ot=0,mi=null,Go(i,s,y,6);break;case 8:Lm(),nn=6;break e;default:throw Error(r(462))}}zR();break}catch(ae){Y0(i,ae)}while(!0);return Vr=xa=null,te.H=u,te.A=p,Tt=o,lt!==null?0:(zt=null,ut=0,Uu(),nn)}function zR(){for(;lt!==null&&!He();)X0(lt)}function X0(i){var s=S0(i.alternate,i,Kr);i.memoizedProps=i.pendingProps,s===null?_d(i):lt=s}function J0(i){var s=i,o=s.alternate;switch(s.tag){case 15:case 0:s=p0(o,s,s.pendingProps,s.type,void 0,ut);break;case 11:s=p0(o,s,s.pendingProps,s.type.render,s.ref,ut);break;case 5:Jf(s);default:b0(o,s),s=lt=Qy(s,Kr),s=S0(o,s,Kr)}i.memoizedProps=i.pendingProps,s===null?_d(i):lt=s}function Go(i,s,o,u){Vr=xa=null,Jf(s),xo=null,Wl=0;var p=s.return;try{if(PR(i,p,s,o,ut)){nn=1,sd(i,Ai(o,i.current)),lt=null;return}}catch(y){if(p!==null)throw lt=p,y;nn=1,sd(i,Ai(o,i.current)),lt=null;return}s.flags&32768?(mt||u===1?i=!0:jo||(ut&536870912)!==0?i=!1:(Vs=i=!0,(u===2||u===9||u===3||u===6)&&(u=hi.current,u!==null&&u.tag===13&&(u.flags|=16384))),Z0(s,i)):_d(s)}function _d(i){var s=i;do{if((s.flags&32768)!==0){Z0(s,Vs);return}i=s.return;var o=OR(s.alternate,s,Kr);if(o!==null){lt=o;return}if(s=s.sibling,s!==null){lt=s;return}lt=s=i}while(s!==null);nn===0&&(nn=5)}function Z0(i,s){do{var o=xR(i.alternate,i);if(o!==null){o.flags&=32767,lt=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(i=i.sibling,i!==null)){lt=i;return}lt=i=o}while(i!==null);nn=6,lt=null}function ev(i,s,o,u,p,y,w,R,V){i.cancelPendingCommit=null;do vd();while(vn!==0);if((Tt&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(y=s.lanes|s.childLanes,y|=Af,In(i,o,y,w,R,V),i===zt&&(lt=zt=null,ut=0),Bo=s,Bs=i,Wr=o,Dm=y,km=p,G0=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,HR(ge,function(){return sv(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=te.T,te.T=null,p=he.p,he.p=2,w=Tt,Tt|=4;try{DR(i,s,o)}finally{Tt=w,he.p=p,te.T=u}}vn=1,tv(),nv(),iv()}}function tv(){if(vn===1){vn=0;var i=Bs,s=Bo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=te.T,te.T=null;var u=he.p;he.p=2;var p=Tt;Tt|=4;try{M0(s,i);var y=Wm,w=By(i.containerInfo),R=y.focusedElem,V=y.selectionRange;if(w!==R&&R&&R.ownerDocument&&zy(R.ownerDocument.documentElement,R)){if(V!==null&&Ef(R)){var J=V.start,ae=V.end;if(ae===void 0&&(ae=J),"selectionStart"in R)R.selectionStart=J,R.selectionEnd=Math.min(ae,R.value.length);else{var de=R.ownerDocument||document,Z=de&&de.defaultView||window;if(Z.getSelection){var ne=Z.getSelection(),Oe=R.textContent.length,Be=Math.min(V.start,Oe),Vt=V.end===void 0?Be:Math.min(V.end,Oe);!ne.extend&&Be>Vt&&(w=Vt,Vt=Be,Be=w);var q=jy(R,Be),F=jy(R,Vt);if(q&&F&&(ne.rangeCount!==1||ne.anchorNode!==q.node||ne.anchorOffset!==q.offset||ne.focusNode!==F.node||ne.focusOffset!==F.offset)){var Q=de.createRange();Q.setStart(q.node,q.offset),ne.removeAllRanges(),Be>Vt?(ne.addRange(Q),ne.extend(F.node,F.offset)):(Q.setEnd(F.node,F.offset),ne.addRange(Q))}}}}for(de=[],ne=R;ne=ne.parentNode;)ne.nodeType===1&&de.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<de.length;R++){var le=de[R];le.element.scrollLeft=le.left,le.element.scrollTop=le.top}}Od=!!Km,Wm=Km=null}finally{Tt=p,he.p=u,te.T=o}}i.current=s,vn=2}}function nv(){if(vn===2){vn=0;var i=Bs,s=Bo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=te.T,te.T=null;var u=he.p;he.p=2;var p=Tt;Tt|=4;try{N0(i,s.alternate,s)}finally{Tt=p,he.p=u,te.T=o}}vn=3}}function iv(){if(vn===4||vn===3){vn=0,It();var i=Bs,s=Bo,o=Wr,u=G0;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?vn=5:(vn=0,Bo=Bs=null,rv(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(zs=null),Pl(o),s=s.stateNode,yt&&typeof yt.onCommitFiberRoot=="function")try{yt.onCommitFiberRoot(Pt,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=te.T,p=he.p,he.p=2,te.T=null;try{for(var y=i.onRecoverableError,w=0;w<u.length;w++){var R=u[w];y(R.value,{componentStack:R.stack})}}finally{te.T=s,he.p=p}}(Wr&3)!==0&&vd(),hr(i),p=i.pendingLanes,(o&261930)!==0&&(p&42)!==0?i===Mm?hc++:(hc=0,Mm=i):hc=0,fc(0)}}function rv(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Yl(s)))}function vd(){return tv(),nv(),iv(),sv()}function sv(){if(vn!==5)return!1;var i=Bs,s=Dm;Dm=0;var o=Pl(Wr),u=te.T,p=he.p;try{he.p=32>o?32:o,te.T=null,o=km,km=null;var y=Bs,w=Wr;if(vn=0,Bo=Bs=null,Wr=0,(Tt&6)!==0)throw Error(r(331));var R=Tt;if(Tt|=4,z0(y.current),U0(y,y.current,w,o),Tt=R,fc(0,!1),yt&&typeof yt.onPostCommitFiberRoot=="function")try{yt.onPostCommitFiberRoot(Pt,y)}catch{}return!0}finally{he.p=p,te.T=u,rv(i,s)}}function av(i,s,o){s=Ai(o,s),s=fm(i.stateNode,s,2),i=ks(i,s,2),i!==null&&(ds(i,2),hr(i))}function xt(i,s,o){if(i.tag===3)av(i,i,o);else for(;s!==null;){if(s.tag===3){av(s,i,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(zs===null||!zs.has(u))){i=Ai(o,i),o=o0(2),u=ks(s,o,2),u!==null&&(l0(o,u,s,i),ds(u,2),hr(u));break}}s=s.return}}function Vm(i,s,o){var u=i.pingCache;if(u===null){u=i.pingCache=new LR;var p=new Set;u.set(s,p)}else p=u.get(s),p===void 0&&(p=new Set,u.set(s,p));p.has(o)||(Nm=!0,p.add(o),i=BR.bind(null,i,s,o),s.then(i,i))}function BR(i,s,o){var u=i.pingCache;u!==null&&u.delete(s),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,zt===i&&(ut&o)===o&&(nn===4||nn===3&&(ut&62914560)===ut&&300>Ze()-fd?(Tt&2)===0&&Fo(i,0):Om|=o,zo===ut&&(zo=0)),hr(i)}function ov(i,s){s===0&&(s=Al()),i=Ca(i,s),i!==null&&(ds(i,s),hr(i))}function FR(i){var s=i.memoizedState,o=0;s!==null&&(o=s.retryLane),ov(i,o)}function GR(i,s){var o=0;switch(i.tag){case 31:case 13:var u=i.stateNode,p=i.memoizedState;p!==null&&(o=p.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(s),ov(i,o)}function HR(i,s){return be(i,s)}var Ed=null,Ho=null,jm=!1,Sd=!1,zm=!1,Gs=0;function hr(i){i!==Ho&&i.next===null&&(Ho===null?Ed=Ho=i:Ho=Ho.next=i),Sd=!0,jm||(jm=!0,qR())}function fc(i,s){if(!zm&&Sd){zm=!0;do for(var o=!1,u=Ed;u!==null;){if(i!==0){var p=u.pendingLanes;if(p===0)var y=0;else{var w=u.suspendedLanes,R=u.pingedLanes;y=(1<<31-Et(42|i)+1)-1,y&=p&~(w&~R),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,dv(u,y))}else y=ut,y=Si(u,u===zt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||us(u,y)||(o=!0,dv(u,y));u=u.next}while(o);zm=!1}}function $R(){lv()}function lv(){Sd=jm=!1;var i=0;Gs!==0&&nI()&&(i=Gs);for(var s=Ze(),o=null,u=Ed;u!==null;){var p=u.next,y=cv(u,s);y===0?(u.next=null,o===null?Ed=p:o.next=p,p===null&&(Ho=o)):(o=u,(i!==0||(y&3)!==0)&&(Sd=!0)),u=p}vn!==0&&vn!==5||fc(i),Gs!==0&&(Gs=0)}function cv(i,s){for(var o=i.suspendedLanes,u=i.pingedLanes,p=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var w=31-Et(y),R=1<<w,V=p[w];V===-1?((R&o)===0||(R&u)!==0)&&(p[w]=co(R,s)):V<=s&&(i.expiredLanes|=R),y&=~R}if(s=zt,o=ut,o=Si(i,i===s?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,o===0||i===s&&(Ot===2||Ot===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&Ue(u),i.callbackNode=null,i.callbackPriority=0;if((o&3)===0||us(i,o)){if(s=o&-o,s===i.callbackPriority)return s;switch(u!==null&&Ue(u),Pl(o)){case 2:case 8:o=me;break;case 32:o=ge;break;case 268435456:o=ye;break;default:o=ge}return u=uv.bind(null,i),o=be(o,u),i.callbackPriority=s,i.callbackNode=o,s}return u!==null&&u!==null&&Ue(u),i.callbackPriority=2,i.callbackNode=null,2}function uv(i,s){if(vn!==0&&vn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var o=i.callbackNode;if(vd()&&i.callbackNode!==o)return null;var u=ut;return u=Si(i,i===zt?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:($0(i,u,s),cv(i,Ze()),i.callbackNode!=null&&i.callbackNode===o?uv.bind(null,i):null)}function dv(i,s){if(vd())return null;$0(i,s,!0)}function qR(){rI(function(){(Tt&6)!==0?be(_e,$R):lv()})}function Bm(){if(Gs===0){var i=Co;i===0&&(i=ji,ji<<=1,(ji&261888)===0&&(ji=256)),Gs=i}return Gs}function hv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ar(""+i)}function fv(i,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,i.id&&o.setAttribute("form",i.id),s.parentNode.insertBefore(o,s),i=new FormData(i),o.parentNode.removeChild(o),i}function YR(i,s,o,u,p){if(s==="submit"&&o&&o.stateNode===p){var y=hv((p[Pn]||null).action),w=u.submitter;w&&(s=(s=w[Pn]||null)?hv(s.formAction):w.getAttribute("formAction"),s!==null&&(y=s,w=null));var R=new wa("action","action",null,u,p);i.push({event:R,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Gs!==0){var V=w?fv(p,w):new FormData(p);om(o,{pending:!0,data:V,method:p.method,action:y},null,V)}}else typeof y=="function"&&(R.preventDefault(),V=w?fv(p,w):new FormData(p),om(o,{pending:!0,data:V,method:p.method,action:y},y,V))},currentTarget:p}]})}}for(var Fm=0;Fm<Tf.length;Fm++){var Gm=Tf[Fm],KR=Gm.toLowerCase(),WR=Gm[0].toUpperCase()+Gm.slice(1);Gi(KR,"on"+WR)}Gi(Hy,"onAnimationEnd"),Gi($y,"onAnimationIteration"),Gi(qy,"onAnimationStart"),Gi("dblclick","onDoubleClick"),Gi("focusin","onFocus"),Gi("focusout","onBlur"),Gi(dR,"onTransitionRun"),Gi(hR,"onTransitionStart"),Gi(fR,"onTransitionCancel"),Gi(Yy,"onTransitionEnd"),sr("onMouseEnter",["mouseout","mouseover"]),sr("onMouseLeave",["mouseout","mouseover"]),sr("onPointerEnter",["pointerout","pointerover"]),sr("onPointerLeave",["pointerout","pointerover"]),Bn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Bn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Bn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Bn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Bn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Bn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mc));function mv(i,s){s=(s&4)!==0;for(var o=0;o<i.length;o++){var u=i[o],p=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var w=u.length-1;0<=w;w--){var R=u[w],V=R.instance,J=R.currentTarget;if(R=R.listener,V!==y&&p.isPropagationStopped())break e;y=R,p.currentTarget=J;try{y(p)}catch(ae){Lu(ae)}p.currentTarget=null,y=V}else for(w=0;w<u.length;w++){if(R=u[w],V=R.instance,J=R.currentTarget,R=R.listener,V!==y&&p.isPropagationStopped())break e;y=R,p.currentTarget=J;try{y(p)}catch(ae){Lu(ae)}p.currentTarget=null,y=V}}}}function ct(i,s){var o=s[ms];o===void 0&&(o=s[ms]=new Set);var u=i+"__bubble";o.has(u)||(pv(s,i,2,!1),o.add(u))}function Hm(i,s,o){var u=0;s&&(u|=4),pv(o,i,u,s)}var wd="_reactListening"+Math.random().toString(36).slice(2);function $m(i){if(!i[wd]){i[wd]=!0,uo.forEach(function(o){o!=="selectionchange"&&(QR.has(o)||Hm(o,!1,i),Hm(o,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[wd]||(s[wd]=!0,Hm("selectionchange",!1,s))}}function pv(i,s,o,u){switch(Hv(s)){case 2:var p=TI;break;case 8:p=AI;break;default:p=ap}o=p.bind(null,s,o,i),p=void 0,!Ll||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),u?p!==void 0?i.addEventListener(s,o,{capture:!0,passive:p}):i.addEventListener(s,o,!0):p!==void 0?i.addEventListener(s,o,{passive:p}):i.addEventListener(s,o,!1)}function qm(i,s,o,u,p){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var R=u.stateNode.containerInfo;if(R===p)break;if(w===4)for(w=u.return;w!==null;){var V=w.tag;if((V===3||V===4)&&w.stateNode.containerInfo===p)return;w=w.return}for(;R!==null;){if(w=Cr(R),w===null)return;if(V=w.tag,V===5||V===6||V===26||V===27){u=y=w;continue e}R=R.parentNode}}u=u.return}Eu(function(){var J=y,ae=go(o),de=[];e:{var Z=Ky.get(i);if(Z!==void 0){var ne=wa,Oe=i;switch(i){case"keypress":if(Sa(o)===0)break e;case"keydown":case"keyup":ne=Cu;break;case"focusin":Oe="focus",ne=Ts;break;case"focusout":Oe="blur",ne=Ts;break;case"beforeblur":case"afterblur":ne=Ts;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=wu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=bu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=Ou;break;case Hy:case $y:case qy:ne=vo;break;case Yy:ne=Eo;break;case"scroll":case"scrollend":ne=Su;break;case"wheel":ne=Du;break;case"copy":case"cut":case"paste":ne=Au;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=Bl;break;case"toggle":case"beforetoggle":ne=Rs}var Be=(s&4)!==0,Vt=!Be&&(i==="scroll"||i==="scrollend"),q=Be?Z!==null?Z+"Capture":null:Z;Be=[];for(var F=J,Q;F!==null;){var le=F;if(Q=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||Q===null||q===null||(le=Yn(F,q),le!=null&&Be.push(pc(F,le,Q))),Vt)break;F=F.return}0<Be.length&&(Z=new ne(Z,Oe,null,o,ae),de.push({event:Z,listeners:Be}))}}if((s&7)===0){e:{if(Z=i==="mouseover"||i==="pointerover",ne=i==="mouseout"||i==="pointerout",Z&&o!==po&&(Oe=o.relatedTarget||o.fromElement)&&(Cr(Oe)||Oe[ir]))break e;if((ne||Z)&&(Z=ae.window===ae?ae:(Z=ae.ownerDocument)?Z.defaultView||Z.parentWindow:window,ne?(Oe=o.relatedTarget||o.toElement,ne=J,Oe=Oe?Cr(Oe):null,Oe!==null&&(Vt=l(Oe),Be=Oe.tag,Oe!==Vt||Be!==5&&Be!==27&&Be!==6)&&(Oe=null)):(ne=null,Oe=J),ne!==Oe)){if(Be=wu,le="onMouseLeave",q="onMouseEnter",F="mouse",(i==="pointerout"||i==="pointerover")&&(Be=Bl,le="onPointerLeave",q="onPointerEnter",F="pointer"),Vt=ne==null?Z:_a(ne),Q=Oe==null?Z:_a(Oe),Z=new Be(le,F+"leave",ne,o,ae),Z.target=Vt,Z.relatedTarget=Q,le=null,Cr(ae)===J&&(Be=new Be(q,F+"enter",Oe,o,ae),Be.target=Q,Be.relatedTarget=Vt,le=Be),Vt=le,ne&&Oe)t:{for(Be=XR,q=ne,F=Oe,Q=0,le=q;le;le=Be(le))Q++;le=0;for(var Me=F;Me;Me=Be(Me))le++;for(;0<Q-le;)q=Be(q),Q--;for(;0<le-Q;)F=Be(F),le--;for(;Q--;){if(q===F||F!==null&&q===F.alternate){Be=q;break t}q=Be(q),F=Be(F)}Be=null}else Be=null;ne!==null&&gv(de,Z,ne,Be,!1),Oe!==null&&Vt!==null&&gv(de,Vt,Oe,Be,!0)}}e:{if(Z=J?_a(J):window,ne=Z.nodeName&&Z.nodeName.toLowerCase(),ne==="select"||ne==="input"&&Z.type==="file")var wt=Dy;else if(Kn(Z))if(ky)wt=lR;else{wt=aR;var xe=sR}else ne=Z.nodeName,!ne||ne.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?J&&kl(J.elementType)&&(wt=Dy):wt=oR;if(wt&&(wt=wt(i,J))){Ra(de,wt,o,ae);break e}xe&&xe(i,Z,J),i==="focusout"&&J&&Z.type==="number"&&J.memoizedProps.value!=null&&mo(Z,"number",Z.value)}switch(xe=J?_a(J):window,i){case"focusin":(Kn(xe)||xe.contentEditable==="true")&&(So=xe,Sf=J,Hl=null);break;case"focusout":Hl=Sf=So=null;break;case"mousedown":wf=!0;break;case"contextmenu":case"mouseup":case"dragend":wf=!1,Fy(de,o,ae);break;case"selectionchange":if(uR)break;case"keydown":case"keyup":Fy(de,o,ae)}var rt;if(E)e:{switch(i){case"compositionstart":var dt="onCompositionStart";break e;case"compositionend":dt="onCompositionEnd";break e;case"compositionupdate":dt="onCompositionUpdate";break e}dt=void 0}else st?Ct(i,o)&&(dt="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(dt="onCompositionStart");dt&&(Y&&o.locale!=="ko"&&(st||dt!=="onCompositionStart"?dt==="onCompositionEnd"&&st&&(rt=Es()):(ci=ae,yo="value"in ci?ci.value:ci.textContent,st=!0)),xe=bd(J,dt),0<xe.length&&(dt=new Vl(dt,i,null,o,ae),de.push({event:dt,listeners:xe}),rt?dt.data=rt:(rt=dn(o),rt!==null&&(dt.data=rt)))),(rt=O?bn(i,o):Tn(i,o))&&(dt=bd(J,"onBeforeInput"),0<dt.length&&(xe=new Vl("onBeforeInput","beforeinput",null,o,ae),de.push({event:xe,listeners:dt}),xe.data=rt)),YR(de,i,J,o,ae)}mv(de,s)})}function pc(i,s,o){return{instance:i,listener:s,currentTarget:o}}function bd(i,s){for(var o=s+"Capture",u=[];i!==null;){var p=i,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Yn(i,o),p!=null&&u.unshift(pc(i,p,y)),p=Yn(i,s),p!=null&&u.push(pc(i,p,y))),i.tag===3)return u;i=i.return}return[]}function XR(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function gv(i,s,o,u,p){for(var y=s._reactName,w=[];o!==null&&o!==u;){var R=o,V=R.alternate,J=R.stateNode;if(R=R.tag,V!==null&&V===u)break;R!==5&&R!==26&&R!==27||J===null||(V=J,p?(J=Yn(o,y),J!=null&&w.unshift(pc(o,J,V))):p||(J=Yn(o,y),J!=null&&w.push(pc(o,J,V)))),o=o.return}w.length!==0&&i.push({event:s,listeners:w})}var JR=/\r\n?/g,ZR=/\u0000|\uFFFD/g;function yv(i){return(typeof i=="string"?i:""+i).replace(JR,`
`).replace(ZR,"")}function _v(i,s){return s=yv(s),yv(i)===s}function Ut(i,s,o,u,p,y){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||bi(i,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&bi(i,""+u);break;case"className":ys(i,"class",u);break;case"tabIndex":ys(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":ys(i,o,u);break;case"style":_u(i,u,y);break;case"data":if(s!=="object"){ys(i,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){i.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(o);break}u=ar(""+u),i.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&Ut(i,s,"name",p.name,p,null),Ut(i,s,"formEncType",p.formEncType,p,null),Ut(i,s,"formMethod",p.formMethod,p,null),Ut(i,s,"formTarget",p.formTarget,p,null)):(Ut(i,s,"encType",p.encType,p,null),Ut(i,s,"method",p.method,p,null),Ut(i,s,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(o);break}u=ar(""+u),i.setAttribute(o,u);break;case"onClick":u!=null&&(i.onclick=wn);break;case"onScroll":u!=null&&ct("scroll",i);break;case"onScrollEnd":u!=null&&ct("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}o=ar(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(o,""+u):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":u===!0?i.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(o,u):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(o,u):i.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(o):i.setAttribute(o,u);break;case"popover":ct("beforetoggle",i),ct("toggle",i),gs(i,"popover",u);break;case"xlinkActuate":wi(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":wi(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":wi(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":wi(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":wi(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":wi(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":wi(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":wi(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":wi(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":gs(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=pf.get(o)||o,gs(i,o,u))}}function Ym(i,s,o,u,p,y){switch(o){case"style":_u(i,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"children":typeof u=="string"?bi(i,u):(typeof u=="number"||typeof u=="bigint")&&bi(i,""+u);break;case"onScroll":u!=null&&ct("scroll",i);break;case"onScrollEnd":u!=null&&ct("scrollend",i);break;case"onClick":u!=null&&(i.onclick=wn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ps.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=i[Pn]||null,y=y!=null?y[o]:null,typeof y=="function"&&i.removeEventListener(s,y,p),typeof u=="function")){typeof y!="function"&&y!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(s,u,p);break e}o in i?i[o]=u:u===!0?i.setAttribute(o,""):gs(i,o,u)}}}function xn(i,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ct("error",i),ct("load",i);var u=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var w=o[y];if(w!=null)switch(y){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Ut(i,s,y,w,o,null)}}p&&Ut(i,s,"srcSet",o.srcSet,o,null),u&&Ut(i,s,"src",o.src,o,null);return;case"input":ct("invalid",i);var R=y=w=p=null,V=null,J=null;for(u in o)if(o.hasOwnProperty(u)){var ae=o[u];if(ae!=null)switch(u){case"name":p=ae;break;case"type":w=ae;break;case"checked":V=ae;break;case"defaultChecked":J=ae;break;case"value":y=ae;break;case"defaultValue":R=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(137,s));break;default:Ut(i,s,u,ae,o,null)}}va(i,y,R,V,J,w,p,!1);return;case"select":ct("invalid",i),u=w=y=null;for(p in o)if(o.hasOwnProperty(p)&&(R=o[p],R!=null))switch(p){case"value":y=R;break;case"defaultValue":w=R;break;case"multiple":u=R;default:Ut(i,s,p,R,o,null)}s=y,o=w,i.multiple=!!u,s!=null?St(i,!!u,s,!1):o!=null&&St(i,!!u,o,!0);return;case"textarea":ct("invalid",i),y=p=u=null;for(w in o)if(o.hasOwnProperty(w)&&(R=o[w],R!=null))switch(w){case"value":u=R;break;case"defaultValue":p=R;break;case"children":y=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(r(91));break;default:Ut(i,s,w,R,o,null)}vs(i,u,p,y);return;case"option":for(V in o)if(o.hasOwnProperty(V)&&(u=o[V],u!=null))switch(V){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Ut(i,s,V,u,o,null)}return;case"dialog":ct("beforetoggle",i),ct("toggle",i),ct("cancel",i),ct("close",i);break;case"iframe":case"object":ct("load",i);break;case"video":case"audio":for(u=0;u<mc.length;u++)ct(mc[u],i);break;case"image":ct("error",i),ct("load",i);break;case"details":ct("toggle",i);break;case"embed":case"source":case"link":ct("error",i),ct("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in o)if(o.hasOwnProperty(J)&&(u=o[J],u!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Ut(i,s,J,u,o,null)}return;default:if(kl(s)){for(ae in o)o.hasOwnProperty(ae)&&(u=o[ae],u!==void 0&&Ym(i,s,ae,u,o,void 0));return}}for(R in o)o.hasOwnProperty(R)&&(u=o[R],u!=null&&Ut(i,s,R,u,o,null))}function eI(i,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,w=null,R=null,V=null,J=null,ae=null;for(ne in o){var de=o[ne];if(o.hasOwnProperty(ne)&&de!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":V=de;default:u.hasOwnProperty(ne)||Ut(i,s,ne,null,u,de)}}for(var Z in u){var ne=u[Z];if(de=o[Z],u.hasOwnProperty(Z)&&(ne!=null||de!=null))switch(Z){case"type":y=ne;break;case"name":p=ne;break;case"checked":J=ne;break;case"defaultChecked":ae=ne;break;case"value":w=ne;break;case"defaultValue":R=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(r(137,s));break;default:ne!==de&&Ut(i,s,Z,ne,u,de)}}_s(i,w,R,V,J,ae,y,p);return;case"select":ne=w=R=Z=null;for(y in o)if(V=o[y],o.hasOwnProperty(y)&&V!=null)switch(y){case"value":break;case"multiple":ne=V;default:u.hasOwnProperty(y)||Ut(i,s,y,null,u,V)}for(p in u)if(y=u[p],V=o[p],u.hasOwnProperty(p)&&(y!=null||V!=null))switch(p){case"value":Z=y;break;case"defaultValue":R=y;break;case"multiple":w=y;default:y!==V&&Ut(i,s,p,y,u,V)}s=R,o=w,u=ne,Z!=null?St(i,!!o,Z,!1):!!u!=!!o&&(s!=null?St(i,!!o,s,!0):St(i,!!o,o?[]:"",!1));return;case"textarea":ne=Z=null;for(R in o)if(p=o[R],o.hasOwnProperty(R)&&p!=null&&!u.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:Ut(i,s,R,null,u,p)}for(w in u)if(p=u[w],y=o[w],u.hasOwnProperty(w)&&(p!=null||y!=null))switch(w){case"value":Z=p;break;case"defaultValue":ne=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==y&&Ut(i,s,w,p,u,y)}Ea(i,Z,ne);return;case"option":for(var Oe in o)if(Z=o[Oe],o.hasOwnProperty(Oe)&&Z!=null&&!u.hasOwnProperty(Oe))switch(Oe){case"selected":i.selected=!1;break;default:Ut(i,s,Oe,null,u,Z)}for(V in u)if(Z=u[V],ne=o[V],u.hasOwnProperty(V)&&Z!==ne&&(Z!=null||ne!=null))switch(V){case"selected":i.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:Ut(i,s,V,Z,u,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in o)Z=o[Be],o.hasOwnProperty(Be)&&Z!=null&&!u.hasOwnProperty(Be)&&Ut(i,s,Be,null,u,Z);for(J in u)if(Z=u[J],ne=o[J],u.hasOwnProperty(J)&&Z!==ne&&(Z!=null||ne!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,s));break;default:Ut(i,s,J,Z,u,ne)}return;default:if(kl(s)){for(var Vt in o)Z=o[Vt],o.hasOwnProperty(Vt)&&Z!==void 0&&!u.hasOwnProperty(Vt)&&Ym(i,s,Vt,void 0,u,Z);for(ae in u)Z=u[ae],ne=o[ae],!u.hasOwnProperty(ae)||Z===ne||Z===void 0&&ne===void 0||Ym(i,s,ae,Z,u,ne);return}}for(var q in o)Z=o[q],o.hasOwnProperty(q)&&Z!=null&&!u.hasOwnProperty(q)&&Ut(i,s,q,null,u,Z);for(de in u)Z=u[de],ne=o[de],!u.hasOwnProperty(de)||Z===ne||Z==null&&ne==null||Ut(i,s,de,Z,u,ne)}function vv(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tI(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var p=o[u],y=p.transferSize,w=p.initiatorType,R=p.duration;if(y&&R&&vv(w)){for(w=0,R=p.responseEnd,u+=1;u<o.length;u++){var V=o[u],J=V.startTime;if(J>R)break;var ae=V.transferSize,de=V.initiatorType;ae&&vv(de)&&(V=V.responseEnd,w+=ae*(V<R?1:(R-J)/(V-J)))}if(--u,s+=8*(y+w)/(p.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Km=null,Wm=null;function Td(i){return i.nodeType===9?i:i.ownerDocument}function Ev(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sv(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Qm(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Xm=null;function nI(){var i=window.event;return i&&i.type==="popstate"?i===Xm?!1:(Xm=i,!0):(Xm=null,!1)}var wv=typeof setTimeout=="function"?setTimeout:void 0,iI=typeof clearTimeout=="function"?clearTimeout:void 0,bv=typeof Promise=="function"?Promise:void 0,rI=typeof queueMicrotask=="function"?queueMicrotask:typeof bv<"u"?function(i){return bv.resolve(null).then(i).catch(sI)}:wv;function sI(i){setTimeout(function(){throw i})}function Hs(i){return i==="head"}function Tv(i,s){var o=s,u=0;do{var p=o.nextSibling;if(i.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(u===0){i.removeChild(p),Ko(s);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")gc(i.ownerDocument.documentElement);else if(o==="head"){o=i.ownerDocument.head,gc(o);for(var y=o.firstChild;y;){var w=y.nextSibling,R=y.nodeName;y[Pr]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=w}}else o==="body"&&gc(i.ownerDocument.body);o=p}while(o);Ko(s)}function Av(i,s){var o=i;i=0;do{var u=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(i===0)break;i--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||i++;o=u}while(o)}function Jm(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Jm(o),ya(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function aI(i,s,o,u){for(;i.nodeType===1;){var p=o;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[Pr])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=Ni(i.nextSibling),i===null)break}return null}function oI(i,s,o){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Ni(i.nextSibling),i===null))return null;return i}function Rv(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=Ni(i.nextSibling),i===null))return null;return i}function Zm(i){return i.data==="$?"||i.data==="$~"}function ep(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function lI(i,s){var o=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||o.readyState!=="loading")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function Ni(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var tp=null;function Iv(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"||o==="/&"){if(s===0)return Ni(i.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}i=i.nextSibling}return null}function Pv(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return i;s--}else o!=="/$"&&o!=="/&"||s++}i=i.previousSibling}return null}function Cv(i,s,o){switch(s=Td(o),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function gc(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);ya(i)}var Oi=new Map,Nv=new Set;function Ad(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Qr=he.d;he.d={f:cI,r:uI,D:dI,C:hI,L:fI,m:mI,X:gI,S:pI,M:yI};function cI(){var i=Qr.f(),s=gd();return i||s}function uI(i){var s=Nr(i);s!==null&&s.tag===5&&s.type==="form"?Y_(s):Qr.r(i)}var $o=typeof document>"u"?null:document;function Ov(i,s,o){var u=$o;if(u&&typeof s=="string"&&s){var p=en(s);p='link[rel="'+i+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),Nv.has(p)||(Nv.add(p),i={rel:i,crossOrigin:o,href:s},u.querySelector(p)===null&&(s=u.createElement("link"),xn(s,"link",i),an(s),u.head.appendChild(s)))}}function dI(i){Qr.D(i),Ov("dns-prefetch",i,null)}function hI(i,s){Qr.C(i,s),Ov("preconnect",i,s)}function fI(i,s,o){Qr.L(i,s,o);var u=$o;if(u&&i&&s){var p='link[rel="preload"][as="'+en(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+en(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+en(o.imageSizes)+'"]')):p+='[href="'+en(i)+'"]';var y=p;switch(s){case"style":y=qo(i);break;case"script":y=Yo(i)}Oi.has(y)||(i=_({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:i,as:s},o),Oi.set(y,i),u.querySelector(p)!==null||s==="style"&&u.querySelector(yc(y))||s==="script"&&u.querySelector(_c(y))||(s=u.createElement("link"),xn(s,"link",i),an(s),u.head.appendChild(s)))}}function mI(i,s){Qr.m(i,s);var o=$o;if(o&&i){var u=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+en(u)+'"][href="'+en(i)+'"]',y=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Yo(i)}if(!Oi.has(y)&&(i=_({rel:"modulepreload",href:i},s),Oi.set(y,i),o.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(_c(y)))return}u=o.createElement("link"),xn(u,"link",i),an(u),o.head.appendChild(u)}}}function pI(i,s,o){Qr.S(i,s,o);var u=$o;if(u&&i){var p=Bi(u).hoistableStyles,y=qo(i);s=s||"default";var w=p.get(y);if(!w){var R={loading:0,preload:null};if(w=u.querySelector(yc(y)))R.loading=5;else{i=_({rel:"stylesheet",href:i,"data-precedence":s},o),(o=Oi.get(y))&&np(i,o);var V=w=u.createElement("link");an(V),xn(V,"link",i),V._p=new Promise(function(J,ae){V.onload=J,V.onerror=ae}),V.addEventListener("load",function(){R.loading|=1}),V.addEventListener("error",function(){R.loading|=2}),R.loading|=4,Rd(w,s,u)}w={type:"stylesheet",instance:w,count:1,state:R},p.set(y,w)}}}function gI(i,s){Qr.X(i,s);var o=$o;if(o&&i){var u=Bi(o).hoistableScripts,p=Yo(i),y=u.get(p);y||(y=o.querySelector(_c(p)),y||(i=_({src:i,async:!0},s),(s=Oi.get(p))&&ip(i,s),y=o.createElement("script"),an(y),xn(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function yI(i,s){Qr.M(i,s);var o=$o;if(o&&i){var u=Bi(o).hoistableScripts,p=Yo(i),y=u.get(p);y||(y=o.querySelector(_c(p)),y||(i=_({src:i,async:!0,type:"module"},s),(s=Oi.get(p))&&ip(i,s),y=o.createElement("script"),an(y),xn(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function xv(i,s,o,u){var p=(p=ze.current)?Ad(p):null;if(!p)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=qo(o.href),o=Bi(p).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=qo(o.href);var y=Bi(p).hoistableStyles,w=y.get(i);if(w||(p=p.ownerDocument||p,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,w),(y=p.querySelector(yc(i)))&&!y._p&&(w.instance=y,w.state.loading=5),Oi.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Oi.set(i,o),y||_I(p,i,o,w.state))),s&&u===null)throw Error(r(528,""));return w}if(s&&u!==null)throw Error(r(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Yo(o),o=Bi(p).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function qo(i){return'href="'+en(i)+'"'}function yc(i){return'link[rel="stylesheet"]['+i+"]"}function Dv(i){return _({},i,{"data-precedence":i.precedence,precedence:null})}function _I(i,s,o,u){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=i.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),xn(s,"link",o),an(s),i.head.appendChild(s))}function Yo(i){return'[src="'+en(i)+'"]'}function _c(i){return"script[async]"+i}function kv(i,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=i.querySelector('style[data-href~="'+en(o.href)+'"]');if(u)return s.instance=u,an(u),u;var p=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),an(u),xn(u,"style",p),Rd(u,o.precedence,i),s.instance=u;case"stylesheet":p=qo(o.href);var y=i.querySelector(yc(p));if(y)return s.state.loading|=4,s.instance=y,an(y),y;u=Dv(o),(p=Oi.get(p))&&np(u,p),y=(i.ownerDocument||i).createElement("link"),an(y);var w=y;return w._p=new Promise(function(R,V){w.onload=R,w.onerror=V}),xn(y,"link",u),s.state.loading|=4,Rd(y,o.precedence,i),s.instance=y;case"script":return y=Yo(o.src),(p=i.querySelector(_c(y)))?(s.instance=p,an(p),p):(u=o,(p=Oi.get(y))&&(u=_({},o),ip(u,p)),i=i.ownerDocument||i,p=i.createElement("script"),an(p),xn(p,"link",u),i.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Rd(u,o.precedence,i));return s.instance}function Rd(i,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,y=p,w=0;w<u.length;w++){var R=u[w];if(R.dataset.precedence===s)y=R;else if(y!==p)break}y?y.parentNode.insertBefore(i,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(i,s.firstChild))}function np(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function ip(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Id=null;function Mv(i,s,o){if(Id===null){var u=new Map,p=Id=new Map;p.set(o,u)}else p=Id,u=p.get(o),u||(u=new Map,p.set(o,u));if(u.has(i))return u;for(u.set(i,null),o=o.getElementsByTagName(i),p=0;p<o.length;p++){var y=o[p];if(!(y[Pr]||y[Zt]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(s)||"";w=i+w;var R=u.get(w);R?R.push(y):u.set(w,[y])}}return u}function Lv(i,s,o){i=i.ownerDocument||i,i.head.insertBefore(o,s==="title"?i.querySelector("head > title"):null)}function vI(i,s,o){if(o===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Uv(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function EI(i,s,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=qo(u.href),y=s.querySelector(yc(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=Pd.bind(i),s.then(i,i)),o.state.loading|=4,o.instance=y,an(y);return}y=s.ownerDocument||s,u=Dv(u),(p=Oi.get(p))&&np(u,p),y=y.createElement("link"),an(y);var w=y;w._p=new Promise(function(R,V){w.onload=R,w.onerror=V}),xn(y,"link",u),o.instance=y}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(i.count++,o=Pd.bind(i),s.addEventListener("load",o),s.addEventListener("error",o))}}var rp=0;function SI(i,s){return i.stylesheets&&i.count===0&&Nd(i,i.stylesheets),0<i.count||0<i.imgCount?function(o){var u=setTimeout(function(){if(i.stylesheets&&Nd(i,i.stylesheets),i.unsuspend){var y=i.unsuspend;i.unsuspend=null,y()}},6e4+s);0<i.imgBytes&&rp===0&&(rp=62500*tI());var p=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Nd(i,i.stylesheets),i.unsuspend)){var y=i.unsuspend;i.unsuspend=null,y()}},(i.imgBytes>rp?50:800)+s);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function Pd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Nd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Cd=null;function Nd(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Cd=new Map,s.forEach(wI,i),Cd=null,Pd.call(i))}function wI(i,s){if(!(s.state.loading&4)){var o=Cd.get(i);if(o)var u=o.get(null);else{o=new Map,Cd.set(i,o);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var w=p[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),u=w)}u&&o.set(null,u)}p=s.instance,w=p.getAttribute("data-precedence"),y=o.get(w)||u,y===u&&o.set(null,p),o.set(w,p),this.count++,u=Pd.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),y?y.parentNode.insertBefore(p,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),s.state.loading|=4}}var vc={$$typeof:U,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function bI(i,s,o,u,p,y,w,R,V){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Rr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rr(0),this.hiddenUpdates=Rr(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function Vv(i,s,o,u,p,y,w,R,V,J,ae,de){return i=new bI(i,s,o,w,V,J,ae,de,R),s=1,y===!0&&(s|=24),y=di(3,null,null,s),i.current=y,y.stateNode=i,s=Uf(),s.refCount++,i.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:s},Bf(y),i}function jv(i){return i?(i=To,i):To}function zv(i,s,o,u,p,y){p=jv(p),u.context===null?u.context=p:u.pendingContext=p,u=Ds(s),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=ks(i,u,s),o!==null&&(Zn(o,i,s),Xl(o,i,s))}function Bv(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<s?o:s}}function sp(i,s){Bv(i,s),(i=i.alternate)&&Bv(i,s)}function Fv(i){if(i.tag===13||i.tag===31){var s=Ca(i,67108864);s!==null&&Zn(s,i,67108864),sp(i,67108864)}}function Gv(i){if(i.tag===13||i.tag===31){var s=gi();s=Il(s);var o=Ca(i,s);o!==null&&Zn(o,i,s),sp(i,s)}}var Od=!0;function TI(i,s,o,u){var p=te.T;te.T=null;var y=he.p;try{he.p=2,ap(i,s,o,u)}finally{he.p=y,te.T=p}}function AI(i,s,o,u){var p=te.T;te.T=null;var y=he.p;try{he.p=8,ap(i,s,o,u)}finally{he.p=y,te.T=p}}function ap(i,s,o,u){if(Od){var p=op(u);if(p===null)qm(i,s,u,xd,o),$v(i,u);else if(II(p,i,s,o,u))u.stopPropagation();else if($v(i,u),s&4&&-1<RI.indexOf(i)){for(;p!==null;){var y=Nr(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=zi(y.pendingLanes);if(w!==0){var R=y;for(R.pendingLanes|=2,R.entangledLanes|=2;w;){var V=1<<31-Et(w);R.entanglements[1]|=V,w&=~V}hr(y),(Tt&6)===0&&(md=Ze()+500,fc(0))}}break;case 31:case 13:R=Ca(y,2),R!==null&&Zn(R,y,2),gd(),sp(y,2)}if(y=op(u),y===null&&qm(i,s,u,xd,o),y===p)break;p=y}p!==null&&u.stopPropagation()}else qm(i,s,u,null,o)}}function op(i){return i=go(i),lp(i)}var xd=null;function lp(i){if(xd=null,i=Cr(i),i!==null){var s=l(i);if(s===null)i=null;else{var o=s.tag;if(o===13){if(i=c(s),i!==null)return i;i=null}else if(o===31){if(i=d(s),i!==null)return i;i=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return xd=i,null}function Hv(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Se()){case _e:return 2;case me:return 8;case ge:case re:return 32;case ye:return 268435456;default:return 32}default:return 32}}var cp=!1,$s=null,qs=null,Ys=null,Ec=new Map,Sc=new Map,Ks=[],RI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $v(i,s){switch(i){case"focusin":case"focusout":$s=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":Ec.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sc.delete(s.pointerId)}}function wc(i,s,o,u,p,y){return i===null||i.nativeEvent!==y?(i={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[p]},s!==null&&(s=Nr(s),s!==null&&Fv(s)),i):(i.eventSystemFlags|=u,s=i.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),i)}function II(i,s,o,u,p){switch(s){case"focusin":return $s=wc($s,i,s,o,u,p),!0;case"dragenter":return qs=wc(qs,i,s,o,u,p),!0;case"mouseover":return Ys=wc(Ys,i,s,o,u,p),!0;case"pointerover":var y=p.pointerId;return Ec.set(y,wc(Ec.get(y)||null,i,s,o,u,p)),!0;case"gotpointercapture":return y=p.pointerId,Sc.set(y,wc(Sc.get(y)||null,i,s,o,u,p)),!0}return!1}function qv(i){var s=Cr(i.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){i.blockedOn=s,mu(i.priority,function(){Gv(o)});return}}else if(s===31){if(s=d(o),s!==null){i.blockedOn=s,mu(i.priority,function(){Gv(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Dd(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var o=op(i.nativeEvent);if(o===null){o=i.nativeEvent;var u=new o.constructor(o.type,o);po=u,o.target.dispatchEvent(u),po=null}else return s=Nr(o),s!==null&&Fv(s),i.blockedOn=o,!1;s.shift()}return!0}function Yv(i,s,o){Dd(i)&&o.delete(s)}function PI(){cp=!1,$s!==null&&Dd($s)&&($s=null),qs!==null&&Dd(qs)&&(qs=null),Ys!==null&&Dd(Ys)&&(Ys=null),Ec.forEach(Yv),Sc.forEach(Yv)}function kd(i,s){i.blockedOn===s&&(i.blockedOn=null,cp||(cp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,PI)))}var Md=null;function Kv(i){Md!==i&&(Md=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Md===i&&(Md=null);for(var s=0;s<i.length;s+=3){var o=i[s],u=i[s+1],p=i[s+2];if(typeof u!="function"){if(lp(u||o)===null)continue;break}var y=Nr(o);y!==null&&(i.splice(s,3),s-=3,om(y,{pending:!0,data:p,method:o.method,action:u},u,p))}}))}function Ko(i){function s(V){return kd(V,i)}$s!==null&&kd($s,i),qs!==null&&kd(qs,i),Ys!==null&&kd(Ys,i),Ec.forEach(s),Sc.forEach(s);for(var o=0;o<Ks.length;o++){var u=Ks[o];u.blockedOn===i&&(u.blockedOn=null)}for(;0<Ks.length&&(o=Ks[0],o.blockedOn===null);)qv(o),o.blockedOn===null&&Ks.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var p=o[u],y=o[u+1],w=p[Pn]||null;if(typeof y=="function")w||Kv(o);else if(w){var R=null;if(y&&y.hasAttribute("formAction")){if(p=y,w=y[Pn]||null)R=w.formAction;else if(lp(p)!==null)continue}else R=w.action;typeof R=="function"?o[u+1]=R:(o.splice(u,3),u-=3),Kv(o)}}}function Wv(){function i(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return p=w})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function up(i){this._internalRoot=i}Ld.prototype.render=up.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var o=s.current,u=gi();zv(o,u,i,s,null,null)},Ld.prototype.unmount=up.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;zv(i.current,2,null,i,null,null),gd(),s[ir]=null}};function Ld(i){this._internalRoot=i}Ld.prototype.unstable_scheduleHydration=function(i){if(i){var s=Ir();i={blockedOn:null,target:i,priority:s};for(var o=0;o<Ks.length&&s!==0&&s<Ks[o].priority;o++);Ks.splice(o,0,i),o===0&&qv(i)}};var Qv=e.version;if(Qv!=="19.2.3")throw Error(r(527,Qv,"19.2.3"));he.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=m(s),i=i!==null?g(i):null,i=i===null?null:i.stateNode,i};var CI={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ud.isDisabled&&Ud.supportsFiber)try{Pt=Ud.inject(CI),yt=Ud}catch{}}return Tc.createRoot=function(i,s){if(!a(i))throw Error(r(299));var o=!1,u="",p=i0,y=r0,w=s0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(w=s.onRecoverableError)),s=Vv(i,1,!1,null,null,o,u,null,p,y,w,Wv),i[ir]=s.current,$m(i),new up(s)},Tc.hydrateRoot=function(i,s,o){if(!a(i))throw Error(r(299));var u=!1,p="",y=i0,w=r0,R=s0,V=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.formState!==void 0&&(V=o.formState)),s=Vv(i,1,!0,s,o??null,u,p,V,y,w,R,Wv),s.context=jv(null),o=s.current,u=gi(),u=Il(u),p=Ds(u),p.callback=null,ks(o,p,u),o=u,s.current.lanes=o,ds(s,o),hr(s),i[ir]=s.current,$m(i),new Ld(s)},Tc.version="19.2.3",Tc}var oE;function BI(){if(oE)return fp.exports;oE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),fp.exports=zI(),fp.exports}var FI=BI();const GI=Tw(FI),HI="modulepreload",$I=function(n){return"/apps/yo-nunca/play/"+n},lE={},Wt=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=c(t.map(m=>{if(m=$I(m),m in lE)return;lE[m]=!0;const g=m.endsWith(".css"),_=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${_}`))return;const v=document.createElement("link");if(v.rel=g?"stylesheet":HI,g||(v.as="script"),v.crossOrigin="",v.href=m,h&&v.setAttribute("nonce",h),document.head.appendChild(v),g)return new Promise((T,I)=>{v.addEventListener("load",T),v.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return a.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},nl={log:console.log.bind(console),info:console.info.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),debug:console.debug?console.debug.bind(console):console.log.bind(console)},Aw=typeof import.meta<"u"&&!0;let Fa=Aw?"error":"debug";function qI(n){try{if(n==null)return n;let t=(typeof n=="string"?n:JSON.stringify(n)).replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"**@**");return t=t.replace(/ca-app-pub-\d+\/\d+/g,"ca-app-pub-**/**"),t=t.replace(/[A-Za-z0-9_-]{24,}/g,"***"),t=t.replace(/https?:\/\/[\w.-]+(?:\/[\w\d#?&%=._-]*)?/gi,"<redacted-url>"),t}catch{return n}}function il(n){return n.map(qI)}const X={setLevel(n){Fa=n},debug:(...n)=>{Fa==="debug"&&nl.debug(...il(n))},info:(...n)=>{(Fa==="debug"||Fa==="info")&&nl.info(...il(n))},warn:(...n)=>{Fa!=="none"&&Fa!=="error"&&nl.warn(...il(n))},error:(...n)=>{Fa!=="none"&&nl.error(...il(n))}},Wd=[],YI=50,kc=[],KI=(n,e)=>{try{const t=e.map(a=>a instanceof Error?`${a.message}
${a.stack}`:typeof a=="object"?JSON.stringify(a):String(a)).join(" "),r=`${new Date().toLocaleTimeString()} [${n.toUpperCase()}] ${t}`;kc.unshift(r),kc.length>YI&&kc.pop(),Wd.forEach(a=>a(r))}catch{}},cE={addListener:n=>{Wd.push(n),kc.forEach(e=>n(e))},removeListener:n=>{const e=Wd.indexOf(n);e>-1&&Wd.splice(e,1)},getHistory:()=>[...kc]},Vh=(n,e)=>(...t)=>{e(...t),KI(n,t)};X.debug=Vh("debug",X.debug);X.info=Vh("info",X.info);X.warn=Vh("warn",X.warn);X.error=Vh("error",X.error);function WI(){Aw&&(console.log=()=>{},console.info=()=>{},console.debug=(...n)=>{},console.warn=(...n)=>nl.warn(...il(n)),console.error=(...n)=>nl.error(...il(n)))}const QI=()=>{};var uE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},XI=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],c=n[t++],d=n[t++],h=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const l=n[t++],c=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},Iw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const l=n[a],c=a+1<n.length,d=c?n[a+1]:0,h=a+2<n.length,m=h?n[a+2]:0,g=l>>2,_=(l&3)<<4|d>>4;let v=(d&15)<<2|m>>6,T=m&63;h||(T=64,c||(v=64)),r.push(t[g],t[_],t[v],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Rw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):XI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],d=a<n.length?t[n.charAt(a)]:0;++a;const m=a<n.length?t[n.charAt(a)]:64;++a;const _=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||d==null||m==null||_==null)throw new JI;const v=l<<2|d>>4;if(r.push(v),m!==64){const T=d<<4&240|m>>2;if(r.push(T),_!==64){const I=m<<6&192|_;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class JI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZI=function(n){const e=Rw(n);return Iw.encodeByteArray(e,!0)},Pw=function(n){return ZI(n).replace(/\./g,"")},Cw=function(n){try{return Iw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=()=>eP().__FIREBASE_DEFAULTS__,nP=()=>{if(typeof process>"u"||typeof uE>"u")return;const n=uE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},iP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Cw(n[1]);return e&&JSON.parse(e)},jh=()=>{try{return QI()||tP()||nP()||iP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Nw=n=>{var e,t;return(t=(e=jh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},rP=n=>{const e=Nw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ow=()=>{var n;return(n=jh())===null||n===void 0?void 0:n.config},xw=n=>{var e;return(e=jh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function bg(n){return(await fetch(n,{credentials:"include"})).ok}const Mc={};function aP(){const n={prod:[],emulator:[]};for(const e of Object.keys(Mc))Mc[e]?n.emulator.push(e):n.prod.push(e);return n}function oP(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let dE=!1;function Dw(n,e){if(typeof window>"u"||typeof document>"u"||!io(window.location.host)||Mc[n]===e||Mc[n]||dE)return;Mc[n]=e;function t(v){return`__firebase__banner__${v}`}const r="__firebase__banner",l=aP().prod.length>0;function c(){const v=document.getElementById(r);v&&v.remove()}function d(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,T){v.setAttribute("width","24"),v.setAttribute("id",T),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function m(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{dE=!0,c()},v}function g(v,T){v.setAttribute("id",T),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function _(){const v=oP(r),T=t("text"),I=document.getElementById(T)||document.createElement("span"),A=t("learnmore"),C=document.getElementById(A)||document.createElement("a"),L=t("preprendIcon"),x=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const U=v.element;d(U),g(C,A);const z=m();h(x,L),U.append(x,I,C,z),document.body.appendChild(U)}l?(I.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zn())}function cP(){var n;const e=(n=jh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kw(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function dP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hP(){const n=zn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function fP(){return!cP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Mw(){try{return typeof indexedDB=="object"}catch{return!1}}function Lw(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}function mP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP="FirebaseError";class Vi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=pP,Object.setPrototypeOf(this,Vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ro.prototype.create)}}class ro{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?gP(l,r):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new Vi(a,d,r)}}function gP(n,e){return n.replace(yP,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const yP=/\{\$([^}]+)}/g;function _P(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ra(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=n[a],c=e[a];if(hE(l)&&hE(c)){if(!ra(l,c))return!1}else if(l!==c)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function hE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function vP(n,e){const t=new EP(n,e);return t.subscribe.bind(t)}class EP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");SP(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=yp),a.error===void 0&&(a.error=yp),a.complete===void 0&&(a.complete=yp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SP(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function yp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=1e3,bP=2,TP=14400*1e3,AP=.5;function fE(n,e=wP,t=bP){const r=e*Math.pow(t,n),a=Math.round(AP*r*(Math.random()-.5)*2);return Math.min(TP,r+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(n){return n&&n._delegate?n._delegate:n}class Ui{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new sP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(PP(e))try{this.getOrInitializeService({instanceIdentifier:$a})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=$a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$a){return this.instances.has(e)}getOptions(e=$a){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);r===d&&c.resolve(a)}return a}onInit(e,t){var r;const a=this.normalizeInstanceIdentifier(t),l=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;l.add(e),this.onInitCallbacks.set(a,l);const c=this.instances.get(a);return c&&e(c,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:IP(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$a){return this.component?this.component.multipleInstances?e:$a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function IP(n){return n===$a?void 0:n}function PP(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new RP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ht||(ht={}));const NP={debug:ht.DEBUG,verbose:ht.VERBOSE,info:ht.INFO,warn:ht.WARN,error:ht.ERROR,silent:ht.SILENT},OP=ht.INFO,xP={[ht.DEBUG]:"log",[ht.VERBOSE]:"log",[ht.INFO]:"info",[ht.WARN]:"warn",[ht.ERROR]:"error"},DP=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=xP[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zh{constructor(e){this.name=e,this._logLevel=OP,this._logHandler=DP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ht))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?NP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ht.DEBUG,...e),this._logHandler(this,ht.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ht.VERBOSE,...e),this._logHandler(this,ht.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ht.INFO,...e),this._logHandler(this,ht.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ht.WARN,...e),this._logHandler(this,ht.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ht.ERROR,...e),this._logHandler(this,ht.ERROR,...e)}}const kP=(n,e)=>e.some(t=>n instanceof t);let mE,pE;function MP(){return mE||(mE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function LP(){return pE||(pE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Uw=new WeakMap,Mp=new WeakMap,Vw=new WeakMap,_p=new WeakMap,Tg=new WeakMap;function UP(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(Zs(n.result)),a()},c=()=>{r(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Uw.set(t,n)}).catch(()=>{}),Tg.set(e,n),e}function VP(n){if(Mp.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Mp.set(n,e)}let Lp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Mp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Vw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function jP(n){Lp=n(Lp)}function zP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(vp(this),e,...t);return Vw.set(r,e.sort?e.sort():[e]),Zs(r)}:LP().includes(n)?function(...e){return n.apply(vp(this),e),Zs(Uw.get(this))}:function(...e){return Zs(n.apply(vp(this),e))}}function BP(n){return typeof n=="function"?zP(n):(n instanceof IDBTransaction&&VP(n),kP(n,MP())?new Proxy(n,Lp):n)}function Zs(n){if(n instanceof IDBRequest)return UP(n);if(_p.has(n))return _p.get(n);const e=BP(n);return e!==n&&(_p.set(n,e),Tg.set(e,n)),e}const vp=n=>Tg.get(n);function jw(n,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const c=indexedDB.open(n,e),d=Zs(c);return r&&c.addEventListener("upgradeneeded",h=>{r(Zs(c.result),h.oldVersion,h.newVersion,Zs(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{l&&h.addEventListener("close",()=>l()),a&&h.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const FP=["get","getKey","getAll","getAllKeys","count"],GP=["put","add","delete","clear"],Ep=new Map;function gE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ep.get(e))return Ep.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=GP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||FP.includes(t)))return;const l=async function(c,...d){const h=this.transaction(c,a?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),a&&h.done]))[0]};return Ep.set(e,l),l}jP(n=>({...n,get:(e,t,r)=>gE(e,t)||n.get(e,t,r),has:(e,t)=>!!gE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if($P(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function $P(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Up="@firebase/app",yE="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=new zh("@firebase/app"),qP="@firebase/app-compat",YP="@firebase/analytics-compat",KP="@firebase/analytics",WP="@firebase/app-check-compat",QP="@firebase/app-check",XP="@firebase/auth",JP="@firebase/auth-compat",ZP="@firebase/database",eC="@firebase/data-connect",tC="@firebase/database-compat",nC="@firebase/functions",iC="@firebase/functions-compat",rC="@firebase/installations",sC="@firebase/installations-compat",aC="@firebase/messaging",oC="@firebase/messaging-compat",lC="@firebase/performance",cC="@firebase/performance-compat",uC="@firebase/remote-config",dC="@firebase/remote-config-compat",hC="@firebase/storage",fC="@firebase/storage-compat",mC="@firebase/firestore",pC="@firebase/ai",gC="@firebase/firestore-compat",yC="firebase",_C="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="[DEFAULT]",vC={[Up]:"fire-core",[qP]:"fire-core-compat",[KP]:"fire-analytics",[YP]:"fire-analytics-compat",[QP]:"fire-app-check",[WP]:"fire-app-check-compat",[XP]:"fire-auth",[JP]:"fire-auth-compat",[ZP]:"fire-rtdb",[eC]:"fire-data-connect",[tC]:"fire-rtdb-compat",[nC]:"fire-fn",[iC]:"fire-fn-compat",[rC]:"fire-iid",[sC]:"fire-iid-compat",[aC]:"fire-fcm",[oC]:"fire-fcm-compat",[lC]:"fire-perf",[cC]:"fire-perf-compat",[uC]:"fire-rc",[dC]:"fire-rc-compat",[hC]:"fire-gcs",[fC]:"fire-gcs-compat",[mC]:"fire-fst",[gC]:"fire-fst-compat",[pC]:"fire-vertex","fire-js":"fire-js",[yC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Map,EC=new Map,jp=new Map;function _E(n,e){try{n.container.addComponent(e)}catch(t){rs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Xi(n){const e=n.name;if(jp.has(e))return rs.debug(`There were multiple attempts to register component ${e}.`),!1;jp.set(e,n);for(const t of uh.values())_E(t,n);for(const t of EC.values())_E(t,n);return!0}function ma(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Mi(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ea=new ro("app","Firebase",SC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ea.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=_C;function zw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Vp,automaticDataCollectionEnabled:!0},e),a=r.name;if(typeof a!="string"||!a)throw ea.create("bad-app-name",{appName:String(a)});if(t||(t=Ow()),!t)throw ea.create("no-options");const l=uh.get(a);if(l){if(ra(t,l.options)&&ra(r,l.config))return l;throw ea.create("duplicate-app",{appName:a})}const c=new CP(a);for(const h of jp.values())c.addComponent(h);const d=new wC(t,r,c);return uh.set(a,d),d}function Ag(n=Vp){const e=uh.get(n);if(!e&&n===Vp&&Ow())return zw();if(!e)throw ea.create("no-app",{appName:n});return e}function ri(n,e,t){var r;let a=(r=vC[n])!==null&&r!==void 0?r:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),c=e.match(/\s|\//);if(l||c){const d=[`Unable to register library "${a}" with version "${e}":`];l&&d.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rs.warn(d.join(" "));return}Xi(new Ui(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC="firebase-heartbeat-database",TC=1,Gc="firebase-heartbeat-store";let Sp=null;function Bw(){return Sp||(Sp=jw(bC,TC,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gc)}catch(t){console.warn(t)}}}}).catch(n=>{throw ea.create("idb-open",{originalErrorMessage:n.message})})),Sp}async function AC(n){try{const t=(await Bw()).transaction(Gc),r=await t.objectStore(Gc).get(Fw(n));return await t.done,r}catch(e){if(e instanceof Vi)rs.warn(e.message);else{const t=ea.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rs.warn(t.message)}}}async function vE(n,e){try{const r=(await Bw()).transaction(Gc,"readwrite");await r.objectStore(Gc).put(e,Fw(n)),await r.done}catch(t){if(t instanceof Vi)rs.warn(t.message);else{const r=ea.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});rs.warn(r.message)}}}function Fw(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=1024,IC=30;class PC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new NC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=EE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>IC){const c=OC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){rs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=EE(),{heartbeatsToSend:r,unsentEntries:a}=CC(this._heartbeatsCache.heartbeats),l=Pw(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return rs.warn(t),""}}}function EE(){return new Date().toISOString().substring(0,10)}function CC(n,e=RC){const t=[];let r=n.slice();for(const a of n){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),SE(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),SE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class NC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Mw()?Lw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await AC(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return vE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return vE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function SE(n){return Pw(JSON.stringify({version:2,heartbeats:n})).length}function OC(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xC(n){Xi(new Ui("platform-logger",e=>new HP(e),"PRIVATE")),Xi(new Ui("heartbeat",e=>new PC(e),"PRIVATE")),ri(Up,yE,n),ri(Up,yE,"esm2017"),ri("fire-js","")}xC("");var wE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ta,Gw;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,P){function N(){}N.prototype=P.prototype,D.D=P.prototype,D.prototype=new N,D.prototype.constructor=D,D.C=function(M,B,G){for(var k=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)k[Ve-2]=arguments[Ve];return P.prototype[B].apply(M,k)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(D,P,N){N||(N=0);var M=Array(16);if(typeof P=="string")for(var B=0;16>B;++B)M[B]=P.charCodeAt(N++)|P.charCodeAt(N++)<<8|P.charCodeAt(N++)<<16|P.charCodeAt(N++)<<24;else for(B=0;16>B;++B)M[B]=P[N++]|P[N++]<<8|P[N++]<<16|P[N++]<<24;P=D.g[0],N=D.g[1],B=D.g[2];var G=D.g[3],k=P+(G^N&(B^G))+M[0]+3614090360&4294967295;P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[1]+3905402710&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[2]+606105819&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[3]+3250441966&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(G^N&(B^G))+M[4]+4118548399&4294967295,P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[5]+1200080426&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[6]+2821735955&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[7]+4249261313&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(G^N&(B^G))+M[8]+1770035416&4294967295,P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[9]+2336552879&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[10]+4294925233&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[11]+2304563134&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(G^N&(B^G))+M[12]+1804603682&4294967295,P=N+(k<<7&4294967295|k>>>25),k=G+(B^P&(N^B))+M[13]+4254626195&4294967295,G=P+(k<<12&4294967295|k>>>20),k=B+(N^G&(P^N))+M[14]+2792965006&4294967295,B=G+(k<<17&4294967295|k>>>15),k=N+(P^B&(G^P))+M[15]+1236535329&4294967295,N=B+(k<<22&4294967295|k>>>10),k=P+(B^G&(N^B))+M[1]+4129170786&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[6]+3225465664&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[11]+643717713&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[0]+3921069994&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(B^G&(N^B))+M[5]+3593408605&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[10]+38016083&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[15]+3634488961&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[4]+3889429448&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(B^G&(N^B))+M[9]+568446438&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[14]+3275163606&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[3]+4107603335&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[8]+1163531501&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(B^G&(N^B))+M[13]+2850285829&4294967295,P=N+(k<<5&4294967295|k>>>27),k=G+(N^B&(P^N))+M[2]+4243563512&4294967295,G=P+(k<<9&4294967295|k>>>23),k=B+(P^N&(G^P))+M[7]+1735328473&4294967295,B=G+(k<<14&4294967295|k>>>18),k=N+(G^P&(B^G))+M[12]+2368359562&4294967295,N=B+(k<<20&4294967295|k>>>12),k=P+(N^B^G)+M[5]+4294588738&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[8]+2272392833&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[11]+1839030562&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[14]+4259657740&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(N^B^G)+M[1]+2763975236&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[4]+1272893353&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[7]+4139469664&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[10]+3200236656&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(N^B^G)+M[13]+681279174&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[0]+3936430074&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[3]+3572445317&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[6]+76029189&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(N^B^G)+M[9]+3654602809&4294967295,P=N+(k<<4&4294967295|k>>>28),k=G+(P^N^B)+M[12]+3873151461&4294967295,G=P+(k<<11&4294967295|k>>>21),k=B+(G^P^N)+M[15]+530742520&4294967295,B=G+(k<<16&4294967295|k>>>16),k=N+(B^G^P)+M[2]+3299628645&4294967295,N=B+(k<<23&4294967295|k>>>9),k=P+(B^(N|~G))+M[0]+4096336452&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[7]+1126891415&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[14]+2878612391&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[5]+4237533241&4294967295,N=B+(k<<21&4294967295|k>>>11),k=P+(B^(N|~G))+M[12]+1700485571&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[3]+2399980690&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[10]+4293915773&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[1]+2240044497&4294967295,N=B+(k<<21&4294967295|k>>>11),k=P+(B^(N|~G))+M[8]+1873313359&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[15]+4264355552&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[6]+2734768916&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[13]+1309151649&4294967295,N=B+(k<<21&4294967295|k>>>11),k=P+(B^(N|~G))+M[4]+4149444226&4294967295,P=N+(k<<6&4294967295|k>>>26),k=G+(N^(P|~B))+M[11]+3174756917&4294967295,G=P+(k<<10&4294967295|k>>>22),k=B+(P^(G|~N))+M[2]+718787259&4294967295,B=G+(k<<15&4294967295|k>>>17),k=N+(G^(B|~P))+M[9]+3951481745&4294967295,D.g[0]=D.g[0]+P&4294967295,D.g[1]=D.g[1]+(B+(k<<21&4294967295|k>>>11))&4294967295,D.g[2]=D.g[2]+B&4294967295,D.g[3]=D.g[3]+G&4294967295}r.prototype.u=function(D,P){P===void 0&&(P=D.length);for(var N=P-this.blockSize,M=this.B,B=this.h,G=0;G<P;){if(B==0)for(;G<=N;)a(this,D,G),G+=this.blockSize;if(typeof D=="string"){for(;G<P;)if(M[B++]=D.charCodeAt(G++),B==this.blockSize){a(this,M),B=0;break}}else for(;G<P;)if(M[B++]=D[G++],B==this.blockSize){a(this,M),B=0;break}}this.h=B,this.o+=P},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var P=1;P<D.length-8;++P)D[P]=0;var N=8*this.o;for(P=D.length-8;P<D.length;++P)D[P]=N&255,N/=256;for(this.u(D),D=Array(16),P=N=0;4>P;++P)for(var M=0;32>M;M+=8)D[N++]=this.g[P]>>>M&255;return D};function l(D,P){var N=d;return Object.prototype.hasOwnProperty.call(N,D)?N[D]:N[D]=P(D)}function c(D,P){this.h=P;for(var N=[],M=!0,B=D.length-1;0<=B;B--){var G=D[B]|0;M&&G==P||(N[B]=G,M=!1)}this.g=N}var d={};function h(D){return-128<=D&&128>D?l(D,function(P){return new c([P|0],0>P?-1:0)}):new c([D|0],0>D?-1:0)}function m(D){if(isNaN(D)||!isFinite(D))return _;if(0>D)return C(m(-D));for(var P=[],N=1,M=0;D>=N;M++)P[M]=D/N|0,N*=4294967296;return new c(P,0)}function g(D,P){if(D.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(D.charAt(0)=="-")return C(g(D.substring(1),P));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=m(Math.pow(P,8)),M=_,B=0;B<D.length;B+=8){var G=Math.min(8,D.length-B),k=parseInt(D.substring(B,B+G),P);8>G?(G=m(Math.pow(P,G)),M=M.j(G).add(m(k))):(M=M.j(N),M=M.add(m(k)))}return M}var _=h(0),v=h(1),T=h(16777216);n=c.prototype,n.m=function(){if(A(this))return-C(this).m();for(var D=0,P=1,N=0;N<this.g.length;N++){var M=this.i(N);D+=(0<=M?M:4294967296+M)*P,P*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(I(this))return"0";if(A(this))return"-"+C(this).toString(D);for(var P=m(Math.pow(D,6)),N=this,M="";;){var B=z(N,P).g;N=L(N,B.j(P));var G=((0<N.g.length?N.g[0]:N.h)>>>0).toString(D);if(N=B,I(N))return G+M;for(;6>G.length;)G="0"+G;M=G+M}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function I(D){if(D.h!=0)return!1;for(var P=0;P<D.g.length;P++)if(D.g[P]!=0)return!1;return!0}function A(D){return D.h==-1}n.l=function(D){return D=L(this,D),A(D)?-1:I(D)?0:1};function C(D){for(var P=D.g.length,N=[],M=0;M<P;M++)N[M]=~D.g[M];return new c(N,~D.h).add(v)}n.abs=function(){return A(this)?C(this):this},n.add=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0,B=0;B<=P;B++){var G=M+(this.i(B)&65535)+(D.i(B)&65535),k=(G>>>16)+(this.i(B)>>>16)+(D.i(B)>>>16);M=k>>>16,G&=65535,k&=65535,N[B]=k<<16|G}return new c(N,N[N.length-1]&-2147483648?-1:0)};function L(D,P){return D.add(C(P))}n.j=function(D){if(I(this)||I(D))return _;if(A(this))return A(D)?C(this).j(C(D)):C(C(this).j(D));if(A(D))return C(this.j(C(D)));if(0>this.l(T)&&0>D.l(T))return m(this.m()*D.m());for(var P=this.g.length+D.g.length,N=[],M=0;M<2*P;M++)N[M]=0;for(M=0;M<this.g.length;M++)for(var B=0;B<D.g.length;B++){var G=this.i(M)>>>16,k=this.i(M)&65535,Ve=D.i(B)>>>16,et=D.i(B)&65535;N[2*M+2*B]+=k*et,x(N,2*M+2*B),N[2*M+2*B+1]+=G*et,x(N,2*M+2*B+1),N[2*M+2*B+1]+=k*Ve,x(N,2*M+2*B+1),N[2*M+2*B+2]+=G*Ve,x(N,2*M+2*B+2)}for(M=0;M<P;M++)N[M]=N[2*M+1]<<16|N[2*M];for(M=P;M<2*P;M++)N[M]=0;return new c(N,0)};function x(D,P){for(;(D[P]&65535)!=D[P];)D[P+1]+=D[P]>>>16,D[P]&=65535,P++}function U(D,P){this.g=D,this.h=P}function z(D,P){if(I(P))throw Error("division by zero");if(I(D))return new U(_,_);if(A(D))return P=z(C(D),P),new U(C(P.g),C(P.h));if(A(P))return P=z(D,C(P)),new U(C(P.g),P.h);if(30<D.g.length){if(A(D)||A(P))throw Error("slowDivide_ only works with positive integers.");for(var N=v,M=P;0>=M.l(D);)N=$(N),M=$(M);var B=se(N,1),G=se(M,1);for(M=se(M,2),N=se(N,2);!I(M);){var k=G.add(M);0>=k.l(D)&&(B=B.add(N),G=k),M=se(M,1),N=se(N,1)}return P=L(D,B.j(P)),new U(B,P)}for(B=_;0<=D.l(P);){for(N=Math.max(1,Math.floor(D.m()/P.m())),M=Math.ceil(Math.log(N)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),G=m(N),k=G.j(P);A(k)||0<k.l(D);)N-=M,G=m(N),k=G.j(P);I(G)&&(G=v),B=B.add(G),D=L(D,k)}return new U(B,D)}n.A=function(D){return z(this,D).h},n.and=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0;M<P;M++)N[M]=this.i(M)&D.i(M);return new c(N,this.h&D.h)},n.or=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0;M<P;M++)N[M]=this.i(M)|D.i(M);return new c(N,this.h|D.h)},n.xor=function(D){for(var P=Math.max(this.g.length,D.g.length),N=[],M=0;M<P;M++)N[M]=this.i(M)^D.i(M);return new c(N,this.h^D.h)};function $(D){for(var P=D.g.length+1,N=[],M=0;M<P;M++)N[M]=D.i(M)<<1|D.i(M-1)>>>31;return new c(N,D.h)}function se(D,P){var N=P>>5;P%=32;for(var M=D.g.length-N,B=[],G=0;G<M;G++)B[G]=0<P?D.i(G+N)>>>P|D.i(G+N+1)<<32-P:D.i(G+N);return new c(B,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Gw=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=g,ta=c}).apply(typeof wE<"u"?wE:typeof self<"u"?self:typeof window<"u"?window:{});var Vd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hw,Cc,$w,Qd,zp,qw,Yw,Kw;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,E,b){return f==Array.prototype||f==Object.prototype||(f[E]=b.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vd=="object"&&Vd];for(var E=0;E<f.length;++E){var b=f[E];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=t(this);function a(f,E){if(E)e:{var b=r;f=f.split(".");for(var O=0;O<f.length-1;O++){var Y=f[O];if(!(Y in b))break e;b=b[Y]}f=f[f.length-1],O=b[f],E=E(O),E!=O&&E!=null&&e(b,f,{configurable:!0,writable:!0,value:E})}}function l(f,E){f instanceof String&&(f+="");var b=0,O=!1,Y={next:function(){if(!O&&b<f.length){var ie=b++;return{value:E(ie,f[ie]),done:!1}}return O=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}a("Array.prototype.values",function(f){return f||function(){return l(this,function(E,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},d=this||self;function h(f){var E=typeof f;return E=E!="object"?E:f?Array.isArray(f)?"array":E:"null",E=="array"||E=="object"&&typeof f.length=="number"}function m(f){var E=typeof f;return E=="object"&&f!=null||E=="function"}function g(f,E,b){return f.call.apply(f.bind,arguments)}function _(f,E,b){if(!f)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,O),f.apply(E,Y)}}return function(){return f.apply(E,arguments)}}function v(f,E,b){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:_,v.apply(null,arguments)}function T(f,E){var b=Array.prototype.slice.call(arguments,1);return function(){var O=b.slice();return O.push.apply(O,arguments),f.apply(this,O)}}function I(f,E){function b(){}b.prototype=E.prototype,f.aa=E.prototype,f.prototype=new b,f.prototype.constructor=f,f.Qb=function(O,Y,ie){for(var ve=Array(arguments.length-2),Ct=2;Ct<arguments.length;Ct++)ve[Ct-2]=arguments[Ct];return E.prototype[Y].apply(O,ve)}}function A(f){const E=f.length;if(0<E){const b=Array(E);for(let O=0;O<E;O++)b[O]=f[O];return b}return[]}function C(f,E){for(let b=1;b<arguments.length;b++){const O=arguments[b];if(h(O)){const Y=f.length||0,ie=O.length||0;f.length=Y+ie;for(let ve=0;ve<ie;ve++)f[Y+ve]=O[ve]}else f.push(O)}}class L{constructor(E,b){this.i=E,this.j=b,this.h=0,this.g=null}get(){let E;return 0<this.h?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function x(f){return/^[\s\xa0]*$/.test(f)}function U(){var f=d.navigator;return f&&(f=f.userAgent)?f:""}function z(f){return z[" "](f),f}z[" "]=function(){};var $=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function se(f,E,b){for(const O in f)E.call(b,f[O],O,f)}function D(f,E){for(const b in f)E.call(void 0,f[b],b,f)}function P(f){const E={};for(const b in f)E[b]=f[b];return E}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(f,E){let b,O;for(let Y=1;Y<arguments.length;Y++){O=arguments[Y];for(b in O)f[b]=O[b];for(let ie=0;ie<N.length;ie++)b=N[ie],Object.prototype.hasOwnProperty.call(O,b)&&(f[b]=O[b])}}function B(f){var E=1;f=f.split(":");const b=[];for(;0<E&&f.length;)b.push(f.shift()),E--;return f.length&&b.push(f.join(":")),b}function G(f){d.setTimeout(()=>{throw f},0)}function k(){var f=je;let E=null;return f.g&&(E=f.g,f.g=f.g.next,f.g||(f.h=null),E.next=null),E}class Ve{constructor(){this.h=this.g=null}add(E,b){const O=et.get();O.set(E,b),this.h?this.h.next=O:this.g=O,this.h=O}}var et=new L(()=>new te,f=>f.reset());class te{constructor(){this.next=this.g=this.h=null}set(E,b){this.h=E,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let he,Ie=!1,je=new Ve,Ke=()=>{const f=d.Promise.resolve(void 0);he=()=>{f.then(j)}};var j=()=>{for(var f;f=k();){try{f.h.call(f.g)}catch(b){G(b)}var E=et;E.j(f),100>E.h&&(E.h++,f.next=E.g,E.g=f)}Ie=!1};function K(){this.s=this.s,this.C=this.C}K.prototype.s=!1,K.prototype.ma=function(){this.s||(this.s=!0,this.N())},K.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(f,E){this.type=f,this.g=this.target=E,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var pe=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var f=!1,E=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const b=()=>{};d.addEventListener("test",b,E),d.removeEventListener("test",b,E)}catch{}return f})();function Pe(f,E){if(ue.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var b=this.type=f.type,O=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=E,E=f.relatedTarget){if($){e:{try{z(E.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(E=null)}}else b=="mouseover"?E=f.fromElement:b=="mouseout"&&(E=f.toElement);this.relatedTarget=E,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ze[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Pe.aa.h.call(this)}}I(Pe,ue);var ze={2:"touch",3:"pen",4:"mouse"};Pe.prototype.h=function(){Pe.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var tt="closure_listenable_"+(1e6*Math.random()|0),Mt=0;function vt(f,E,b,O,Y){this.listener=f,this.proxy=null,this.src=E,this.type=b,this.capture=!!O,this.ha=Y,this.key=++Mt,this.da=this.fa=!1}function Je(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Rt(f){this.src=f,this.g={},this.h=0}Rt.prototype.add=function(f,E,b,O,Y){var ie=f.toString();f=this.g[ie],f||(f=this.g[ie]=[],this.h++);var ve=Ft(f,E,O,Y);return-1<ve?(E=f[ve],b||(E.fa=!1)):(E=new vt(E,this.src,ie,!!O,Y),E.fa=b,f.push(E)),E};function ot(f,E){var b=E.type;if(b in f.g){var O=f.g[b],Y=Array.prototype.indexOf.call(O,E,void 0),ie;(ie=0<=Y)&&Array.prototype.splice.call(O,Y,1),ie&&(Je(E),f.g[b].length==0&&(delete f.g[b],f.h--))}}function Ft(f,E,b,O){for(var Y=0;Y<f.length;++Y){var ie=f[Y];if(!ie.da&&ie.listener==E&&ie.capture==!!b&&ie.ha==O)return Y}return-1}var Xt="closure_lm_"+(1e6*Math.random()|0),Re={};function oe(f,E,b,O,Y){if(Array.isArray(E)){for(var ie=0;ie<E.length;ie++)oe(f,E[ie],b,O,Y);return null}return b=Se(b),f&&f[tt]?f.K(E,b,m(O)?!!O.capture:!1,Y):De(f,E,b,!1,O,Y)}function De(f,E,b,O,Y,ie){if(!E)throw Error("Invalid event type");var ve=m(Y)?!!Y.capture:!!Y,Ct=It(f);if(Ct||(f[Xt]=Ct=new Rt(f)),b=Ct.add(E,b,O,ve,ie),b.proxy)return b;if(O=Ee(),b.proxy=O,O.src=f,O.listener=b,f.addEventListener)pe||(Y=ve),Y===void 0&&(Y=!1),f.addEventListener(E.toString(),O,Y);else if(f.attachEvent)f.attachEvent(Ue(E.toString()),O);else if(f.addListener&&f.removeListener)f.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return b}function Ee(){function f(b){return E.call(f.src,f.listener,b)}const E=He;return f}function Te(f,E,b,O,Y){if(Array.isArray(E))for(var ie=0;ie<E.length;ie++)Te(f,E[ie],b,O,Y);else O=m(O)?!!O.capture:!!O,b=Se(b),f&&f[tt]?(f=f.i,E=String(E).toString(),E in f.g&&(ie=f.g[E],b=Ft(ie,b,O,Y),-1<b&&(Je(ie[b]),Array.prototype.splice.call(ie,b,1),ie.length==0&&(delete f.g[E],f.h--)))):f&&(f=It(f))&&(E=f.g[E.toString()],f=-1,E&&(f=Ft(E,b,O,Y)),(b=-1<f?E[f]:null)&&be(b))}function be(f){if(typeof f!="number"&&f&&!f.da){var E=f.src;if(E&&E[tt])ot(E.i,f);else{var b=f.type,O=f.proxy;E.removeEventListener?E.removeEventListener(b,O,f.capture):E.detachEvent?E.detachEvent(Ue(b),O):E.addListener&&E.removeListener&&E.removeListener(O),(b=It(E))?(ot(b,f),b.h==0&&(b.src=null,E[Xt]=null)):Je(f)}}}function Ue(f){return f in Re?Re[f]:Re[f]="on"+f}function He(f,E){if(f.da)f=!0;else{E=new Pe(E,this);var b=f.listener,O=f.ha||f.src;f.fa&&be(f),f=b.call(O,E)}return f}function It(f){return f=f[Xt],f instanceof Rt?f:null}var Ze="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(f){return typeof f=="function"?f:(f[Ze]||(f[Ze]=function(E){return f.handleEvent(E)}),f[Ze])}function _e(){K.call(this),this.i=new Rt(this),this.M=this,this.F=null}I(_e,K),_e.prototype[tt]=!0,_e.prototype.removeEventListener=function(f,E,b,O){Te(this,f,E,b,O)};function me(f,E){var b,O=f.F;if(O)for(b=[];O;O=O.F)b.push(O);if(f=f.M,O=E.type||E,typeof E=="string")E=new ue(E,f);else if(E instanceof ue)E.target=E.target||f;else{var Y=E;E=new ue(O,f),M(E,Y)}if(Y=!0,b)for(var ie=b.length-1;0<=ie;ie--){var ve=E.g=b[ie];Y=ge(ve,O,!0,E)&&Y}if(ve=E.g=f,Y=ge(ve,O,!0,E)&&Y,Y=ge(ve,O,!1,E)&&Y,b)for(ie=0;ie<b.length;ie++)ve=E.g=b[ie],Y=ge(ve,O,!1,E)&&Y}_e.prototype.N=function(){if(_e.aa.N.call(this),this.i){var f=this.i,E;for(E in f.g){for(var b=f.g[E],O=0;O<b.length;O++)Je(b[O]);delete f.g[E],f.h--}}this.F=null},_e.prototype.K=function(f,E,b,O){return this.i.add(String(f),E,!1,b,O)},_e.prototype.L=function(f,E,b,O){return this.i.add(String(f),E,!0,b,O)};function ge(f,E,b,O){if(E=f.i.g[String(E)],!E)return!0;E=E.concat();for(var Y=!0,ie=0;ie<E.length;++ie){var ve=E[ie];if(ve&&!ve.da&&ve.capture==b){var Ct=ve.listener,dn=ve.ha||ve.src;ve.fa&&ot(f.i,ve),Y=Ct.call(dn,O)!==!1&&Y}}return Y&&!O.defaultPrevented}function re(f,E,b){if(typeof f=="function")b&&(f=v(f,b));else if(f&&typeof f.handleEvent=="function")f=v(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(E)?-1:d.setTimeout(f,E||0)}function ye(f){f.g=re(()=>{f.g=null,f.i&&(f.i=!1,ye(f))},f.l);const E=f.h;f.h=null,f.m.apply(null,E)}class $e extends K{constructor(E,b){super(),this.m=E,this.l=b,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qe(f){K.call(this),this.h=f,this.g={}}I(qe,K);var Pt=[];function yt(f){se(f.g,function(E,b){this.g.hasOwnProperty(b)&&be(E)},f),f.g={}}qe.prototype.N=function(){qe.aa.N.call(this),yt(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fe=d.JSON.stringify,Et=d.JSON.parse,ai=class{stringify(f){return d.JSON.stringify(f,void 0)}parse(f){return d.JSON.parse(f,void 0)}};function Ei(){}Ei.prototype.h=null;function oi(f){return f.h||(f.h=f.i())}function ji(){}var tr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function cs(){ue.call(this,"d")}I(cs,ue);function zi(){ue.call(this,"c")}I(zi,ue);var Si={},us=null;function co(){return us=us||new _e}Si.La="serverreachability";function Al(f){ue.call(this,Si.La,f)}I(Al,ue);function Rr(f){const E=co();me(E,new Al(E))}Si.STAT_EVENT="statevent";function ds(f,E){ue.call(this,Si.STAT_EVENT,f),this.stat=E}I(ds,ue);function In(f){const E=co();me(E,new ds(E,f))}Si.Ma="timingevent";function Rl(f,E){ue.call(this,Si.Ma,f),this.size=E}I(Rl,ue);function hs(f,E){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){f()},E)}function fs(){this.g=!0}fs.prototype.xa=function(){this.g=!1};function Il(f,E,b,O,Y,ie){f.info(function(){if(f.g)if(ie)for(var ve="",Ct=ie.split("&"),dn=0;dn<Ct.length;dn++){var st=Ct[dn].split("=");if(1<st.length){var bn=st[0];st=st[1];var Tn=bn.split("_");ve=2<=Tn.length&&Tn[1]=="type"?ve+(bn+"="+st+"&"):ve+(bn+"=redacted&")}}else ve=null;else ve=ie;return"XMLHTTP REQ ("+O+") [attempt "+Y+"]: "+E+`
`+b+`
`+ve})}function Pl(f,E,b,O,Y,ie,ve){f.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+Y+"]: "+E+`
`+b+`
`+ie+" "+ve})}function Ir(f,E,b,O){f.info(function(){return"XMLHTTP TEXT ("+E+"): "+nr(f,b)+(O?" "+O:"")})}function mu(f,E){f.info(function(){return"TIMEOUT: "+E})}fs.prototype.info=function(){};function nr(f,E){if(!f.g)return E;if(!E)return null;try{var b=JSON.parse(E);if(b){for(f=0;f<b.length;f++)if(Array.isArray(b[f])){var O=b[f];if(!(2>O.length)){var Y=O[1];if(Array.isArray(Y)&&!(1>Y.length)){var ie=Y[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var ve=1;ve<Y.length;ve++)Y[ve]=""}}}}return Fe(b)}catch{return E}}var Zt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ir;function ms(){}I(ms,Ei),ms.prototype.g=function(){return new XMLHttpRequest},ms.prototype.i=function(){return{}},ir=new ms;function rr(f,E,b,O){this.j=f,this.i=E,this.l=b,this.R=O||1,this.U=new qe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new pu}function pu(){this.i=null,this.g="",this.h=!1}var Cl={},Pr={};function ya(f,E,b){f.L=1,f.v=Ea(en(E)),f.m=b,f.P=!0,Cr(f,null)}function Cr(f,E){f.F=Date.now(),Bi(f),f.A=en(f.v);var b=f.A,O=f.R;Array.isArray(O)||(O=[String(O)]),xr(b.i,"t",O),f.C=0,b=f.j.J,f.h=new pu,f.g=Ou(f.j,b?E:null,!f.m),0<f.O&&(f.M=new $e(v(f.Y,f,f.g),f.O)),E=f.U,b=f.g,O=f.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(Pt[0]=Y.toString()),Y=Pt);for(var ie=0;ie<Y.length;ie++){var ve=oe(b,Y[ie],O||E.handleEvent,!1,E.h||E);if(!ve)break;E.g[ve.key]=ve}E=f.H?P(f.H):{},f.m?(f.u||(f.u="POST"),E["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,E)):(f.u="GET",f.g.ea(f.A,f.u,null,E)),Rr(),Il(f.i,f.u,f.A,f.l,f.R,f.m)}rr.prototype.ca=function(f){f=f.target;const E=this.M;E&&Gn(f)==3?E.j():this.Y(f)},rr.prototype.Y=function(f){try{if(f==this.g)e:{const Tn=Gn(this.g);var E=this.g.Ba();const Is=this.g.Z();if(!(3>Tn)&&(Tn!=3||this.g&&(this.h.h||this.g.oa()||ba(this.g)))){this.J||Tn!=4||E==7||(E==8||0>=Is?Rr(3):Rr(2)),uo(this);var b=this.g.Z();this.X=b;t:if(Nr(this)){var O=ba(this.g);f="";var Y=O.length,ie=Gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Bn(this),ps(this);var ve="";break t}this.h.i=new d.TextDecoder}for(E=0;E<Y;E++)this.h.h=!0,f+=this.h.i.decode(O[E],{stream:!(ie&&E==Y-1)});O.length=0,this.h.g+=f,this.C=0,ve=this.h.g}else ve=this.g.oa();if(this.o=b==200,Pl(this.i,this.u,this.A,this.l,this.R,Tn,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Ct,dn=this.g;if((Ct=dn.g?dn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(Ct)){var st=Ct;break t}}st=null}if(b=st)Ir(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,sr(this,b);else{this.o=!1,this.s=3,In(12),Bn(this),ps(this);break e}}if(this.P){b=!0;let Kn;for(;!this.J&&this.C<ve.length;)if(Kn=_a(this,ve),Kn==Pr){Tn==4&&(this.s=4,In(14),b=!1),Ir(this.i,this.l,null,"[Incomplete Response]");break}else if(Kn==Cl){this.s=4,In(15),Ir(this.i,this.l,ve,"[Invalid Chunk]"),b=!1;break}else Ir(this.i,this.l,Kn,null),sr(this,Kn);if(Nr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tn!=4||ve.length!=0||this.h.h||(this.s=1,In(16),b=!1),this.o=this.o&&b,!b)Ir(this.i,this.l,ve,"[Invalid Chunked Response]"),Bn(this),ps(this);else if(0<ve.length&&!this.W){this.W=!0;var bn=this.j;bn.g==this&&bn.ba&&!bn.M&&(bn.j.info("Great, no buffering proxy detected. Bytes received: "+ve.length),zl(bn),bn.M=!0,In(11))}}else Ir(this.i,this.l,ve,null),sr(this,ve);Tn==4&&Bn(this),this.o&&!this.J&&(Tn==4?Pu(this.j,this):(this.o=!1,Bi(this)))}else wu(this.g),b==400&&0<ve.indexOf("Unknown SID")?(this.s=3,In(12)):(this.s=0,In(13)),Bn(this),ps(this)}}}catch{}finally{}};function Nr(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function _a(f,E){var b=f.C,O=E.indexOf(`
`,b);return O==-1?Pr:(b=Number(E.substring(b,O)),isNaN(b)?Cl:(O+=1,O+b>E.length?Pr:(E=E.slice(O,O+b),f.C=O+b,E)))}rr.prototype.cancel=function(){this.J=!0,Bn(this)};function Bi(f){f.S=Date.now()+f.I,an(f,f.I)}function an(f,E){if(f.B!=null)throw Error("WatchDog timer not null");f.B=hs(v(f.ba,f),E)}function uo(f){f.B&&(d.clearTimeout(f.B),f.B=null)}rr.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(mu(this.i,this.A),this.L!=2&&(Rr(),In(17)),Bn(this),this.s=2,ps(this)):an(this,this.S-f)};function ps(f){f.j.G==0||f.J||Pu(f.j,f)}function Bn(f){uo(f);var E=f.M;E&&typeof E.ma=="function"&&E.ma(),f.M=null,yt(f.U),f.g&&(E=f.g,f.g=null,E.abort(),E.ma())}function sr(f,E){try{var b=f.j;if(b.G!=0&&(b.g==f||gs(b.h,f))){if(!f.K&&gs(b.h,f)&&b.G==3){try{var O=b.Da.g.parse(E)}catch{O=null}if(Array.isArray(O)&&O.length==3){var Y=O;if(Y[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<f.F)As(b),Ts(b);else break e;jl(b),In(18)}}else b.za=Y[1],0<b.za-b.T&&37500>Y[2]&&b.F&&b.v==0&&!b.C&&(b.C=hs(v(b.Za,b),6e3));if(1>=gu(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else kr(b,11)}else if((f.K||b.g==f)&&As(b),!x(E))for(Y=b.Da.g.parse(E),E=0;E<Y.length;E++){let st=Y[E];if(b.T=st[0],st=st[1],b.G==2)if(st[0]=="c"){b.K=st[1],b.ia=st[2];const bn=st[3];bn!=null&&(b.la=bn,b.j.info("VER="+b.la));const Tn=st[4];Tn!=null&&(b.Aa=Tn,b.j.info("SVER="+b.Aa));const Is=st[5];Is!=null&&typeof Is=="number"&&0<Is&&(O=1.5*Is,b.L=O,b.j.info("backChannelRequestTimeoutMs_="+O)),O=b;const Kn=f.g;if(Kn){const Ra=Kn.g?Kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ra){var ie=O.h;ie.g||Ra.indexOf("spdy")==-1&&Ra.indexOf("quic")==-1&&Ra.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(ys(ie,ie.h),ie.h=null))}if(O.D){const Mr=Kn.g?Kn.g.getResponseHeader("X-HTTP-Session-Id"):null;Mr&&(O.ya=Mr,St(O.I,O.D,Mr))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-f.F,b.j.info("Handshake RTT: "+b.R+"ms")),O=b;var ve=f;if(O.qa=Nu(O,O.J?O.ia:null,O.W),ve.K){wi(O.h,ve);var Ct=ve,dn=O.L;dn&&(Ct.I=dn),Ct.B&&(uo(Ct),Bi(Ct)),O.g=ve}else Ru(O);0<b.i.length&&vo(b)}else st[0]!="stop"&&st[0]!="close"||kr(b,7);else b.G==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?kr(b,7):Ul(b):st[0]!="noop"&&b.l&&b.l.ta(st),b.v=0)}}Rr(4)}catch{}}var hf=class{constructor(f,E){this.g=f,this.map=E}};function Nl(f){this.l=f||10,d.PerformanceNavigationTiming?(f=d.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ol(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function gu(f){return f.h?1:f.g?f.g.size:0}function gs(f,E){return f.h?f.h==E:f.g?f.g.has(E):!1}function ys(f,E){f.g?f.g.add(E):f.h=E}function wi(f,E){f.h&&f.h==E?f.h=null:f.g&&f.g.has(E)&&f.g.delete(E)}Nl.prototype.cancel=function(){if(this.i=Fn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Fn(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let E=f.i;for(const b of f.g.values())E=E.concat(b.D);return E}return A(f.i)}function yu(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(h(f)){for(var E=[],b=f.length,O=0;O<b;O++)E.push(f[O]);return E}E=[],b=0;for(O in f)E[b++]=f[O];return E}function ff(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(h(f)||typeof f=="string"){var E=[];f=f.length;for(var b=0;b<f;b++)E.push(b);return E}E=[],b=0;for(const O in f)E[b++]=O;return E}}}function ho(f,E){if(f.forEach&&typeof f.forEach=="function")f.forEach(E,void 0);else if(h(f)||typeof f=="string")Array.prototype.forEach.call(f,E,void 0);else for(var b=ff(f),O=yu(f),Y=O.length,ie=0;ie<Y;ie++)E.call(void 0,O[ie],b&&b[ie],f)}var xl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fo(f,E){if(f){f=f.split("&");for(var b=0;b<f.length;b++){var O=f[b].indexOf("="),Y=null;if(0<=O){var ie=f[b].substring(0,O);Y=f[b].substring(O+1)}else ie=f[b];E(ie,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Or(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Or){this.h=f.h,_s(this,f.j),this.o=f.o,this.g=f.g,va(this,f.s),this.l=f.l;var E=f.i,b=new ar;b.i=E.i,E.g&&(b.g=new Map(E.g),b.h=E.h),mo(this,b),this.m=f.m}else f&&(E=String(f).match(xl))?(this.h=!1,_s(this,E[1]||"",!0),this.o=vs(E[2]||""),this.g=vs(E[3]||"",!0),va(this,E[4]),this.l=vs(E[5]||"",!0),mo(this,E[6]||"",!0),this.m=vs(E[7]||"")):(this.h=!1,this.i=new ar(null,this.h))}Or.prototype.toString=function(){var f=[],E=this.j;E&&f.push(bi(E,Dl,!0),":");var b=this.g;return(b||E=="file")&&(f.push("//"),(E=this.o)&&f.push(bi(E,Dl,!0),"@"),f.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&f.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&f.push("/"),f.push(bi(b,b.charAt(0)=="/"?kl:_u,!0))),(b=this.i.toString())&&f.push("?",b),(b=this.m)&&f.push("#",bi(b,gf)),f.join("")};function en(f){return new Or(f)}function _s(f,E,b){f.j=b?vs(E,!0):E,f.j&&(f.j=f.j.replace(/:$/,""))}function va(f,E){if(E){if(E=Number(E),isNaN(E)||0>E)throw Error("Bad port number "+E);f.s=E}else f.s=null}function mo(f,E,b){E instanceof ar?(f.i=E,vu(f.i,f.h)):(b||(E=bi(E,pf)),f.i=new ar(E,f.h))}function St(f,E,b){f.i.set(E,b)}function Ea(f){return St(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function vs(f,E){return f?E?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function bi(f,E,b){return typeof f=="string"?(f=encodeURI(f).replace(E,mf),b&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function mf(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Dl=/[#\/\?@]/g,_u=/[#\?:]/g,kl=/[#\?]/g,pf=/[#\?@]/g,gf=/#/g;function ar(f,E){this.h=this.g=null,this.i=f||null,this.j=!!E}function wn(f){f.g||(f.g=new Map,f.h=0,f.i&&fo(f.i,function(E,b){f.add(decodeURIComponent(E.replace(/\+/g," ")),b)}))}n=ar.prototype,n.add=function(f,E){wn(this),this.i=null,f=li(this,f);var b=this.g.get(f);return b||this.g.set(f,b=[]),b.push(E),this.h+=1,this};function po(f,E){wn(f),E=li(f,E),f.g.has(E)&&(f.i=null,f.h-=f.g.get(E).length,f.g.delete(E))}function go(f,E){return wn(f),E=li(f,E),f.g.has(E)}n.forEach=function(f,E){wn(this),this.g.forEach(function(b,O){b.forEach(function(Y){f.call(E,Y,O,this)},this)},this)},n.na=function(){wn(this);const f=Array.from(this.g.values()),E=Array.from(this.g.keys()),b=[];for(let O=0;O<E.length;O++){const Y=f[O];for(let ie=0;ie<Y.length;ie++)b.push(E[O])}return b},n.V=function(f){wn(this);let E=[];if(typeof f=="string")go(this,f)&&(E=E.concat(this.g.get(li(this,f))));else{f=Array.from(this.g.values());for(let b=0;b<f.length;b++)E=E.concat(f[b])}return E},n.set=function(f,E){return wn(this),this.i=null,f=li(this,f),go(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[E]),this.h+=1,this},n.get=function(f,E){return f?(f=this.V(f),0<f.length?String(f[0]):E):E};function xr(f,E,b){po(f,E),0<b.length&&(f.i=null,f.g.set(li(f,E),A(b)),f.h+=b.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],E=Array.from(this.g.keys());for(var b=0;b<E.length;b++){var O=E[b];const ie=encodeURIComponent(String(O)),ve=this.V(O);for(O=0;O<ve.length;O++){var Y=ie;ve[O]!==""&&(Y+="="+encodeURIComponent(String(ve[O]))),f.push(Y)}}return this.i=f.join("&")};function li(f,E){return E=String(E),f.j&&(E=E.toLowerCase()),E}function vu(f,E){E&&!f.j&&(wn(f),f.i=null,f.g.forEach(function(b,O){var Y=O.toLowerCase();O!=Y&&(po(this,O),xr(this,Y,b))},f)),f.j=E}function Ml(f,E){const b=new fs;if(d.Image){const O=new Image;O.onload=T(Yn,b,"TestLoadImage: loaded",!0,E,O),O.onerror=T(Yn,b,"TestLoadImage: error",!1,E,O),O.onabort=T(Yn,b,"TestLoadImage: abort",!1,E,O),O.ontimeout=T(Yn,b,"TestLoadImage: timeout",!1,E,O),d.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=f}else E(!1)}function Eu(f,E){const b=new fs,O=new AbortController,Y=setTimeout(()=>{O.abort(),Yn(b,"TestPingServer: timeout",!1,E)},1e4);fetch(f,{signal:O.signal}).then(ie=>{clearTimeout(Y),ie.ok?Yn(b,"TestPingServer: ok",!0,E):Yn(b,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(Y),Yn(b,"TestPingServer: error",!1,E)})}function Yn(f,E,b,O,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),O(b)}catch{}}function Fi(){this.g=new ai}function Ll(f,E,b){const O=b||"";try{ho(f,function(Y,ie){let ve=Y;m(Y)&&(ve=Fe(Y)),E.push(O+ie+"="+encodeURIComponent(ve))})}catch(Y){throw E.push(O+"type="+encodeURIComponent("_badmap")),Y}}function or(f){this.l=f.Ub||null,this.j=f.eb||!1}I(or,Ei),or.prototype.g=function(){return new ci(this.l,this.j)},or.prototype.i=(function(f){return function(){return f}})({});function ci(f,E){_e.call(this),this.D=f,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(ci,_e),n=ci.prototype,n.open=function(f,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=E,this.readyState=1,Es(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const E={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(E.body=f),(this.D||d).fetch(new Request(this.A,E)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,lr(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Es(this)),this.g&&(this.readyState=3,Es(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yo(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function yo(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var E=f.value?f.value:new Uint8Array(0);(E=this.v.decode(E,{stream:!f.done}))&&(this.response=this.responseText+=E)}f.done?lr(this):Es(this),this.readyState==3&&yo(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,lr(this))},n.Qa=function(f){this.g&&(this.response=f,lr(this))},n.ga=function(){this.g&&lr(this)};function lr(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Es(f)}n.setRequestHeader=function(f,E){this.u.append(f,E)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],E=this.h.entries();for(var b=E.next();!b.done;)b=b.value,f.push(b[0]+": "+b[1]),b=E.next();return f.join(`\r
`)};function Es(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(ci.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Sa(f){let E="";return se(f,function(b,O){E+=O,E+=":",E+=b,E+=`\r
`}),E}function Ss(f,E,b){e:{for(O in b){var O=!1;break e}O=!0}O||(b=Sa(b),typeof f=="string"?b!=null&&encodeURIComponent(String(b)):St(f,E,b))}function $t(f){_e.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I($t,_e);var Ln=/^https?$/i,Dr=["POST","PUT"];n=$t.prototype,n.Ha=function(f){this.J=f},n.ea=function(f,E,b,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);E=E?E.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ir.g(),this.v=this.o?oi(this.o):oi(ir),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(E,String(f),!0),this.B=!1}catch(ie){wa(this,ie);return}if(f=b||"",b=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var Y in O)b.set(Y,O[Y]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ie of O.keys())b.set(ie,O.get(ie));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(b.keys()).find(ie=>ie.toLowerCase()=="content-type"),Y=d.FormData&&f instanceof d.FormData,!(0<=Array.prototype.indexOf.call(Dr,E,void 0))||O||Y||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,ve]of b)this.g.setRequestHeader(ie,ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_o(this),this.u=!0,this.g.send(f),this.u=!1}catch(ie){wa(this,ie)}};function wa(f,E){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=E,f.m=5,ws(f),bs(f)}function ws(f){f.A||(f.A=!0,me(f,"complete"),me(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,me(this,"complete"),me(this,"abort"),bs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bs(this,!0)),$t.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Su(this):this.bb())},n.bb=function(){Su(this)};function Su(f){if(f.h&&typeof c<"u"&&(!f.v[1]||Gn(f)!=4||f.Z()!=2)){if(f.u&&Gn(f)==4)re(f.Ea,0,f);else if(me(f,"readystatechange"),Gn(f)==4){f.h=!1;try{const ve=f.Z();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var b;if(!(b=E)){var O;if(O=ve===0){var Y=String(f.D).match(xl)[1]||null;!Y&&d.self&&d.self.location&&(Y=d.self.location.protocol.slice(0,-1)),O=!Ln.test(Y?Y.toLowerCase():"")}b=O}if(b)me(f,"complete"),me(f,"success");else{f.m=6;try{var ie=2<Gn(f)?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.Z()+"]",ws(f)}}finally{bs(f)}}}}function bs(f,E){if(f.g){_o(f);const b=f.g,O=f.v[0]?()=>{}:null;f.g=null,f.v=null,E||me(f,"ready");try{b.onreadystatechange=O}catch{}}}function _o(f){f.I&&(d.clearTimeout(f.I),f.I=null)}n.isActive=function(){return!!this.g};function Gn(f){return f.g?f.g.readyState:0}n.Z=function(){try{return 2<Gn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var E=this.g.responseText;return f&&E.indexOf(f)==0&&(E=E.substring(f.length)),Et(E)}};function ba(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function wu(f){const E={};f=(f.g&&2<=Gn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<f.length;O++){if(x(f[O]))continue;var b=B(f[O]);const Y=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const ie=E[Y]||[];E[Y]=ie,ie.push(b)}D(E,function(O){return O.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ta(f,E,b){return b&&b.internalChannelParams&&b.internalChannelParams[f]||E}function bu(f){this.Aa=0,this.i=[],this.j=new fs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ta("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ta("baseRetryDelayMs",5e3,f),this.cb=Ta("retryDelaySeedMs",1e4,f),this.Wa=Ta("forwardChannelMaxRetries",2,f),this.wa=Ta("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Nl(f&&f.concurrentRequestLimit),this.Da=new Fi,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=bu.prototype,n.la=8,n.G=1,n.connect=function(f,E,b,O){In(0),this.W=f,this.H=E||{},b&&O!==void 0&&(this.H.OSID=b,this.H.OAID=O),this.F=this.X,this.I=Nu(this,null,this.W),vo(this)};function Ul(f){if(Tu(f),f.G==3){var E=f.U++,b=en(f.I);if(St(b,"SID",f.K),St(b,"RID",E),St(b,"TYPE","terminate"),Aa(f,b),E=new rr(f,f.j,E),E.L=2,E.v=Ea(en(b)),b=!1,d.navigator&&d.navigator.sendBeacon)try{b=d.navigator.sendBeacon(E.v.toString(),"")}catch{}!b&&d.Image&&(new Image().src=E.v,b=!0),b||(E.g=Ou(E.j,null),E.g.ea(E.v)),E.F=Date.now(),Bi(E)}Bl(f)}function Ts(f){f.g&&(zl(f),f.g.cancel(),f.g=null)}function Tu(f){Ts(f),f.u&&(d.clearTimeout(f.u),f.u=null),As(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&d.clearTimeout(f.s),f.s=null)}function vo(f){if(!Ol(f.h)&&!f.s){f.s=!0;var E=f.Ga;he||Ke(),Ie||(he(),Ie=!0),je.add(E,f),f.B=0}}function yf(f,E){return gu(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=E.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=hs(v(f.Ga,f,E),Cu(f,f.B)),f.B++,!0)}n.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const Y=new rr(this,this.j,f);let ie=this.o;if(this.S&&(ie?(ie=P(ie),M(ie,this.S)):ie=this.S),this.m!==null||this.O||(Y.H=ie,ie=null),this.P)e:{for(var E=0,b=0;b<this.i.length;b++){t:{var O=this.i[b];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(E+=O,4096<E){E=b;break e}if(E===4096||b===this.i.length-1){E=b+1;break e}}E=1e3}else E=1e3;E=Vl(this,Y,E),b=en(this.I),St(b,"RID",f),St(b,"CVER",22),this.D&&St(b,"X-HTTP-Session-Id",this.D),Aa(this,b),ie&&(this.O?E="headers="+encodeURIComponent(String(Sa(ie)))+"&"+E:this.m&&Ss(b,this.m,ie)),ys(this.h,Y),this.Ua&&St(b,"TYPE","init"),this.P?(St(b,"$req",E),St(b,"SID","null"),Y.T=!0,ya(Y,b,null)):ya(Y,b,E),this.G=2}}else this.G==3&&(f?Au(this,f):this.i.length==0||Ol(this.h)||Au(this))};function Au(f,E){var b;E?b=E.l:b=f.U++;const O=en(f.I);St(O,"SID",f.K),St(O,"RID",b),St(O,"AID",f.T),Aa(f,O),f.m&&f.o&&Ss(O,f.m,f.o),b=new rr(f,f.j,b,f.B+1),f.m===null&&(b.H=f.o),E&&(f.i=E.D.concat(f.i)),E=Vl(f,b,1e3),b.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),ys(f.h,b),ya(b,O,E)}function Aa(f,E){f.H&&se(f.H,function(b,O){St(E,O,b)}),f.l&&ho({},function(b,O){St(E,O,b)})}function Vl(f,E,b){b=Math.min(f.i.length,b);var O=f.l?v(f.l.Na,f.l,f):null;e:{var Y=f.i;let ie=-1;for(;;){const ve=["count="+b];ie==-1?0<b?(ie=Y[0].g,ve.push("ofs="+ie)):ie=0:ve.push("ofs="+ie);let Ct=!0;for(let dn=0;dn<b;dn++){let st=Y[dn].g;const bn=Y[dn].map;if(st-=ie,0>st)ie=Math.max(0,Y[dn].g-100),Ct=!1;else try{Ll(bn,ve,"req"+st+"_")}catch{O&&O(bn)}}if(Ct){O=ve.join("&");break e}}}return f=f.i.splice(0,b),E.D=f,O}function Ru(f){if(!f.g&&!f.u){f.Y=1;var E=f.Fa;he||Ke(),Ie||(he(),Ie=!0),je.add(E,f),f.v=0}}function jl(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=hs(v(f.Fa,f),Cu(f,f.v)),f.v++,!0)}n.Fa=function(){if(this.u=null,Iu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=hs(v(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,In(10),Ts(this),Iu(this))};function zl(f){f.A!=null&&(d.clearTimeout(f.A),f.A=null)}function Iu(f){f.g=new rr(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var E=en(f.qa);St(E,"RID","rpc"),St(E,"SID",f.K),St(E,"AID",f.T),St(E,"CI",f.F?"0":"1"),!f.F&&f.ja&&St(E,"TO",f.ja),St(E,"TYPE","xmlhttp"),Aa(f,E),f.m&&f.o&&Ss(E,f.m,f.o),f.L&&(f.g.I=f.L);var b=f.g;f=f.ia,b.L=1,b.v=Ea(en(E)),b.m=null,b.P=!0,Cr(b,f)}n.Za=function(){this.C!=null&&(this.C=null,Ts(this),jl(this),In(19))};function As(f){f.C!=null&&(d.clearTimeout(f.C),f.C=null)}function Pu(f,E){var b=null;if(f.g==E){As(f),zl(f),f.g=null;var O=2}else if(gs(f.h,E))b=E.D,wi(f.h,E),O=1;else return;if(f.G!=0){if(E.o)if(O==1){b=E.m?E.m.length:0,E=Date.now()-E.F;var Y=f.B;O=co(),me(O,new Rl(O,b)),vo(f)}else Ru(f);else if(Y=E.s,Y==3||Y==0&&0<E.X||!(O==1&&yf(f,E)||O==2&&jl(f)))switch(b&&0<b.length&&(E=f.h,E.i=E.i.concat(b)),Y){case 1:kr(f,5);break;case 4:kr(f,10);break;case 3:kr(f,6);break;default:kr(f,2)}}}function Cu(f,E){let b=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(b*=2),b*E}function kr(f,E){if(f.j.info("Error code "+E),E==2){var b=v(f.fb,f),O=f.Xa;const Y=!O;O=new Or(O||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||_s(O,"https"),Ea(O),Y?Ml(O.toString(),b):Eu(O.toString(),b)}else In(2);f.G=0,f.l&&f.l.sa(E),Bl(f),Tu(f)}n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),In(2)):(this.j.info("Failed to ping google.com"),In(1))};function Bl(f){if(f.G=0,f.ka=[],f.l){const E=Fn(f.h);(E.length!=0||f.i.length!=0)&&(C(f.ka,E),C(f.ka,f.i),f.h.i.length=0,A(f.i),f.i.length=0),f.l.ra()}}function Nu(f,E,b){var O=b instanceof Or?en(b):new Or(b);if(O.g!="")E&&(O.g=E+"."+O.g),va(O,O.s);else{var Y=d.location;O=Y.protocol,E=E?E+"."+Y.hostname:Y.hostname,Y=+Y.port;var ie=new Or(null);O&&_s(ie,O),E&&(ie.g=E),Y&&va(ie,Y),b&&(ie.l=b),O=ie}return b=f.D,E=f.ya,b&&E&&St(O,b,E),St(O,"VER",f.la),Aa(f,O),O}function Ou(f,E,b){if(E&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return E=f.Ca&&!f.pa?new $t(new or({eb:b})):new $t(f.pa),E.Ha(f.J),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function xu(){}n=xu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Eo(){}Eo.prototype.g=function(f,E){return new Hn(f,E)};function Hn(f,E){_e.call(this),this.g=new bu(E),this.l=f,this.h=E&&E.messageUrlParams||null,f=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(f?f["X-WebChannel-Content-Type"]=E.messageContentType:f={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.va&&(f?f["X-WebChannel-Client-Profile"]=E.va:f={"X-WebChannel-Client-Profile":E.va}),this.g.S=f,(f=E&&E.Sb)&&!x(f)&&(this.g.m=f),this.v=E&&E.supportsCrossDomainXhr||!1,this.u=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!x(E)&&(this.g.D=E,f=this.h,f!==null&&E in f&&(f=this.h,E in f&&delete f[E])),this.j=new Rs(this)}I(Hn,_e),Hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){Ul(this.g)},Hn.prototype.o=function(f){var E=this.g;if(typeof f=="string"){var b={};b.__data__=f,f=b}else this.u&&(b={},b.__data__=Fe(f),f=b);E.i.push(new hf(E.Ya++,f)),E.G==3&&vo(E)},Hn.prototype.N=function(){this.g.l=null,delete this.j,Ul(this.g),delete this.g,Hn.aa.N.call(this)};function Du(f){cs.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var E=f.__sm__;if(E){e:{for(const b in E){f=b;break e}f=void 0}(this.i=f)&&(f=this.i,E=E!==null&&f in E?E[f]:void 0),this.data=E}else this.data=f}I(Du,cs);function ku(){zi.call(this),this.status=1}I(ku,zi);function Rs(f){this.g=f}I(Rs,xu),Rs.prototype.ua=function(){me(this.g,"a")},Rs.prototype.ta=function(f){me(this.g,new Du(f))},Rs.prototype.sa=function(f){me(this.g,new ku)},Rs.prototype.ra=function(){me(this.g,"b")},Eo.prototype.createWebChannel=Eo.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,Kw=function(){return new Eo},Yw=function(){return co()},qw=Si,zp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zt.NO_ERROR=0,Zt.TIMEOUT=8,Zt.HTTP_ERROR=6,Qd=Zt,Pn.COMPLETE="complete",$w=Pn,ji.EventType=tr,tr.OPEN="a",tr.CLOSE="b",tr.ERROR="c",tr.MESSAGE="d",_e.prototype.listen=_e.prototype.K,Cc=ji,$t.prototype.listenOnce=$t.prototype.L,$t.prototype.getLastError=$t.prototype.Ka,$t.prototype.getLastErrorCode=$t.prototype.Ba,$t.prototype.getStatus=$t.prototype.Z,$t.prototype.getResponseJson=$t.prototype.Oa,$t.prototype.getResponseText=$t.prototype.oa,$t.prototype.send=$t.prototype.ea,$t.prototype.setWithCredentials=$t.prototype.Ha,Hw=$t}).apply(typeof Vd<"u"?Vd:typeof self<"u"?self:typeof window<"u"?window:{});const bE="@firebase/firestore",TE="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ei.UNAUTHENTICATED=new ei(null),ei.GOOGLE_CREDENTIALS=new ei("google-credentials-uid"),ei.FIRST_PARTY=new ei("first-party-uid"),ei.MOCK_USER=new ei("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let El="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=new zh("@firebase/firestore");function Xo(){return Xa.logLevel}function Ce(n,...e){if(Xa.logLevel<=ht.DEBUG){const t=e.map(Rg);Xa.debug(`Firestore (${El}): ${n}`,...t)}}function ss(n,...e){if(Xa.logLevel<=ht.ERROR){const t=e.map(Rg);Xa.error(`Firestore (${El}): ${n}`,...t)}}function Ja(n,...e){if(Xa.logLevel<=ht.WARN){const t=e.map(Rg);Xa.warn(`Firestore (${El}): ${n}`,...t)}}function Rg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Ww(n,r,t)}function Ww(n,e,t){let r=`FIRESTORE (${El}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ss(r),new Error(r)}function Nt(n,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,n||Ww(e,a,r)}function Xe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends Vi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ei.UNAUTHENTICATED)))}shutdown(){}}class MC{constructor(e){this.t=e,this.currentUser=ei.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Nt(this.o===void 0,42304);let r=this.i;const a=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let l=new is;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new is,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const h=l;e.enqueueRetryable((async()=>{await h.promise,await a(this.currentUser)}))},d=h=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((h=>d(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?d(h):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new is)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Nt(typeof r.accessToken=="string",31837,{l:r}),new DC(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Nt(e===null||typeof e=="string",2055,{h:e}),new ei(e)}}class LC{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ei.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class UC{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new LC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ei.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class AE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class VC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Nt(this.o===void 0,3512);const r=l=>{l.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Ce("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const a=l=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new AE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Nt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new AE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=jC(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function at(n,e){return n<e?-1:n>e?1:0}function Bp(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),a=e.codePointAt(t);if(r!==a){if(r<128&&a<128)return at(r,a);{const l=Qw(),c=zC(l.encode(RE(n,t)),l.encode(RE(e,t)));return c!==0?c:at(r,a)}}t+=r>65535?2:1}return at(n.length,e.length)}function RE(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function zC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return at(n[t],e[t]);return at(n.length,e.length)}function hl(n,e,t){return n.length===e.length&&n.every(((r,a)=>t(r,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="__name__";class pr{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ge(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ge(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return pr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof pr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=pr.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return at(e.length,t.length)}static compareSegments(e,t){const r=pr.isNumericId(e),a=pr.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?pr.extractNumericId(e).compare(pr.extractNumericId(t)):Bp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ta.fromString(e.substring(4,e.length-2))}}class Gt extends pr{construct(e,t,r){return new Gt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ae(ce.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Gt(t)}static emptyPath(){return new Gt([])}}const BC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kn extends pr{construct(e,t,r){return new kn(e,t,r)}static isValidIdentifier(e){return BC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===IE}static keyField(){return new kn([IE])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new Ae(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new Ae(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Ae(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(r+=d,a++):(l(),a++)}if(l(),c)throw new Ae(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kn(t)}static emptyPath(){return new kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.path=e}static fromPath(e){return new Le(Gt.fromString(e))}static fromName(e){return new Le(Gt.fromString(e).popFirst(5))}static empty(){return new Le(Gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Le(new Gt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(n,e,t){if(!t)throw new Ae(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function FC(n,e,t,r){if(e===!0&&r===!0)throw new Ae(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function PE(n){if(!Le.isDocumentKey(n))throw new Ae(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function CE(n){if(Le.isDocumentKey(n))throw new Ae(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Jw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Bh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ge(12329,{type:typeof n})}function Ji(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ae(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bh(n);throw new Ae(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(n,e){const t={typeString:n};return e&&(t.value=e),t}function iu(n,e){if(!Jw(n))throw new Ae(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const c=n[r];if(a&&typeof c!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new Ae(ce.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=-62135596800,OE=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*OE);return new kt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ae(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ae(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<NE)throw new Ae(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/OE}_compareTo(e){return this.seconds===e.seconds?at(this.nanoseconds,e.nanoseconds):at(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(iu(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-NE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:_n("string",kt._jsonSchemaVersion),seconds:_n("number"),nanoseconds:_n("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{static fromTimestamp(e){return new We(e)}static min(){return new We(new kt(0,0))}static max(){return new We(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc=-1;function GC(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,a=We.fromTimestamp(r===1e9?new kt(t+1,0):new kt(t,r));return new sa(a,Le.empty(),e)}function HC(n){return new sa(n.readTime,n.key,Hc)}class sa{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new sa(We.min(),Le.empty(),Hc)}static max(){return new sa(We.max(),Le.empty(),Hc)}}function $C(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Le.comparator(n.documentKey,e.documentKey),t!==0?t:at(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class YC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sl(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==qC)throw n;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ge(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe(((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.reject(t)}static resolve(e){return new fe(((t,r)=>{t(e)}))}static reject(e){return new fe(((t,r)=>{r(e)}))}static waitFor(e){return new fe(((t,r)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&t()}),(h=>r(h)))})),c=!0,l===a&&t()}))}static or(e){let t=fe.resolve(!1);for(const r of e)t=t.next((a=>a?fe.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,l)=>{r.push(t.call(this,a,l))})),this.waitFor(r)}static mapArray(e,t){return new fe(((r,a)=>{const l=e.length,c=new Array(l);let d=0;for(let h=0;h<l;h++){const m=h;t(e[m]).next((g=>{c[m]=g,++d,d===l&&r(c)}),(g=>a(g)))}}))}static doWhile(e,t){return new fe(((r,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):r()};l()}))}}function KC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function wl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Fh.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pg=-1;function Gh(n){return n==null}function dh(n){return n===0&&1/n==-1/0}function WC(n){return typeof n=="number"&&Number.isInteger(n)&&!dh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw="";function QC(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=xE(e)),e=XC(n.get(t),e);return xE(e)}function XC(n,e){let t=e;const r=n.length;for(let a=0;a<r;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case Zw:t+="";break;default:t+=l}}return t}function xE(n){return n+Zw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function pa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function eb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,t){this.comparator=e,this.root=t||Dn.EMPTY}insert(e,t){return new Jt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dn.BLACK,null,null))}remove(e){return new Jt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jd(this.root,e,this.comparator,!1)}getReverseIterator(){return new jd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jd(this.root,e,this.comparator,!0)}}class jd{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dn{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??Dn.RED,this.left=a??Dn.EMPTY,this.right=l??Dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new Dn(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Dn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ge(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ge(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ge(27949);return e+(this.isRed()?0:1)}}Dn.EMPTY=null,Dn.RED=!0,Dn.BLACK=!1;Dn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ge(57766)}get value(){throw Ge(16141)}get color(){throw Ge(16727)}get left(){throw Ge(29726)}get right(){throw Ge(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new Dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.comparator=e,this.data=new Jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kE(this.data.getIterator())}getIteratorFrom(e){return new kE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Sn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Sn(this.comparator);return t.data=e,t}}class kE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.fields=e,e.sort(kn.comparator)}static empty(){return new yi([])}unionWith(e){let t=new Sn(kn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new yi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new tb("Invalid base64 string: "+l):l}})(e);return new Mn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new Mn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return at(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Mn.EMPTY_BYTE_STRING=new Mn("");const JC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function aa(n){if(Nt(!!n,39018),typeof n=="string"){let e=0;const t=JC.exec(n);if(Nt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:un(n.seconds),nanos:un(n.nanos)}}function un(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function oa(n){return typeof n=="string"?Mn.fromBase64String(n):Mn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb="server_timestamp",ib="__type__",rb="__previous_value__",sb="__local_write_time__";function Cg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[ib])===null||t===void 0?void 0:t.stringValue)===nb}function Hh(n){const e=n.mapValue.fields[rb];return Cg(e)?Hh(e):e}function $c(n){const e=aa(n.mapValue.fields[sb].timestampValue);return new kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,t,r,a,l,c,d,h,m,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=g}}const hh="(default)";class qc{constructor(e,t){this.projectId=e,this.database=t||hh}static empty(){return new qc("","")}get isDefaultDatabase(){return this.database===hh}isEqual(e){return e instanceof qc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab="__type__",e1="__max__",zd={mapValue:{}},ob="__vector__",fh="value";function la(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Cg(n)?4:n1(n)?9007199254740991:t1(n)?10:11:Ge(28295,{value:n})}function Tr(n,e){if(n===e)return!0;const t=la(n);if(t!==la(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return $c(n).isEqual($c(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=aa(a.timestampValue),d=aa(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return oa(a.bytesValue).isEqual(oa(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return un(a.geoPointValue.latitude)===un(l.geoPointValue.latitude)&&un(a.geoPointValue.longitude)===un(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return un(a.integerValue)===un(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=un(a.doubleValue),d=un(l.doubleValue);return c===d?dh(c)===dh(d):isNaN(c)&&isNaN(d)}return!1})(n,e);case 9:return hl(n.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(DE(c)!==DE(d))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(d[h]===void 0||!Tr(c[h],d[h])))return!1;return!0})(n,e);default:return Ge(52216,{left:n})}}function Yc(n,e){return(n.values||[]).find((t=>Tr(t,e)))!==void 0}function fl(n,e){if(n===e)return 0;const t=la(n),r=la(e);if(t!==r)return at(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=un(l.integerValue||l.doubleValue),h=un(c.integerValue||c.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1})(n,e);case 3:return ME(n.timestampValue,e.timestampValue);case 4:return ME($c(n),$c(e));case 5:return Bp(n.stringValue,e.stringValue);case 6:return(function(l,c){const d=oa(l),h=oa(c);return d.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),h=c.split("/");for(let m=0;m<d.length&&m<h.length;m++){const g=at(d[m],h[m]);if(g!==0)return g}return at(d.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=at(un(l.latitude),un(c.latitude));return d!==0?d:at(un(l.longitude),un(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return LE(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var d,h,m,g;const _=l.fields||{},v=c.fields||{},T=(d=_[fh])===null||d===void 0?void 0:d.arrayValue,I=(h=v[fh])===null||h===void 0?void 0:h.arrayValue,A=at(((m=T==null?void 0:T.values)===null||m===void 0?void 0:m.length)||0,((g=I==null?void 0:I.values)===null||g===void 0?void 0:g.length)||0);return A!==0?A:LE(T,I)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===zd.mapValue&&c===zd.mapValue)return 0;if(l===zd.mapValue)return 1;if(c===zd.mapValue)return-1;const d=l.fields||{},h=Object.keys(d),m=c.fields||{},g=Object.keys(m);h.sort(),g.sort();for(let _=0;_<h.length&&_<g.length;++_){const v=Bp(h[_],g[_]);if(v!==0)return v;const T=fl(d[h[_]],m[g[_]]);if(T!==0)return T}return at(h.length,g.length)})(n.mapValue,e.mapValue);default:throw Ge(23264,{le:t})}}function ME(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return at(n,e);const t=aa(n),r=aa(e),a=at(t.seconds,r.seconds);return a!==0?a:at(t.nanos,r.nanos)}function LE(n,e){const t=n.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=fl(t[a],r[a]);if(l)return l}return at(t.length,r.length)}function ml(n){return Fp(n)}function Fp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=aa(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return oa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Le.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=Fp(l);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of r)l?l=!1:a+=",",a+=`${c}:${Fp(t.fields[c])}`;return a+"}"})(n.mapValue):Ge(61005,{value:n})}function Xd(n){switch(la(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hh(n);return e?16+Xd(e):16;case 5:return 2*n.stringValue.length;case 6:return oa(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,l)=>a+Xd(l)),0)})(n.arrayValue);case 10:case 11:return(function(r){let a=0;return pa(r.fields,((l,c)=>{a+=l.length+Xd(c)})),a})(n.mapValue);default:throw Ge(13486,{value:n})}}function UE(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Gp(n){return!!n&&"integerValue"in n}function Ng(n){return!!n&&"arrayValue"in n}function VE(n){return!!n&&"nullValue"in n}function jE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jd(n){return!!n&&"mapValue"in n}function t1(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[ab])===null||t===void 0?void 0:t.stringValue)===ob}function Lc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return pa(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Lc(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Lc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function n1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===e1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.value=e}static empty(){return new ni({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lc(t)}setAll(e){let t=kn.emptyPath(),r={},a=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,r,a),r={},a=[],t=d.popLast()}c?r[d.lastSegment()]=Lc(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());Jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Jd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){pa(t,((a,l)=>e[a]=l));for(const a of r)delete e[a]}clone(){return new ni(Lc(this.value))}}function lb(n){const e=[];return pa(n.fields,((t,r)=>{const a=new kn([t]);if(Jd(r)){const l=lb(r.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new yi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,t,r,a,l,c,d){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new jn(e,0,We.min(),We.min(),We.min(),ni.empty(),0)}static newFoundDocument(e,t,r,a){return new jn(e,1,t,We.min(),r,a,0)}static newNoDocument(e,t){return new jn(e,2,t,We.min(),We.min(),ni.empty(),0)}static newUnknownDocument(e,t){return new jn(e,3,t,We.min(),We.min(),ni.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(We.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ni.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ni.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,t){this.position=e,this.inclusive=t}}function zE(n,e,t){let r=0;for(let a=0;a<n.position.length;a++){const l=e[a],c=n.position[a];if(l.field.isKeyField()?r=Le.comparator(Le.fromName(c.referenceValue),t.key):r=fl(c,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function BE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,t="asc"){this.field=e,this.dir=t}}function i1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{}class yn extends cb{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new s1(e,t,r):t==="array-contains"?new l1(e,r):t==="in"?new c1(e,r):t==="not-in"?new u1(e,r):t==="array-contains-any"?new d1(e,r):new yn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new a1(e,r):new o1(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(fl(t,this.value)):t!==null&&la(this.value)===la(t)&&this.matchesComparison(fl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ge(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zi extends cb{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Zi(e,t)}matches(e){return ub(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ub(n){return n.op==="and"}function db(n){return r1(n)&&ub(n)}function r1(n){for(const e of n.filters)if(e instanceof Zi)return!1;return!0}function Hp(n){if(n instanceof yn)return n.field.canonicalString()+n.op.toString()+ml(n.value);if(db(n))return n.filters.map((e=>Hp(e))).join(",");{const e=n.filters.map((t=>Hp(t))).join(",");return`${n.op}(${e})`}}function hb(n,e){return n instanceof yn?(function(r,a){return a instanceof yn&&r.op===a.op&&r.field.isEqual(a.field)&&Tr(r.value,a.value)})(n,e):n instanceof Zi?(function(r,a){return a instanceof Zi&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((l,c,d)=>l&&hb(c,a.filters[d])),!0):!1})(n,e):void Ge(19439)}function fb(n){return n instanceof yn?(function(t){return`${t.field.canonicalString()} ${t.op} ${ml(t.value)}`})(n):n instanceof Zi?(function(t){return t.op.toString()+" {"+t.getFilters().map(fb).join(" ,")+"}"})(n):"Filter"}class s1 extends yn{constructor(e,t,r){super(e,t,r),this.key=Le.fromName(r.referenceValue)}matches(e){const t=Le.comparator(e.key,this.key);return this.matchesComparison(t)}}class a1 extends yn{constructor(e,t){super(e,"in",t),this.keys=mb("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class o1 extends yn{constructor(e,t){super(e,"not-in",t),this.keys=mb("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function mb(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>Le.fromName(r.referenceValue)))}class l1 extends yn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ng(t)&&Yc(t.arrayValue,this.value)}}class c1 extends yn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yc(this.value.arrayValue,t)}}class u1 extends yn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yc(this.value.arrayValue,t)}}class d1 extends yn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ng(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Yc(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e,t=null,r=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Pe=null}}function FE(n,e=null,t=[],r=[],a=null,l=null,c=null){return new h1(n,e,t,r,a,l,c)}function Og(n){const e=Xe(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Hp(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),Gh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>ml(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>ml(r))).join(",")),e.Pe=t}return e.Pe}function xg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!i1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!hb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!BE(n.startAt,e.startAt)&&BE(n.endAt,e.endAt)}function $p(n){return Le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,t=null,r=[],a=[],l=null,c="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function f1(n,e,t,r,a,l,c,d){return new ru(n,e,t,r,a,l,c,d)}function Dg(n){return new ru(n)}function GE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pb(n){return n.collectionGroup!==null}function Uc(n){const e=Xe(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new Sn(kn.comparator);return c.filters.forEach((h=>{h.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new ph(l,r))})),t.has(kn.keyField().canonicalString())||e.Te.push(new ph(kn.keyField(),r))}return e.Te}function gr(n){const e=Xe(n);return e.Ie||(e.Ie=m1(e,Uc(n))),e.Ie}function m1(n,e){if(n.limitType==="F")return FE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new ph(a.field,l)}));const t=n.endAt?new mh(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new mh(n.startAt.position,n.startAt.inclusive):null;return FE(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function qp(n,e){const t=n.filters.concat([e]);return new ru(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function gh(n,e,t){return new ru(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $h(n,e){return xg(gr(n),gr(e))&&n.limitType===e.limitType}function gb(n){return`${Og(gr(n))}|lt:${n.limitType}`}function Jo(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>fb(a))).join(", ")}]`),Gh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>ml(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>ml(a))).join(",")),`Target(${r})`})(gr(n))}; limitType=${n.limitType})`}function qh(n,e){return e.isFoundDocument()&&(function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):Le.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(n,e)&&(function(r,a){for(const l of Uc(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(r,a){return!(r.startAt&&!(function(c,d,h){const m=zE(c,d,h);return c.inclusive?m<=0:m<0})(r.startAt,Uc(r),a)||r.endAt&&!(function(c,d,h){const m=zE(c,d,h);return c.inclusive?m>=0:m>0})(r.endAt,Uc(r),a))})(n,e)}function p1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function yb(n){return(e,t)=>{let r=!1;for(const a of Uc(n)){const l=g1(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function g1(n,e,t){const r=n.field.isKeyField()?Le.comparator(e.key,t.key):(function(l,c,d){const h=c.data.field(l),m=d.data.field(l);return h!==null&&m!==null?fl(h,m):Ge(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ge(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){pa(this.inner,((t,r)=>{for(const[a,l]of r)e(a,l)}))}isEmpty(){return eb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1=new Jt(Le.comparator);function as(){return y1}const _b=new Jt(Le.comparator);function Nc(...n){let e=_b;for(const t of n)e=e.insert(t.key,t);return e}function vb(n){let e=_b;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ka(){return Vc()}function Eb(){return Vc()}function Vc(){return new so((n=>n.toString()),((n,e)=>n.isEqual(e)))}const _1=new Jt(Le.comparator),v1=new Sn(Le.comparator);function ft(...n){let e=v1;for(const t of n)e=e.add(t);return e}const E1=new Sn(at);function S1(){return E1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dh(e)?"-0":e}}function Sb(n){return{integerValue:""+n}}function wb(n,e){return WC(e)?Sb(e):kg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(){this._=void 0}}function w1(n,e,t){return n instanceof Kc?(function(a,l){const c={fields:{[ib]:{stringValue:nb},[sb]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Cg(l)&&(l=Hh(l)),l&&(c.fields[rb]=l),{mapValue:c}})(t,e):n instanceof Wc?Tb(n,e):n instanceof Qc?Ab(n,e):(function(a,l){const c=bb(a,l),d=HE(c)+HE(a.Ee);return Gp(c)&&Gp(a.Ee)?Sb(d):kg(a.serializer,d)})(n,e)}function b1(n,e,t){return n instanceof Wc?Tb(n,e):n instanceof Qc?Ab(n,e):t}function bb(n,e){return n instanceof Xc?(function(r){return Gp(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class Kc extends Yh{}class Wc extends Yh{constructor(e){super(),this.elements=e}}function Tb(n,e){const t=Rb(e);for(const r of n.elements)t.some((a=>Tr(a,r)))||t.push(r);return{arrayValue:{values:t}}}class Qc extends Yh{constructor(e){super(),this.elements=e}}function Ab(n,e){let t=Rb(e);for(const r of n.elements)t=t.filter((a=>!Tr(a,r)));return{arrayValue:{values:t}}}class Xc extends Yh{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function HE(n){return un(n.integerValue||n.doubleValue)}function Rb(n){return Ng(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,t){this.field=e,this.transform=t}}function T1(n,e){return n.field.isEqual(e.field)&&(function(r,a){return r instanceof Wc&&a instanceof Wc||r instanceof Qc&&a instanceof Qc?hl(r.elements,a.elements,Tr):r instanceof Xc&&a instanceof Xc?Tr(r.Ee,a.Ee):r instanceof Kc&&a instanceof Kc})(n.transform,e.transform)}class A1{constructor(e,t){this.version=e,this.transformResults=t}}class Qi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qi}static exists(e){return new Qi(void 0,e)}static updateTime(e){return new Qi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Kh{}function Pb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Nb(n.key,Qi.none()):new su(n.key,n.data,Qi.none());{const t=n.data,r=ni.empty();let a=new Sn(kn.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?r.delete(l):r.set(l,c),a=a.add(l)}return new ga(n.key,r,new yi(a.toArray()),Qi.none())}}function R1(n,e,t){n instanceof su?(function(a,l,c){const d=a.value.clone(),h=qE(a.fieldTransforms,l,c.transformResults);d.setAll(h),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):n instanceof ga?(function(a,l,c){if(!Zd(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=qE(a.fieldTransforms,l,c.transformResults),h=l.data;h.setAll(Cb(a)),h.setAll(d),l.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function jc(n,e,t,r){return n instanceof su?(function(l,c,d,h){if(!Zd(l.precondition,c))return d;const m=l.value.clone(),g=YE(l.fieldTransforms,h,c);return m.setAll(g),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,r):n instanceof ga?(function(l,c,d,h){if(!Zd(l.precondition,c))return d;const m=YE(l.fieldTransforms,h,c),g=c.data;return g.setAll(Cb(l)),g.setAll(m),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((_=>_.field)))})(n,e,t,r):(function(l,c,d){return Zd(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(n,e,t)}function I1(n,e){let t=null;for(const r of n.fieldTransforms){const a=e.data.field(r.field),l=bb(r.transform,a||null);l!=null&&(t===null&&(t=ni.empty()),t.set(r.field,l))}return t||null}function $E(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&hl(r,a,((l,c)=>T1(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class su extends Kh{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ga extends Kh{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Cb(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function qE(n,e,t){const r=new Map;Nt(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],c=l.transform,d=e.data.field(l.field);r.set(l.field,b1(c,d,t[a]))}return r}function YE(n,e,t){const r=new Map;for(const a of n){const l=a.transform,c=t.data.field(a.field);r.set(a.field,w1(l,c,e))}return r}class Nb extends Kh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class P1 extends Kh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&R1(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=jc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=jc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Eb();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(a.key)?null:d;const h=Pb(c,d);h!==null&&r.set(a.key,h),c.isValidDocument()||c.convertToNoDocument(We.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ft())}isEqual(e){return this.batchId===e.batchId&&hl(this.mutations,e.mutations,((t,r)=>$E(t,r)))&&hl(this.baseMutations,e.baseMutations,((t,r)=>$E(t,r)))}}class Mg{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){Nt(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let a=(function(){return _1})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,r[c].version);return new Mg(e,t,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gn,_t;function x1(n){switch(n){case ce.OK:return Ge(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Ge(15467,{code:n})}}function Ob(n){if(n===void 0)return ss("GRPC error has no .code"),ce.UNKNOWN;switch(n){case gn.OK:return ce.OK;case gn.CANCELLED:return ce.CANCELLED;case gn.UNKNOWN:return ce.UNKNOWN;case gn.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case gn.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case gn.INTERNAL:return ce.INTERNAL;case gn.UNAVAILABLE:return ce.UNAVAILABLE;case gn.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case gn.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case gn.NOT_FOUND:return ce.NOT_FOUND;case gn.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case gn.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case gn.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case gn.ABORTED:return ce.ABORTED;case gn.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case gn.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case gn.DATA_LOSS:return ce.DATA_LOSS;default:return Ge(39323,{code:n})}}(_t=gn||(gn={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1=new ta([4294967295,4294967295],0);function KE(n){const e=Qw().encode(n),t=new Gw;return t.update(e),new Uint8Array(t.digest())}function WE(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ta([t,r],0),new ta([a,l],0)]}class Lg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Oc(`Invalid padding: ${t}`);if(r<0)throw new Oc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Oc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Oc(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ta.fromNumber(this.fe)}pe(e,t,r){let a=e.add(t.multiply(ta.fromNumber(r)));return a.compare(D1)===1&&(a=new ta([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=KE(e),[r,a]=WE(t);for(let l=0;l<this.hashCount;l++){const c=this.pe(r,a,l);if(!this.ye(c))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new Lg(l,a,t);return r.forEach((d=>c.insert(d))),c}insert(e){if(this.fe===0)return;const t=KE(e),[r,a]=WE(t);for(let l=0;l<this.hashCount;l++){const c=this.pe(r,a,l);this.we(c)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Oc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,au.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Wh(We.min(),a,new Jt(at),as(),ft())}}class au{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new au(r,t,ft(),ft(),ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,t,r,a){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=a}}class xb{constructor(e,t){this.targetId=e,this.De=t}}class Db{constructor(e,t,r=Mn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class QE{constructor(){this.ve=0,this.Ce=XE(),this.Fe=Mn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ft(),t=ft(),r=ft();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:Ge(38017,{changeType:l})}})),new au(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=XE()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Nt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class k1{constructor(e){this.We=e,this.Ge=new Map,this.ze=as(),this.je=Bd(),this.Je=Bd(),this.He=new Jt(at)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:Ge(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((r,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,r=e.De.count,a=this.st(t);if(a){const l=a.target;if($p(l))if(r===0){const c=new Le(l.path);this.Xe(t,c,jn.newNoDocument(c,We.min()))}else Nt(r===1,20013,{expectedCount:r});else{const c=this.ot(t);if(c!==r){const d=this._t(e),h=d?this.ut(d,e,c):1;if(h!==0){this.rt(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,m)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let c,d;try{c=oa(r).toUint8Array()}catch(h){if(h instanceof tb)return Ja("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{d=new Lg(c,a,l)}catch(h){return Ja(h instanceof Oc?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return d.fe===0?null:d}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let a=0;return r.forEach((l=>{const c=this.We.lt(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,c)=>{const d=this.st(c);if(d){if(l.current&&$p(d.target)){const h=new Le(d.target.path);this.Tt(h).has(c)||this.It(c,h)||this.Xe(c,h,jn.newNoDocument(h,e))}l.Ne&&(t.set(c,l.Le()),l.ke())}}));let r=ft();this.Je.forEach(((l,c)=>{let d=!0;c.forEachWhile((h=>{const m=this.st(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(l))})),this.ze.forEach(((l,c)=>c.setReadTime(e)));const a=new Wh(e,t,this.He,this.ze,r);return this.ze=as(),this.je=Bd(),this.Je=Bd(),this.He=new Jt(at),a}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new QE,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Sn(at),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Sn(at),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Ce("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new QE),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Bd(){return new Jt(Le.comparator)}function XE(){return new Jt(Le.comparator)}const M1={asc:"ASCENDING",desc:"DESCENDING"},L1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},U1={and:"AND",or:"OR"};class V1{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Yp(n,e){return n.useProto3Json||Gh(e)?e:{value:e}}function yh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function j1(n,e){return yh(n,e.toTimestamp())}function yr(n){return Nt(!!n,49232),We.fromTimestamp((function(t){const r=aa(t);return new kt(r.seconds,r.nanos)})(n))}function Ug(n,e){return Kp(n,e).canonicalString()}function Kp(n,e){const t=(function(a){return new Gt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Mb(n){const e=Gt.fromString(n);return Nt(zb(e),10190,{key:e.toString()}),e}function Wp(n,e){return Ug(n.databaseId,e.path)}function wp(n,e){const t=Mb(e);if(t.get(1)!==n.databaseId.projectId)throw new Ae(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ae(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Le(Ub(t))}function Lb(n,e){return Ug(n.databaseId,e)}function z1(n){const e=Mb(n);return e.length===4?Gt.emptyPath():Ub(e)}function Qp(n){return new Gt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ub(n){return Nt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function JE(n,e,t){return{name:Wp(n,e),fields:t.value.mapValue.fields}}function B1(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ge(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,g){return m.useProto3Json?(Nt(g===void 0||typeof g=="string",58123),Mn.fromBase64String(g||"")):(Nt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Mn.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(m){const g=m.code===void 0?ce.UNKNOWN:Ob(m.code);return new Ae(g,m.message||"")})(c);t=new Db(r,a,l,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=wp(n,r.document.name),l=yr(r.document.updateTime),c=r.document.createTime?yr(r.document.createTime):We.min(),d=new ni({mapValue:{fields:r.document.fields}}),h=jn.newFoundDocument(a,l,c,d),m=r.targetIds||[],g=r.removedTargetIds||[];t=new eh(m,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=wp(n,r.document),l=r.readTime?yr(r.readTime):We.min(),c=jn.newNoDocument(a,l),d=r.removedTargetIds||[];t=new eh([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=wp(n,r.document),l=r.removedTargetIds||[];t=new eh([],l,a,null)}else{if(!("filter"in e))return Ge(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,c=new O1(a,l),d=r.targetId;t=new xb(d,c)}}return t}function F1(n,e){let t;if(e instanceof su)t={update:JE(n,e.key,e.value)};else if(e instanceof Nb)t={delete:Wp(n,e.key)};else if(e instanceof ga)t={update:JE(n,e.key,e.data),updateMask:X1(e.fieldMask)};else{if(!(e instanceof P1))return Ge(16599,{Rt:e.type});t={verify:Wp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,c){const d=c.transform;if(d instanceof Kc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Wc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Qc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Xc)return{fieldPath:c.field.canonicalString(),increment:d.Ee};throw Ge(20930,{transform:c.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:j1(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ge(27497)})(n,e.precondition)),t}function G1(n,e){return n&&n.length>0?(Nt(e!==void 0,14353),n.map((t=>(function(a,l){let c=a.updateTime?yr(a.updateTime):yr(l);return c.isEqual(We.min())&&(c=yr(l)),new A1(c,a.transformResults||[])})(t,e)))):[]}function H1(n,e){return{documents:[Lb(n,e.path)]}}function $1(n,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Lb(n,a);const l=(function(m){if(m.length!==0)return jb(Zi.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(m){if(m.length!==0)return m.map((g=>(function(v){return{field:Zo(v.field),direction:K1(v.dir)}})(g)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Yp(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{Vt:t,parent:a}}function q1(n){let e=z1(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){Nt(r===1,65062);const g=t.from[0];g.allDescendants?a=g.collectionId:e=e.child(g.collectionId)}let l=[];t.where&&(l=(function(_){const v=Vb(_);return v instanceof Zi&&db(v)?v.getFilters():[v]})(t.where));let c=[];t.orderBy&&(c=(function(_){return _.map((v=>(function(I){return new ph(el(I.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(v)))})(t.orderBy));let d=null;t.limit&&(d=(function(_){let v;return v=typeof _=="object"?_.value:_,Gh(v)?null:v})(t.limit));let h=null;t.startAt&&(h=(function(_){const v=!!_.before,T=_.values||[];return new mh(T,v)})(t.startAt));let m=null;return t.endAt&&(m=(function(_){const v=!_.before,T=_.values||[];return new mh(T,v)})(t.endAt)),f1(e,a,c,l,d,"F",h,m)}function Y1(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ge(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Vb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=el(t.unaryFilter.field);return yn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=el(t.unaryFilter.field);return yn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=el(t.unaryFilter.field);return yn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=el(t.unaryFilter.field);return yn.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ge(61313);default:return Ge(60726)}})(n):n.fieldFilter!==void 0?(function(t){return yn.create(el(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ge(58110);default:return Ge(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Zi.create(t.compositeFilter.filters.map((r=>Vb(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ge(1026)}})(t.compositeFilter.op))})(n):Ge(30097,{filter:n})}function K1(n){return M1[n]}function W1(n){return L1[n]}function Q1(n){return U1[n]}function Zo(n){return{fieldPath:n.canonicalString()}}function el(n){return kn.fromServerFormat(n.fieldPath)}function jb(n){return n instanceof yn?(function(t){if(t.op==="=="){if(jE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NAN"}};if(VE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NAN"}};if(VE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zo(t.field),op:W1(t.op),value:t.value}}})(n):n instanceof Zi?(function(t){const r=t.getFilters().map((a=>jb(a)));return r.length===1?r[0]:{compositeFilter:{op:Q1(t.op),filters:r}}})(n):Ge(54877,{filter:n})}function X1(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function zb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,t,r,a,l=We.min(),c=We.min(),d=Mn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new Js(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e){this.gt=e}}function Z1(n){const e=q1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?gh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(){this.Dn=new tN}addToCollectionParentIndex(e,t){return this.Dn.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}deleteAllFieldIndexes(e){return fe.resolve()}createTargetIndexes(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t){return fe.resolve(null)}getIndexType(e,t){return fe.resolve(0)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}getMinOffset(e,t){return fe.resolve(sa.min())}getMinOffsetFromCollectionGroup(e,t){return fe.resolve(sa.min())}updateCollectionGroup(e,t,r){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class tN{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new Sn(Gt.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new Sn(Gt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bb=41943040;class ti{static withCacheSize(e){return new ti(e,ti.DEFAULT_COLLECTION_PERCENTILE,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ti.DEFAULT_COLLECTION_PERCENTILE=10,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ti.DEFAULT=new ti(Bb,ti.DEFAULT_COLLECTION_PERCENTILE,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ti.DISABLED=new ti(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new pl(0)}static ur(){return new pl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS="LruGarbageCollector",Fb=1048576;function tS([n,e],[t,r]){const a=at(n,t);return a===0?at(e,r):a}class nN{constructor(e){this.Tr=e,this.buffer=new Sn(tS),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();tS(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class iN{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Ce(eS,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){wl(t)?Ce(eS,"Ignoring IndexedDB error during garbage collection: ",t):await Sl(t)}await this.Rr(3e5)}))}}class rN{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return fe.resolve(Fh.ue);const r=new nN(t);return this.Vr.forEachTarget(e,(a=>r.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>r.Er(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(ZE)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZE):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,a,l,c,d,h,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),a=this.params.maximumSequenceNumbersToCollect):a=_,c=Date.now(),this.nthSequenceNumber(e,a)))).next((_=>(r=_,d=Date.now(),this.removeTargets(e,r,t)))).next((_=>(l=_,h=Date.now(),this.removeOrphanedDocuments(e,r)))).next((_=>(m=Date.now(),Xo()<=ht.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(h-d)+`ms
	Removed ${_} documents in `+(m-h)+`ms
Total Duration: ${m-g}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:_}))))}}function sN(n,e){return new rN(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(){this.changes=new so((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,jn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&jc(r.mutation,a,yi.empty(),kt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,ft()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=ft()){const a=Ka();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((l=>{let c=Nc();return l.forEach(((d,h)=>{c=c.insert(d,h.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const r=Ka();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,ft())))}populateOverlays(e,t,r){const a=[];return r.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,r,a){let l=as();const c=Vc(),d=(function(){return Vc()})();return t.forEach(((h,m)=>{const g=r.get(m.key);a.has(m.key)&&(g===void 0||g.mutation instanceof ga)?l=l.insert(m.key,m):g!==void 0?(c.set(m.key,g.mutation.getFieldMask()),jc(g.mutation,m,g.mutation.getFieldMask(),kt.now())):c.set(m.key,yi.empty())})),this.recalculateAndSaveOverlays(e,l).next((h=>(h.forEach(((m,g)=>c.set(m,g))),t.forEach(((m,g)=>{var _;return d.set(m,new oN(g,(_=c.get(m))!==null&&_!==void 0?_:null))})),d)))}recalculateAndSaveOverlays(e,t){const r=Vc();let a=new Jt(((c,d)=>c-d)),l=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((h=>{const m=t.get(h);if(m===null)return;let g=r.get(h)||yi.empty();g=d.applyToLocalView(m,g),r.set(h,g);const _=(a.get(d.batchId)||ft()).add(h);a=a.insert(d.batchId,_)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),m=h.key,g=h.value,_=Eb();g.forEach((v=>{if(!l.has(v)){const T=Pb(t.get(v),r.get(v));T!==null&&_.set(v,T),l=l.add(v)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,_))}return fe.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return(function(c){return Le.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):fe.resolve(Ka());let d=Hc,h=l;return c.next((m=>fe.forEach(m,((g,_)=>(d<_.largestBatchId&&(d=_.largestBatchId),l.get(g)?fe.resolve():this.remoteDocumentCache.getEntry(e,g).next((v=>{h=h.insert(g,v)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,h,m,ft()))).next((g=>({batchId:d,changes:vb(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Le(t)).next((r=>{let a=Nc();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let c=Nc();return this.indexManager.getCollectionParents(e,l).next((d=>fe.forEach(d,(h=>{const m=(function(_,v){return new ru(v,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,h.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,r,a).next((g=>{g.forEach(((_,v)=>{c=c.insert(_,v)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a)))).next((c=>{l.forEach(((h,m)=>{const g=m.getKey();c.get(g)===null&&(c=c.insert(g,jn.newInvalidDocument(g)))}));let d=Nc();return c.forEach(((h,m)=>{const g=l.get(h);g!==void 0&&jc(g.mutation,m,yi.empty(),kt.now()),qh(t,m)&&(d=d.insert(h,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return fe.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:yr(a.createTime)}})(t)),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:Z1(a.bundledQuery),readTime:yr(a.readTime)}})(t)),fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(){this.overlays=new Jt(Le.comparator),this.kr=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ka();return fe.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,l)=>{this.wt(e,t,l)})),fe.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.kr.get(r);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(r)),fe.resolve()}getOverlaysForCollection(e,t,r){const a=Ka(),l=t.length+1,c=new Le(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const h=d.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&h.largestBatchId>r&&a.set(h.getKey(),h)}return fe.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new Jt(((m,g)=>m-g));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let g=l.get(m.largestBatchId);g===null&&(g=Ka(),l=l.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const d=Ka(),h=l.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((m,g)=>d.set(m,g))),!(d.size()>=a)););return fe.resolve(d)}wt(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const c=this.kr.get(a.largestBatchId).delete(r.key);this.kr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new N1(t,r));let l=this.kr.get(t);l===void 0&&(l=ft(),this.kr.set(t,l)),this.kr.set(t,l.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this.sessionToken=Mn.EMPTY_BYTE_STRING}getSessionToken(e){return fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(){this.qr=new Sn(Rn.Qr),this.$r=new Sn(Rn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new Rn(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new Rn(e,t))}Gr(e,t){e.forEach((r=>this.removeReference(r,t)))}zr(e){const t=new Le(new Gt([])),r=new Rn(t,e),a=new Rn(t,e+1),l=[];return this.$r.forEachInRange([r,a],(c=>{this.Wr(c),l.push(c.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Le(new Gt([])),r=new Rn(t,e),a=new Rn(t,e+1);let l=ft();return this.$r.forEachInRange([r,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new Rn(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Rn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Le.comparator(e.key,t.key)||at(e.Hr,t.Hr)}static Ur(e,t){return at(e.Hr,t.Hr)||Le.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Sn(Rn.Qr)}checkEmpty(e){return fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new C1(l,t,r,a);this.mutationQueue.push(c);for(const d of a)this.Yr=this.Yr.add(new Rn(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return fe.resolve(c)}lookupMutationBatch(e,t){return fe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.Xr(r),l=a<0?0:a;return fe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(this.mutationQueue.length===0?Pg:this.er-1)}getAllMutationBatches(e){return fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Rn(t,0),a=new Rn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([r,a],(c=>{const d=this.Zr(c.Hr);l.push(d)})),fe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Sn(at);return t.forEach((a=>{const l=new Rn(a,0),c=new Rn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,c],(d=>{r=r.add(d.Hr)}))})),fe.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;Le.isDocumentKey(l)||(l=l.child(""));const c=new Rn(new Le(l),0);let d=new Sn(at);return this.Yr.forEachWhile((h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===a&&(d=d.add(h.Hr)),!0)}),c),fe.resolve(this.ei(d))}ei(e){const t=[];return e.forEach((r=>{const a=this.Zr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Nt(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return fe.forEach(t.mutations,(a=>{const l=new Rn(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=r}))}rr(e){}containsKey(e,t){const r=new Rn(t,0),a=this.Yr.firstAfterOrEqual(r);return fe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,fe.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.ni=e,this.docs=(function(){return new Jt(Le.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,c=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return fe.resolve(r?r.document.mutableCopy():jn.newInvalidDocument(t))}getEntries(e,t){let r=as();return t.forEach((a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():jn.newInvalidDocument(a))})),fe.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=as();const c=t.path,d=new Le(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:m,value:{document:g}}=h.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||$C(HC(g),r)<=0||(a.has(g.key)||qh(t,g))&&(l=l.insert(g.key,g.mutableCopy()))}return fe.resolve(l)}getAllFromCollectionGroup(e,t,r,a){Ge(9500)}ri(e,t){return fe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new mN(this)}getSize(e){return fe.resolve(this.size)}}class mN extends aN{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(r)})),fe.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e){this.persistence=e,this.ii=new so((t=>Og(t)),xg),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.si=0,this.oi=new Vg,this.targetCount=0,this._i=pl.ar()}forEachTarget(e,t){return this.ii.forEach(((r,a)=>t(a))),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),fe.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new pl(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.hr(t),fe.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.ii.forEach(((c,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.ii.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),fe.waitFor(l).next((()=>a))}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return fe.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),fe.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),fe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return fe.resolve(r)}containsKey(e,t){return fe.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,t){this.ai={},this.overlays={},this.ui=new Fh(0),this.ci=!1,this.ci=!0,this.li=new dN,this.referenceDelegate=e(this),this.hi=new pN(this),this.indexManager=new eN,this.remoteDocumentCache=(function(a){return new fN(a)})((r=>this.referenceDelegate.Pi(r))),this.serializer=new J1(t),this.Ti=new cN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new hN(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){Ce("MemoryPersistence","Starting transaction:",e);const a=new gN(this.ui.next());return this.referenceDelegate.Ii(),r(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return fe.or(Object.values(this.ai).map((r=>()=>r.containsKey(e,t))))}}class gN extends YC{constructor(e){super(),this.currentSequenceNumber=e}}class jg{constructor(e){this.persistence=e,this.Ai=new Vg,this.Ri=null}static Vi(e){return new jg(e)}get mi(){if(this.Ri)return this.Ri;throw Ge(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),fe.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.mi,(r=>{const a=Le.fromPath(r);return this.fi(e,a).next((l=>{l||t.removeEntry(a,We.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return fe.or([()=>fe.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class _h{constructor(e,t){this.persistence=e,this.gi=new so((r=>QC(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=sN(this,t)}static Vi(e,t){return new _h(e,t)}Ii(){}di(e){return fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}gr(e,t){return fe.forEach(this.gi,((r,a)=>this.Sr(e,r,a).next((l=>l?fe.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(c=>this.Sr(e,c,t).next((d=>{d||(r++,l.removeEntry(c,We.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),fe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),fe.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),fe.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),fe.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Xd(e.data.value)),t}Sr(e,t,r){return fe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return fe.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=a}static Es(e,t){let r=ft(),a=ft();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new zg(e,t.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return fP()?8:KC(zn())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.ps(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ys(e,t,a,r).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new yN;return this.ws(e,t,c).next((d=>{if(l.result=d,this.Rs)return this.Ss(e,t,c,d.size)}))})).next((()=>l.result))}Ss(e,t,r,a){return r.documentReadCount<this.Vs?(Xo()<=ht.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",Jo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),fe.resolve()):(Xo()<=ht.DEBUG&&Ce("QueryEngine","Query:",Jo(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.fs*a?(Xo()<=ht.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",Jo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gr(t))):fe.resolve())}ps(e,t){if(GE(t))return fe.resolve(null);let r=gr(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=gh(t,null,"F"),r=gr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const c=ft(...l);return this.gs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,r).next((h=>{const m=this.bs(t,d);return this.Ds(t,m,c,h.readTime)?this.ps(e,gh(t,null,"F")):this.vs(e,m,t,h)}))))})))))}ys(e,t,r,a){return GE(t)||a.isEqual(We.min())?fe.resolve(null):this.gs.getDocuments(e,r).next((l=>{const c=this.bs(t,l);return this.Ds(t,c,r,a)?fe.resolve(null):(Xo()<=ht.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Jo(t)),this.vs(e,c,t,GC(a,Hc)).next((d=>d)))}))}bs(e,t){let r=new Sn(yb(e));return t.forEach(((a,l)=>{qh(e,l)&&(r=r.add(l))})),r}Ds(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,r){return Xo()<=ht.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",Jo(t)),this.gs.getDocumentsMatchingQuery(e,t,sa.min(),r)}vs(e,t,r,a){return this.gs.getDocumentsMatchingQuery(e,r,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg="LocalStore",vN=3e8;class EN{constructor(e,t,r,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Jt(at),this.Ms=new so((l=>Og(l)),xg),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lN(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function SN(n,e,t,r){return new EN(n,e,t,r)}async function Hb(n,e){const t=Xe(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const c=[],d=[];let h=ft();for(const m of a){c.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}for(const m of l){d.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}return t.localDocuments.getDocuments(r,h).next((m=>({Bs:m,removedBatchIds:c,addedBatchIds:d})))}))}))}function wN(n,e){const t=Xe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(d,h,m,g){const _=m.batch,v=_.keys();let T=fe.resolve();return v.forEach((I=>{T=T.next((()=>g.getEntry(h,I))).next((A=>{const C=m.docVersions.get(I);Nt(C!==null,48541),A.version.compareTo(C)<0&&(_.applyToRemoteDocument(A,m),A.isValidDocument()&&(A.setReadTime(m.commitVersion),g.addEntry(A)))}))})),T.next((()=>d.mutationQueue.removeMutationBatch(h,_)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let h=ft();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(h=h.add(d.batch.mutations[m].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function $b(n){const e=Xe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function bN(n,e){const t=Xe(n),r=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const d=[];e.targetChanges.forEach(((g,_)=>{const v=a.get(_);if(!v)return;d.push(t.hi.removeMatchingKeys(l,g.removedDocuments,_).next((()=>t.hi.addMatchingKeys(l,g.addedDocuments,_))));let T=v.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(_)!==null?T=T.withResumeToken(Mn.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,r)),a=a.insert(_,T),(function(A,C,L){return A.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=vN?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(v,T,g)&&d.push(t.hi.updateTargetData(l,T))}));let h=as(),m=ft();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,g))})),d.push(TN(l,c,e.documentUpdates).next((g=>{h=g.Ls,m=g.ks}))),!r.isEqual(We.min())){const g=t.hi.getLastRemoteSnapshotVersion(l).next((_=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,r)));d.push(g)}return fe.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,h,m))).next((()=>h))})).then((l=>(t.Fs=a,l)))}function TN(n,e,t){let r=ft(),a=ft();return t.forEach((l=>r=r.add(l))),e.getEntries(n,r).next((l=>{let c=as();return t.forEach(((d,h)=>{const m=l.get(d);h.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(d)),h.isNoDocument()&&h.version.isEqual(We.min())?(e.removeEntry(d,h.readTime),c=c.insert(d,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),c=c.insert(d,h)):Ce(Bg,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",h.version)})),{Ls:c,ks:a}}))}function AN(n,e){const t=Xe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Pg),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function RN(n,e){const t=Xe(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.hi.getTargetData(r,e).next((l=>l?(a=l,fe.resolve(a)):t.hi.allocateTargetId(r).next((c=>(a=new Js(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.Fs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r}))}async function Xp(n,e,t){const r=Xe(n),a=r.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(c=>r.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!wl(c))throw c;Ce(Bg,`Failed to update sequence numbers for target ${e}: ${c}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(a.target)}function nS(n,e,t){const r=Xe(n);let a=We.min(),l=ft();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(h,m,g){const _=Xe(h),v=_.Ms.get(g);return v!==void 0?fe.resolve(_.Fs.get(v)):_.hi.getTargetData(m,g)})(r,c,gr(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(c,d.targetId).next((h=>{l=h}))})).next((()=>r.Cs.getDocumentsMatchingQuery(c,e,t?a:We.min(),t?l:ft()))).next((d=>(IN(r,p1(e),d),{documents:d,qs:l})))))}function IN(n,e,t){let r=n.xs.get(e)||We.min();t.forEach(((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),n.xs.set(e,r)}class iS{constructor(){this.activeTargetIds=S1()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class PN{constructor(){this.Fo=new iS,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new iS,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS="ConnectivityMonitor";class sS{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ce(rS,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ce(rS,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fd=null;function Jp(){return Fd===null?Fd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fd++,"0x"+Fd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp="RestConnection",NN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ON{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${a}`,this.Ko=this.databaseId.database===hh?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Wo(e,t,r,a,l){const c=Jp(),d=this.Go(e,t.toUriEncodedString());Ce(bp,`Sending RPC '${e}' ${c}:`,d,r);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,a,l);const{host:m}=new URL(d),g=io(m);return this.jo(e,d,h,r,g).then((_=>(Ce(bp,`Received RPC '${e}' ${c}: `,_),_)),(_=>{throw Ja(bp,`RPC '${e}' ${c} failed with error: `,_,"url: ",d,"request:",r),_}))}Jo(e,t,r,a,l,c){return this.Wo(e,t,r,a,l)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+El})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),r&&r.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const r=NN[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="WebChannelConnection";class DN extends ON{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,a,l){const c=Jp();return new Promise(((d,h)=>{const m=new Hw;m.setWithCredentials(!0),m.listenOnce($w.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Qd.NO_ERROR:const _=m.getResponseJson();Ce(Vn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(_)),d(_);break;case Qd.TIMEOUT:Ce(Vn,`RPC '${e}' ${c} timed out`),h(new Ae(ce.DEADLINE_EXCEEDED,"Request time out"));break;case Qd.HTTP_ERROR:const v=m.getStatus();if(Ce(Vn,`RPC '${e}' ${c} failed with status:`,v,"response text:",m.getResponseText()),v>0){let T=m.getResponseJson();Array.isArray(T)&&(T=T[0]);const I=T==null?void 0:T.error;if(I&&I.status&&I.message){const A=(function(L){const x=L.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(x)>=0?x:ce.UNKNOWN})(I.status);h(new Ae(A,I.message))}else h(new Ae(ce.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new Ae(ce.UNAVAILABLE,"Connection failed."));break;default:Ge(9055,{c_:e,streamId:c,l_:m.getLastErrorCode(),h_:m.getLastError()})}}finally{Ce(Vn,`RPC '${e}' ${c} completed.`)}}));const g=JSON.stringify(a);Ce(Vn,`RPC '${e}' ${c} sending request:`,a),m.send(t,"POST",g,r,15)}))}P_(e,t,r){const a=Jp(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Kw(),d=Yw(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=l.join("");Ce(Vn,`Creating RPC '${e}' stream ${a}: ${g}`,h);const _=c.createWebChannel(g,h);this.T_(_);let v=!1,T=!1;const I=new xN({Ho:C=>{T?Ce(Vn,`Not sending because RPC '${e}' stream ${a} is closed:`,C):(v||(Ce(Vn,`Opening RPC '${e}' stream ${a} transport.`),_.open(),v=!0),Ce(Vn,`RPC '${e}' stream ${a} sending:`,C),_.send(C))},Yo:()=>_.close()}),A=(C,L,x)=>{C.listen(L,(U=>{try{x(U)}catch(z){setTimeout((()=>{throw z}),0)}}))};return A(_,Cc.EventType.OPEN,(()=>{T||(Ce(Vn,`RPC '${e}' stream ${a} transport opened.`),I.s_())})),A(_,Cc.EventType.CLOSE,(()=>{T||(T=!0,Ce(Vn,`RPC '${e}' stream ${a} transport closed`),I.__(),this.I_(_))})),A(_,Cc.EventType.ERROR,(C=>{T||(T=!0,Ja(Vn,`RPC '${e}' stream ${a} transport errored. Name:`,C.name,"Message:",C.message),I.__(new Ae(ce.UNAVAILABLE,"The operation could not be completed")))})),A(_,Cc.EventType.MESSAGE,(C=>{var L;if(!T){const x=C.data[0];Nt(!!x,16349);const U=x,z=(U==null?void 0:U.error)||((L=U[0])===null||L===void 0?void 0:L.error);if(z){Ce(Vn,`RPC '${e}' stream ${a} received error:`,z);const $=z.status;let se=(function(N){const M=gn[N];if(M!==void 0)return Ob(M)})($),D=z.message;se===void 0&&(se=ce.INTERNAL,D="Unknown error status: "+$+" with message "+z.message),T=!0,I.__(new Ae(se,D)),_.close()}else Ce(Vn,`RPC '${e}' stream ${a} received:`,x),I.a_(x)}})),A(d,qw.STAT_EVENT,(C=>{C.stat===zp.PROXY?Ce(Vn,`RPC '${e}' stream ${a} detected buffering proxy`):C.stat===zp.NOPROXY&&Ce(Vn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{I.o_()}),0),I}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function Tp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(n){return new V1(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-r);a>0&&Ce("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS="PersistentStream";class Yb{constructor(e,t,r,a,l,c,d,h){this.Fi=e,this.w_=r,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new qb(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(ss(t.toString()),ss("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.b_===t&&this.W_(r,a)}),(r=>{e((()=>{const a=new Ae(ce.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(a)}))}))}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.e_((()=>{r((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{r((()=>this.G_(a)))})),this.stream.onMessage((a=>{r((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Ce(aS,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Ce(aS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class kN extends Yb{constructor(e,t,r,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=B1(this.serializer,e),r=(function(l){if(!("targetChange"in l))return We.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?We.min():c.readTime?yr(c.readTime):We.min()})(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=Qp(this.serializer),t.addTarget=(function(l,c){let d;const h=c.target;if(d=$p(h)?{documents:H1(l,h)}:{query:$1(l,h).Vt},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=kb(l,c.resumeToken);const m=Yp(l,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(We.min())>0){d.readTime=yh(l,c.snapshotVersion.toTimestamp());const m=Yp(l,c.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const r=Y1(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=Qp(this.serializer),t.removeTarget=e,this.k_(t)}}class MN extends Yb{constructor(e,t,r,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Nt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Nt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Nt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=G1(e.writeResults,e.commitTime),r=yr(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=Qp(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>F1(this.serializer,r)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{}class UN extends LN{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Ae(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,Kp(t,r),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ae(ce.UNKNOWN,l.toString())}))}Jo(e,t,r,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Jo(e,Kp(t,r),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ae(ce.UNKNOWN,c.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class VN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ss(t),this._a=!1):Ce("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za="RemoteStore";class jN{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((c=>{r.enqueueAndForget((async()=>{ao(this)&&(Ce(Za,"Restarting streams for network reachability change."),await(async function(h){const m=Xe(h);m.Ia.add(4),await ou(m),m.Aa.set("Unknown"),m.Ia.delete(4),await Xh(m)})(this))}))})),this.Aa=new VN(r,a)}}async function Xh(n){if(ao(n))for(const e of n.da)await e(!0)}async function ou(n){for(const e of n.da)await e(!1)}function Kb(n,e){const t=Xe(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),$g(t)?Hg(t):bl(t).x_()&&Gg(t,e))}function Fg(n,e){const t=Xe(n),r=bl(t);t.Ta.delete(e),r.x_()&&Wb(t,e),t.Ta.size===0&&(r.x_()?r.B_():ao(t)&&t.Aa.set("Unknown"))}function Gg(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}bl(n).H_(e)}function Wb(n,e){n.Ra.$e(e),bl(n).Y_(e)}function Hg(n){n.Ra=new k1({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),bl(n).start(),n.Aa.aa()}function $g(n){return ao(n)&&!bl(n).M_()&&n.Ta.size>0}function ao(n){return Xe(n).Ia.size===0}function Qb(n){n.Ra=void 0}async function zN(n){n.Aa.set("Online")}async function BN(n){n.Ta.forEach(((e,t)=>{Gg(n,e)}))}async function FN(n,e){Qb(n),$g(n)?(n.Aa.la(e),Hg(n)):n.Aa.set("Unknown")}async function GN(n,e,t){if(n.Aa.set("Online"),e instanceof Db&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ta.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ta.delete(d),a.Ra.removeTarget(d))})(n,e)}catch(r){Ce(Za,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await vh(n,r)}else if(e instanceof eh?n.Ra.Ye(e):e instanceof xb?n.Ra.it(e):n.Ra.et(e),!t.isEqual(We.min()))try{const r=await $b(n.localStore);t.compareTo(r)>=0&&await(function(l,c){const d=l.Ra.Pt(c);return d.targetChanges.forEach(((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const g=l.Ta.get(m);g&&l.Ta.set(m,g.withResumeToken(h.resumeToken,c))}})),d.targetMismatches.forEach(((h,m)=>{const g=l.Ta.get(h);if(!g)return;l.Ta.set(h,g.withResumeToken(Mn.EMPTY_BYTE_STRING,g.snapshotVersion)),Wb(l,h);const _=new Js(g.target,h,m,g.sequenceNumber);Gg(l,_)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){Ce(Za,"Failed to raise snapshot:",r),await vh(n,r)}}async function vh(n,e,t){if(!wl(e))throw e;n.Ia.add(1),await ou(n),n.Aa.set("Offline"),t||(t=()=>$b(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ce(Za,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Xh(n)}))}function Xb(n,e){return e().catch((t=>vh(n,t,e)))}async function Jh(n){const e=Xe(n),t=ca(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Pg;for(;HN(e);)try{const a=await AN(e.localStore,r);if(a===null){e.Pa.length===0&&t.B_();break}r=a.batchId,$N(e,a)}catch(a){await vh(e,a)}Jb(e)&&Zb(e)}function HN(n){return ao(n)&&n.Pa.length<10}function $N(n,e){n.Pa.push(e);const t=ca(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Jb(n){return ao(n)&&!ca(n).M_()&&n.Pa.length>0}function Zb(n){ca(n).start()}async function qN(n){ca(n).na()}async function YN(n){const e=ca(n);for(const t of n.Pa)e.X_(t.mutations)}async function KN(n,e,t){const r=n.Pa.shift(),a=Mg.from(r,e,t);await Xb(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await Jh(n)}async function WN(n,e){e&&ca(n).Z_&&await(async function(r,a){if((function(c){return x1(c)&&c!==ce.ABORTED})(a.code)){const l=r.Pa.shift();ca(r).N_(),await Xb(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Jh(r)}})(n,e),Jb(n)&&Zb(n)}async function oS(n,e){const t=Xe(n);t.asyncQueue.verifyOperationInProgress(),Ce(Za,"RemoteStore received new credentials");const r=ao(t);t.Ia.add(3),await ou(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Xh(t)}async function QN(n,e){const t=Xe(n);e?(t.Ia.delete(2),await Xh(t)):e||(t.Ia.add(2),await ou(t),t.Aa.set("Unknown"))}function bl(n){return n.Va||(n.Va=(function(t,r,a){const l=Xe(t);return l.ia(),new kN(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:zN.bind(null,n),e_:BN.bind(null,n),n_:FN.bind(null,n),J_:GN.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),$g(n)?Hg(n):n.Aa.set("Unknown")):(await n.Va.stop(),Qb(n))}))),n.Va}function ca(n){return n.ma||(n.ma=(function(t,r,a){const l=Xe(t);return l.ia(),new MN(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:qN.bind(null,n),n_:WN.bind(null,n),ea:YN.bind(null,n),ta:KN.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await Jh(n)):(await n.ma.stop(),n.Pa.length>0&&(Ce(Za,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const c=Date.now()+r,d=new qg(e,t,c,a,l);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yg(n,e){if(ss("AsyncQueue",`${e}: ${n}`),wl(n))return new Ae(ce.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{static emptySet(e){return new al(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Le.comparator(t.key,r.key):(t,r)=>Le.comparator(t.key,r.key),this.keyedMap=Nc(),this.sortedSet=new Jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof al)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new al;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(){this.fa=new Jt(Le.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Ge(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,r)=>{e.push(r)})),e}}class gl{constructor(e,t,r,a,l,c,d,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,a,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new gl(e,t,al.emptySet(t),c,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$h(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class JN{constructor(){this.queries=cS(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const a=Xe(t),l=a.queries;a.queries=cS(),l.forEach(((c,d)=>{for(const h of d.wa)h.onError(r)}))})(this,new Ae(ce.ABORTED,"Firestore shutting down"))}}function cS(){return new so((n=>gb(n)),$h)}async function eT(n,e){const t=Xe(n);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(r=2):(l=new XN,r=e.ba()?0:1);try{switch(r){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const d=Yg(c,`Initialization of query '${Jo(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Kg(t)}async function tT(n,e){const t=Xe(n),r=e.query;let a=3;const l=t.queries.get(r);if(l){const c=l.wa.indexOf(e);c>=0&&(l.wa.splice(c,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function ZN(n,e){const t=Xe(n);let r=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const d of c.wa)d.Ca(a)&&(r=!0);c.ya=a}}r&&Kg(t)}function eO(n,e,t){const r=Xe(n),a=r.queries.get(e);if(a)for(const l of a.wa)l.onError(t);r.queries.delete(e)}function Kg(n){n.Da.forEach((e=>{e.next()}))}var Zp,uS;(uS=Zp||(Zp={})).Fa="default",uS.Cache="cache";class nT{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new gl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=gl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Zp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e){this.key=e}}class rT{constructor(e){this.key=e}}class tO{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ft(),this.mutatedKeys=ft(),this.Xa=yb(e),this.eu=new al(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new lS,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,d=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((g,_)=>{const v=a.get(g),T=qh(this.query,_)?_:null,I=!!v&&this.mutatedKeys.has(v.key),A=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let C=!1;v&&T?v.data.isEqual(T.data)?I!==A&&(r.track({type:3,doc:T}),C=!0):this.iu(v,T)||(r.track({type:2,doc:T}),C=!0,(h&&this.Xa(T,h)>0||m&&this.Xa(T,m)<0)&&(d=!0)):!v&&T?(r.track({type:0,doc:T}),C=!0):v&&!T&&(r.track({type:1,doc:v}),C=!0,(h||m)&&(d=!0)),C&&(T?(c=c.add(T),l=A?l.add(g):l.delete(g)):(c=c.delete(g),l=l.delete(g)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),l=l.delete(g.key),r.track({type:1,doc:g})}return{eu:c,ru:r,Ds:d,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const c=e.ru.pa();c.sort(((g,_)=>(function(T,I){const A=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ge(20277,{At:C})}};return A(T)-A(I)})(g.type,_.type)||this.Xa(g.doc,_.doc))),this.su(r),a=a!=null&&a;const d=t&&!a?this.ou():[],h=this.Za.size===0&&this.current&&!a?1:0,m=h!==this.Ya;return this.Ya=h,c.length!==0||m?{snapshot:new gl(this.query,e.eu,l,c,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:d}:{_u:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new lS,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ft(),this.eu.forEach((r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))}));const t=[];return e.forEach((r=>{this.Za.has(r)||t.push(new rT(r))})),this.Za.forEach((r=>{e.has(r)||t.push(new iT(r))})),t}uu(e){this.Ha=e.qs,this.Za=ft();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return gl.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Wg="SyncEngine";class nO{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class iO{constructor(e){this.key=e,this.lu=!1}}class rO{constructor(e,t,r,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new so((d=>gb(d)),$h),this.Tu=new Map,this.Iu=new Set,this.du=new Jt(Le.comparator),this.Eu=new Map,this.Au=new Vg,this.Ru={},this.Vu=new Map,this.mu=pl.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function sO(n,e,t=!0){const r=uT(n);let a;const l=r.Pu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await sT(r,e,t,!0),a}async function aO(n,e){const t=uT(n);await sT(t,e,!0,!1)}async function sT(n,e,t,r){const a=await RN(n.localStore,gr(e)),l=a.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let d;return r&&(d=await oO(n,e,l,c==="current",a.resumeToken)),n.isPrimaryClient&&t&&Kb(n.remoteStore,a),d}async function oO(n,e,t,r,a){n.gu=(_,v,T)=>(async function(A,C,L,x){let U=C.view.nu(L);U.Ds&&(U=await nS(A.localStore,C.query,!1).then((({documents:D})=>C.view.nu(D,U))));const z=x&&x.targetChanges.get(C.targetId),$=x&&x.targetMismatches.get(C.targetId)!=null,se=C.view.applyChanges(U,A.isPrimaryClient,z,$);return hS(A,C.targetId,se._u),se.snapshot})(n,_,v,T);const l=await nS(n.localStore,e,!0),c=new tO(e,l.qs),d=c.nu(l.documents),h=au.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",a),m=c.applyChanges(d,n.isPrimaryClient,h);hS(n,t,m._u);const g=new nO(e,t,c);return n.Pu.set(e,g),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),m.snapshot}async function lO(n,e,t){const r=Xe(n),a=r.Pu.get(e),l=r.Tu.get(a.targetId);if(l.length>1)return r.Tu.set(a.targetId,l.filter((c=>!$h(c,e)))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Xp(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&Fg(r.remoteStore,a.targetId),eg(r,a.targetId)})).catch(Sl)):(eg(r,a.targetId),await Xp(r.localStore,a.targetId,!0))}async function cO(n,e){const t=Xe(n),r=t.Pu.get(e),a=t.Tu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Fg(t.remoteStore,r.targetId))}async function uO(n,e,t){const r=yO(n);try{const a=await(function(c,d){const h=Xe(c),m=kt.now(),g=d.reduce(((T,I)=>T.add(I.key)),ft());let _,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let I=as(),A=ft();return h.Os.getEntries(T,g).next((C=>{I=C,I.forEach(((L,x)=>{x.isValidDocument()||(A=A.add(L))}))})).next((()=>h.localDocuments.getOverlayedDocuments(T,I))).next((C=>{_=C;const L=[];for(const x of d){const U=I1(x,_.get(x.key).overlayedDocument);U!=null&&L.push(new ga(x.key,U,lb(U.value.mapValue),Qi.exists(!0)))}return h.mutationQueue.addMutationBatch(T,m,L,d)})).next((C=>{v=C;const L=C.applyToLocalDocumentSet(_,A);return h.documentOverlayCache.saveOverlays(T,C.batchId,L)}))})).then((()=>({batchId:v.batchId,changes:vb(_)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(c,d,h){let m=c.Ru[c.currentUser.toKey()];m||(m=new Jt(at)),m=m.insert(d,h),c.Ru[c.currentUser.toKey()]=m})(r,a.batchId,t),await lu(r,a.changes),await Jh(r.remoteStore)}catch(a){const l=Yg(a,"Failed to persist write");t.reject(l)}}async function aT(n,e){const t=Xe(n);try{const r=await bN(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Eu.get(l);c&&(Nt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.lu=!0:a.modifiedDocuments.size>0?Nt(c.lu,14607):a.removedDocuments.size>0&&(Nt(c.lu,42227),c.lu=!1))})),await lu(t,r,e)}catch(r){await Sl(r)}}function dS(n,e,t){const r=Xe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Pu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const h=Xe(c);h.onlineState=d;let m=!1;h.queries.forEach(((g,_)=>{for(const v of _.wa)v.va(d)&&(m=!0)})),m&&Kg(h)})(r.eventManager,e),a.length&&r.hu.J_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function dO(n,e,t){const r=Xe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Eu.get(e),l=a&&a.key;if(l){let c=new Jt(Le.comparator);c=c.insert(l,jn.newNoDocument(l,We.min()));const d=ft().add(l),h=new Wh(We.min(),new Map,new Jt(at),c,d);await aT(r,h),r.du=r.du.remove(l),r.Eu.delete(e),Qg(r)}else await Xp(r.localStore,e,!1).then((()=>eg(r,e,t))).catch(Sl)}async function hO(n,e){const t=Xe(n),r=e.batch.batchId;try{const a=await wN(t.localStore,e);lT(t,r,null),oT(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await lu(t,a)}catch(a){await Sl(a)}}async function fO(n,e,t){const r=Xe(n);try{const a=await(function(c,d){const h=Xe(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let g;return h.mutationQueue.lookupMutationBatch(m,d).next((_=>(Nt(_!==null,37113),g=_.keys(),h.mutationQueue.removeMutationBatch(m,_)))).next((()=>h.mutationQueue.performConsistencyCheck(m))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(m,g,d))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g))).next((()=>h.localDocuments.getDocuments(m,g)))}))})(r.localStore,e);lT(r,e,t),oT(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await lu(r,a)}catch(a){await Sl(a)}}function oT(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function lT(n,e,t){const r=Xe(n);let a=r.Ru[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.Ru[r.currentUser.toKey()]=a}}function eg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((r=>{n.Au.containsKey(r)||cT(n,r)}))}function cT(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Fg(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Qg(n))}function hS(n,e,t){for(const r of t)r instanceof iT?(n.Au.addReference(r.key,e),mO(n,r)):r instanceof rT?(Ce(Wg,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||cT(n,r.key)):Ge(19791,{yu:r})}function mO(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(Ce(Wg,"New document in limbo: "+t),n.Iu.add(r),Qg(n))}function Qg(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Le(Gt.fromString(e)),r=n.mu.next();n.Eu.set(r,new iO(t)),n.du=n.du.insert(t,r),Kb(n.remoteStore,new Js(gr(Dg(t.path)),r,"TargetPurposeLimboResolution",Fh.ue))}}async function lu(n,e,t){const r=Xe(n),a=[],l=[],c=[];r.Pu.isEmpty()||(r.Pu.forEach(((d,h)=>{c.push(r.gu(h,e,t).then((m=>{var g;if((m||t)&&r.isPrimaryClient){const _=m?!m.fromCache:(g=t==null?void 0:t.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(m){a.push(m);const _=zg.Es(h.targetId,m);l.push(_)}})))})),await Promise.all(c),r.hu.J_(a),await(async function(h,m){const g=Xe(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>fe.forEach(m,(v=>fe.forEach(v.Is,(T=>g.persistence.referenceDelegate.addReference(_,v.targetId,T))).next((()=>fe.forEach(v.ds,(T=>g.persistence.referenceDelegate.removeReference(_,v.targetId,T)))))))))}catch(_){if(!wl(_))throw _;Ce(Bg,"Failed to update sequence numbers: "+_)}for(const _ of m){const v=_.targetId;if(!_.fromCache){const T=g.Fs.get(v),I=T.snapshotVersion,A=T.withLastLimboFreeSnapshotVersion(I);g.Fs=g.Fs.insert(v,A)}}})(r.localStore,l))}async function pO(n,e){const t=Xe(n);if(!t.currentUser.isEqual(e)){Ce(Wg,"User change. New user:",e.toKey());const r=await Hb(t.localStore,e);t.currentUser=e,(function(l,c){l.Vu.forEach((d=>{d.forEach((h=>{h.reject(new Ae(ce.CANCELLED,c))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await lu(t,r.Bs)}}function gO(n,e){const t=Xe(n),r=t.Eu.get(e);if(r&&r.lu)return ft().add(r.key);{let a=ft();const l=t.Tu.get(e);if(!l)return a;for(const c of l){const d=t.Pu.get(c);a=a.unionWith(d.view.tu)}return a}}function uT(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=aT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dO.bind(null,e),e.hu.J_=ZN.bind(null,e.eventManager),e.hu.pu=eO.bind(null,e.eventManager),e}function yO(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fO.bind(null,e),e}class Eh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return SN(this.persistence,new _N,e.initialUser,this.serializer)}Du(e){return new Gb(jg.Vi,this.serializer)}bu(e){return new PN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Eh.provider={build:()=>new Eh};class _O extends Eh{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Nt(this.persistence.referenceDelegate instanceof _h,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new iN(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?ti.withCacheSize(this.cacheSizeBytes):ti.DEFAULT;return new Gb((r=>_h.Vi(r,t)),this.serializer)}}class tg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=pO.bind(null,this.syncEngine),await QN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new JN})()}createDatastore(e){const t=Qh(e.databaseInfo.databaseId),r=(function(l){return new DN(l)})(e.databaseInfo);return(function(l,c,d,h){return new UN(l,c,d,h)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,l,c,d){return new jN(r,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>dS(this.syncEngine,t,0)),(function(){return sS.C()?new sS:new CN})())}createSyncEngine(e,t){return(function(a,l,c,d,h,m,g){const _=new rO(a,l,c,d,h,m);return g&&(_.fu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Xe(a);Ce(Za,"RemoteStore shutting down."),l.Ia.add(5),await ou(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}tg.provider={build:()=>new tg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ss("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="FirestoreClient";class vO{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=ei.UNAUTHENTICATED,this.clientId=Ig.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async c=>{Ce(ua,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(Ce(ua,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Yg(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ap(n,e){n.asyncQueue.verifyOperationInProgress(),Ce(ua,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async a=>{r.isEqual(a)||(await Hb(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>{Ja("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Ce("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Ja("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function fS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await EO(n);Ce(ua,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>oS(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,a)=>oS(e.remoteStore,a))),n._onlineComponents=e}async function EO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ce(ua,"Using user provided OfflineComponentProvider");try{await Ap(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ce.FAILED_PRECONDITION||a.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Ja("Error using user provided cache. Falling back to memory cache: "+t),await Ap(n,new Eh)}}else Ce(ua,"Using default OfflineComponentProvider"),await Ap(n,new _O(void 0));return n._offlineComponents}async function hT(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ce(ua,"Using user provided OnlineComponentProvider"),await fS(n,n._uninitializedComponentsProvider._online)):(Ce(ua,"Using default OnlineComponentProvider"),await fS(n,new tg))),n._onlineComponents}function SO(n){return hT(n).then((e=>e.syncEngine))}async function fT(n){const e=await hT(n),t=e.eventManager;return t.onListen=sO.bind(null,e.syncEngine),t.onUnlisten=lO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cO.bind(null,e.syncEngine),t}function mT(n,e,t={}){const r=new is;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,h,m){const g=new dT({next:v=>{g.Ou(),c.enqueueAndForget((()=>tT(l,_)));const T=v.docs.has(d);!T&&v.fromCache?m.reject(new Ae(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&v.fromCache&&h&&h.source==="server"?m.reject(new Ae(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(v)},error:v=>m.reject(v)}),_=new nT(Dg(d.path),g,{includeMetadataChanges:!0,ka:!0});return eT(l,_)})(await fT(n),n.asyncQueue,e,t,r))),r.promise}function wO(n,e,t={}){const r=new is;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,h,m){const g=new dT({next:v=>{g.Ou(),c.enqueueAndForget((()=>tT(l,_))),v.fromCache&&h.source==="server"?m.reject(new Ae(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(v)},error:v=>m.reject(v)}),_=new nT(d,g,{includeMetadataChanges:!0,ka:!0});return eT(l,_)})(await fT(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO="firestore.googleapis.com",pS=!0;class gS{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bO,this.ssl=pS}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:pS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Bb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Fb)throw new Ae(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Ae(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Ae(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Ae(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xg{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new kC;switch(r.type){case"firstParty":return new UC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ae(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=mS.get(t);r&&(Ce("ComponentProvider","Removing Datastore"),mS.delete(t),r.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oo(this.firestore,e,this._query)}}class rn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new na(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rn(this.firestore,e,this._key)}toJSON(){return{type:rn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(iu(t,rn._jsonSchema))return new rn(e,r||null,new Le(Gt.fromString(t.referencePath)))}}rn._jsonSchemaVersion="firestore/documentReference/1.0",rn._jsonSchema={type:_n("string",rn._jsonSchemaVersion),referencePath:_n("string")};class na extends oo{constructor(e,t,r){super(e,t,Dg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rn(this.firestore,null,new Le(e))}withConverter(e){return new na(this.firestore,e,this._path)}}function Jg(n,e,...t){if(n=sn(n),Xw("collection","path",e),n instanceof Xg){const r=Gt.fromString(e,...t);return CE(r),new na(n,null,r)}{if(!(n instanceof rn||n instanceof na))throw new Ae(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Gt.fromString(e,...t));return CE(r),new na(n.firestore,null,r)}}function At(n,e,...t){if(n=sn(n),arguments.length===1&&(e=Ig.newId()),Xw("doc","path",e),n instanceof Xg){const r=Gt.fromString(e,...t);return PE(r),new rn(n,null,new Le(r))}{if(!(n instanceof rn||n instanceof na))throw new Ae(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Gt.fromString(e,...t));return PE(r),new rn(n.firestore,n instanceof na?n.converter:null,new Le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="AsyncQueue";class _S{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new qb(this,"async_queue_retry"),this.oc=()=>{const r=Tp();r&&Ce(yS,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=Tp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Tp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new is;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!wl(e))throw e;Ce(yS,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((r=>{throw this.tc=r,this.nc=!1,ss("INTERNAL UNHANDLED ERROR: ",vS(r)),r})).then((r=>(this.nc=!1,r))))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=qg.createAndSchedule(this,e,t,r,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&Ge(47125,{hc:vS(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function vS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class lo extends Xg{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new _S,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _S(e),this._firestoreClient=void 0,await e}}}function ES(n,e,t){t||(t=hh);const r=ma(n,"firestore");if(r.isInitialized(t)){const a=r.getImmediate({identifier:t}),l=r.getOptions(t);if(ra(l,e))return a;throw new Ae(ce.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ae(ce.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Fb)throw new Ae(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&io(e.host)&&bg(e.host),r.initialize({options:e,instanceIdentifier:t})}function Zh(n){if(n._terminated)throw new Ae(ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||TO(n),n._firestoreClient}function TO(n){var e,t,r;const a=n._freezeSettings(),l=(function(d,h,m,g){return new ZC(d,h,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,pT(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new vO(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Li(Mn.fromBase64String(e))}catch(t){throw new Ae(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Li(Mn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Li._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(iu(e,Li._jsonSchema))return Li.fromBase64String(e.bytes)}}Li._jsonSchemaVersion="firestore/bytes/1.0",Li._jsonSchema={type:_n("string",Li._jsonSchemaVersion),bytes:_n("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ae(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ae(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ae(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return at(this._lat,e._lat)||at(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:_r._jsonSchemaVersion}}static fromJSON(e){if(iu(e,_r._jsonSchema))return new _r(e.latitude,e.longitude)}}_r._jsonSchemaVersion="firestore/geoPoint/1.0",_r._jsonSchema={type:_n("string",_r._jsonSchemaVersion),latitude:_n("number"),longitude:_n("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:vr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(iu(e,vr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new vr(e.vectorValues);throw new Ae(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}vr._jsonSchemaVersion="firestore/vectorValue/1.0",vr._jsonSchema={type:_n("string",vr._jsonSchemaVersion),vectorValues:_n("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO=/^__.*__$/;class RO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ga(e,this.data,this.fieldMask,t,this.fieldTransforms):new su(e,this.data,t,this.fieldTransforms)}}class gT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ga(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function yT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ge(40011,{Ec:n})}}class Zg{constructor(e,t,r,a,l,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Zg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:r,mc:!1});return a.fc(e),a}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:r,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Sh(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(yT(this.Ec)&&AO.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class IO{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Qh(e)}Dc(e,t,r,a=!1){return new Zg({Ec:e,methodName:t,bc:r,path:kn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tf(n){const e=n._freezeSettings(),t=Qh(n._databaseId);return new IO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function _T(n,e,t,r,a,l={}){const c=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);ny("Data must be an object, but it was:",c,r);const d=vT(r,c);let h,m;if(l.merge)h=new yi(c.fieldMask),m=c.fieldTransforms;else if(l.mergeFields){const g=[];for(const _ of l.mergeFields){const v=ng(e,_,t);if(!c.contains(v))throw new Ae(ce.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);ST(g,v)||g.push(v)}h=new yi(g),m=c.fieldTransforms.filter((_=>h.covers(_.field)))}else h=null,m=c.fieldTransforms;return new RO(new ni(d),h,m)}class nf extends cu{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nf}}class ey extends cu{_toFieldTransform(e){return new Ib(e.path,new Kc)}isEqual(e){return e instanceof ey}}class ty extends cu{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){const t=new Xc(e.serializer,wb(e.serializer,this.Cc));return new Ib(e.path,t)}isEqual(e){return e instanceof ty&&this.Cc===e.Cc}}function PO(n,e,t,r){const a=n.Dc(1,e,t);ny("Data must be an object, but it was:",a,r);const l=[],c=ni.empty();pa(r,((h,m)=>{const g=iy(e,h,t);m=sn(m);const _=a.gc(g);if(m instanceof nf)l.push(g);else{const v=uu(m,_);v!=null&&(l.push(g),c.set(g,v))}}));const d=new yi(l);return new gT(c,d,a.fieldTransforms)}function CO(n,e,t,r,a,l){const c=n.Dc(1,e,t),d=[ng(e,r,t)],h=[a];if(l.length%2!=0)throw new Ae(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<l.length;v+=2)d.push(ng(e,l[v])),h.push(l[v+1]);const m=[],g=ni.empty();for(let v=d.length-1;v>=0;--v)if(!ST(m,d[v])){const T=d[v];let I=h[v];I=sn(I);const A=c.gc(T);if(I instanceof nf)m.push(T);else{const C=uu(I,A);C!=null&&(m.push(T),g.set(T,C))}}const _=new yi(m);return new gT(g,_,c.fieldTransforms)}function NO(n,e,t,r=!1){return uu(t,n.Dc(r?4:3,e))}function uu(n,e){if(ET(n=sn(n)))return ny("Unsupported field value:",e,n),vT(n,e);if(n instanceof cu)return(function(r,a){if(!yT(a.Ec))throw a.wc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,a){const l=[];let c=0;for(const d of r){let h=uu(d,a.yc(c));h==null&&(h={nullValue:"NULL_VALUE"}),l.push(h),c++}return{arrayValue:{values:l}}})(n,e)}return(function(r,a){if((r=sn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wb(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=kt.fromDate(r);return{timestampValue:yh(a.serializer,l)}}if(r instanceof kt){const l=new kt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:yh(a.serializer,l)}}if(r instanceof _r)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Li)return{bytesValue:kb(a.serializer,r._byteString)};if(r instanceof rn){const l=a.databaseId,c=r.firestore._databaseId;if(!c.isEqual(l))throw a.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Ug(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof vr)return(function(c,d){return{mapValue:{fields:{[ab]:{stringValue:ob},[fh]:{arrayValue:{values:c.toArray().map((m=>{if(typeof m!="number")throw d.wc("VectorValues must only contain numeric values.");return kg(d.serializer,m)}))}}}}}})(r,a);throw a.wc(`Unsupported field value: ${Bh(r)}`)})(n,e)}function vT(n,e){const t={};return eb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pa(n,((r,a)=>{const l=uu(a,e.Vc(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function ET(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof kt||n instanceof _r||n instanceof Li||n instanceof rn||n instanceof cu||n instanceof vr)}function ny(n,e,t){if(!ET(t)||!Jw(t)){const r=Bh(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function ng(n,e,t){if((e=sn(e))instanceof ef)return e._internalPath;if(typeof e=="string")return iy(n,e);throw Sh("Field path arguments must be of type string or ",n,!1,void 0,t)}const OO=new RegExp("[~\\*/\\[\\]]");function iy(n,e,t){if(e.search(OO)>=0)throw Sh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ef(...e.split("."))._internalPath}catch{throw Sh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Sh(n,e,t,r,a){const l=r&&!r.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(l||c)&&(h+=" (found",l&&(h+=` in field ${r}`),c&&(h+=` in document ${a}`),h+=")"),new Ae(ce.INVALID_ARGUMENT,d+n+h)}function ST(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(bT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class xO extends wT{data(){return super.data()}}function bT(n,e){return typeof e=="string"?iy(n,e):e instanceof ef?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ae(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ry{}class TT extends ry{}function kO(n,e,...t){let r=[];e instanceof ry&&r.push(e),r=r.concat(t),(function(l){const c=l.filter((h=>h instanceof ay)).length,d=l.filter((h=>h instanceof sy)).length;if(c>1||c>0&&d>0)throw new Ae(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)n=a._apply(n);return n}class sy extends TT{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new sy(e,t,r)}_apply(e){const t=this._parse(e);return AT(e._query,t),new oo(e.firestore,e.converter,qp(e._query,t))}_parse(e){const t=tf(e.firestore);return(function(l,c,d,h,m,g,_){let v;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new Ae(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){wS(_,g);const I=[];for(const A of _)I.push(SS(h,l,A));v={arrayValue:{values:I}}}else v=SS(h,l,_)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||wS(_,g),v=NO(d,c,_,g==="in"||g==="not-in");return yn.create(m,g,v)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class ay extends ry{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ay(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Zi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const h of d)AT(c,h),c=qp(c,h)})(e._query,t),new oo(e.firestore,e.converter,qp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class oy extends TT{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new oy(e,t,r)}_apply(e){return new oo(e.firestore,e.converter,gh(e._query,this._limit,this._limitType))}}function MO(n){return oy._create("limit",n,"F")}function SS(n,e,t){if(typeof(t=sn(t))=="string"){if(t==="")throw new Ae(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pb(e)&&t.indexOf("/")!==-1)throw new Ae(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Gt.fromString(t));if(!Le.isDocumentKey(r))throw new Ae(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return UE(n,new Le(r))}if(t instanceof rn)return UE(n,t._key);throw new Ae(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bh(t)}.`)}function wS(n,e){if(!Array.isArray(n)||n.length===0)throw new Ae(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function AT(n,e){const t=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ae(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ae(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class LO{convertValue(e,t="none"){switch(la(e)){case 0:return null;case 1:return e.booleanValue;case 2:return un(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(oa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ge(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return pa(e,((a,l)=>{r[a]=this.convertValue(l,t)})),r}convertVectorValue(e){var t,r,a;const l=(a=(r=(t=e.fields)===null||t===void 0?void 0:t[fh].arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map((c=>un(c.doubleValue)));return new vr(l)}convertGeoPoint(e){return new _r(un(e.latitude),un(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Hh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp($c(e));default:return null}}convertTimestamp(e){const t=aa(e);return new kt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Gt.fromString(e);Nt(zb(r),9688,{name:e});const a=new qc(r.get(1),r.get(3)),l=new Le(r.popFirst(5));return a.isEqual(t)||ss(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class xc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qa extends wT{constructor(e,t,r,a,l,c){super(e,t,r,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(bT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qa._jsonSchema={type:_n("string",Qa._jsonSchemaVersion),bundleSource:_n("string","DocumentSnapshot"),bundleName:_n("string"),bundle:_n("string")};class th extends Qa{data(e={}){return super.data(e)}}class ol{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new xc(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new th(this._firestore,this._userDataWriter,r.key,r,new xc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ae(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const h=new th(a._firestore,a._userDataWriter,d.doc.key,d.doc,new xc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const h=new th(a._firestore,a._userDataWriter,d.doc.key,d.doc,new xc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,g=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),g=c.indexOf(d.doc.key)),{type:UO(d.type),doc:h,oldIndex:m,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ol._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ig.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function UO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ge(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(n){n=Ji(n,rn);const e=Ji(n.firestore,lo);return mT(Zh(e),n._key).then((t=>CT(e,n,t)))}ol._jsonSchemaVersion="firestore/querySnapshot/1.0",ol._jsonSchema={type:_n("string",ol._jsonSchemaVersion),bundleSource:_n("string","QuerySnapshot"),bundleName:_n("string"),bundle:_n("string")};class IT extends LO{constructor(e){super(),this.firestore=e}convertBytes(e){return new Li(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rn(this.firestore,null,t)}}function VO(n){n=Ji(n,rn);const e=Ji(n.firestore,lo);return mT(Zh(e),n._key,{source:"server"}).then((t=>CT(e,n,t)))}function PT(n){n=Ji(n,oo);const e=Ji(n.firestore,lo),t=Zh(e),r=new IT(e);return DO(n._query),wO(t,n._query).then((a=>new ol(e,r,n,a)))}function da(n,e,t){n=Ji(n,rn);const r=Ji(n.firestore,lo),a=RT(n.converter,e,t);return ly(r,[_T(tf(r),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Qi.none())])}function Ac(n,e,t,...r){n=Ji(n,rn);const a=Ji(n.firestore,lo),l=tf(a);let c;return c=typeof(e=sn(e))=="string"||e instanceof ef?CO(l,"updateDoc",n._key,e,t,r):PO(l,"updateDoc",n._key,e),ly(a,[c.toMutation(n._key,Qi.exists(!0))])}function jO(n,e){const t=Ji(n.firestore,lo),r=At(n),a=RT(n.converter,e);return ly(t,[_T(tf(n.firestore),"addDoc",r._key,a,n.converter!==null,{}).toMutation(r._key,Qi.exists(!1))]).then((()=>r))}function ly(n,e){return(function(r,a){const l=new is;return r.asyncQueue.enqueueAndForget((async()=>uO(await SO(r),a,l))),l.promise})(Zh(n),e)}function CT(n,e,t){const r=t.docs.get(e._key),a=new IT(n);return new Qa(n,a,e._key,r,new xc(t.hasPendingWrites,t.fromCache),e.converter)}function Jc(){return new ey("serverTimestamp")}function ki(n){return new ty("increment",n)}(function(e,t=!0){(function(a){El=a})(vl),Xi(new Ui("firestore",((r,{instanceIdentifier:a,options:l})=>{const c=r.getProvider("app").getImmediate(),d=new lo(new MC(r.getProvider("auth-internal")),new VC(c,r.getProvider("app-check-internal")),(function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ae(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qc(m.options.projectId,g)})(c,a),c);return l=Object.assign({useFetchStreams:t},l),d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),ri(bE,TE,e),ri(bE,TE,"esm2017")})();var zO="firebase",BO="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ri(zO,BO,"app");function cy(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}function NT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const OT=NT,xT=new ro("auth","Firebase",NT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=new zh("@firebase/auth");function FO(n,...e){wh.logLevel<=ht.WARN&&wh.warn(`Auth (${vl}): ${n}`,...e)}function nh(n,...e){wh.logLevel<=ht.ERROR&&wh.error(`Auth (${vl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(n,...e){throw uy(n,...e)}function Er(n,...e){return uy(n,...e)}function DT(n,e,t){const r=Object.assign(Object.assign({},OT()),{[e]:t});return new ro("auth","Firebase",r).create(e,{appName:n.name})}function ia(n){return DT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uy(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return xT.create(n,...e)}function Ye(n,e,...t){if(!n)throw uy(e,...t)}function ts(n){const e="INTERNAL ASSERTION FAILED: "+n;throw nh(e),new Error(e)}function ls(n,e){n||ts(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function GO(){return bS()==="http:"||bS()==="https:"}function bS(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GO()||kw()||"connection"in navigator)?navigator.onLine:!0}function $O(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,t){this.shortDelay=e,this.longDelay=t,ls(t>e,"Short delay should be less than long delay!"),this.isMobile=lP()||dP()}get(){return HO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dy(n,e){ls(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ts("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ts("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ts("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KO=new du(3e4,6e4);function rf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Tl(n,e,t,r,a={}){return MT(n,a,async()=>{let l={},c={};r&&(e==="GET"?c=r:l={body:JSON.stringify(r)});const d=nu(Object.assign({key:n.config.apiKey},c)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:h},l);return uP()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&io(n.emulatorConfig.host)&&(m.credentials="include"),kT.fetch()(await UT(n,n.config.apiHost,t,d),m)})}async function MT(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},qO),e);try{const a=new WO(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Gd(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[h,m]=d.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gd(n,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Gd(n,"email-already-in-use",c);if(h==="USER_DISABLED")throw Gd(n,"user-disabled",c);const g=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw DT(n,g,m);os(n,g)}}catch(a){if(a instanceof Vi)throw a;os(n,"network-request-failed",{message:String(a)})}}async function LT(n,e,t,r,a={}){const l=await Tl(n,e,t,r,a);return"mfaPendingCredential"in l&&os(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function UT(n,e,t,r){const a=`${e}${t}?${r}`,l=n,c=l.config.emulator?dy(n.config,a):`${n.config.apiScheme}://${a}`;return YO.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}class WO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Er(this.auth,"network-request-failed")),KO.get())})}}function Gd(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=Er(n,e,r);return a.customData._tokenResponse=t,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QO(n,e){return Tl(n,"POST","/v1/accounts:delete",e)}async function bh(n,e){return Tl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function VT(n,e=!1){const t=sn(n),r=await t.getIdToken(e),a=hy(r);Ye(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:r,authTime:zc(Rp(a.auth_time)),issuedAtTime:zc(Rp(a.iat)),expirationTime:zc(Rp(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Rp(n){return Number(n)*1e3}function hy(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return nh("JWT malformed, contained fewer than 3 sections"),null;try{const a=Cw(t);return a?JSON.parse(a):(nh("Failed to decode base64 JWT payload"),null)}catch(a){return nh("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function TS(n){const e=hy(n);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Vi&&XO(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function XO({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zc(this.lastLoginAt),this.creationTime=zc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Th(n){var e;const t=n.auth,r=await n.getIdToken(),a=await Zc(n,bh(t,{idToken:r}));Ye(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const c=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?zT(l.providerUserInfo):[],d=ZO(n.providerData,c),h=n.isAnonymous,m=!(n.email&&l.passwordHash)&&!(d!=null&&d.length),g=h?m:!1,_={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new rg(l.createdAt,l.lastLoginAt),isAnonymous:g};Object.assign(n,_)}async function jT(n){const e=sn(n);await Th(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZO(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function zT(n){return n.map(e=>{var{providerId:t}=e,r=cy(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ex(n,e){const t=await MT(n,{},async()=>{const r=nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,c=await UT(n,a,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:d,body:r};return n.emulatorConfig&&io(n.emulatorConfig.host)&&(h.credentials="include"),kT.fetch()(c,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tx(n,e){return Tl(n,"POST","/v2/accounts:revokeToken",rf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):TS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const t=TS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await ex(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,c=new ll;return r&&(Ye(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),a&&(Ye(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Ye(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ll,this.toJSON())}_performRefresh(){return ts("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(n,e){Ye(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Wi{constructor(e){var{uid:t,auth:r,stsTokenManager:a}=e,l=cy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new JO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new rg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await Zc(this,this.stsTokenManager.getToken(this.auth,e));return Ye(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return VT(this,e)}reload(){return jT(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Wi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Th(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mi(this.auth.app))return Promise.reject(ia(this.auth));const e=await this.getIdToken();return await Zc(this,QO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,a,l,c,d,h,m,g;const _=(r=t.displayName)!==null&&r!==void 0?r:void 0,v=(a=t.email)!==null&&a!==void 0?a:void 0,T=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,I=(c=t.photoURL)!==null&&c!==void 0?c:void 0,A=(d=t.tenantId)!==null&&d!==void 0?d:void 0,C=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,L=(m=t.createdAt)!==null&&m!==void 0?m:void 0,x=(g=t.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:U,emailVerified:z,isAnonymous:$,providerData:se,stsTokenManager:D}=t;Ye(U&&D,e,"internal-error");const P=ll.fromJSON(this.name,D);Ye(typeof U=="string",e,"internal-error"),Qs(_,e.name),Qs(v,e.name),Ye(typeof z=="boolean",e,"internal-error"),Ye(typeof $=="boolean",e,"internal-error"),Qs(T,e.name),Qs(I,e.name),Qs(A,e.name),Qs(C,e.name),Qs(L,e.name),Qs(x,e.name);const N=new Wi({uid:U,auth:e,email:v,emailVerified:z,displayName:_,isAnonymous:$,photoURL:I,phoneNumber:T,tenantId:A,stsTokenManager:P,createdAt:L,lastLoginAt:x});return se&&Array.isArray(se)&&(N.providerData=se.map(M=>Object.assign({},M))),C&&(N._redirectEventId=C),N}static async _fromIdTokenResponse(e,t,r=!1){const a=new ll;a.updateFromServerResponse(t);const l=new Wi({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await Th(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];Ye(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?zT(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),d=new ll;d.updateFromIdToken(r);const h=new Wi({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new rg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=new Map;function ns(n){ls(n instanceof Function,"Expected a class definition");let e=AS.get(n);return e?(ls(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,AS.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}BT.type="NONE";const Ah=BT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(n,e,t){return`firebase:${n}:${e}:${t}`}class cl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=ih(this.userKey,a.apiKey,l),this.fullPersistenceKey=ih("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await bh(this.auth,{idToken:e}).catch(()=>{});return t?Wi._fromGetAccountInfoResponse(this.auth,t,e):null}return Wi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new cl(ns(Ah),e,r);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||ns(Ah);const c=ih(r,e.config.apiKey,e.name);let d=null;for(const m of t)try{const g=await m._get(c);if(g){let _;if(typeof g=="string"){const v=await bh(e,{idToken:g}).catch(()=>{});if(!v)break;_=await Wi._fromGetAccountInfoResponse(e,v,g)}else _=Wi._fromJSON(e,g);m!==l&&(d=_),l=m;break}}catch{}const h=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!h.length?new cl(l,e,r):(l=h[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(c)}catch{}})),new cl(l,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($T(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(YT(e))return"Blackberry";if(KT(e))return"Webos";if(GT(e))return"Safari";if((e.includes("chrome/")||HT(e))&&!e.includes("edge/"))return"Chrome";if(qT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function FT(n=zn()){return/firefox\//i.test(n)}function GT(n=zn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function HT(n=zn()){return/crios\//i.test(n)}function $T(n=zn()){return/iemobile/i.test(n)}function qT(n=zn()){return/android/i.test(n)}function YT(n=zn()){return/blackberry/i.test(n)}function KT(n=zn()){return/webos/i.test(n)}function fy(n=zn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nx(n=zn()){var e;return fy(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ix(){return hP()&&document.documentMode===10}function WT(n=zn()){return fy(n)||qT(n)||KT(n)||YT(n)||/windows phone/i.test(n)||$T(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(n,e=[]){let t;switch(n){case"Browser":t=RS(zn());break;case"Worker":t=`${RS(zn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((c,d)=>{try{const h=e(l);c(h)}catch(h){d(h)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sx(n,e={}){return Tl(n,"GET","/v2/passwordPolicy",rf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ax=6;class ox{constructor(e){var t,r,a,l;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:ax,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,a,l,c,d;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(a=h.containsLowercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsUppercaseLetter)!==null&&l!==void 0?l:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(d=h.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new IS(this),this.idTokenSubscription=new IS(this),this.beforeStateQueue=new rx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ns(t)),this._initializationPromise=this.queue(async()=>{var r,a,l;if(!this._deleted&&(this.persistenceManager=await cl.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await bh(this,{idToken:e}),r=await Wi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Mi(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let a=r,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=a==null?void 0:a._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===d)&&(h!=null&&h.user)&&(a=h.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(c){a=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Th(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$O()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mi(this.app))return Promise.reject(ia(this));const t=e?sn(e):null;return t&&Ye(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mi(this.app)?Promise.reject(ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mi(this.app)?Promise.reject(ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sx(this),t=new ox(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ro("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await tx(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ns(e)||this._popupRedirectResolver;Ye(t,this,"argument-error"),this.redirectPersistenceManager=await cl.create(this,[ns(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,a);return()=>{c=!0,h()}}else{const h=e.addObserver(t);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=QT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Mi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&FO(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function sf(n){return sn(n)}class IS{constructor(e){this.auth=e,this.observer=null,this.addObserver=vP(t=>this.observer=t)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let my={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cx(n){my=n}function ux(n){return my.loadJS(n)}function dx(){return my.gapiScript}function hx(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(n,e){const t=ma(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(ra(l,e??{}))return a;os(a,"already-initialized")}return t.initialize({options:e})}function fx(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ns);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function XT(n,e,t){const r=sf(n);Ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,l=JT(e),{host:c,port:d}=mx(e),h=d===null?"":`:${d}`,m={url:`${l}//${c}${h}/`},g=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){Ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ye(ra(m,r.config.emulator)&&ra(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,io(c)?(bg(`${l}//${c}${h}`),Dw("Auth",!0)):px()}function JT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mx(n){const e=JT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:PS(r.substr(l.length+1))}}else{const[l,c]=r.split(":");return{host:l,port:PS(c)}}}function PS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function px(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ts("not implemented")}_getIdTokenResponse(e){return ts("not implemented")}_linkToIdToken(e,t){return ts("not implemented")}_getReauthenticationResolver(e){return ts("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ul(n,e){return LT(n,"POST","/v1/accounts:signInWithIdp",rf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gx="http://localhost";class ha extends py{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ha(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):os("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a}=t,l=cy(t,["providerId","signInMethod"]);if(!r||!a)return null;const c=new ha(r,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return ul(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ul(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ul(e,t)}buildRequest(){const e={requestUri:gx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=nu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu extends ZT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends hu{constructor(){super("facebook.com")}static credential(e){return ha._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ha._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Jr.credential(t,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends hu{constructor(){super("github.com")}static credential(e){return ha._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.GITHUB_SIGN_IN_METHOD="github.com";Zr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends hu{constructor(){super("twitter.com")}static credential(e,t){return ha._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return es.credential(t,r)}catch{return null}}}es.TWITTER_SIGN_IN_METHOD="twitter.com";es.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yx(n,e){return LT(n,"POST","/v1/accounts:signUp",rf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await Wi._fromIdTokenResponse(e,r,a),c=CS(r);return new fa({user:l,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=CS(r);return new fa({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function CS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function af(n){var e;if(Mi(n.app))return Promise.reject(ia(n));const t=sf(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new fa({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await yx(t,{returnSecureToken:!0}),a=await fa._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh extends Vi{constructor(e,t,r,a){var l;super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Rh.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new Rh(e,t,r,a)}}function eA(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Rh._fromErrorAndOperation(n,l,e,r):l})}async function _x(n,e,t=!1){const r=await Zc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fa._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vx(n,e,t=!1){const{auth:r}=n;if(Mi(r.app))return Promise.reject(ia(r));const a="reauthenticate";try{const l=await Zc(n,eA(r,a,e,n),t);Ye(l.idToken,r,"internal-error");const c=hy(l.idToken);Ye(c,r,"internal-error");const{sub:d}=c;return Ye(n.uid===d,r,"user-mismatch"),fa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&os(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ex(n,e,t=!1){if(Mi(n.app))return Promise.reject(ia(n));const r="signIn",a=await eA(n,r,e),l=await fa._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(l.user),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(n,e){return sn(n).setPersistence(e)}function tA(n,e,t,r){return sn(n).onIdTokenChanged(e,t,r)}function nA(n,e,t){return sn(n).beforeAuthStateChanged(e,t)}function Sx(n,e,t,r){return sn(n).onAuthStateChanged(e,t,r)}const Ih="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ih,"1"),this.storage.removeItem(Ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx=1e3,bx=10;class rA extends iA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=WT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,h)=>{this.notifyListeners(c,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},l=this.storage.getItem(r);ix()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,bx):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},wx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}rA.type="LOCAL";const Ph=rA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA extends iA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}sA.type="SESSION";const gy=sA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new of(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const d=Array.from(c).map(async m=>m(t.origin,l)),h=await Tx(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}of.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,h)=>{const m=yy("",20);a.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:a,onMessage(_){const v=_;if(v.data.eventId===m)switch(v.data.status){case"ack":clearTimeout(g),l=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(v.data.response);break;default:clearTimeout(g),clearTimeout(l),h(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(){return window}function Rx(n){Sr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(){return typeof Sr().WorkerGlobalScope<"u"&&typeof Sr().importScripts=="function"}async function Ix(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Px(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Cx(){return aA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="firebaseLocalStorageDb",Nx=1,Ch="firebaseLocalStorage",lA="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function lf(n,e){return n.transaction([Ch],e?"readwrite":"readonly").objectStore(Ch)}function Ox(){const n=indexedDB.deleteDatabase(oA);return new fu(n).toPromise()}function ag(){const n=indexedDB.open(oA,Nx);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ch,{keyPath:lA})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ch)?e(r):(r.close(),await Ox(),e(await ag()))})})}async function NS(n,e,t){const r=lf(n,!0).put({[lA]:e,value:t});return new fu(r).toPromise()}async function xx(n,e){const t=lf(n,!1).get(e),r=await new fu(t).toPromise();return r===void 0?null:r.value}function OS(n,e){const t=lf(n,!0).delete(e);return new fu(t).toPromise()}const Dx=800,kx=3;class cA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ag(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>kx)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return aA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=of._getInstance(Cx()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Ix(),!this.activeServiceWorker)return;this.sender=new Ax(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Px()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ag();return await NS(e,Ih,"1"),await OS(e,Ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>NS(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>xx(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>OS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=lf(a,!1).getAll();return new fu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Dx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cA.type="LOCAL";const Nh=cA;new du(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(n,e){return e?ns(e):(Ye(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y extends py{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ul(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ul(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ul(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Lx(n){return Ex(n.auth,new _y(n),n.bypassAuthState)}function Ux(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),vx(t,new _y(n),n.bypassAuthState)}async function Vx(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),_x(t,new _y(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Lx;case"linkViaPopup":case"linkViaRedirect":return Vx;case"reauthViaPopup":case"reauthViaRedirect":return Ux;default:os(this.auth,"internal-error")}}resolve(e){ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx=new du(2e3,1e4);class rl extends uA{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,rl.currentPopupAction&&rl.currentPopupAction.cancel(),rl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){ls(this.filter.length===1,"Popup operations only handle one event");const e=yy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jx.get())};e()}}rl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx="pendingRedirect",rh=new Map;class Bx extends uA{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=rh.get(this.auth._key());if(!e){try{const r=await Fx(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}rh.set(this.auth._key(),e)}return this.bypassAuthState||rh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Fx(n,e){const t=$x(e),r=Hx(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}function Gx(n,e){rh.set(n._key(),e)}function Hx(n){return ns(n._redirectPersistence)}function $x(n){return ih(zx,n.config.apiKey,n.name)}async function qx(n,e,t=!1){if(Mi(n.app))return Promise.reject(ia(n));const r=sf(n),a=Mx(r,e),c=await new Bx(r,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx=600*1e3;class Kx{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Wx(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!dA(e)){const a=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Er(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Yx&&this.cachedEventUids.clear(),this.cachedEventUids.has(xS(e))}saveEventToCache(e){this.cachedEventUids.add(xS(e)),this.lastProcessedEventTime=Date.now()}}function xS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function dA({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Wx(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qx(n,e={}){return Tl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Jx=/^https?/;async function Zx(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Qx(n);for(const t of e)try{if(eD(t))return}catch{}os(n,"unauthorized-domain")}function eD(n){const e=ig(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!Jx.test(t))return!1;if(Xx.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=new du(3e4,6e4);function DS(){const n=Sr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function nD(n){return new Promise((e,t)=>{var r,a,l;function c(){DS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{DS(),t(Er(n,"network-request-failed"))},timeout:tD.get()})}if(!((a=(r=Sr().gapi)===null||r===void 0?void 0:r.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Sr().gapi)===null||l===void 0)&&l.load)c();else{const d=hx("iframefcb");return Sr()[d]=()=>{gapi.load?c():t(Er(n,"network-request-failed"))},ux(`${dx()}?onload=${d}`).catch(h=>t(h))}}).catch(e=>{throw sh=null,e})}let sh=null;function iD(n){return sh=sh||nD(n),sh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD=new du(5e3,15e3),sD="__/auth/iframe",aD="emulator/auth/iframe",oD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},lD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cD(n){const e=n.config;Ye(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?dy(e,aD):`https://${n.config.authDomain}/${sD}`,r={apiKey:e.apiKey,appName:n.name,v:vl},a=lD.get(n.config.apiHost);a&&(r.eid=a);const l=n._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${nu(r).slice(1)}`}async function uD(n){const e=await iD(n),t=Sr().gapi;return Ye(t,n,"internal-error"),e.open({where:document.body,url:cD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oD,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const c=Er(n,"network-request-failed"),d=Sr().setTimeout(()=>{l(c)},rD.get());function h(){Sr().clearTimeout(d),a(r)}r.ping(h).then(h,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hD=500,fD=600,mD="_blank",pD="http://localhost";class kS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gD(n,e,t,r=hD,a=fD){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const h=Object.assign(Object.assign({},dD),{width:r.toString(),height:a.toString(),top:l,left:c}),m=zn().toLowerCase();t&&(d=HT(m)?mD:t),FT(m)&&(e=e||pD,h.scrollbars="yes");const g=Object.entries(h).reduce((v,[T,I])=>`${v}${T}=${I},`,"");if(nx(m)&&d!=="_self")return yD(e||"",d),new kS(null);const _=window.open(e||"",d,g);Ye(_,n,"popup-blocked");try{_.focus()}catch{}return new kS(_)}function yD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D="__/auth/handler",vD="emulator/auth/handler",ED=encodeURIComponent("fac");async function MS(n,e,t,r,a,l){Ye(n.config.authDomain,n,"auth-domain-config-required"),Ye(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:vl,eventId:a};if(e instanceof ZT){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",_P(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries({}))c[g]=_}if(e instanceof hu){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(c.scopes=g.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const g of Object.keys(d))d[g]===void 0&&delete d[g];const h=await n._getAppCheckToken(),m=h?`#${ED}=${encodeURIComponent(h)}`:"";return`${SD(n)}?${nu(d).slice(1)}${m}`}function SD({config:n}){return n.emulator?dy(n,vD):`https://${n.authDomain}/${_D}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="webStorageSupport";class wD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gy,this._completeRedirectFn=qx,this._overrideRedirectResult=Gx}async _openPopup(e,t,r,a){var l;ls((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const c=await MS(e,t,r,ig(),a);return gD(e,c,yy())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await MS(e,t,r,ig(),a);return Rx(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(ls(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await uD(e),r=new Kx(e);return t.register("authEvent",a=>(Ye(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ip,{type:Ip},a=>{var l;const c=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[Ip];c!==void 0&&t(!!c),os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Zx(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return WT()||GT()||fy()}}const hA=wD;var LS="@firebase/auth",US="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function AD(n){Xi(new Ui("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=r.options;Ye(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:QT(n)},m=new lx(r,a,l,h);return fx(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Xi(new Ui("auth-internal",e=>{const t=sf(e.getProvider("auth").getImmediate());return(r=>new bD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ri(LS,US,TD(n)),ri(LS,US,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=300,ID=xw("authIdTokenMaxAge")||RD;let VS=null;const PD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>ID)return;const a=t==null?void 0:t.token;VS!==a&&(VS=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function og(n=Ag()){const e=ma(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Bc(n,{popupRedirectResolver:hA,persistence:[Nh,Ph,gy]}),r=xw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(r,location.origin);if(location.origin===l.origin){const c=PD(l.toString());nA(t,c,()=>c(t.currentUser)),tA(t,d=>c(d))}}const a=Nw("auth");return a&&XT(t,`http://${a}`),t}function CD(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}cx({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const l=Er("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",CD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});AD("Browser");const jS=Object.freeze(Object.defineProperty({__proto__:null,AuthCredential:py,FacebookAuthProvider:Xr,GithubAuthProvider:Zr,GoogleAuthProvider:Jr,OAuthCredential:ha,TwitterAuthProvider:es,beforeAuthStateChanged:nA,browserLocalPersistence:Ph,browserPopupRedirectResolver:hA,browserSessionPersistence:gy,connectAuthEmulator:XT,getAuth:og,getIdTokenResult:VT,inMemoryPersistence:Ah,indexedDBLocalPersistence:Nh,initializeAuth:Bc,onAuthStateChanged:Sx,onIdTokenChanged:tA,prodErrorMap:OT,reload:jT,setPersistence:sg,signInAnonymously:af},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND="type.googleapis.com/google.protobuf.Int64Value",OD="type.googleapis.com/google.protobuf.UInt64Value";function fA(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function Oh(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Oh(e));if(typeof n=="function"||typeof n=="object")return fA(n,e=>Oh(e));throw new Error("Data cannot be encoded in JSON: "+n)}function yl(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case ND:case OD:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>yl(e)):typeof n=="function"||typeof n=="object"?fA(n,e=>yl(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ii extends Vi{constructor(e,t,r){super(`${vy}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,ii.prototype)}}function xD(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function xh(n,e){let t=xD(n),r=t,a;try{const l=e&&e.error;if(l){const c=l.status;if(typeof c=="string"){if(!zS[c])return new ii("internal","internal");t=zS[c],r=c}const d=l.message;typeof d=="string"&&(r=d),a=l.details,a!==void 0&&(a=yl(a))}}catch{}return t==="ok"?null:new ii(t,r,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,t,r,a){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Mi(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(l=>this.auth=l,()=>{}),this.messaging||r.get().then(l=>this.messaging=l,()=>{}),this.appCheck||a==null||a.get().then(l=>this.appCheck=l,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),a=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:a}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="us-central1",kD=/^data: (.*?)(?:\n|$)/;function MD(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new ii("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class LD{constructor(e,t,r,a,l=lg,c=(...d)=>fetch(...d)){this.app=e,this.fetchImpl=c,this.emulatorOrigin=null,this.contextProvider=new DD(e,t,r,a),this.cancelAllRequests=new Promise(d=>{this.deleteService=()=>Promise.resolve(d())});try{const d=new URL(l);this.customDomain=d.origin+(d.pathname==="/"?"":d.pathname),this.region=lg}catch{this.customDomain=null,this.region=l}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function UD(n,e,t){const r=io(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(bg(n.emulatorOrigin),Dw("Functions",!0))}function VD(n,e,t){const r=a=>zD(n,e,a,{});return r.stream=(a,l)=>FD(n,e,a,l),r}async function jD(n,e,t,r){t["Content-Type"]="application/json";let a;try{a=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let l=null;try{l=await a.json()}catch{}return{status:a.status,json:l}}async function mA(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function zD(n,e,t,r){const a=n._url(e);return BD(n,a,t,r)}async function BD(n,e,t,r){t=Oh(t);const a={data:t},l=await mA(n,r),c=r.timeout||7e4,d=MD(c),h=await Promise.race([jD(e,a,l,n.fetchImpl),d.promise,n.cancelAllRequests]);if(d.cancel(),!h)throw new ii("cancelled","Firebase Functions instance was deleted.");const m=xh(h.status,h.json);if(m)throw m;if(!h.json)throw new ii("internal","Response is not valid JSON object.");let g=h.json.data;if(typeof g>"u"&&(g=h.json.result),typeof g>"u")throw new ii("internal","Response is missing data field.");return{data:yl(g)}}function FD(n,e,t,r){const a=n._url(e);return GD(n,a,t,r||{})}async function GD(n,e,t,r){var a;t=Oh(t);const l={data:t},c=await mA(n,r);c["Content-Type"]="application/json",c.Accept="text/event-stream";let d;try{d=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(l),headers:c,signal:r==null?void 0:r.signal})}catch(T){if(T instanceof Error&&T.name==="AbortError"){const A=new ii("cancelled","Request was cancelled.");return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}const I=xh(0,null);return{data:Promise.reject(I),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(I)}}}}}}let h,m;const g=new Promise((T,I)=>{h=T,m=I});(a=r==null?void 0:r.signal)===null||a===void 0||a.addEventListener("abort",()=>{const T=new ii("cancelled","Request was cancelled.");m(T)});const _=d.body.getReader(),v=HD(_,h,m,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const T=v.getReader();return{async next(){const{value:I,done:A}=await T.read();return{value:I,done:A}},async return(){return await T.cancel(),{done:!0,value:void 0}}}}},data:g}}function HD(n,e,t,r){const a=(c,d)=>{const h=c.match(kD);if(!h)return;const m=h[1];try{const g=JSON.parse(m);if("result"in g){e(yl(g.result));return}if("message"in g){d.enqueue(yl(g.message));return}if("error"in g){const _=xh(0,g);d.error(_),t(_);return}}catch(g){if(g instanceof ii){d.error(g),t(g);return}}},l=new TextDecoder;return new ReadableStream({start(c){let d="";return h();async function h(){if(r!=null&&r.aborted){const m=new ii("cancelled","Request was cancelled");return c.error(m),t(m),Promise.resolve()}try{const{value:m,done:g}=await n.read();if(g){d.trim()&&a(d.trim(),c),c.close();return}if(r!=null&&r.aborted){const v=new ii("cancelled","Request was cancelled");c.error(v),t(v),await n.cancel();return}d+=l.decode(m,{stream:!0});const _=d.split(`
`);d=_.pop()||"";for(const v of _)v.trim()&&a(v.trim(),c);return h()}catch(m){const g=m instanceof ii?m:xh(0,null);c.error(g),t(g)}}},cancel(){return n.cancel()}})}const BS="@firebase/functions",FS="0.12.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D="auth-internal",qD="app-check-internal",YD="messaging-internal";function KD(n){const e=(t,{instanceIdentifier:r})=>{const a=t.getProvider("app").getImmediate(),l=t.getProvider($D),c=t.getProvider(YD),d=t.getProvider(qD);return new LD(a,l,c,d,r)};Xi(new Ui(vy,e,"PUBLIC").setMultipleInstances(!0)),ri(BS,FS,n),ri(BS,FS,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WD(n=Ag(),e=lg){const r=ma(sn(n),vy).getImmediate({identifier:e}),a=rP("functions");return a&&QD(r,...a),r}function QD(n,e,t){UD(sn(n),e,t)}function Ey(n,e,t){return VD(sn(n),e)}KD();/*! Capacitor: https://capacitorjs.com/ - MIT License */var eo;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(eo||(eo={}));class ah extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const XD=n=>{var e,t;return n!=null&&n.androidBridge?"android":!((t=(e=n==null?void 0:n.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},JD=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},a=()=>e!==null?e.name:XD(n),l=()=>a()!=="web",c=_=>{const v=m.get(_);return!!(v!=null&&v.platforms.has(a())||d(_))},d=_=>{var v;return(v=t.PluginHeaders)===null||v===void 0?void 0:v.find(T=>T.name===_)},h=_=>n.console.error(_),m=new Map,g=(_,v={})=>{const T=m.get(_);if(T)return console.warn(`Capacitor plugin "${_}" already registered. Cannot register plugins twice.`),T.proxy;const I=a(),A=d(_);let C;const L=async()=>(!C&&I in v?C=typeof v[I]=="function"?C=await v[I]():C=v[I]:e!==null&&!C&&"web"in v&&(C=typeof v.web=="function"?C=await v.web():C=v.web),C),x=(P,N)=>{var M,B;if(A){const G=A==null?void 0:A.methods.find(k=>N===k.name);if(G)return G.rtype==="promise"?k=>t.nativePromise(_,N.toString(),k):(k,Ve)=>t.nativeCallback(_,N.toString(),k,Ve);if(P)return(M=P[N])===null||M===void 0?void 0:M.bind(P)}else{if(P)return(B=P[N])===null||B===void 0?void 0:B.bind(P);throw new ah(`"${_}" plugin is not implemented on ${I}`,eo.Unimplemented)}},U=P=>{let N;const M=(...B)=>{const G=L().then(k=>{const Ve=x(k,P);if(Ve){const et=Ve(...B);return N=et==null?void 0:et.remove,et}else throw new ah(`"${_}.${P}()" is not implemented on ${I}`,eo.Unimplemented)});return P==="addListener"&&(G.remove=async()=>N()),G};return M.toString=()=>`${P.toString()}() { [capacitor code] }`,Object.defineProperty(M,"name",{value:P,writable:!1,configurable:!1}),M},z=U("addListener"),$=U("removeListener"),se=(P,N)=>{const M=z({eventName:P},N),B=async()=>{const k=await M;$({eventName:P,callbackId:k},N)},G=new Promise(k=>M.then(()=>k({remove:B})));return G.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await B()},G},D=new Proxy({},{get(P,N){switch(N){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return A?se:z;case"removeListener":return $;default:return U(N)}}});return r[_]=D,m.set(_,{name:_,proxy:D,platforms:new Set([...Object.keys(v),...A?[I]:[]])}),D};return t.convertFileSrc||(t.convertFileSrc=_=>_),t.getPlatform=a,t.handleError=h,t.isNativePlatform=l,t.isPluginAvailable=c,t.registerPlugin=g,t.Exception=ah,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},ZD=n=>n.Capacitor=JD(n),Ne=ZD(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),er=Ne.registerPlugin;class Sy{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const l=this.windowListeners[e];l&&!l.registered&&this.addWindowListener(l),r&&this.sendRetainedArgumentsForEvent(e);const c=async()=>this.removeListener(e,t);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const a=this.listeners[e];if(!a){if(r){let l=this.retainedEventArguments[e];l||(l=[]),l.push(t),this.retainedEventArguments[e]=l}return}a.forEach(l=>l(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new Ne.Exception(e,eo.Unimplemented)}unavailable(e="not available"){return new Ne.Exception(e,eo.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const a=r.indexOf(t);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const GS=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),HS=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class e2 extends Sy{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,l]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=HS(a).trim(),l=HS(l).trim(),t[a]=l}),t}async setCookie(e){try{const t=GS(e.key),r=GS(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,l=(e.path||"/").replace("path=",""),c=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${a}; path=${l}; ${c};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}er("CapacitorCookies",{web:()=>new e2});const t2=async n=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>t(a),r.readAsDataURL(n)}),n2=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(a=>a.toLocaleLowerCase()).reduce((a,l,c)=>(a[l]=n[e[c]],a),{})},i2=(n,e=!0)=>n?Object.entries(n).reduce((r,a)=>{const[l,c]=a;let d,h;return Array.isArray(c)?(h="",c.forEach(m=>{d=e?encodeURIComponent(m):m,h+=`${l}=${d}&`}),h.slice(0,-1)):(d=e?encodeURIComponent(c):c,h=`${l}=${d}`),`${r}&${h}`},"").substr(1):null,pA=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),a=n2(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(a.includes("application/x-www-form-urlencoded")){const l=new URLSearchParams;for(const[c,d]of Object.entries(n.data||{}))l.set(c,d);t.body=l.toString()}else if(a.includes("multipart/form-data")||n.data instanceof FormData){const l=new FormData;if(n.data instanceof FormData)n.data.forEach((d,h)=>{l.append(h,d)});else for(const d of Object.keys(n.data))l.append(d,n.data[d]);t.body=l;const c=new Headers(t.headers);c.delete("content-type"),t.headers=c}else(a.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class r2 extends Sy{async request(e){const t=pA(e,e.webFetchExtra),r=i2(e.params,e.shouldEncodeUrlParams),a=r?`${e.url}?${r}`:e.url,l=await fetch(a,t),c=l.headers.get("content-type")||"";let{responseType:d="text"}=l.ok?e:{};c.includes("application/json")&&(d="json");let h,m;switch(d){case"arraybuffer":case"blob":m=await l.blob(),h=await t2(m);break;case"json":h=await l.json();break;case"document":case"text":default:h=await l.text()}const g={};return l.headers.forEach((_,v)=>{g[v]=_}),{data:h,headers:g,status:l.status,url:l.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}er("CapacitorHttp",{web:()=>new r2});const s2=Object.freeze(Object.defineProperty({__proto__:null,Capacitor:Ne,CapacitorException:ah,get ExceptionCode(){return eo},WebPlugin:Sy,buildRequestInit:pA,registerPlugin:er},Symbol.toStringTag,{value:"Module"})),Wo={apiKey:"AIzaSyBx7eIcSrFFQ-TAaGM1DQJ1GNcHc1wDHkg",authDomain:"yo-nunca-85b0c.firebaseapp.com",projectId:"yo-nunca-85b0c",storageBucket:"yo-nunca-85b0c.firebasestorage.app",messagingSenderId:"814751987159",appId:"1:814751987159:web:5849912e1b43a82899c792"};Ne.getPlatform()==="ios"&&X.error("[firebaseConfig]  iOS detectado - Usando configuracin Web estndar compatible con capacitor://");const Dh={apiKey:Wo.apiKey,authDomain:Wo.authDomain,projectId:Wo.projectId,storageBucket:Wo.storageBucket,messagingSenderId:Wo.messagingSenderId,appId:Wo.appId};Dh.apiKey||X.error("[firebaseConfig]  FATAL: No se encontr API Key. Fallback fall.");let xi,it,jt,_l;const Ht=!!Dh.apiKey&&!!Dh.projectId;if(Ht)try{if(X.error("[firebaseConfig]  Inicializando Firebase (Modo Debug)..."),xi=zw(Dh),X.error(`[firebaseConfig]  Platform: ${Ne.getPlatform()}`),X.error(`[firebaseConfig]  UserAgent: ${navigator.userAgent}`),X.error(`[firebaseConfig]  Origin: ${window.location.href}`),X.error(`[firebaseConfig]  Online Status: ${navigator.onLine}`),Ne.getPlatform()==="ios")try{it=ES(xi,{experimentalForceLongPolling:!0}),X.error("[firebaseConfig]  Firestore inicializado (LongPolling: ON)")}catch(n){X.error("[firebaseConfig]  Error inicializando Firestore:",n)}else it=ES(xi,{}),X.error("[firebaseConfig]  Firestore inicializado (Standard)");if(Ne.getPlatform()==="ios")try{jt=Bc(xi,{persistence:Nh}),X.error("[firebaseConfig]  Auth inicializado con INDEXED_DB persistence (iOS)")}catch(n){try{jt=Bc(xi,{persistence:Ph}),X.error("[firebaseConfig]  Auth inicializado con LOCAL persistence (iOS)")}catch(e){try{jt=Bc(xi,{persistence:Ah}),X.error("[firebaseConfig]  Auth inicializado con MEMORY persistence (iOS fallback)")}catch(t){X.error(`[firebaseConfig]  Fall initializeAuth (${(t==null?void 0:t.message)||(e==null?void 0:e.message)||(n==null?void 0:n.message)}), usando getAuth estndar`),jt=og(xi)}}}else jt=og(xi);jt.onAuthStateChanged(n=>{n?X.error(`[firebaseConfig]  onAuthStateChanged: LOGUEADO (${n.uid})`):X.error("[firebaseConfig]  onAuthStateChanged: NO LOGUEADO")}),_l=WD(xi),(async()=>{try{X.error("[firebaseConfig]  Configurando persistencia...");try{await sg(jt,Nh),X.error("[firebaseConfig]  Persistencia establecida: INDEXED_DB")}catch{await sg(jt,Ph),X.error("[firebaseConfig]  Persistencia establecida: LOCAL")}}catch(n){X.error(`[firebaseConfig]  Error en setPersistence: ${n.message}`)}try{if(jt.currentUser)X.error("[firebaseConfig]  Usuario ya autenticado: "+jt.currentUser.uid);else{X.error("[firebaseConfig]  Iniciando sesin annima automtica...");const n=await af(jt);X.error(`[firebaseConfig]  Sesin annima creada: ${n.user.uid}`)}X.error(`[Firebase]  Inicializado correctamente en ${Ne.getPlatform()}`)}catch(n){X.error(`[Firebase]  Error CRTICO en signInAnonymously: ${n.message} (Code: ${n.code})`)}})()}catch(n){X.error("[Firebase]  Error crtico durante inicializacin:",n)}else X.error("[Firebase]  No se inicializ: faltan variables de entorno");const cg=async()=>{X.error("[TestFirestore]  Iniciando test...");try{if(!it)return X.error("[TestFirestore]  DB es null"),{success:!1,message:"Firestore no inicializado"};try{const c=navigator.onLine;X.error(`[TestFirestore]  Navigator Online: ${c}`)}catch{}const n=jt==null?void 0:jt.currentUser;X.error(`[TestFirestore]  Auth User: ${n?n.uid:"NULL"}`),X.error('[TestFirestore]  Intentando leer coleccin "config"...');const e=Jg(it,"config"),t=kO(e,MO(1)),r=Date.now(),a=await PT(t),l=Date.now()-r;return X.error(`[TestFirestore]  Lectura exitosa en ${l}ms. Docs: ${a.size}`),a.empty?X.error("[TestFirestore]  La coleccin est vaca, pero la conexin funciona."):a.forEach(c=>X.error(`[TestFirestore]  Doc ID: ${c.id}`)),{success:!0,count:a.size,message:`Conexin exitosa. Docs ledos: ${a.size}`}}catch(n){return X.error("[TestFirestore]  Error CRTICO:",n),X.error("[TestFirestore]  Code:",n.code),X.error("[TestFirestore]  Message:",n.message),{success:!1,message:n.message,code:n.code||"UNKNOWN"}}},a2=Object.freeze(Object.defineProperty({__proto__:null,FIREBASE_ENABLED:Ht,get auth(){return jt},get db(){return it},get firebaseApp(){return xi},get functions(){return _l},httpsCallable:Ey,signInAnonymously:af,testFirestoreConnection:cg},Symbol.toStringTag,{value:"Module"})),mr={RATE_LIMITS:{PHRASES_READ:30,ADMIN_OPERATIONS:100,SUGGESTIONS:5,GAME_SESSIONS:60,STORE_QUERIES:20,CACHE_REFRESH:2,PROMO_ATTEMPTS:3,ADMIN_CREATE_PHRASE:50,ADMIN_UPDATE_PHRASE:100,ADMIN_DELETE_PHRASE:20},TIME_WINDOWS:{RATE_LIMIT_WINDOW:60*1e3,BLOCK_DURATION:900*1e3,CLEANUP_INTERVAL:600*1e3,METRICS_RESET:1440*60*1e3},THRESHOLDS:{CRITICAL_THRESHOLD_MULTIPLIER:2,MAX_PARAM_LENGTH:1e3,MAX_QUERY_TYPE_LENGTH:50},MALICIOUS_PATTERNS:[/javascript:/i,/<script/i,/eval\(/i,/function\(/i,/\$\{/,/\.__proto__/,/constructor/,/alert\(/i,/document\./i,/window\./i,/location\./i,/cookie/i,/onclick/i,/onload/i,/onerror/i,/innerHTML/i,/outerHTML/i],LOGGING:{ENABLE_CONSOLE_LOGS:!0,ENABLE_SECURITY_ALERTS:!0,ENABLE_METRICS_LOGGING:!0,LOG_BLOCKED_REQUESTS:!0,LOG_SUSPICIOUS_ACTIVITY:!0}},Ga=n=>mr.LOGGING[n]||!1,qa=class qa{constructor(){ke(this,"rateLimitMap",new Map);ke(this,"metrics",{totalRequests:0,blockedRequests:0,suspiciousIPs:new Set,lastReset:Date.now()});ke(this,"RATE_LIMITS",mr.RATE_LIMITS);ke(this,"TIME_WINDOW",mr.TIME_WINDOWS.RATE_LIMIT_WINDOW);ke(this,"BLOCK_DURATION",mr.TIME_WINDOWS.BLOCK_DURATION);this.startCleanupInterval(),this.startMetricsReset()}static getInstance(){return qa.instance||(qa.instance=new qa),qa.instance}checkRateLimit(e,t){const r=Date.now(),a=this.RATE_LIMITS[t];this.metrics.totalRequests++;const l=`${e}|${String(t)}`;let c=this.rateLimitMap.get(l);return c||(c={count:0,firstRequest:r,lastRequest:r,blocked:!1},this.rateLimitMap.set(l,c)),c.blocked&&c.blockExpiry&&r<c.blockExpiry?(this.metrics.blockedRequests++,console.warn(`[Security]  Solicitud bloqueada para ${e} (${t})`),!1):(r-c.firstRequest>this.TIME_WINDOW&&(c.count=0,c.firstRequest=r,c.blocked=!1,c.blockExpiry=void 0),c.count++,c.lastRequest=r,c.count>a?(c.blocked=!0,c.blockExpiry=r+this.BLOCK_DURATION,this.metrics.blockedRequests++,this.metrics.suspiciousIPs.add(e),Ga("LOG_BLOCKED_REQUESTS")&&console.warn(`[Security]  RATE LIMIT EXCEDIDO: ${e} (${t}) - ${c.count}/${a} solicitudes`),c.count>a*mr.THRESHOLDS.CRITICAL_THRESHOLD_MULTIPLIER&&this.triggerSecurityAlert(e,t,c.count),!1):!0)}getClientIdentifier(){const e=navigator.userAgent,t=navigator.language,r=Intl.DateTimeFormat().resolvedOptions().timeZone;return btoa(`${e}-${t}-${r}`).slice(0,16)}checkReadOperation(e){const t=this.getClientIdentifier();switch(e){case"phrases":return this.checkRateLimit(t,"PHRASES_READ");case"store":return this.checkRateLimit(t,"STORE_QUERIES");case"cache":return this.checkRateLimit(t,"CACHE_REFRESH");default:return!1}}checkWriteOperation(e){const t=this.getClientIdentifier();switch(e){case"suggestion":return this.checkRateLimit(t,"SUGGESTIONS");case"admin":return this.checkRateLimit(t,"ADMIN_OPERATIONS");case"game":return this.checkRateLimit(t,"GAME_SESSIONS");default:return!1}}getSecurityMetrics(){return{...this.metrics,suspiciousIPs:Array.from(this.metrics.suspiciousIPs),currentTime:Date.now(),activeClients:this.rateLimitMap.size}}startCleanupInterval(){setInterval(()=>{const e=Date.now(),t=[];this.rateLimitMap.forEach((r,a)=>{e-r.lastRequest>3600*1e3&&t.push(a)}),t.forEach(r=>{this.rateLimitMap.delete(r)}),t.length>0&&Ga("ENABLE_CONSOLE_LOGS")&&console.log(`[Security]  Limpiados ${t.length} registros expirados`)},mr.TIME_WINDOWS.CLEANUP_INTERVAL)}startMetricsReset(){setInterval(()=>{const e=Date.now();e-this.metrics.lastReset>mr.TIME_WINDOWS.METRICS_RESET&&(Ga("ENABLE_METRICS_LOGGING")&&console.log("[Security]  Reseteando mtricas diarias:",this.getSecurityMetrics()),this.metrics={totalRequests:0,blockedRequests:0,suspiciousIPs:new Set,lastReset:e})},3600*1e3)}triggerSecurityAlert(e,t,r){const a={timestamp:new Date().toISOString(),identifier:e,operation:t,requestCount:r,type:"POTENTIAL_DDOS_ATTACK"};Ga("ENABLE_SECURITY_ALERTS")&&console.error("[Security]  ALERTA DE SEGURIDAD:",a)}validateQuery(e,t){if(typeof e!="string"||e.length>mr.THRESHOLDS.MAX_QUERY_TYPE_LENGTH)return Ga("LOG_SUSPICIOUS_ACTIVITY")&&console.warn(`[Security]  Tipo de consulta invlido: ${e}`),!1;if(t){const r=JSON.stringify(t);if(r.length>mr.THRESHOLDS.MAX_PARAM_LENGTH)return Ga("LOG_SUSPICIOUS_ACTIVITY")&&console.warn("[Security]  Parmetros demasiado largos:",r.length),!1;for(const a of mr.MALICIOUS_PATTERNS)if(a.test(r))return Ga("LOG_SUSPICIOUS_ACTIVITY")&&console.warn("[Security]  Patrn malicioso detectado en consulta:",t),!1}return!0}};ke(qa,"instance");let ug=qa;const wy=ug.getInstance(),gA=n=>wy.checkReadOperation(n),yA=n=>wy.checkWriteOperation(n),_A=(n,e)=>wy.validateQuery(n,e),kh=new Map,by=()=>{const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`},vA=n=>n===by(),EA=async(n,e)=>{try{const t=JSON.stringify(e);typeof window<"u"&&window.localStorage?(localStorage.setItem(n,t),console.log(`[PHRASE_FLOW][STORAGE]  set ${n} (localStorage)`)):(kh.set(n,t),console.log(`[PHRASE_FLOW][STORAGE]  set ${n} (memory)`))}catch(t){console.error(`[PHRASE_FLOW][STORAGE]  set error ${n}:`,t),kh.set(n,JSON.stringify(e))}},SA=async n=>{try{let e=null;if(typeof window<"u"&&window.localStorage?e=localStorage.getItem(n):e=kh.get(n)||null,e){const t=JSON.parse(e);return console.log(`[PHRASE_FLOW][STORAGE]  get ${n}`),t}return null}catch(e){return console.error(`[PHRASE_FLOW][STORAGE]  get error ${n}:`,e),null}},dg=async n=>{try{typeof window<"u"&&window.localStorage?localStorage.removeItem(n):kh.delete(n),console.log(`[PHRASE_FLOW][STORAGE]  remove ${n}`)}catch(e){console.error(`[Storage] Error eliminando ${n}:`,e)}},Mh=2,Pp=async n=>{const e={...n,cacheDate:by(),version:Mh};await EA("phrases_cache",e),console.log(`[PHRASE_FLOW][CACHE_SAVE]  phrases_cache date=${e.cacheDate} v=${Mh} total=${e.allPhrases.length} packs=${Object.keys(n.packPhrases||{}).length}`),console.log("[PHRASE_FLOW][CACHE_SAVE]  packDetail="+Object.entries(n.packPhrases||{}).map(([t,r])=>`${t}:${r.length}`).join(" | "))},o2=async()=>{const n=await SA("phrases_cache");return n?!n.version||n.version<Mh?(console.warn(`[PHRASE_FLOW][CACHE_LOAD]  obsolete v${n.version||0}<${Mh} -> purge`),await dg("phrases_cache"),null):vA(n.cacheDate)?(console.log(`[PHRASE_FLOW][CACHE_LOAD]  valid date=${n.cacheDate} v=${n.version} total=${n.allPhrases.length} premium=${n.premiumPhrases.length} packs=${Object.keys(n.packPhrases||{}).length}`),console.log("[PHRASE_FLOW][CACHE_LOAD]  packDetail="+Object.entries(n.packPhrases||{}).map(([e,t])=>`${e}:${t.length}`).join(" | ")),{freePhrases:n.freePhrases,premiumPhrases:n.premiumPhrases,adultPhrases:n.adultPhrases,allPhrases:n.allPhrases,packPhrases:n.packPhrases||{},lastUpdated:n.lastUpdated}):(console.log(`[PHRASE_FLOW][CACHE_LOAD]  stale date=${n.cacheDate} -> purge`),await dg("phrases_cache"),null):(console.log("[PHRASE_FLOW][CACHE_LOAD]  phrases_cache missing"),null)},l2=async n=>{const e={data:n,lastUpdated:Date.now(),cacheDate:by()};await EA("config_cache",e),console.log(`[PHRASE_FLOW][CONFIG_SAVE]  config_cache date=${e.cacheDate}`)},c2=async()=>{const n=await SA("config_cache");return n?vA(n.cacheDate)?(console.log(`[PHRASE_FLOW][CONFIG_LOAD]  valid date=${n.cacheDate}`),n.data):(console.log(`[PHRASE_FLOW][CONFIG_LOAD]  stale date=${n.cacheDate} -> purge`),await dg("config_cache"),null):(console.log("[PHRASE_FLOW][CONFIG_LOAD]  config_cache missing"),null)},Yi=[{id:"1",text:"he fingido que me gustaba un regalo.",isPremium:!1},{id:"2",text:"he espiado el mvil de mi pareja.",isPremium:!1},{id:"3",text:"he usado el cepillo de dientes de otra persona.",isPremium:!1},{id:"4",text:"he vuelto con un ex.",isPremium:!1},{id:"5",text:"me he redo en un momento inoportuno.",isPremium:!1},{id:"6",text:"he querido besar a alguien de esta mesa.",isPremium:!1},{id:"7",text:"me he besado con alguien que no sea mi pareja en un sueo.",isPremium:!1},{id:"8",text:"he salido solo de fiesta.",isPremium:!1},{id:"9",text:"he trabajado en algo que no me gusta.",isPremium:!1},{id:"10",text:"he puesto los cuernos a mi pareja.",isPremium:!1},{id:"11",text:"he criticado a alguien de esta mesa.",isPremium:!1},{id:"12",text:"me he puesto celoso por alguien de esta mesa.",isPremium:!1},{id:"13",text:"he pensado que alguien de esta mesa es tonto.",isPremium:!1},{id:"14",text:"he conducido a mas de 130km/h.",isPremium:!1},{id:"15",text:"he cogido un vuelo.",isPremium:!1}],W={freePhrases:[],premiumPhrases:[],adultPhrases:[],allPhrases:[],packPhrases:{},lastUpdated:0},wA=()=>W.lastUpdated>0&&W.allPhrases.length>0;let qi=!1;const dl=async(n=!1,e=[])=>{const t="[PHRASE_FLOW]";if(console.log(`${t}  updatePhraseCache(forceUpdate=${n}, owned=[${e.join(",")}])`),qi&&!n){console.log(`${t}  Abortado: actualizacin concurrente en progreso`);return}if(qi=!0,wA()&&!n){const r=Object.keys(W.packPhrases),a=e.filter(_=>!r.includes(_)&&_!=="remove_ads"),l=e.filter(_=>_!=="remove_ads"&&(!W.packPhrases[_]||W.packPhrases[_].length===0));console.log(`${t}  Cache vlido. cached=[${r.join(",")}] new=[${a.join(",")}] emptyOwned=[${l.join(",")}]`);let c=[];if(a.length===0&&l.length===0){console.log(`${t}  Early return: sin nuevos packs ni packs vacos`),qi=!1;return}else a.length>0?(c=[...a],l.forEach(_=>{c.includes(_)||c.push(_)}),console.log(`${t}  Cargando packs nuevos+vacos -> ${c.join(",")}`)):(c=[...l],console.log(`${t}  Recuperando packs vacos -> ${c.join(",")}`));const d=W.allPhrases.length;console.log(`${t}  Antes incremental all=${d} detalle=`+c.map(_=>{var v;return`${_}:${((v=W.packPhrases[_])==null?void 0:v.length)||0}`}).join(" | "));for(const _ of c)try{const v=`consolidated/phrases_pack_${_}`;console.log(`${t}  Leyendo ${v}`);const T=At(it,"consolidated",`phrases_pack_${_}`),I=await En(T);if(I.exists()){const C=I.data().phrases||[];W.packPhrases[_]=C,W.allPhrases.push(...C),console.log(`${t}  Pack ${_} frases=${C.length}`)}else console.warn(`${t}  Documento pack inexistente ${_}`)}catch(v){if(console.error(`${t}  Error pack ${_}`,v),v instanceof Error&&(v.message.includes("offline")||v.message.includes("network"))){console.warn(`${t}  Modo offline detectado - usando cache existente`);break}}const h=new Map;W.allPhrases.forEach(_=>{_.id&&!h.has(_.id)&&h.set(_.id,_)});const m=W.allPhrases.length;W.allPhrases=[...h.values()];const g=m-W.allPhrases.length;W.adultPhrases=W.allPhrases.filter(_=>_.isAdult),W.lastUpdated=Date.now(),console.log(`${t}  Incremental fin all=${W.allPhrases.length} dupEliminados=${g} packs=`+Object.entries(W.packPhrases).map(([_,v])=>`${_}:${v.length}`).join(" | "));try{await Pp({freePhrases:W.freePhrases,premiumPhrases:W.premiumPhrases,adultPhrases:W.adultPhrases,allPhrases:W.allPhrases,packPhrases:W.packPhrases,lastUpdated:W.lastUpdated}),console.log(`${t}  Guardado incremental packs=${c.length}`)}catch(_){console.warn(`${t}  Error guardando incremental`,_)}qi=!1;return}if(n)console.log(`${t}  Full reload (forceUpdate=true)`);else{console.log(`${t}  Verificando almacenamiento local...`);const r=await o2();if(r){const a=Object.keys(r.packPhrases||{}).sort(),l=e.filter(d=>d!=="remove_ads").sort(),c=JSON.stringify(a)===JSON.stringify(l);if(console.log(`${t}  Comparando packs storage vs usuario`,{enCache:a,actuales:l,coinciden:c}),c){W.freePhrases=[],W.premiumPhrases=[],W.adultPhrases=[],W.allPhrases=[],W.packPhrases={},W.freePhrases=r.freePhrases,W.premiumPhrases=r.premiumPhrases,W.adultPhrases=r.adultPhrases,W.allPhrases=r.allPhrases,W.packPhrases=r.packPhrases||{},W.lastUpdated=r.lastUpdated;const d=new Map;W.allPhrases.forEach(_=>{_.id&&!d.has(_.id)&&d.set(_.id,_)});const h=W.allPhrases.length;W.allPhrases=Array.from(d.values());const m=h-W.allPhrases.length;m>0&&console.warn(`[updatePhraseCache]  ${m} DUPLICADOS eliminados del cach restaurado`);const g=W.allPhrases.filter(_=>_.packIds&&_.packIds.length>0);if(g.length>0){console.log(`[updatePhraseCache]  Detectadas ${g.length} frases con packIds en cache`);const _=[...new Set(g.flatMap(I=>I.packIds||[]))];console.log("[updatePhraseCache]  PackIds en cache:",_),console.log("[updatePhraseCache]  PackIds autorizados:",l);const v=W.allPhrases.length;W.allPhrases=W.allPhrases.filter(I=>!I.packIds||I.packIds.length===0||I.isDemo===!0?!0:I.packIds.some(A=>l.includes(A)));const T=v-W.allPhrases.length;if(T>0){console.log(`[updatePhraseCache]  ${T} frases de packs no autorizados eliminadas del cache`),W.adultPhrases=W.allPhrases.filter(I=>I.isAdult);try{await Pp({freePhrases:W.freePhrases,premiumPhrases:W.premiumPhrases,adultPhrases:W.adultPhrases,allPhrases:W.allPhrases,packPhrases:W.packPhrases,lastUpdated:W.lastUpdated}),console.log("[updatePhraseCache]  Cache limpio guardado")}catch(I){console.warn("[updatePhraseCache] Error guardando cache limpio:",I)}}}console.log(`${t}  Restaurado storage frases=${W.allPhrases.length} dupEliminados=${m} packs=${Object.keys(W.packPhrases).length}`),console.log(`${t}  Detalle packs=`+Object.entries(W.packPhrases).map(([_,v])=>`${_}:${v.length}`).join(" | ")),qi=!1;return}else{console.log("[updatePhraseCache]  Los packs del usuario cambiaron, invalidando cache local");try{typeof window<"u"&&window.localStorage&&localStorage.removeItem("phrases_cache")}catch(d){console.warn("[updatePhraseCache] Error limpiando cache:",d)}}}console.log(`${t}  Storage invlido -> full reload Firestore`)}if(W.lastUpdated>0&&!gA("cache")){console.warn("[updatePhraseCache]  Operacin de cache bloqueada por rate limiting"),qi=!1;return}if(!Ht){console.warn("[updatePhraseCache] Firebase no est configurado, usando datos mock."),W.freePhrases=Yi.filter(r=>!r.isPremium),W.premiumPhrases=Yi.filter(r=>r.isPremium),W.adultPhrases=[],W.allPhrases=Yi,W.lastUpdated=Date.now(),qi=!1;return}try{console.log(`${t}  Full reload: limpiando cache y leyendo documentos consolidados`);try{const I=At(it,"consolidated","phrases_free");await En(I)}catch(I){if(console.error(`${t}  Error de conectividad detectado:`,I),W.allPhrases.length===0){console.warn(`${t}  MODO OFFLINE SIN CACHE - Usando datos mock`),W.freePhrases=Yi.filter(A=>!A.isPremium),W.premiumPhrases=Yi.filter(A=>A.isPremium),W.adultPhrases=[],W.allPhrases=Yi,W.lastUpdated=Date.now(),qi=!1;return}else{console.warn(`${t}  MODO OFFLINE - Usando cache existente (${W.allPhrases.length} frases)`),qi=!1;return}}if(!_A("phrases_cache_update",{forceUpdate:n}))throw new Error("Consulta no vlida por seguridad");W.freePhrases=[],W.premiumPhrases=[],W.adultPhrases=[],W.allPhrases=[],W.packPhrases={};const r=At(it,"consolidated","phrases_free"),a=await En(r);if(a.exists()){const A=a.data().phrases||[],C=A.filter(z=>!z.packIds||z.packIds.length===0||z.isDemo===!0),L=A.filter(z=>z.packIds&&z.packIds.length>0&&z.isDemo!==!0);if(L.length>0){const z=[...new Set(L.flatMap($=>$.packIds||[]))];console.log(`[updatePhraseCache]  Documento phrases_free contiene ${L.length} frases NO-DEMO con packIds:`,z),console.log("[updatePhraseCache]  Estas frases NO se aadirn aqu (requieren comprar el pack)")}W.freePhrases=C,W.allPhrases.push(...C);const x=C.filter(z=>z.isDemo).length,U=C.filter(z=>!z.isDemo).length;console.log(`[updatePhraseCache]  Frases gratuitas cargadas: ${C.length} (${U} gratuitas + ${x} demos) - ${L.length} excluidas por packIds`)}else{console.warn("[updatePhraseCache]  No se encontr documento phrases_free, usando estructura antigua"),await u2();return}if(e.length>0){console.log(`${t}  Full reload packs=[${e.join(",")}] count=${e.length}`);for(const A of e){const C=A==="starter_pack"?"[starter_pack]":"";if(console.log(`[updatePhraseCache] ${C} Procesando pack: ${A}`),A==="remove_ads"){console.log(`[updatePhraseCache]  Saltando producto sin frases: ${A}`);continue}try{const L=`consolidated/phrases_pack_${A}`;console.log(`[updatePhraseCache] ${C}  Intentando leer documento: ${L}`);const x=A,U=At(it,"consolidated",`phrases_pack_${x}`);let z=await En(U),$=!1,se=null;if(!z.exists()&&x.endsWith("_pack")){se=x.replace(/_pack$/,"");const N=At(it,"consolidated",`phrases_pack_${se}`),M=await En(N);M.exists()&&(z=M,$=!0,console.warn(`[updatePhraseCache] ${C}  Usando alias phrases_pack_${se} para ${x}`))}if(!z.exists()){console.warn(`[updatePhraseCache] ${C}  Documento phrases_pack_${x} NO existe`);const N=W.freePhrases.filter(M=>M.packIds&&M.packIds.includes(x));N.length>0&&console.warn(`[updatePhraseCache] ${C}  Detectadas ${N.length} frases de ${x} dentro de phrases_free (no-demo). Deben migrarse a consolidated/phrases_pack_${x}.`);continue}let P=z.data().phrases||[];if($&&se&&(P=P.map(N=>{const M=Array.isArray(N.packIds)?N.packIds.slice():[];return M.includes(x)||M.push(x),{...N,packIds:M}})),console.log(`[updatePhraseCache] ${C}  Pack ${x}: ${P.length} frases encontradas`),W.packPhrases[x]=P,W.allPhrases.push(...P),console.log(`[updatePhraseCache] ${C}  Pack ${x}: ${P.length} frases aadidas (allPhrases ahora ${W.allPhrases.length})`),x==="starter_pack"){const N=P.slice(0,3).map(M=>M.id||M.text).join(", ");console.log(`[updatePhraseCache] [starter_pack] Ejemplo de frases cargadas: ${N||"<<vaco>>"}`)}}catch(L){console.error(`[updatePhraseCache] ${C}  Error cargando pack ${A}:`,L)}}const I=Object.entries(W.packPhrases).map(([A,C])=>`${A}:${C.length}`).join(" | ");console.log(`[updatePhraseCache]  Total frases en allPhrases tras packs: ${W.allPhrases.length}`),console.log(`[updatePhraseCache]  Packs en cache: ${Object.keys(W.packPhrases).length} -> ${I}`),W.packPhrases.starter_pack?W.packPhrases.starter_pack.length===0&&console.warn("[updatePhraseCache]  starter_pack cargado pero vaco (documento sin frases o filtradas)"):console.warn("[updatePhraseCache]  starter_pack NO est en phraseCache.packPhrases (verificar documento Firestore y ownedPackIds)")}const l=new Map;W.allPhrases.forEach(I=>{I.id&&!l.has(I.id)&&l.set(I.id,I)});const c=W.allPhrases.length;W.allPhrases=Array.from(l.values());const d=c-W.allPhrases.length;d>0&&console.warn(`[updatePhraseCache]  ${d} DUPLICADOS eliminados de allPhrases`),W.adultPhrases=W.allPhrases.filter(I=>I.isAdult),W.lastUpdated=Date.now();const h=Object.values(W.packPhrases).reduce((I,A)=>I+A.length,0),m=W.allPhrases.filter(I=>!I.packIds||I.packIds.length===0).length,g=W.allPhrases.filter(I=>(!I.packIds||I.packIds.length===0)&&!I.isDemo).length,_=W.allPhrases.filter(I=>I.isDemo).length;console.log(`[updatePhraseCache]  Cach actualizado con ${W.allPhrases.length} frases en total (${d} duplicados eliminados)`),console.log(`[updatePhraseCache]  Gratis (freePhrases doc): ${W.freePhrases.length}, Packs: ${h}, Adulto: ${W.adultPhrases.length}`),console.log(`[updatePhraseCache]  Gratuitas reales (sin packIds): ${m} (${g} sin demos + ${_} demos)`),console.log("[updatePhraseCache]  Packs cargados:",Object.keys(W.packPhrases)),console.log("[updatePhraseCache]  Frases por pack:",Object.entries(W.packPhrases).map(([I,A])=>({[I]:A.length}))),console.log(`[updatePhraseCache]  OPTIMIZACIN: Solo ${1+e.filter(I=>I!=="remove_ads").length} lecturas de Firestore`),console.log("[updatePhraseCache]  Guardando cach en almacenamiento local...");const v=W.allPhrases.filter(I=>I.packIds&&I.packIds.length>0),T=W.allPhrases.filter(I=>!I.packIds||I.packIds.length===0);if(console.log("[updatePhraseCache]  VERIFICACIN FINAL:"),console.log(`[updatePhraseCache]   - Sin packIds (gratuitas): ${T.length}`),console.log(`[updatePhraseCache]   - Con packIds: ${v.length}`),v.length>0){const I=[...new Set(v.flatMap(C=>C.packIds||[]))];console.log("[updatePhraseCache]   - PackIds encontrados en allPhrases:",I),console.log("[updatePhraseCache]   - PackIds del usuario (ownedPackIds):",e);const A=I.filter(C=>!e.includes(C)&&C!=="remove_ads");A.length>0&&console.error("[updatePhraseCache]  ERROR: Hay frases de packs NO AUTORIZADOS:",A)}try{await Pp({freePhrases:W.freePhrases,premiumPhrases:W.premiumPhrases,adultPhrases:W.adultPhrases,allPhrases:W.allPhrases,packPhrases:W.packPhrases,lastUpdated:W.lastUpdated}),console.log("[updatePhraseCache]  Cach guardado en almacenamiento local para hoy")}catch(I){console.warn("[updatePhraseCache]  Error guardando en almacenamiento local:",I)}}catch(r){console.error(`${t}  Error actualizando cach FULL:`,r),console.error("Error details:",{message:r instanceof Error?r.message:"Unknown error",stack:r instanceof Error?r.stack:void 0,firebaseEnabled:Ht,dbConfigured:!!it}),console.warn(`${t} Usando datos mock como fallback (error en full reload)`),W.freePhrases=Yi.filter(a=>!a.isPremium),W.premiumPhrases=Yi.filter(a=>a.isPremium),W.adultPhrases=[],W.allPhrases=Yi,W.lastUpdated=Date.now(),qi=!1}qi=!1},u2=async()=>{console.log("[loadPhrasesFromOldStructure] Cargando desde estructura antigua...");const n=Jg(it,"phrases"),e=await PT(n);console.log(`[loadPhrasesFromOldStructure] ${e.size} documentos obtenidos`),W.freePhrases=[],W.premiumPhrases=[],W.adultPhrases=[],W.allPhrases=[],e.forEach(t=>{const r={id:t.id,...t.data()};W.allPhrases.push(r),r.isPremium?W.premiumPhrases.push(r):W.freePhrases.push(r),r.isAdult&&W.adultPhrases.push(r)}),W.lastUpdated=Date.now(),console.log(`[loadPhrasesFromOldStructure]  Cach cargado: ${W.allPhrases.length} frases`)},bA=async(n,e=!1,t=[])=>{const r="[PHRASE_FLOW]";if(console.log(`${r}  includePremium=${n} (OBSOLETO) adult=${e} owned=[${t.join(",")}] cache: all=${W.allPhrases.length} free=${W.freePhrases.length} packsLoaded=${Object.keys(W.packPhrases).length}`),W.allPhrases.length>0&&!gA("phrases")){console.warn("[fetchPhrases]  Operacin de lectura bloqueada por rate limiting");const a=W.allPhrases.filter(l=>!l.packIds||l.packIds.length===0?!0:l.packIds.some(c=>t.includes(c)));return e?a:a.filter(l=>!l.isAdult)}if(!Ht){console.warn("[fetchPhrases] Firebase no est configurado, devolviendo datos mock.");const a=Yi.filter(l=>!l.packIds||l.packIds.length===0?!0:l.packIds.some(c=>t.includes(c)));return e?a:a.filter(l=>!l.isAdult)}try{if(!wA()||W.allPhrases.length===0)console.log("[fetchPhrases]  Cache vaco o invlido, cargando..."),await dl(!1,t);else{const l=Object.keys(W.packPhrases),c=t.filter(d=>!l.includes(d)&&d!=="remove_ads");c.length>0&&(console.log(`${r}  Nuevos packs detectados: ${c.join(", ")}`),await dl(!1,t))}let a=W.allPhrases.filter(l=>!l.packIds||l.packIds.length===0?!0:l.packIds.some(c=>t.includes(c)));return e||(a=a.filter(l=>!l.isAdult)),console.log(`${r}  result frases=${a.length} demo=${a.filter(l=>l.isDemo).length} permanentes=${a.filter(l=>!l.isDemo).length}`),console.log(`${r}  owned=[${t.join(",")}]`),console.log(`${r}  distribucin packs`,a.reduce((l,c)=>(c.packIds&&c.packIds.length>0?c.packIds.forEach(d=>{l[d]=(l[d]||0)+1}):l.gratuitas=(l.gratuitas||0)+1,l),{})),a}catch(a){console.error(`${r}  Error obteniendo frases:`,a),console.error(`${r}  Fallback - mock`);const l=Yi.filter(c=>!c.packIds||c.packIds.length===0?!0:c.packIds.some(d=>t.includes(d)));return e?l:l.filter(c=>!c.isAdult)}},TA=async n=>{if(console.log(`Adding suggestion: "${n}"`),!yA("suggestion"))throw new Error(" Demasiadas sugerencias enviadas. Espera un momento antes de enviar otra.");if(!_A("add_suggestion",{text:n}))throw new Error("El contenido de la sugerencia no es vlido.");try{if(!Ht)throw console.warn("[addSuggestion] Firebase no est configurado. La sugerencia no se enviar en este entorno."),new Error("Firebase no configurado en este entorno.");await jO(Jg(it,"suggestions"),{text:n,createdAt:new Date,status:"pending"}),console.log("Suggestion submitted successfully.")}catch(e){throw console.error("Error adding suggestion:",e),new Error("No se pudo enviar la sugerencia. Intntalo ms tarde.")}};let Xs=null,oh=!1,Rc=null;const Ar=async()=>oh&&Xs?(console.log("[loadConsolidatedConfig]  Usando cach de configuracin en memoria"),Xs):Rc?(console.log("[loadConsolidatedConfig]  Esperando a carga en progreso..."),Rc):(Rc=(async()=>{try{console.log("[loadConsolidatedConfig]  Verificando almacenamiento local...");const n=await c2();if(n)return Xs=n,oh=!0,console.log("[loadConsolidatedConfig]  Configuracin restaurada desde almacenamiento local (0 lecturas de Firestore)"),console.log("[loadConsolidatedConfig]  AHORRO: 0 lecturas vs 1 lectura desde Firestore"),Xs;console.log("[loadConsolidatedConfig]  No hay configuracin local vlida, descargando desde Firestore...");try{console.log("[loadConsolidatedConfig]  Cargando configuracin consolidada (solo una vez al inicio)...");const e=At(it,"consolidated","app_config"),t=await En(e);if(t.exists()){Xs=t.data(),oh=!0,console.log("[loadConsolidatedConfig]  Configuracin consolidada cargada y almacenada"),console.log("[loadConsolidatedConfig]  OPTIMIZACIN: 1 lectura vs mltiples lecturas anteriormente"),console.log("[loadConsolidatedConfig]  Guardando configuracin en almacenamiento local...");try{await l2(Xs),console.log("[loadConsolidatedConfig]  Configuracin guardada en almacenamiento local para hoy")}catch(r){console.warn("[loadConsolidatedConfig]  Error guardando en almacenamiento local:",r)}return Xs}else return console.warn("[loadConsolidatedConfig]  No se encontr documento consolidado, usando estructura antigua"),null}catch(e){return console.error("[loadConsolidatedConfig] Error:",e),null}}finally{Rc=null}})(),Rc),AA=async()=>{console.log("[forceReloadConfig]  Forzando recarga de configuracin..."),Xs=null,oh=!1;try{typeof window<"u"&&window.localStorage&&(localStorage.removeItem("config_cache"),console.log("[forceReloadConfig]  Cach local eliminado"))}catch(n){console.warn("[forceReloadConfig] Error limpiando cach local:",n)}return await Ar()},RA=async()=>{try{if(!Ht)return"Prueba el pack premium para descubrir algunas de las nuevas frases que puedes desbloquear en la tienda";const n=await Ar();return!n||!n.premiumPromoMessage?"Prueba el pack premium para descubrir algunas de las nuevas frases que puedes desbloquear en la tienda":n.premiumPromoMessage}catch(n){return console.error("[getPremiumPromoMessage] Error:",n),"Prueba el pack premium para descubrir algunas de las nuevas frases que puedes desbloquear en la tienda"}},IA=async(n,e)=>{try{return!Ht||!_l?!1:(await Ey(_l,"incrementEntryCodeUsage")({productId:n,entryCode:e}),!0)}catch(t){return console.error("[incrementEntryCodeUsage] Error:",t),!1}},Ty=async()=>{try{if(console.log("[getStoreProducts]  Cargando productos de tienda..."),!Ht)return console.warn("[getStoreProducts]  Firebase no habilitado"),[];const n=At(it,"consolidated","app_config");let e;try{e=await VO(n)}catch(t){console.warn("[getStoreProducts]  getDocFromServer fall, usando getDoc estndar (podra devolver cach):",t),e=await En(n)}if(e.exists()){const t=e.data(),r=Array.isArray(t.storeProducts)?t.storeProducts:null,a=Array.isArray(t.store_products)?t.store_products:null,l=r||a||[],c=l.map(d=>{let h;return Array.isArray(d==null?void 0:d.benefits)?h=d.benefits.filter(m=>typeof m=="string"&&m.trim().length>0):typeof(d==null?void 0:d.benefits)=="string"?h=String(d.benefits).split(`
`).map(m=>m.trim()).filter(m=>!!m):h=void 0,{...d,benefits:h}});if(l.length>0)return console.log(`[getStoreProducts]  ${l.length} productos cargados`),console.log("[getStoreProducts]  IDs:",c.map(d=>d.productId).join(", ")),c}return console.warn("[getStoreProducts]  No hay storeProducts/store_products en app_config"),[]}catch(n){return console.error("[getStoreProducts]  Error:",n),[]}},d2=async()=>{try{if(!Ht)return{enable_store:!0,enable_remove_ads_purchase:!0,enable_premium_purchase:!0,enable_share_button:!0,enable_play:!0};const n=await Ar();if(n&&n.featureFlags){console.log("[getFeatureFlags]  Feature flags desde config consolidada");const r=n.featureFlags,a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=(h,m,g)=>l?m??h:c?g??h:h;return{enable_store:d(r.enable_store,r.enable_store_ios,r.enable_store_web),enable_play:d(r.enable_play,r.enable_play_ios,r.enable_play_web),enable_share_button:d(r.enable_share_button,r.enable_share_button_ios,r.enable_share_button_web),enable_adult_mode:d(r.enable_adult_mode,r.enable_adult_mode_ios,r.enable_adult_mode_web),enable_remove_ads_purchase:r.enable_remove_ads_purchase,enable_premium_purchase:r.enable_premium_purchase}}console.log("[getFeatureFlags] Usando estructura antigua...");const e=At(it,"config","feature_flags"),t=await En(e);if(t.exists()){const r=t.data(),a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=(h,m,g)=>l?m??h:c?g??h:h;return{enable_store:d(r.enable_store,r.enable_store_ios,r.enable_store_web),enable_play:d(r.enable_play,r.enable_play_ios,r.enable_play_web),enable_share_button:d(r.enable_share_button,r.enable_share_button_ios,r.enable_share_button_web),enable_adult_mode:d(r.enable_adult_mode,r.enable_adult_mode_ios,r.enable_adult_mode_web),enable_remove_ads_purchase:r.enable_remove_ads_purchase,enable_premium_purchase:r.enable_premium_purchase}}return{enable_store:!0,enable_remove_ads_purchase:!0,enable_premium_purchase:!0,enable_share_button:!0,enable_play:!0}}catch(n){return console.error("[getFeatureFlags] Error:",n),{enable_store:!0,enable_remove_ads_purchase:!0,enable_premium_purchase:!0,enable_share_button:!0,enable_play:!0}}},h2=async()=>{try{if(!Ht)return{required_update_version:void 0};const n=await Ar();if(n&&n.appSettings){console.log("[getAppSettings]  App settings desde config consolidada");const r=n.appSettings,a=Ne.getPlatform();return{required_update_version:a==="ios"?r.required_update_version_ios??r.required_update_version:a==="web"?r.required_update_version_web??r.required_update_version:r.required_update_version}}console.log("[getAppSettings] Usando estructura antigua...");const e=At(it,"config","app_settings"),t=await En(e);if(t.exists()){const r=t.data(),a=Ne.getPlatform();return{required_update_version:a==="ios"?r.required_update_version_ios??r.required_update_version:a==="web"?r.required_update_version_web??r.required_update_version:r.required_update_version}}return{required_update_version:void 0}}catch(n){return console.error("[getAppSettings] Error:",n),{required_update_version:void 0}}},f2=async()=>{var n;try{if(!Ht)return"https://play.google.com/store/apps/details?id=com.mrodr.yonunca";const e=await Ar();if(e&&e.externalLinks&&e.externalLinks.play_store_url)return console.log("[getPlayStoreUrl]  URL desde config consolidada"),e.externalLinks.play_store_url;console.log("[getPlayStoreUrl] Usando estructura antigua...");const t=At(it,"config","app_config"),r=await En(t);if(r.exists()){const a=r.data();return((n=a==null?void 0:a.external_links)==null?void 0:n.play_store_url)||void 0}return}catch(e){console.error("[getPlayStoreUrl] Error:",e);return}},m2=async()=>{try{if(!Ht)return"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos.";const n=await Ar();if(n&&n.appSettings)return console.log("[getWelcomeMessage]  Mensaje desde config consolidada"),n.appSettings.welcome_message||"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos.";console.log("[getWelcomeMessage] Usando estructura antigua...");const e=At(it,"config","app_settings"),t=await En(e);if(t.exists()){const r=t.data();return(r==null?void 0:r.welcome_message)||"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."}return"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."}catch(n){return console.error("[getWelcomeMessage] Error:",n),"Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."}},p2=async()=>{try{if(!Ht)return{enabled:!1,title:"",message:"",buttonText:"Entendido"};const n=await Ar();if(n&&n.appSettings){console.log("[getPopupConfig]  Popup config desde config consolidada");const r=n.appSettings,a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=l?r.popup_enabled_ios??r.popup_enabled:c?r.popup_enabled_web??r.popup_enabled:r.popup_enabled,h=l?r.popup_show_playstore_button_ios??r.popup_show_playstore_button:c?r.popup_show_playstore_button_web??r.popup_show_playstore_button:r.popup_show_playstore_button;return{enabled:!!d,title:l?r.popup_title_ios??r.popup_title??"":c?r.popup_title_web??r.popup_title??"":r.popup_title??"",message:l?r.popup_message_ios??r.popup_message??"":c?r.popup_message_web??r.popup_message??"":r.popup_message??"",buttonText:l?r.popup_button_text_ios??r.popup_button_text??"Entendido":c?r.popup_button_text_web??r.popup_button_text??"Entendido":r.popup_button_text??"Entendido",showPlayStoreButton:!!h,playStoreButtonText:l?r.popup_playstore_button_text_ios??r.popup_playstore_button_text??"Descargar App":c?r.popup_playstore_button_text_web??r.popup_playstore_button_text??"Descargar App":r.popup_playstore_button_text??"Descargar App",playStoreUrl:l?r.popup_playstore_url_ios??r.popup_playstore_url??"":c?r.popup_playstore_url_web??r.popup_playstore_url??"":r.popup_playstore_url??""}}console.log("[getPopupConfig] Usando estructura antigua...");const e=At(it,"config","app_settings"),t=await En(e);if(t.exists()){const r=t.data(),a=Ne.getPlatform(),l=a==="ios",c=a==="web",d=l?r.popup_enabled_ios??r.popup_enabled:c?r.popup_enabled_web??r.popup_enabled:r.popup_enabled,h=l?r.popup_show_playstore_button_ios??r.popup_show_playstore_button:c?r.popup_show_playstore_button_web??r.popup_show_playstore_button:r.popup_show_playstore_button;return{enabled:!!d,title:l?r.popup_title_ios??r.popup_title??"":c?r.popup_title_web??r.popup_title??"":r.popup_title??"",message:l?r.popup_message_ios??r.popup_message??"":c?r.popup_message_web??r.popup_message??"":r.popup_message??"",buttonText:l?r.popup_button_text_ios??r.popup_button_text??"Entendido":c?r.popup_button_text_web??r.popup_button_text??"Entendido":r.popup_button_text??"Entendido",showPlayStoreButton:!!h,playStoreButtonText:l?r.popup_playstore_button_text_ios??r.popup_playstore_button_text??"Descargar App":c?r.popup_playstore_button_text_web??r.popup_playstore_button_text??"Descargar App":r.popup_playstore_button_text??"Descargar App",playStoreUrl:l?r.popup_playstore_url_ios??r.popup_playstore_url??"":c?r.popup_playstore_url_web??r.popup_playstore_url??"":r.popup_playstore_url??""}}return{enabled:!1,title:"",message:"",buttonText:"Entendido"}}catch(n){return console.error("[getPopupConfig] Error:",n),{enabled:!1,title:"",message:"",buttonText:"Entendido"}}},PA=async()=>{try{const n="ca-app-pub-3940256099942544/6300978111",e="ca-app-pub-3940256099942544/1033173712",t="ca-app-pub-3940256099942544/5224354917";if(!Ht)return{enabled:!0,testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0,bannerId:n,interstitialId:e,rewardedVideoId:t};const r=await Ar();if(r&&r.admobSettings){console.log("[getAdMobConfig]  AdMob config desde config consolidada");const d=Ne.getPlatform()==="ios",h=r.admobSettings||{},m=d?h.test_mode_ios===!0||h.test_mode_ios==null&&h.test_mode===!0:h.test_mode_android===!0||h.test_mode_android==null&&h.test_mode===!0,g=d?h.ios_banner_id||h.banner_id||n:h.android_banner_id||h.banner_id||n,_=d?h.ios_interstitial_id||h.interstitial_id||e:h.android_interstitial_id||h.interstitial_id||e,v=d?h.ios_rewarded_video_id||h.rewarded_video_id||t:h.android_rewarded_video_id||h.rewarded_video_id||t;return{enabled:h.ads_enabled!==!1,testMode:m,interstitialCooldown:h.interstitial_cooldown_seconds?h.interstitial_cooldown_seconds*1e3:6e4,rewardedCooldown:h.rewarded_cooldown_seconds?h.rewarded_cooldown_seconds*1e3:3e4,showBanners:h.show_banners!==!1,showInterstitials:h.show_interstitials!==!1,showRewardedVideos:h.show_rewarded_videos!==!1,bannerId:m?n:g,interstitialId:m?e:_,rewardedVideoId:m?t:v}}console.log("[getAdMobConfig] Usando estructura antigua...");const a=At(it,"config","admob_settings"),l=await En(a);if(l.exists()){const c=l.data(),d=Ne.getPlatform()==="ios",h=d?(c==null?void 0:c.test_mode_ios)===!0||(c==null?void 0:c.test_mode_ios)==null&&(c==null?void 0:c.test_mode)===!0:(c==null?void 0:c.test_mode_android)===!0||(c==null?void 0:c.test_mode_android)==null&&(c==null?void 0:c.test_mode)===!0;return{enabled:(c==null?void 0:c.ads_enabled)!==!1,testMode:h,interstitialCooldown:c!=null&&c.interstitial_cooldown_seconds?c.interstitial_cooldown_seconds*1e3:6e4,rewardedCooldown:c!=null&&c.rewarded_cooldown_seconds?c.rewarded_cooldown_seconds*1e3:3e4,showBanners:(c==null?void 0:c.show_banners)!==!1,showInterstitials:(c==null?void 0:c.show_interstitials)!==!1,showRewardedVideos:(c==null?void 0:c.show_rewarded_videos)!==!1,bannerId:h?n:d?(c==null?void 0:c.ios_banner_id)||n:(c==null?void 0:c.banner_id)||n,interstitialId:h?e:d?(c==null?void 0:c.ios_interstitial_id)||e:(c==null?void 0:c.interstitial_id)||e,rewardedVideoId:h?t:d?(c==null?void 0:c.ios_rewarded_video_id)||t:(c==null?void 0:c.rewarded_video_id)||t}}return{enabled:!0,testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0,bannerId:n,interstitialId:e,rewardedVideoId:t}}catch(n){return console.error("[getAdMobConfig] Error:",n),{enabled:!0,testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0,bannerId:"ca-app-pub-3940256099942544/6300978111",interstitialId:"ca-app-pub-3940256099942544/1033173712",rewardedVideoId:"ca-app-pub-3940256099942544/5224354917"}}},CA=async n=>{var e;try{if(!Ht)return{total:0,available:0,assigned:0};const t=await Ar(),r=((e=t==null?void 0:t.promo_codes)==null?void 0:e[n])||[];if(!Array.isArray(r)||r.length===0)return{total:0,available:0,assigned:0};let a=0,l=0,c=!1;if(r.forEach(h=>{const m=h.maxUses||0,g=h.usedCount||0;m===0?c=!0:(a+=m,l+=g)}),c)return{total:999999,available:999999,assigned:0};const d=a-l;return{total:a,available:d>0?d:0,assigned:l}}catch(t){return console.error("[getPromoCodesStats] Error:",t),{total:0,available:0,assigned:0}}},hg=async n=>{var e;try{const t=await Ar(),r=((e=t==null?void 0:t.promo_codes)==null?void 0:e[n])||[];if(console.log("[getValidEntryCodesForProduct]  Product:",n),console.log("[getValidEntryCodesForProduct]  Cdigos encontrados:",r.length),!Array.isArray(r))return console.warn("[getValidEntryCodesForProduct]  promo_codes no es array"),[];const a=r.map(l=>l==null?void 0:l.code).filter(l=>l&&typeof l=="string").map(l=>l.toUpperCase());return console.log("[getValidEntryCodesForProduct]  Cdigos:",a),a}catch(t){return console.error("[getValidEntryCodesForProduct] Error:",t),[]}},NA=async()=>{if(W.allPhrases.length>0){const n=Object.values(W.packPhrases).flat().length,e=W.allPhrases.filter(t=>t.isDemo).length;return console.log("[getPhraseCounters]  Usando contadores desde cach (0 lecturas)"),console.log("[getPhraseCounters]  Premium (packs):",n,"Demo:",e,"Free:",W.freePhrases.length),{totalPremiumPhrases:n,totalDemoPhrases:e,totalFreePhrases:W.freePhrases.length}}try{if(!Ht)return console.warn("[getPhraseCounters]  Firebase deshabilitado - usando valores por defecto"),{totalPremiumPhrases:161,totalDemoPhrases:26,totalFreePhrases:192};console.log("[getPhraseCounters]  Leyendo contador de frases gratuitas...");const n=At(it,"consolidated","phrases_free"),e=await En(n);if(e.exists()){const r=e.data().phrases||[],a=r.filter(l=>l.isDemo).length;return console.log("[getPhraseCounters]  Contadores desde documento gratuitas (1 lectura)"),console.log("[getPhraseCounters]  Free:",r.length,"Demo:",a),{totalPremiumPhrases:0,totalDemoPhrases:a,totalFreePhrases:r.length}}return console.log("[getPhraseCounters]  No se encontr documento consolidado, usando valores estimados"),{totalPremiumPhrases:0,totalDemoPhrases:26,totalFreePhrases:192}}catch(n){return console.error("[getPhraseCounters]  Error al obtener contadores:",n),console.warn("[getPhraseCounters]  Usando valores de fallback"),{totalPremiumPhrases:0,totalDemoPhrases:26,totalFreePhrases:192}}},g2=async(n,e)=>{try{if(!Ht||!it){console.warn("[linkDeviceToUser] Firebase no habilitado");return}const t=At(it,"device_mappings",n);await da(t,{deviceId:n,firebaseUid:e,lastSeen:new Date,platform:typeof navigator<"u"?navigator.platform:"unknown",userAgent:typeof navigator<"u"?navigator.userAgent:"unknown"},{merge:!0}),console.log("[linkDeviceToUser]  Device vinculado a usuario:",{deviceId:n,firebaseUid:e})}catch(t){console.error("[linkDeviceToUser]  Error vinculando device:",t)}},y2=async(n,e)=>{try{if(!Ht||!it){console.warn("[updateUserProfile] Firebase no habilitado");return}const t=At(it,"users",n);await da(t,{deviceId:e,lastLogin:new Date,updatedAt:new Date},{merge:!0}),console.log("[updateUserProfile]  Perfil actualizado:",{firebaseUid:n,deviceId:e})}catch(t){console.error("[updateUserProfile]  Error actualizando perfil:",t)}},Ki=Object.freeze(Object.defineProperty({__proto__:null,addSuggestion:TA,fetchPhrases:bA,forceReloadConfig:AA,getAdMobConfig:PA,getAppSettings:h2,getFeatureFlags:d2,getPhraseCounters:NA,getPlayStoreUrl:f2,getPopupConfig:p2,getPremiumPromoMessage:RA,getPromoCodesStats:CA,getStoreProducts:Ty,getValidEntryCodesForProduct:hg,getWelcomeMessage:m2,incrementEntryCodeUsage:IA,linkDeviceToUser:g2,phraseCache:W,updatePhraseCache:dl,updateUserProfile:y2},Symbol.toStringTag,{value:"Module"}));class _2{constructor(){ke(this,"counters",{totalPremiumPhrases:0,totalDemoPhrases:0,totalFreePhrases:0,isLoaded:!1})}async loadCounters(){try{console.log("[PhraseCounters] Cargando contadores desde Firebase...");const e=await NA();this.counters={...e,isLoaded:!0},console.log("[PhraseCounters] Contadores cargados:",this.counters)}catch(e){console.error("[PhraseCounters]  Error cargando contadores:",e),console.warn("[PhraseCounters]  Usando valores de fallback"),this.counters={totalPremiumPhrases:161,totalDemoPhrases:26,totalFreePhrases:100,isLoaded:!0},console.log("[PhraseCounters] Fallback aplicado:",this.counters)}}async getCounters(){return this.counters.isLoaded||await this.loadCounters(),{...this.counters}}getPremiumCount(){return this.counters.totalPremiumPhrases}getDemoCount(){return this.counters.totalDemoPhrases}isReady(){return this.counters.isLoaded}async refresh(){this.counters.isLoaded=!1,await this.loadCounters()}}const OA=new _2;var $S;(function(n){n.General="General",n.ParentalGuidance="ParentalGuidance",n.Teen="Teen",n.MatureAudience="MatureAudience"})($S||($S={}));var qS;(function(n){n.SizeChanged="bannerAdSizeChanged",n.Loaded="bannerAdLoaded",n.FailedToLoad="bannerAdFailedToLoad",n.Opened="bannerAdOpened",n.Closed="bannerAdClosed",n.AdImpression="bannerAdImpression"})(qS||(qS={}));var fg;(function(n){n.TOP_CENTER="TOP_CENTER",n.CENTER="CENTER",n.BOTTOM_CENTER="BOTTOM_CENTER"})(fg||(fg={}));var mg;(function(n){n.BANNER="BANNER",n.FULL_BANNER="FULL_BANNER",n.LARGE_BANNER="LARGE_BANNER",n.MEDIUM_RECTANGLE="MEDIUM_RECTANGLE",n.LEADERBOARD="LEADERBOARD",n.ADAPTIVE_BANNER="ADAPTIVE_BANNER",n.SMART_BANNER="SMART_BANNER"})(mg||(mg={}));var YS;(function(n){n.Loaded="interstitialAdLoaded",n.FailedToLoad="interstitialAdFailedToLoad",n.Showed="interstitialAdShowed",n.FailedToShow="interstitialAdFailedToShow",n.Dismissed="interstitialAdDismissed"})(YS||(YS={}));var KS;(function(n){n.Loaded="onRewardedInterstitialAdLoaded",n.FailedToLoad="onRewardedInterstitialAdFailedToLoad",n.Showed="onRewardedInterstitialAdShowed",n.FailedToShow="onRewardedInterstitialAdFailedToShow",n.Dismissed="onRewardedInterstitialAdDismissed",n.Rewarded="onRewardedInterstitialAdReward"})(KS||(KS={}));var WS;(function(n){n.Loaded="onRewardedVideoAdLoaded",n.FailedToLoad="onRewardedVideoAdFailedToLoad",n.Showed="onRewardedVideoAdShowed",n.FailedToShow="onRewardedVideoAdFailedToShow",n.Dismissed="onRewardedVideoAdDismissed",n.Rewarded="onRewardedVideoAdReward"})(WS||(WS={}));var QS;(function(n){n.NOT_REQUIRED="NOT_REQUIRED",n.OBTAINED="OBTAINED",n.REQUIRED="REQUIRED",n.UNKNOWN="UNKNOWN"})(QS||(QS={}));var XS;(function(n){n[n.DISABLED=0]="DISABLED",n[n.EEA=1]="EEA",n[n.NOT_EEA=2]="NOT_EEA",n[n.US=3]="US",n[n.OTHER=4]="OTHER"})(XS||(XS={}));const Di=er("AdMob",{web:()=>Wt(()=>import("./web-DIidTmJ6.js"),[]).then(n=>new n.AdMobWeb)}),xA="@firebase/installations",Ay="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=1e4,kA=`w:${Ay}`,MA="FIS_v2",v2="https://firebaseinstallations.googleapis.com/v1",E2=3600*1e3,S2="installations",w2="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},to=new ro(S2,w2,b2);function LA(n){return n instanceof Vi&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA({projectId:n}){return`${v2}/projects/${n}/installations`}function VA(n){return{token:n.token,requestStatus:2,expiresIn:A2(n.expiresIn),creationTime:Date.now()}}async function jA(n,e){const r=(await e.json()).error;return to.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function zA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function T2(n,{refreshToken:e}){const t=zA(n);return t.append("Authorization",R2(e)),t}async function BA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function A2(n){return Number(n.replace("s","000"))}function R2(n){return`${MA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I2({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=UA(n),a=zA(n),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={fid:t,authVersion:MA,appId:n.appId,sdkVersion:kA},d={method:"POST",headers:a,body:JSON.stringify(c)},h=await BA(()=>fetch(r,d));if(h.ok){const m=await h.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:VA(m.authToken)}}else throw await jA("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=/^[cdef][\w-]{21}$/,pg="";function N2(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=O2(n);return C2.test(t)?t:pg}catch{return pg}}function O2(n){return P2(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA=new Map;function HA(n,e){const t=cf(n);$A(t,e),x2(t,e)}function $A(n,e){const t=GA.get(n);if(t)for(const r of t)r(e)}function x2(n,e){const t=D2();t&&t.postMessage({key:n,fid:e}),k2()}let Wa=null;function D2(){return!Wa&&"BroadcastChannel"in self&&(Wa=new BroadcastChannel("[Firebase] FID Change"),Wa.onmessage=n=>{$A(n.data.key,n.data.fid)}),Wa}function k2(){GA.size===0&&Wa&&(Wa.close(),Wa=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="firebase-installations-database",L2=1,no="firebase-installations-store";let Cp=null;function Ry(){return Cp||(Cp=jw(M2,L2,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(no)}}})),Cp}async function Lh(n,e){const t=cf(n),a=(await Ry()).transaction(no,"readwrite"),l=a.objectStore(no),c=await l.get(t);return await l.put(e,t),await a.done,(!c||c.fid!==e.fid)&&HA(n,e.fid),e}async function qA(n){const e=cf(n),r=(await Ry()).transaction(no,"readwrite");await r.objectStore(no).delete(e),await r.done}async function uf(n,e){const t=cf(n),a=(await Ry()).transaction(no,"readwrite"),l=a.objectStore(no),c=await l.get(t),d=e(c);return d===void 0?await l.delete(t):await l.put(d,t),await a.done,d&&(!c||c.fid!==d.fid)&&HA(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iy(n){let e;const t=await uf(n.appConfig,r=>{const a=U2(r),l=V2(n,a);return e=l.registrationPromise,l.installationEntry});return t.fid===pg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function U2(n){const e=n||{fid:N2(),registrationStatus:0};return YA(e)}function V2(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(to.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=j2(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:z2(n)}:{installationEntry:e}}async function j2(n,e){try{const t=await I2(n,e);return Lh(n.appConfig,t)}catch(t){throw LA(t)&&t.customData.serverCode===409?await qA(n.appConfig):await Lh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function z2(n){let e=await JS(n.appConfig);for(;e.registrationStatus===1;)await FA(100),e=await JS(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await Iy(n);return r||t}return e}function JS(n){return uf(n,e=>{if(!e)throw to.create("installation-not-found");return YA(e)})}function YA(n){return B2(n)?{fid:n.fid,registrationStatus:0}:n}function B2(n){return n.registrationStatus===1&&n.registrationTime+DA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F2({appConfig:n,heartbeatServiceProvider:e},t){const r=G2(n,t),a=T2(n,t),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={installation:{sdkVersion:kA,appId:n.appId}},d={method:"POST",headers:a,body:JSON.stringify(c)},h=await BA(()=>fetch(r,d));if(h.ok){const m=await h.json();return VA(m)}else throw await jA("Generate Auth Token",h)}function G2(n,{fid:e}){return`${UA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Py(n,e=!1){let t;const r=await uf(n.appConfig,l=>{if(!KA(l))throw to.create("not-registered");const c=l.authToken;if(!e&&q2(c))return l;if(c.requestStatus===1)return t=H2(n,e),l;{if(!navigator.onLine)throw to.create("app-offline");const d=K2(l);return t=$2(n,d),d}});return t?await t:r.authToken}async function H2(n,e){let t=await ZS(n.appConfig);for(;t.authToken.requestStatus===1;)await FA(100),t=await ZS(n.appConfig);const r=t.authToken;return r.requestStatus===0?Py(n,e):r}function ZS(n){return uf(n,e=>{if(!KA(e))throw to.create("not-registered");const t=e.authToken;return W2(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function $2(n,e){try{const t=await F2(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await Lh(n.appConfig,r),t}catch(t){if(LA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await qA(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Lh(n.appConfig,r)}throw t}}function KA(n){return n!==void 0&&n.registrationStatus===2}function q2(n){return n.requestStatus===2&&!Y2(n)}function Y2(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+E2}function K2(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function W2(n){return n.requestStatus===1&&n.requestTime+DA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q2(n){const e=n,{installationEntry:t,registrationPromise:r}=await Iy(e);return r?r.catch(console.error):Py(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X2(n,e=!1){const t=n;return await J2(t),(await Py(t,e)).token}async function J2(n){const{registrationPromise:e}=await Iy(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(n){if(!n||!n.options)throw Np("App Configuration");if(!n.name)throw Np("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Np(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Np(n){return to.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA="installations",ek="installations-internal",tk=n=>{const e=n.getProvider("app").getImmediate(),t=Z2(e),r=ma(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},nk=n=>{const e=n.getProvider("app").getImmediate(),t=ma(e,WA).getImmediate();return{getId:()=>Q2(t),getToken:a=>X2(t,a)}};function ik(){Xi(new Ui(WA,tk,"PUBLIC")),Xi(new Ui(ek,nk,"PRIVATE"))}ik();ri(xA,Ay);ri(xA,Ay,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh="analytics",rk="firebase_id",sk="origin",ak=60*1e3,ok="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Cy="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new zh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},_i=new ro("analytics","Analytics",lk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(n){if(!n.startsWith(Cy)){const e=_i.create("invalid-gtag-resource",{gtagURL:n});return si.warn(e.message),""}return n}function QA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function uk(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function dk(n,e){const t=uk("firebase-js-sdk-policy",{createScriptURL:ck}),r=document.createElement("script"),a=`${Cy}?l=${n}&id=${e}`;r.src=t?t==null?void 0:t.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function hk(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function fk(n,e,t,r,a,l){const c=r[a];try{if(c)await e[c];else{const h=(await QA(t)).find(m=>m.measurementId===a);h&&await e[h.appId]}}catch(d){si.error(d)}n("config",a,l)}async function mk(n,e,t,r,a){try{let l=[];if(a&&a.send_to){let c=a.send_to;Array.isArray(c)||(c=[c]);const d=await QA(t);for(const h of c){const m=d.find(_=>_.measurementId===h),g=m&&e[m.appId];if(g)l.push(g);else{l=[];break}}}l.length===0&&(l=Object.values(e)),await Promise.all(l),n("event",r,a||{})}catch(l){si.error(l)}}function pk(n,e,t,r){async function a(l,...c){try{if(l==="event"){const[d,h]=c;await mk(n,e,t,d,h)}else if(l==="config"){const[d,h]=c;await fk(n,e,t,r,d,h)}else if(l==="consent"){const[d,h]=c;n("consent",d,h)}else if(l==="get"){const[d,h,m]=c;n("get",d,h,m)}else if(l==="set"){const[d]=c;n("set",d)}else n(l,...c)}catch(d){si.error(d)}}return a}function gk(n,e,t,r,a){let l=function(...c){window[r].push(arguments)};return window[a]&&typeof window[a]=="function"&&(l=window[a]),window[a]=pk(l,n,e,t),{gtagCore:l,wrappedGtag:window[a]}}function yk(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Cy)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=30,vk=1e3;class Ek{constructor(e={},t=vk){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const XA=new Ek;function Sk(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function wk(n){var e;const{appId:t,apiKey:r}=n,a={method:"GET",headers:Sk(r)},l=ok.replace("{app-id}",t),c=await fetch(l,a);if(c.status!==200&&c.status!==304){let d="";try{const h=await c.json();!((e=h.error)===null||e===void 0)&&e.message&&(d=h.error.message)}catch{}throw _i.create("config-fetch-failed",{httpStatus:c.status,responseMessage:d})}return c.json()}async function bk(n,e=XA,t){const{appId:r,apiKey:a,measurementId:l}=n.options;if(!r)throw _i.create("no-app-id");if(!a){if(l)return{measurementId:l,appId:r};throw _i.create("no-api-key")}const c=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new Rk;return setTimeout(async()=>{d.abort()},ak),JA({appId:r,apiKey:a,measurementId:l},c,d,e)}async function JA(n,{throttleEndTimeMillis:e,backoffCount:t},r,a=XA){var l;const{appId:c,measurementId:d}=n;try{await Tk(r,e)}catch(h){if(d)return si.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:c,measurementId:d};throw h}try{const h=await wk(n);return a.deleteThrottleMetadata(c),h}catch(h){const m=h;if(!Ak(m)){if(a.deleteThrottleMetadata(c),d)return si.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:c,measurementId:d};throw h}const g=Number((l=m==null?void 0:m.customData)===null||l===void 0?void 0:l.httpStatus)===503?fE(t,a.intervalMillis,_k):fE(t,a.intervalMillis),_={throttleEndTimeMillis:Date.now()+g,backoffCount:t+1};return a.setThrottleMetadata(c,_),si.debug(`Calling attemptFetch again in ${g} millis`),JA(n,_,r,a)}}function Tk(n,e){return new Promise((t,r)=>{const a=Math.max(e-Date.now(),0),l=setTimeout(t,a);n.addEventListener(()=>{clearTimeout(l),r(_i.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Ak(n){if(!(n instanceof Vi)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Rk{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Ik(n,e,t,r,a){if(a&&a.global){n("event",t,r);return}else{const l=await e,c=Object.assign(Object.assign({},r),{send_to:l});n("event",t,c)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pk(){if(Mw())try{await Lw()}catch(n){return si.warn(_i.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return si.warn(_i.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Ck(n,e,t,r,a,l,c){var d;const h=bk(n);h.then(T=>{t[T.measurementId]=T.appId,n.options.measurementId&&T.measurementId!==n.options.measurementId&&si.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${T.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(T=>si.error(T)),e.push(h);const m=Pk().then(T=>{if(T)return r.getId()}),[g,_]=await Promise.all([h,m]);yk(l)||dk(l,g.measurementId),a("js",new Date);const v=(d=c==null?void 0:c.config)!==null&&d!==void 0?d:{};return v[sk]="firebase",v.update=!0,_!=null&&(v[rk]=_),a("config",g.measurementId,v),g.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e){this.app=e}_delete(){return delete Fc[this.app.options.appId],Promise.resolve()}}let Fc={},ew=[];const tw={};let Op="dataLayer",Ok="gtag",nw,ZA,iw=!1;function xk(){const n=[];if(kw()&&n.push("This is a browser extension environment."),mP()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,a)=>`(${a+1}) ${r}`).join(" "),t=_i.create("invalid-analytics-context",{errorInfo:e});si.warn(t.message)}}function Dk(n,e,t){xk();const r=n.options.appId;if(!r)throw _i.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)si.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw _i.create("no-api-key");if(Fc[r]!=null)throw _i.create("already-exists",{id:r});if(!iw){hk(Op);const{wrappedGtag:l,gtagCore:c}=gk(Fc,ew,tw,Op,Ok);ZA=l,nw=c,iw=!0}return Fc[r]=Ck(n,ew,tw,e,nw,Op,t),new Nk(n)}function kk(n=Ag()){n=sn(n);const e=ma(n,Uh);return e.isInitialized()?e.getImmediate():Mk(n)}function Mk(n,e={}){const t=ma(n,Uh);if(t.isInitialized()){const a=t.getImmediate();if(ra(e,t.getOptions()))return a;throw _i.create("already-initialized")}return t.initialize({options:e})}function eR(n,e,t,r){n=sn(n),Ik(ZA,Fc[n.app.options.appId],e,t,r).catch(a=>si.error(a))}const rw="@firebase/analytics",sw="0.10.17";function Lk(){Xi(new Ui(Uh,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return Dk(r,a,t)},"PUBLIC")),Xi(new Ui("analytics-internal",n,"PRIVATE")),ri(rw,sw),ri(rw,sw,"esm2017");function n(e){try{const t=e.getProvider(Uh).getImmediate();return{logEvent:(r,a,l)=>eR(t,r,a,l)}}catch(t){throw _i.create("interop-component-reg-failed",{reason:t})}}}Lk();let gg=null,lh=!1;const Uk=n=>{try{if(!Ht){console.warn("[Analytics] Firebase no est habilitado");return}Ne.getPlatform()==="web"?(gg=kk(n),lh=!0,console.log("[Analytics]  Inicializado para Web")):(console.log("[Analytics]  En plataforma nativa, Analytics se maneja por el SDK nativo"),lh=!1)}catch(e){console.error("[Analytics]  Error inicializando:",e),lh=!1}},vi=(n,e)=>{try{if(!lh||!gg){console.log("[Analytics] Event (not tracked - web only):",n,e);return}eR(gg,n,e),console.log("[Analytics]  Event tracked:",n,e)}catch(t){console.error("[Analytics]  Error tracking event:",t)}},Vk=()=>{vi("app_open")},aw=n=>{vi("screen_view",{screen_name:n,screen_class:n})},jk=n=>{vi("game_start",{include_adult:n.includeAdult||!1,adult_only:n.adultOnly||!1,has_premium:n.hasPremium||!1})},zk=n=>{vi("game_end",{phrases_played:n.phrasesPlayed,duration_seconds:n.duration||0,include_adult:n.includeAdult||!1})},ow=n=>{vi("game_completion",{is_premium:n.isPremium,is_adult:n.isAdult})},lw=n=>{vi("ad_shown",{ad_type:n})},Bk=(n,e)=>{vi("begin_checkout",{product_id:n,product_type:e})},Hd=n=>{vi("purchase",{transaction_id:`${Date.now()}_${n.productId}`,value:n.price||0,currency:n.currency||"EUR",items:[{item_id:n.productId,item_name:n.productType,price:n.price||0}]})},Fk=n=>{vi("purchase_restored",{product_count:n})},Gk=()=>{vi("phrase_suggested")},Hk=()=>{vi("store_opened")},cw={banner:.15,interstitial:2.5,rewarded:4,fillRate:{banner:.85,interstitial:.75,rewarded:.8}},uw=async n=>{try{if(!Ht||!it){console.log("[RevenueAnalytics] Firebase no habilitado");return}const e=cw.fillRate[n],t=cw[n],r=t/1e3*e,a=new Date().toISOString().split("T")[0],l=localStorage.getItem("firebase_uid")||"anonymous",c=At(it,"analytics_revenue",a,"users",l);await da(c,{[`ads.${n}.impressions`]:ki(1),[`ads.${n}.revenue`]:ki(r),lastUpdate:Jc()},{merge:!0});const d=At(it,"analytics_revenue",a);await da(d,{[`ads.${n}.impressions`]:ki(1),[`ads.${n}.revenue`]:ki(r),totalAdRevenue:ki(r),lastUpdate:Jc()},{merge:!0}),vi("ad_impression_revenue",{ad_type:n,estimated_revenue_eur:r,ecpm:t,fill_rate:e}),console.log(`[RevenueAnalytics]  Ad revenue tracked: ${n} = ${r.toFixed(4)}`)}catch(e){console.error("[RevenueAnalytics]  Error tracking ad revenue:",e)}},$k=async n=>{try{if(!Ht||!it){console.log("[RevenueAnalytics] Firebase no habilitado");return}const e=new Date().toISOString().split("T")[0],t=localStorage.getItem("firebase_uid")||"anonymous",r=.3,a=n.price*(1-r),l=At(it,"analytics_revenue",e,"users",t);await da(l,{"purchases.transactions":ki(1),"purchases.grossRevenue":ki(n.price),"purchases.netRevenue":ki(a),lastUpdate:Jc()},{merge:!0});const c=At(it,"analytics_revenue",e);await da(c,{"purchases.transactions":ki(1),"purchases.grossRevenue":ki(n.price),"purchases.netRevenue":ki(a),totalPurchaseRevenue:ki(a),lastUpdate:Jc()},{merge:!0}),vi("purchase_revenue",{product_id:n.productId,product_type:n.productType,gross_revenue:n.price,net_revenue:a,currency:n.currency,google_play_commission:n.price*r}),console.log(`[RevenueAnalytics]  Purchase revenue tracked: ${n.productId} = ${a.toFixed(2)} (after 30% Google commission)`)}catch(e){console.error("[RevenueAnalytics]  Error tracking purchase revenue:",e)}};class qk{constructor(){ke(this,"config");ke(this,"isInitialized",!1);ke(this,"isInitializing",!1);ke(this,"initPromise",null);ke(this,"lastInterstitialTime",0);ke(this,"lastRewardedVideoTime",0);ke(this,"INTERSTITIAL_COOLDOWN",6e4);ke(this,"REWARDED_COOLDOWN",3e4);ke(this,"interstitialReady",!1);ke(this,"rewardedVideoReady",!1);ke(this,"TEST_REWARDED_ID","ca-app-pub-3940256099942544/5224354917");this.config={enabled:!0,interstitialId:"ca-app-pub-3940256099942544/1033173712",rewardedVideoId:"ca-app-pub-3940256099942544/5224354917",bannerId:"ca-app-pub-3940256099942544/6300978111",testMode:!0,interstitialCooldown:6e4,rewardedCooldown:3e4,showBanners:!0,showInterstitials:!0,showRewardedVideos:!0}}async loadAdMobConfig(){try{console.log("[AdService] Cargando configuracin de Firebase...");const e=await PA();this.config.enabled=e.enabled,this.config.interstitialId=e.interstitialId,this.config.rewardedVideoId=e.rewardedVideoId,this.config.bannerId=e.bannerId,this.config.testMode=e.testMode,this.config.interstitialCooldown=e.interstitialCooldown,this.config.rewardedCooldown=e.rewardedCooldown,this.config.showBanners=e.showBanners,this.config.showInterstitials=e.showInterstitials,this.config.showRewardedVideos=e.showRewardedVideos,this.INTERSTITIAL_COOLDOWN=e.interstitialCooldown,this.REWARDED_COOLDOWN=e.rewardedCooldown,console.log("[AdService]  Configuracin de AdMob cargada:",this.config),this.config.testMode&&(this.config.enabled=!0,this.config.showBanners=!0,this.config.showInterstitials=!0,this.config.showRewardedVideos=!0)}catch(e){console.warn("[AdService]  Error cargando configuracin de Firebase, usando valores por defecto:",e)}}async ensureInitialized(){return this.isInitialized?!0:this.isInitializing&&this.initPromise?this.initPromise:this.initialize()}async initialize(){return this.isInitializing&&this.initPromise?this.initPromise:this.isInitialized?!0:(this.isInitializing=!0,this.initPromise=(async()=>{console.log("[AdService] Iniciando inicializacin...");try{const e=Ne.getPlatform();if(console.log("[AdService] Platform detectada:",e),e==="web")return console.log("[AdService] Platform web - modo simulacin activado"),this.isInitialized=!0,!0;try{await this.loadAdMobConfig()}catch{console.warn("[AdService] Continuando sin configuracin de Firebase")}try{if(await Di.initialize({initializeForTesting:this.config.testMode}),e==="ios")try{await Di.requestTrackingAuthorization()}catch(r){console.warn("[AdService] Tracking authorization no disponible:",r)}console.log("[AdService]  AdMob iniciado correctamente")}catch(r){return console.error("[AdService]  Error iniciando AdMob:",r),this.isInitialized=!0,!1}return console.log("[AdService] Preparando anuncios..."),(await Promise.allSettled([this.prepareInterstitial(),this.prepareRewardedVideo()])).forEach((r,a)=>{const l=a===0?"Intersticial":"Video recompensado";r.status==="fulfilled"?console.log(`[AdService]  ${l} preparado`):console.warn(`[AdService]  ${l} no se pudo preparar:`,r.reason)}),this.isInitialized=!0,!0}catch(e){return console.error("[AdService]  Error crtico inicializando:",e),this.isInitialized=!0,!1}finally{this.isInitializing=!1,this.initPromise=null}})(),this.initPromise)}async prepareInterstitial(){try{const e={adId:this.config.testMode?"ca-app-pub-3940256099942544/1033173712":this.config.interstitialId,isTesting:this.config.testMode};await Di.prepareInterstitial(e),this.interstitialReady=!0}catch(e){throw console.warn("[AdService] Error preparando intersticial:",e),this.interstitialReady=!1,e}}async prepareRewardedVideo(){try{const e={adId:this.config.testMode?this.TEST_REWARDED_ID:this.config.rewardedVideoId,isTesting:this.config.testMode};await Di.prepareRewardVideoAd(e),this.rewardedVideoReady=!0}catch(e){throw console.warn("[AdService] Error preparando video recompensado:",e),this.rewardedVideoReady=!1,e}}async showEndGameInterstitial(e){console.log("[AdService]  Intentando mostrar intersticial fin de partida");try{if(!await this.ensureInitialized())return{success:!1,error:"Servicio no disponible"};const r=this.config.testMode===!0;return!this.config.enabled&&!r?{success:!1,error:"Anuncios deshabilitados"}:!this.config.showInterstitials&&!r?{success:!1,error:"Intersticiales deshabilitados"}:!(e!=null&&e.force)&&!this.canShowInterstitial()?{success:!1,error:"Intersticial en cooldown"}:Ne.getPlatform()==="web"?(await this.simulateWebAd("intersticial"),this.lastInterstitialTime=Date.now(),{success:!0}):(this.interstitialReady||await this.prepareInterstitial(),await Di.showInterstitial(),lw("interstitial"),uw("interstitial"),this.lastInterstitialTime=Date.now(),this.interstitialReady=!1,setTimeout(()=>this.prepareInterstitial().catch(console.warn),1e3),{success:!0})}catch(t){return console.error("[AdService]  Error mostrando intersticial:",t),{success:!1,error:String(t)}}}async showPremiumDemoRewardedVideo(){console.log("[AdService]  Intentando mostrar video recompensado");try{if(!await this.ensureInitialized())return{success:!1,error:"Servicio no disponible"};const t=this.config.testMode===!0;if(!this.config.enabled&&!t)return{success:!1,error:"Anuncios deshabilitados"};if(!this.config.showRewardedVideos&&!t)return{success:!1,error:"Videos recompensados deshabilitados"};if(!this.canShowRewardedVideo())return{success:!1,error:"Video en cooldown"};if(Ne.getPlatform()==="web")return await this.simulateWebAd("video recompensado"),this.lastRewardedVideoTime=Date.now(),{success:!0,rewarded:!0};this.rewardedVideoReady||await this.prepareRewardedVideo();const r=await Di.showRewardVideoAd();return lw("rewarded"),uw("rewarded"),this.lastRewardedVideoTime=Date.now(),this.rewardedVideoReady=!1,setTimeout(()=>this.prepareRewardedVideo().catch(console.warn),1e3),{success:!0,rewarded:r&&r.amount>0}}catch(e){return console.error("[AdService]  Error mostrando video recompensado:",e),{success:!1,error:String(e)}}}canShowInterstitial(){return this.config.testMode?!0:Date.now()-this.lastInterstitialTime>=this.INTERSTITIAL_COOLDOWN}canShowRewardedVideo(){return this.config.testMode?!0:Date.now()-this.lastRewardedVideoTime>=this.REWARDED_COOLDOWN}simulateWebAd(e){return new Promise(t=>{console.log(`[AdService]  Simulando ${e} en web (3s)...`),setTimeout(()=>{console.log(`[AdService]  ${e} simulado completado`),t()},3e3)})}async showBanner(){if(console.log("[AdService]  Intentando mostrar banner"),Ne.getPlatform()==="web"){console.log("[AdService] Banner no soportado en web");return}try{if(!await this.ensureInitialized())return;const t=this.config.testMode===!0;if(!this.config.enabled&&!t||!this.config.showBanners&&!t)return;const r={adId:this.config.testMode?this.config.bannerId:this.config.bannerId,adSize:mg.ADAPTIVE_BANNER,position:fg.BOTTOM_CENTER,margin:0,isTesting:this.config.testMode};await Di.showBanner(r),console.log("[AdService]  Banner mostrado")}catch(e){console.error("[AdService]  Error mostrando banner:",e)}}async hideBanner(){if(Ne.getPlatform()!=="web")try{await Di.hideBanner(),console.log("[AdService]  Banner ocultado")}catch(e){console.warn("[AdService] Error ocultando banner:",e)}}async removeBanner(){if(Ne.getPlatform()!=="web")try{await Di.removeBanner(),console.log("[AdService]  Banner eliminado")}catch(e){console.warn("[AdService] Error eliminando banner:",e)}}async retryLoadAdsAfterConnectionRestored(){if(!(Ne.getPlatform()==="web"||!await this.ensureInitialized())){try{await this.loadAdMobConfig()}catch{}try{(await Promise.allSettled([this.prepareInterstitial(),this.prepareRewardedVideo()])).forEach((a,l)=>{const c=l===0?"Intersticial":"Video recompensado";a.status==="fulfilled"?console.log(`[AdService]  ${c} preparado tras reconexin`):console.warn(`[AdService]  ${c} no se pudo preparar tras reconexin:`,a.reason)})}catch(r){console.warn("[AdService]  Error reintentando preparacin de anuncios:",r)}}}}const wr=new qk;var gt=(n=>(n.Home="HOME",n.Game="GAME",n.Store="STORE",n))(gt||{});const Qt=({children:n,variant:e="primary",size:t="normal",fullWidth:r=!1,shimmerVariant:a="default",className:l="",...c})=>{const[d,h]=ee.useState(!1),m=L=>{c.disabled||(h(!0),setTimeout(()=>h(!1),400),c.onClick&&c.onClick(L))},g="font-bold rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 flex items-center justify-center relative overflow-hidden",_={primary:"bg-gradient-to-r from-cyan-500 to-pink-500 text-white hover:opacity-90 hover:shadow-2xl shadow-lg shadow-cyan-500/20 disabled:opacity-50 disabled:cursor-not-allowed focus:ring-cyan-400 hover:scale-105 active:scale-95",secondary:"bg-slate-700 text-slate-200 hover:bg-slate-600 border border-slate-600 disabled:opacity-50 disabled:cursor-not-allowed focus:ring-slate-500 hover:scale-105 active:scale-95",custom:""},v={normal:"py-2 px-4 text-base",large:"py-3 px-6 text-lg"},T=r?"w-full":"w-auto",I=d?e==="primary"?"animate-button-press":"animate-button-press-secondary":"",A=!c.disabled&&!d&&e==="primary"?"button-idle-pulse button-idle-glow":"",C=`${g} ${_[e]} ${v[t]} ${T} ${I} ${A} ${l}`;return S.jsxs("button",{className:C,...c,onClick:m,children:[S.jsx("span",{className:"relative z-10",children:n}),e==="primary"&&!c.disabled&&S.jsx("span",{className:`absolute inset-0 ${a==="discount"?"shimmer-effect-discount opacity-20 hover:opacity-60":"shimmer-effect opacity-0 hover:opacity-100"} transition-opacity duration-500 pointer-events-none`})]})},Yk=er("Network",{web:()=>Wt(()=>import("./web-C3LzHR3F.js"),[]).then(n=>new n.NetworkWeb)}),Kk={BASE_URL:"/apps/yo-nunca/play/",DEV:!1,MODE:"web",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"pro"};class Wk{constructor(){ke(this,"OFFLINE_GAMES_PER_DAY",1);ke(this,"OFFLINE_PHRASES_LIMIT",15);ke(this,"PREMIUM_PHRASES_LIMIT",30);ke(this,"STORAGE_KEY","offline_game_data");ke(this,"CONNECTION_CACHE_KEY","connection_status_cache");ke(this,"CONNECTION_CHECK_INTERVAL",6e4);ke(this,"CONNECTION_CACHE_TTL",3e4);ke(this,"connectionCheckInterval",null);ke(this,"lastConnectionStatus",!0);ke(this,"onConnectionLostCallback",null);ke(this,"onConnectionRestoredCallback",null);ke(this,"connectionCache",null)}async canPlayOffline(e,t=!1,r){console.log("[OfflineService]  Verificando permiso para jugar offline..."),console.log("[OfflineService] Usuario con remove_ads?:",e),console.log("[OfflineService] Es continuacin?:",t);const a=(r==null?void 0:r.ownedPackIds)||[],l=Array.isArray(r==null?void 0:r.storeProducts)?r==null?void 0:r.storeProducts:[];let c=!1;if(l.length>0&&a.length>0)try{c=l.filter(_=>(_==null?void 0:_.grantsUnlimitedOffline)&&a.includes(_.productId)).length>0}catch(g){console.warn("[OfflineService]  Error evaluando grantsUnlimitedOffline:",g)}if(console.log("[OfflineService] Tiene offline ilimitado por pack?:",c),e||c)return console.log("[OfflineService]  Usuario con privilegios de offline ilimitado"),{allowed:!0,remaining:-1,phrasesLimit:c?this.PREMIUM_PHRASES_LIMIT:this.PREMIUM_PHRASES_LIMIT};if(await this.checkConnection(!0)&&!(r!=null&&r.forceRecalcUnlimited))return console.log("[OfflineService]  Tiene conexin - puede jugar online"),{allowed:!0,remaining:-1,phrasesLimit:this.PREMIUM_PHRASES_LIMIT};const h=this.getOfflineGameData();if(h.currentGameStarted&&!t)return console.log("[OfflineService]  Ya tiene una partida offline en curso (no es continuacin)"),{allowed:!1,remaining:0,reason:"Ya has agotado tu lmite de partidas offline por da. Compra el pack sin anuncios para poder jugar offline de forma ilimitada.",phrasesLimit:this.OFFLINE_PHRASES_LIMIT};if(h.currentGameStarted&&t)return console.log("[OfflineService]  Continuando partida offline existente"),{allowed:!0,remaining:this.OFFLINE_GAMES_PER_DAY-h.gamesPlayed,phrasesLimit:this.OFFLINE_PHRASES_LIMIT};const m=this.OFFLINE_GAMES_PER_DAY-h.gamesPlayed;return m>0?(console.log("[OfflineService]  Puede iniciar partida offline:",m,"restante(s)"),{allowed:!0,remaining:m,phrasesLimit:this.OFFLINE_PHRASES_LIMIT}):(console.log("[OfflineService]  Lmite de partidas offline alcanzado"),{allowed:!1,remaining:0,reason:"Ya usaste tu partida offline diaria. Vuelve maana o desbloquea el Pack Sin Anuncios.",phrasesLimit:this.OFFLINE_PHRASES_LIMIT})}markOfflineGameStarted(){console.log("[OfflineService]  Marcando partida offline como iniciada (anti-fraude)");const e=this.getOfflineGameData();e.currentGameStarted=!0,e.currentGameStartTime=Date.now(),e.currentGamePhrasesPlayed=0,this.saveOfflineGameData(e),console.log("[OfflineService]  Partida offline marcada - no puede reiniciar hasta completar")}incrementOfflinePhrasesPlayed(){const e=this.getOfflineGameData();if(!e.currentGameStarted){console.warn("[OfflineService]  No hay partida offline en curso");return}e.currentGamePhrasesPlayed++,this.saveOfflineGameData(e),console.log(`[OfflineService]  Frase offline jugada: ${e.currentGamePhrasesPlayed}/${this.OFFLINE_PHRASES_LIMIT}`)}markOfflineGameCompleted(){console.log("[OfflineService]  Marcando partida offline como completada");const e=this.getOfflineGameData();e.gamesPlayed=1,e.currentGameStarted=!1,e.currentGameStartTime=0,e.currentGamePhrasesPlayed=0,this.saveOfflineGameData(e),console.log("[OfflineService]  Partida offline completada - no puede jugar ms hasta maana")}hasActiveOfflineGame(){return this.getOfflineGameData().currentGameStarted}getOfflineGameProgress(){return{current:this.getOfflineGameData().currentGamePhrasesPlayed,total:this.OFFLINE_PHRASES_LIMIT}}isOfflineGameLimitReached(){return this.getOfflineGameData().currentGamePhrasesPlayed>=this.OFFLINE_PHRASES_LIMIT}async checkConnection(e=!1){try{const t=typeof import.meta<"u"&&Kk&&!1;if(!e&&this.connectionCache){const l=Date.now()-this.connectionCache.timestamp;if(l<this.CONNECTION_CACHE_TTL)return console.log(`[OfflineService]  Usando cache de conexin (${l}ms): ${this.connectionCache.connected}`),this.connectionCache.connected}console.log("[OfflineService]  Verificando conexin a internet (check real)...");const r=await Yk.getStatus();if(console.log("[OfflineService]  Estado de red del dispositivo:",{connected:r.connected,connectionType:r.connectionType}),!r.connected)return console.log("[OfflineService]  Sin conexin de red (dispositivo)"),this.updateConnectionCache(!1,"network"),!1;const a=await this.verifyRealConnection();return console.log("[OfflineService]  Verificacin real:",a?" OK":" FAIL"),this.updateConnectionCache(a,"fetch"),a}catch(t){return console.error("[OfflineService] Error verificando conexin:",t),this.updateConnectionCache(!1,"error"),!1}}async verifyRealConnection(){const e=["https://www.gstatic.com/generate_204","https://www.google.com/favicon.ico","https://1.1.1.1"],t=e.map(r=>this.fetchWithTimeout(r,4e3).then(()=>!0).catch(()=>!1));try{const a=(await Promise.all(t)).filter(c=>c).length,l=a>=2;return console.log("[OfflineService]  Endpoints OK:",a,"/",e.length),l}catch(r){return console.error("[OfflineService] Error en verificacin mltiple:",r),!1}}async fetchWithTimeout(e,t){const r=new AbortController,a=setTimeout(()=>r.abort(),t);try{const l=await fetch(e,{method:"HEAD",signal:r.signal,cache:"no-cache",mode:"no-cors"});return clearTimeout(a),l}catch(l){throw clearTimeout(a),l}}updateConnectionCache(e,t){this.connectionCache={connected:e,timestamp:Date.now(),method:t};try{localStorage.setItem(this.CONNECTION_CACHE_KEY,JSON.stringify(this.connectionCache))}catch{console.warn("[OfflineService] No se pudo guardar cache de conexin")}}startConnectionMonitoring(e,t){console.log("[OfflineService]  Iniciando monitoreo de conexin (cada 60s)"),this.onConnectionLostCallback=e,this.onConnectionRestoredCallback=t||null,this.stopConnectionMonitoring(),this.checkConnection(!0).then(r=>{this.lastConnectionStatus=r,console.log("[OfflineService] Estado inicial de conexin:",r?" Online":" Offline")}),this.connectionCheckInterval=setInterval(async()=>{var a,l;const r=await this.checkConnection(!0);this.lastConnectionStatus&&!r?(console.log("[OfflineService]  CONEXIN PERDIDA - Notificando..."),(a=this.onConnectionLostCallback)==null||a.call(this)):!this.lastConnectionStatus&&r&&(console.log("[OfflineService]  CONEXIN RESTAURADA - Notificando..."),(l=this.onConnectionRestoredCallback)==null||l.call(this)),this.lastConnectionStatus=r},this.CONNECTION_CHECK_INTERVAL),console.log("[OfflineService]  Monitoreo de conexin iniciado")}stopConnectionMonitoring(){this.connectionCheckInterval&&(console.log("[OfflineService]  Deteniendo monitoreo de conexin"),clearInterval(this.connectionCheckInterval),this.connectionCheckInterval=null)}getOfflineGameData(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(!e)return this.createFreshData();const t=JSON.parse(e),r=this.getTodayString(),a=new Date(t.date),l=new Date(r);return a>l?(console.warn("[OfflineService]  Fecha futura detectada - resetando (anti-fraude)"),this.createFreshData()):t.date!==r?(console.log("[OfflineService]  Nuevo da detectado - resetando lmites"),t.currentGameStarted&&console.log("[OfflineService]  Partida offline incompleta detectada - marcando como usada (anti-fraude)"),this.createFreshData()):t}catch(e){return console.error("[OfflineService] Error leyendo datos offline:",e),this.createFreshData()}}saveOfflineGameData(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e)),console.log("[OfflineService]  Datos guardados:",e)}catch(t){console.error("[OfflineService] Error guardando datos offline:",t)}}createFreshData(){return{date:this.getTodayString(),gamesPlayed:0,currentGameStarted:!1,currentGameStartTime:0,currentGamePhrasesPlayed:0}}getTodayString(){return new Date().toISOString().split("T")[0]}clearOfflineData(){console.log("[OfflineService]  Limpiando datos offline"),localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.CONNECTION_CACHE_KEY),this.connectionCache=null}getOfflineStats(){const e=this.getOfflineGameData();return{gamesPlayedToday:e.gamesPlayed,remainingGames:Math.max(0,this.OFFLINE_GAMES_PER_DAY-e.gamesPlayed),hasActiveGame:e.currentGameStarted,currentGameProgress:{current:e.currentGamePhrasesPlayed,total:this.OFFLINE_PHRASES_LIMIT}}}}const Dt=new Wk,br=({children:n,onClose:e,isVisible:t=!0})=>t?S.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fadeIn",onClick:e,children:S.jsx("div",{className:"w-full max-w-md animate-scaleUp",onClick:r=>r.stopPropagation(),children:n})}):null;function Qk({title:n,titleId:e,...t},r){return ee.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?ee.createElement("title",{id:e},n):null,ee.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const Xk=ee.forwardRef(Qk);function Jk({title:n,titleId:e,...t},r){return ee.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?ee.createElement("title",{id:e},n):null,ee.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const Zk=ee.forwardRef(Jk);function eM({title:n,titleId:e,...t},r){return ee.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?ee.createElement("title",{id:e},n):null,ee.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0"}))}const tM=ee.forwardRef(eM);function nM({title:n,titleId:e,...t},r){return ee.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?ee.createElement("title",{id:e},n):null,ee.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const iM=ee.forwardRef(nM);function rM({title:n,titleId:e,...t},r){return ee.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?ee.createElement("title",{id:e},n):null,ee.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const sM=ee.forwardRef(rM),tR=({isOpen:n,onStartOfflineGame:e,onConnectionRestored:t,onClose:r,hasRemoveAds:a})=>{const[l,c]=ee.useState(!1),[d,h]=ee.useState(!0),[m,g]=ee.useState("");wg.useEffect(()=>{n&&!a&&_()},[n,a]);const _=async()=>{const I=await Dt.canPlayOffline(a);h(I.allowed),g(I.reason||"")},v=async()=>{c(!0);try{if(await Dt.checkConnection(!0)){console.log("[OfflineLimitModal]  Conexin restaurada");try{console.log("[OfflineLimitModal]  Recargando anuncios tras recuperar conexin..."),await wr.retryLoadAdsAfterConnectionRestored()}catch(A){console.warn("[OfflineLimitModal]  Error recargando anuncios:",A)}t()}else console.log("[OfflineLimitModal]  An sin conexin"),alert("An no hay conexin a internet. Por favor, verifica tu WiFi o datos mviles.")}catch(I){console.error("[OfflineLimitModal] Error verificando conexin:",I),alert("Error verificando conexin. Intenta nuevamente.")}finally{c(!1)}},T=()=>{if(!d){alert(m||"No puedes iniciar partida offline");return}e()};return S.jsx(br,{isVisible:n,onClose:r,children:S.jsxs("div",{className:"bg-gray-900 rounded-2xl p-4 md:p-8 shadow-xl flex flex-col items-center max-w-[95vw] w-full sm:w-[400px] mx-auto",children:[S.jsxs("div",{className:"flex flex-col items-center w-full border-b border-gray-700 pb-4 mb-2",children:[S.jsx("div",{className:"text-5xl mb-1",children:""}),S.jsx("h2",{className:"text-2xl font-bold text-white",children:"Sin Conexin a Internet"})]}),S.jsxs("div",{className:"text-center space-y-2 w-full",children:[S.jsx("p",{className:"text-lg text-gray-200 font-medium",children:"Perdiste la conexin a internet"}),S.jsx("p",{className:"text-sm text-gray-400",children:a?"Con tu Pack Sin Anuncios puedes seguir jugando offline.":"Puedes conectarte nuevamente o iniciar tu partida offline diaria."})]}),!a&&S.jsxs("div",{className:"bg-purple-900/30 border border-purple-500/50 rounded-lg p-2 w-full mt-4 flex flex-col items-center",children:[S.jsx("div",{className:"flex items-center justify-center mb-1 w-full",children:S.jsx("h3",{className:"font-bold text-purple-200 text-base text-center",children:"Partida Offline Diaria"})}),S.jsxs("ul",{className:"text-sm text-purple-300 space-y-1 text-center",children:[S.jsx("li",{children:" Mximo 15 frases por da"}),S.jsx("li",{children:" 1 partida offline gratis al da"}),S.jsx("li",{children:" Se renueva cada 24 horas"})]})]}),!a&&!d&&S.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-3 w-full mt-3 flex items-center gap-3",children:[S.jsx(sM,{className:"h-7 w-7 text-red-300 flex-shrink-0","aria-hidden":"true"}),S.jsxs("div",{className:"flex-1",children:[S.jsx("h3",{className:"font-bold text-red-200 mb-1",children:"Lmite Alcanzado"}),S.jsx("p",{className:"text-sm text-red-300",children:m})]})]}),S.jsxs("div",{className:"flex flex-col gap-3 w-full mt-6",children:[S.jsx(Qt,{onClick:v,disabled:l,className:"w-full flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-base py-3",children:l?S.jsxs(S.Fragment,{children:[S.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-white",viewBox:"0 0 24 24",children:[S.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),S.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Verificando conexin..."]}):S.jsxs(S.Fragment,{children:[S.jsx(iM,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Vuelvo a tener conexin"]})}),!a&&d&&S.jsxs(Qt,{onClick:T,className:"w-full flex items-center justify-center bg-purple-600 hover:bg-purple-700 text-base py-3",children:[S.jsx(Zk,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Iniciar Partida Offline (15 frases)"]}),a&&S.jsxs(Qt,{onClick:T,className:"w-full flex items-center justify-center bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-base py-3",children:[S.jsx(tM,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Continuar en Modo Offline Premium"]}),S.jsxs(Qt,{onClick:r,className:"w-full flex items-center justify-center bg-gray-700 hover:bg-gray-600 text-base py-3",children:[S.jsx(Xk,{className:"h-5 w-5 mr-2 text-white","aria-hidden":"true"}),"Volver"]})]}),!a&&S.jsxs("div",{className:"bg-gradient-to-r from-yellow-900/40 to-orange-900/40 border border-yellow-500/50 rounded-lg p-3 mt-5 w-full flex flex-col items-center",children:[S.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[S.jsx("span",{className:"text-2xl",role:"img","aria-label":"trophy",children:""}),S.jsx("span",{className:"font-bold text-yellow-200 text-base",children:"Juegas sin internet frecuentemente?"})]}),S.jsxs("p",{className:"text-sm text-yellow-300 text-center mb-1",children:["Con ",S.jsx("span",{className:"font-semibold text-yellow-100",children:"Pack Sin Anuncios"})," puedes jugar ",S.jsx("span",{className:"font-semibold text-yellow-100",children:"partidas completas ilimitadas"})," sin conexin."]}),S.jsxs("div",{className:"text-xs text-yellow-400 text-center flex flex-wrap gap-x-2 gap-y-1 justify-center",children:[S.jsx("span",{children:" 30 frases por partida"}),S.jsx("span",{children:" Sin lmite de partidas"}),S.jsx("span",{children:" Sin anuncios"})]})]})]})})},aM=({isActive:n,onComplete:e})=>{const[t,r]=ee.useState(!1);return ee.useEffect(()=>{if(n){r(!0);const a=setTimeout(()=>{r(!1),e==null||e()},1e3);return()=>clearTimeout(a)}},[n,e]),t?S.jsx("div",{className:"fire-transition-overlay",children:S.jsx("div",{className:"fire-emoji",children:""})}):null},Ny=er("Browser",{web:()=>Wt(()=>import("./web-Bzu5J7ZU.js"),[]).then(n=>new n.BrowserWeb)}),oM=()=>{const n="https://play.google.com/store/apps/details?id=com.mrodr.yonunca",e=async()=>{try{await Ny.open({url:n})}catch(t){console.error("[GooglePlayModal] Error abriendo Play Store:",t),window.open(n,"_blank")}};return S.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-80 z-50 p-4",children:S.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black rounded-2xl shadow-2xl max-w-sm w-full p-6 border-2 border-purple-500 text-center",children:[S.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Juego disponible en Google Play"}),S.jsx("div",{onClick:e,className:"cursor-pointer my-6",children:S.jsx("i",{className:"fab fa-google-play text-8xl text-green-400 hover:text-green-500 transition-colors"})})]})})},dw="yo_nunca_device_id",hw="yo_nunca_firebase_uid",fw=()=>{const n=Ne.getPlatform(),e=Ne.isNativePlatform(),t=[];t.push(n),t.push(e?"native":"web"),typeof window<"u"&&window.screen&&(t.push(`${window.screen.width}x${window.screen.height}`),t.push(`${window.screen.colorDepth}`),t.push(`${window.devicePixelRatio||1}`)),typeof navigator<"u"&&(t.push(navigator.userAgent),t.push(navigator.language||"es"),t.push(`${navigator.hardwareConcurrency||0}`));try{t.push(Intl.DateTimeFormat().resolvedOptions().timeZone)}catch{t.push("UTC")}const r=t.join("|");return lM(r)},lM=n=>{let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return Math.abs(e).toString(36)},Oy=()=>{try{const n=localStorage.getItem(dw);if(n)return console.log("[DeviceService]  Device ID encontrado en storage:",n),n;const e=fw();return console.log("[DeviceService]  Nuevo Device ID generado:",e),localStorage.setItem(dw,e),e}catch(n){return console.error("[DeviceService]  Error obteniendo Device ID:",n),fw()}},cM=()=>{try{const n=Oy(),e=`${hw}_${n}`;let t=localStorage.getItem(e);return t||(t=localStorage.getItem(hw)),t?console.log("[DeviceService]  Firebase UID encontrado para dispositivo:",t):console.log("[DeviceService]  No hay Firebase UID guardado para este dispositivo"),t}catch(n){return console.error("[DeviceService]  Error obteniendo Firebase UID:",n),null}},uM=()=>({platform:Ne.getPlatform(),isNative:Ne.isNativePlatform(),deviceId:Oy(),storedFirebaseUid:cM(),screen:typeof window<"u"&&window.screen?{width:window.screen.width,height:window.screen.height,colorDepth:window.screen.colorDepth,pixelRatio:window.devicePixelRatio}:null,userAgent:typeof navigator<"u"?navigator.userAgent:"unknown"}),dM=()=>{if(Ne.isNativePlatform())return!1;const n=navigator.userAgent||navigator.vendor||window.opera,e=/android/i.test(n);return console.log(`[DeviceService] User Agent: ${n}`),console.log(`[DeviceService] Is Android: ${e}`),e},hM=({navigate:n,onSuggestClick:e,onStartGame:t,disablePlay:r,disableStore:a,disableShare:l,disableAdultMode:c,welcomeMessage:d="Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos.",hasPremium:h=!1,hasRemoveAds:m=!1,ownedPackIds:g=[],playStoreUrl:_="https://play.google.com/store/apps/details?id=com.mrodr.yonunca",appStoreUrl:v="https://tiendaapple.com"})=>{const[T,I]=ee.useState(!1),[A,C]=ee.useState(!1),[L,x]=ee.useState(null),[U,z]=ee.useState(!1),[$,se]=ee.useState(!1),[D,P]=ee.useState(!1),[N,M]=ee.useState(!1),[B,G]=ee.useState(!1),[k,Ve]=ee.useState(!1),[et,te]=ee.useState(!1),[he,Ie]=ee.useState(!1),[je,Ke]=ee.useState(!1),j=Ne.getPlatform(),K=j==="web",ue=(()=>{if(!K)return!1;try{const Je=navigator.userAgent||"";return/iPad|iPhone|iPod/i.test(Je)||Je.includes("Mac")&&typeof document<"u"&&"ontouchend"in document}catch{return!1}})(),pe=(()=>{var Je,Rt;if(!K)return!1;try{const ot=navigator;return(ot==null?void 0:ot.standalone)===!0||typeof window<"u"&&((Rt=(Je=window.matchMedia)==null?void 0:Je.call(window,"(display-mode: standalone)"))==null?void 0:Rt.matches)===!0}catch{return!1}})();wg.useEffect(()=>{dM()&&Ke(!0)},[]);const Pe=async(Je,Rt)=>{console.log("[HomeScreen]  Intentando iniciar partida...",{includeAdult:Je,adultOnly:Rt}),z(!0);try{if(await Dt.checkConnection(!0)){if(console.log("[HomeScreen]  Conexin disponible - iniciando partida online"),Rt){Ve(!0),G(!0),se(!0),console.log("[HomeScreen]  Precargando frases durante animacin del fuego...");const Xt=Date.now(),Re=(async()=>{try{const{fetchPhrases:De}=await Wt(async()=>{const{fetchPhrases:He}=await Promise.resolve().then(()=>Ki);return{fetchPhrases:He}},void 0),{updatePhraseCache:Ee}=await Wt(async()=>{const{updatePhraseCache:He}=await Promise.resolve().then(()=>Ki);return{updatePhraseCache:He}},void 0);console.log("[HomeScreen]  Actualizando cach con packs:",g),await Ee(!1,g),console.log("[HomeScreen]  Obteniendo frases del cach...");const Te=await De(h||!1,!0,g),be=Te.filter(He=>He.isAdult),Ue=Date.now()-Xt;return console.log("[HomeScreen]  Precarga completada:",{totalPhrases:Te.length,adultPhrases:be.length,timeMs:Ue}),be.length>0}catch(De){return console.error("[HomeScreen]  Error precargando frases:",De),!1}})(),[oe]=await Promise.all([Re,new Promise(De=>setTimeout(De,1200))]);oe?console.log("[HomeScreen]  Frases listas, navegando a juego..."):console.warn("[HomeScreen]  No hay frases +18, navegando igualmente..."),t(Je,Rt),n(gt.Game),setTimeout(()=>{se(!1),Ve(!1)},100)}else se(!0),await new Promise(Xt=>setTimeout(Xt,400)),t(Je,Rt),n(gt.Game),setTimeout(()=>se(!1),500);return}console.log("[HomeScreen]  Sin conexin - verificando lmite offline");const Ft=await Dt.canPlayOffline(m);x({includeAdult:Je,adultOnly:Rt}),C(!0)}catch(ot){console.error("[HomeScreen] Error verificando conexin:",ot),alert("Error verificando conexin. Intenta nuevamente.")}finally{z(!1)}},ze=()=>{L&&(console.log("[HomeScreen]  Iniciando partida offline..."),Dt.markOfflineGameStarted(),console.log("[HomeScreen]  Partida offline marcada como iniciada (anti-fraude)"),L.adultOnly?(Ve(!0),G(!0),se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(gt.Game),setTimeout(()=>{se(!1),Ve(!1)},100)},1200)):(se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(gt.Game),setTimeout(()=>se(!1),500)},400)))},tt=async()=>{if(!L)return;console.log("[HomeScreen]  Usuario confirm conexin, verificando..."),await Dt.checkConnection(!0)?(console.log("[HomeScreen]  Conexin restaurada - iniciando partida online"),L.adultOnly?(Ve(!0),G(!0),se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(gt.Game),setTimeout(()=>{se(!1),Ve(!1)},100)},1200)):(se(!0),setTimeout(async()=>{t(L.includeAdult,L.adultOnly),C(!1),x(null),n(gt.Game),setTimeout(()=>se(!1),500)},400))):(console.log("[HomeScreen]  An sin conexin"),alert("An no hay conexin a internet. Verifica tu WiFi o datos mviles e intenta nuevamente."))},Mt=async Je=>{var Rt;try{if((Rt=navigator.clipboard)!=null&&Rt.writeText)return await navigator.clipboard.writeText(Je),!0}catch{}try{const ot=document.createElement("textarea");ot.value=Je,ot.setAttribute("readonly",""),ot.style.position="fixed",ot.style.top="0",ot.style.left="0",ot.style.opacity="0",document.body.appendChild(ot),ot.select();const Ft=document.execCommand("copy");return document.body.removeChild(ot),Ft}catch{return!1}},vt=async()=>{var Rt,ot;if(K){try{const Ft=((ot=(Rt=import.meta)==null?void 0:Rt.env)==null?void 0:ot.BASE_URL)||"/games/yo-nunca/play/",Xt=new URL(Ft,window.location.origin).toString();await Mt(Xt)&&(I(!0),setTimeout(()=>I(!1),2e3))}catch(Ft){console.error("No se pudo copiar al portapapeles",Ft)}return}const Je=j==="ios"?v:_;if(navigator.share)try{await navigator.share({title:"Yo Nunca",text:"Descarga Yo Nunca y juega con tus amigos!",url:Je});return}catch(Ft){console.error("Error compartiendo la app:",Ft)}try{await Mt(Je)&&(I(!0),setTimeout(()=>I(!1),2e3))}catch(Ft){console.error("No se pudo copiar al portapapeles",Ft)}};return S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"fixed inset-0 pointer-events-none select-none overflow-hidden","aria-hidden":"true",style:{zIndex:-1},children:[S.jsx("div",{className:"absolute -top-16 -left-20 w-80 h-80 bg-cyan-500/35 rounded-full blur-2xl animate-float-background opacity-50"}),S.jsx("div",{className:"absolute -bottom-20 -right-16 w-96 h-96 bg-red-500/35 rounded-full blur-2xl animate-float-background-reverse opacity-50"}),S.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[28rem] h-[28rem] bg-purple-500/30 rounded-full blur-2xl animate-float-background opacity-45",style:{animationDelay:"2s"}}),S.jsx("div",{className:"absolute top-1/4 -right-10 w-72 h-72 bg-blue-500/30 rounded-full blur-2xl animate-float-background opacity-45",style:{animationDelay:"4s"}}),S.jsx("div",{className:"absolute -bottom-10 left-1/4 w-80 h-80 bg-pink-500/30 rounded-full blur-2xl animate-float-background-reverse opacity-45",style:{animationDelay:"6s"}}),S.jsx("div",{className:"absolute top-1/6 left-1/3 w-64 h-64 bg-emerald-500/25 rounded-full blur-2xl animate-float-background opacity-40",style:{animationDelay:"1s"}}),S.jsx("div",{className:"absolute bottom-1/3 right-1/3 w-72 h-72 bg-orange-500/25 rounded-full blur-2xl animate-float-background-reverse opacity-40",style:{animationDelay:"3s"}}),S.jsx("div",{className:"absolute top-3/4 left-1/6 w-56 h-56 bg-indigo-500/25 rounded-full blur-2xl animate-float-background opacity-40",style:{animationDelay:"5s"}}),S.jsx("div",{className:"absolute top-1/5 right-1/4 w-60 h-60 bg-rose-500/25 rounded-full blur-2xl animate-float-background-reverse opacity-40",style:{animationDelay:"7s"}})]}),S.jsxs("div",{className:`relative overflow-hidden flex flex-col items-center justify-center min-h-screen w-full text-center p-4 ${$&&!k?"animate-fade-out-scale":k?"screen-slide-out":""}`,children:[S.jsx("h1",{className:"text-6xl md:text-7xl font-bold title-shimmer mb-4 drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]",children:"Yo Nunca"}),S.jsx("p",{className:"text-slate-300 mb-8 text-base md:text-lg max-w-xl px-4",children:d}),S.jsxs("div",{className:"w-full max-w-xs space-y-4 relative z-10",children:[S.jsx("div",{className:"main-play-button",children:S.jsx(Qt,{onClick:()=>Pe(!c,!1),fullWidth:!0,size:"large",disabled:r||U,children:U?S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Verificando conexin..."]}):S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-play mr-2"}),"Iniciar Partida"]})})}),!c&&S.jsxs("button",{onClick:()=>{!r&&!U&&(P(!0),M(!0),setTimeout(()=>P(!1),400),setTimeout(()=>M(!1),800),Pe(!0,!0))},disabled:r||U,className:`w-full flex items-center justify-center gap-1 py-3 rounded-lg font-bold text-base transition-all relative overflow-hidden ${r||U?"bg-slate-700 text-slate-500 cursor-not-allowed":"bg-gradient-to-r from-red-500 to-pink-600 text-white shadow-lg shadow-pink-500/30 hover:shadow-pink-500/50 hover:shadow-2xl hover:scale-105 active:scale-95 fire-button-idle"} ${D?"animate-button-press":""}`,children:[S.jsx("span",{className:"relative z-10",children:U?S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"Verificando..."]}):S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-fire mr-1"}),"Solo +18"]})}),!r&&!U&&S.jsx("span",{className:"absolute inset-0 shimmer-effect opacity-0 hover:opacity-100 transition-opacity duration-500"}),N&&S.jsx("span",{className:"fire-swipe-effect"})]}),S.jsxs(Qt,{onClick:()=>n(gt.Store),variant:"secondary",fullWidth:!0,disabled:a,children:[S.jsx("i",{className:"fas fa-store mr-2"}),"Tienda"]}),!l&&S.jsx(Qt,{onClick:vt,variant:"secondary",fullWidth:!0,children:T?"Enlace copiado!":K?"Compartir":"Compartir App"}),!l&&ue&&!pe&&S.jsxs(Qt,{onClick:()=>Ie(!0),variant:"secondary",fullWidth:!0,children:[S.jsx("i",{className:"fas fa-plus-square mr-2"}),"Aadir al escritorio"]})]}),S.jsxs("button",{onClick:()=>te(!0),className:"mt-6 text-slate-400 hover:text-cyan-400 transition-colors text-sm flex items-center justify-center gap-1 relative z-10",children:[S.jsx("i",{className:"fas fa-question-circle text-xs"}),"Cmo jugar?"]}),S.jsx(tR,{isOpen:A,onStartOfflineGame:ze,onConnectionRestored:tt,onClose:()=>{C(!1),x(null)},hasRemoveAds:m}),et&&S.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 ",onClick:()=>te(!1),children:S.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 max-w-lg w-full border-2 border-cyan-500/30 shadow-2xl shadow-cyan-500/20 animate-pop-in max-h-[90vh] overflow-y-auto",onClick:Je=>Je.stopPropagation(),children:[S.jsxs("div",{className:"flex items-center justify-between mb-4",children:[S.jsxs("h2",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-pink-500",children:[S.jsx("i",{className:"fas fa-question-circle mr-2"}),"Cmo jugar?"]}),S.jsx("button",{onClick:()=>te(!1),className:"text-slate-400 hover:text-white transition-colors text-2xl",children:S.jsx("i",{className:"fas fa-times"})})]}),S.jsxs("div",{className:"space-y-4 text-slate-300",children:[S.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-cyan-500/20",children:[S.jsxs("h3",{className:"font-bold text-cyan-400 mb-2 flex items-center",children:[S.jsx("i",{className:"fas fa-gamepad mr-2"}),"Reglas Bsicas"]}),S.jsx("p",{className:"text-sm leading-relaxed",children:'"Yo Nunca" es un juego de preguntas donde los jugadores descubren experiencias que han vivido. El juego mostrar frases que comienzan con "Yo nunca..." y los jugadores deben indicar si han hecho o no esa accin.'})]}),S.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-pink-500/20",children:[S.jsxs("h3",{className:"font-bold text-pink-400 mb-2 flex items-center",children:[S.jsx("i",{className:"fas fa-play-circle mr-2"}),"Cmo se Juega"]}),S.jsxs("ul",{className:"text-sm space-y-2",children:[S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Lee la frase:"}),' Aparecer una frase como "Yo nunca he viajado en avin"']})]}),S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Pulsa el botn:"})," Toca la pantalla para ver la siguiente frase"]})]}),S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Los jugadores responden:"})," Quien S haya hecho esa accin bebe o pierde un punto"]})]}),S.jsxs("li",{className:"flex items-start",children:[S.jsx("i",{className:"fas fa-check text-green-400 mr-2 mt-1"}),S.jsxs("span",{children:[S.jsx("strong",{children:"Contina:"})," Sigue con ms frases y divirtete conociendo a tus amigos"]})]})]})]}),S.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-purple-500/20",children:[S.jsxs("h3",{className:"font-bold text-purple-400 mb-2 flex items-center",children:[S.jsx("i",{className:"fas fa-fire mr-2"}),"Modo +18"]}),S.jsx("p",{className:"text-sm leading-relaxed",children:"El modo +18 incluye frases ms atrevidas y picantes para jugadores adultos. Este modo es solo para mayores de 18 aos y ambientes apropiados."})]})]}),S.jsx("div",{className:"mt-6",children:S.jsxs(Qt,{onClick:()=>te(!1),fullWidth:!0,variant:"primary",children:[S.jsx("i",{className:"fas fa-check mr-2"}),"Entendido!"]})})]})}),he&&S.jsx(br,{onClose:()=>Ie(!1),children:S.jsxs("div",{className:"bg-slate-900/95 border border-slate-700 rounded-xl p-6 shadow-2xl",children:[S.jsxs("div",{className:"text-center mb-5",children:[S.jsx("div",{className:"text-3xl mb-2 text-cyan-400",children:S.jsx("i",{className:"fas fa-mobile-alt"})}),S.jsx("h2",{className:"text-xl font-bold text-white",children:"Aadir al escritorio"}),S.jsx("p",{className:"text-slate-300 text-sm mt-2",children:"Para instalar esta web como app en iPhone/iPad:"})]}),S.jsxs("ol",{className:"text-left text-slate-200 text-sm space-y-2 mb-6",children:[S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-cyan-400 font-bold",children:"1."}),S.jsxs("span",{children:["Abre el men de compartir de Safari (",S.jsx("i",{className:"fas fa-share-square"}),")."]})]}),S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-cyan-400 font-bold",children:"2."}),S.jsx("span",{children:"Selecciona Aadir a pantalla de inicio."})]}),S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-cyan-400 font-bold",children:"3."}),S.jsx("span",{children:"Pulsa Aadir."})]})]}),S.jsxs(Qt,{onClick:()=>Ie(!1),fullWidth:!0,variant:"primary",children:[S.jsx("i",{className:"fas fa-check mr-2"}),"Entendido"]})]})}),je&&S.jsx(oM,{})]}),S.jsx(aM,{isActive:B,onComplete:()=>G(!1)})]})};class fM{constructor(){ke(this,"PHRASES_PER_PARTIDA",30);ke(this,"SESSION_STORAGE_BASE_KEY","game_session");ke(this,"currentSession",null);ke(this,"phrases",[]);ke(this,"phraseCounters",{totalPremiumPhrases:0,totalDemoPhrases:0,totalFreePhrases:0,isLoaded:!1})}async loadPhraseCounters(){try{console.log("[GameSession] Cargando contadores de frases...");const e=await OA.getCounters();this.phraseCounters={totalPremiumPhrases:e.totalPremiumPhrases,totalDemoPhrases:e.totalDemoPhrases,totalFreePhrases:e.totalFreePhrases,isLoaded:!0},console.log("[GameSession] Contadores cargados:",this.phraseCounters)}catch(e){console.error("[GameSession]  Error cargando contadores:",e),console.warn("[GameSession]  Usando valores de fallback"),this.phraseCounters={totalPremiumPhrases:161,totalDemoPhrases:26,totalFreePhrases:100,isLoaded:!1},console.log("[GameSession] Fallback aplicado:",this.phraseCounters)}}getStorageKey(e){return`${this.SESSION_STORAGE_BASE_KEY}_${e}`}async initializeSession(e,t,r=!1,a=!1,l=!1,c=[]){if(console.log("[GameSession] Inicializando sesin para categora:",e),console.log("[GameSession] Usuario tiene premium?:",r),console.log("[GameSession] Usuario tiene Pack Bienvenida (DEPRECATED)?:",l),console.log("[GameSession] Packs del usuario:",c),console.log("[GameSession] Total frases cargadas:",t.length),!yA("game"))throw new Error(" Demasiadas sesiones iniciadas. Espera un momento antes de continuar.");this.phrases=t,await this.loadPhraseCounters();const d=await this.getStoredSession(e);if(d&&d.category===e){if(console.log("[GameSession] Sesin existente encontrada"),this.currentSession=d,this.currentSession.hasPremium=r,this.currentSession.hasRemoveAds=a||this.currentSession.hasRemoveAds===!0,this.currentSession.hasStarterPack=l,this.currentSession.ownedPackIds=c,this.currentSession.availablePool.length>1&&this.isPoolSequential(this.currentSession.availablePool)){console.log("[GameSession]  Pool secuencial detectado en sesin existente, mezclando...");const m=[...this.currentSession.availablePool];for(let g=m.length-1;g>0;g--){const _=Math.floor(Math.random()*(g+1));[m[g],m[_]]=[m[_],m[g]]}this.currentSession.availablePool=m,await this.saveSession(),console.log("[GameSession]  Pool de sesin existente mezclado aleatoriamente")}if(!this.currentSession.hasPremium){const h=this.currentSession.availablePool.length;this.currentSession.isDemoMode?this.currentSession.availablePool=this.currentSession.availablePool.filter(g=>{const _=this.phrases[g];return(_==null?void 0:_.isDemo)===!0}):this.currentSession.availablePool=this.currentSession.availablePool.filter(g=>{var T;const _=this.phrases[g],v=((T=this.currentSession)==null?void 0:T.ownedPackIds)||[];return _!=null&&_.packIds&&_.packIds.length>0&&_.packIds.some(A=>v.includes(A))||_!=null&&_.starterPack&&this.currentSession&&this.currentSession.hasStarterPack?!0:!(_!=null&&_.isPremium)&&!(_!=null&&_.isDemo)&&!(_!=null&&_.starterPack)&&(!(_!=null&&_.packIds)||_.packIds.length===0)});const m=this.currentSession.availablePool.length;console.log(`[GameSession] Pool filtrado por modo (${this.currentSession.isDemoMode?"demo":"gratuito"}): ${h}  ${m}`),await this.saveSession()}try{await Dt.checkConnection(!0)?this.currentSession.isOfflineMode&&await this.deactivateOfflineMode():(this.currentSession.isOfflineMode=!0,this.currentSession.hasRemoveAds=this.currentSession.hasRemoveAds===!0||!!a,this.currentSession.offlinePhrasesLimit=this.currentSession.hasRemoveAds?30:15,await this.saveSession(),console.log("[GameSession]  Ajuste automtico: modo offline activado (initializeSession - sesin existente). Lmite:",this.currentSession.offlinePhrasesLimit))}catch(h){console.warn("[GameSession]  No se pudo verificar conexin para auto offline/online (sesin existente):",h)}this.currentSession.currentPartidaCount>=this.getPhrasesPerPartida()?(console.log("[GameSession] Partida anterior completada, iniciando nueva partida"),await this.startNewPartida()):(console.log("[GameSession] Continuando partida existente"),await this.checkAndReorganizeIfNeeded())}else if(console.log("[GameSession] Creando nueva sesin"),await this.createNewSession(e,r,l,c),this.currentSession&&(this.currentSession.hasRemoveAds=a),this.currentSession)try{await Dt.checkConnection(!0)?this.currentSession.isOfflineMode&&await this.deactivateOfflineMode():(this.currentSession.isOfflineMode=!0,this.currentSession.hasRemoveAds=this.currentSession.hasRemoveAds===!0||!!a,this.currentSession.offlinePhrasesLimit=this.currentSession.hasRemoveAds?30:15,await this.saveSession(),console.log("[GameSession]  Ajuste automtico: modo offline activado (initializeSession - sesin nueva). Lmite:",this.currentSession.offlinePhrasesLimit))}catch(h){console.warn("[GameSession]  No se pudo verificar conexin para auto offline/online (sesin nueva):",h)}}getCurrentPhrase(){if(!this.currentSession)return null;if(this.currentSession.currentPartidaCount>=this.getPhrasesPerPartida())return{phrase:null,id:-1,isEndOfPartida:!0,stats:this.calculatePartidaStats()};if(this.currentSession.availablePool.length===0)return null;const e=this.getNextAvailablePhraseId();return{phrase:this.phrases[e],id:e,isEndOfPartida:!1,stats:void 0}}getCurrentProgress(){return this.currentSession?{current:this.currentSession.currentPartidaCount+1,total:this.getPhrasesPerPartida()}:{current:0,total:this.PHRASES_PER_PARTIDA}}async createNewSession(e,t=!1,r=!1,a=[]){const l=this.phrases.map((h,m)=>m);let c;t?(c=l,console.log("[GameSession] Modo premium: pool inicial con todas las frases")):(c=l.filter(h=>{const m=this.phrases[h];return m!=null&&m.packIds&&m.packIds.length>0&&m.packIds.some(_=>a.includes(_))||m!=null&&m.starterPack&&r?!0:!(m!=null&&m.isPremium)&&!(m!=null&&m.isDemo)&&!(m!=null&&m.starterPack)&&(!(m!=null&&m.packIds)||m.packIds.length===0)}),console.log("[GameSession] Modo gratuito: pool inicial solo con frases base + packs del usuario"));const d=[...c];for(let h=d.length-1;h>0;h--){const m=Math.floor(Math.random()*(h+1));[d[h],d[m]]=[d[m],d[h]]}console.log("[GameSession]  Frases mezcladas aleatoriamente para nueva sesin"),this.currentSession={category:e,phrasesShown:[],currentPartidaCount:0,totalPhrasesViewed:0,partida:1,startTime:Date.now(),sessionStartTime:Date.now(),availablePool:d,needsReorganization:!1,isDemoMode:!1,demoPhrasesShown:0,demoPhrasesTarget:10,hasPremium:t,hasRemoveAds:!1,isOfflineMode:!1,offlinePhrasesLimit:t?30:15,hasStarterPack:r,ownedPackIds:a},await this.saveSession(),console.log("[GameSession] Nueva sesin creada con orden aleatorio:",this.currentSession)}async getNextPhrase(){if(!this.currentSession)throw new Error("Sesin no inicializada");if((await this.checkAndReorganizeIfNeeded(this.currentSession.isDemoMode===!0)).needsCompletion)return{phrase:null,id:-1,isEndOfPartida:!0,stats:this.calculatePartidaStats(),needsCompletionModal:!0};if(this.currentSession.currentPartidaCount>=this.getPhrasesPerPartida()){const c=this.calculatePartidaStats(),d=this.currentSession.isOfflineMode&&!this.currentSession.hasRemoveAds;return{phrase:null,id:-1,isEndOfPartida:!0,stats:c,isOfflineLimitReached:d}}const t=this.getNextAvailablePhraseId(),r=this.phrases[t];this.currentSession.isDemoMode&&(r!=null&&r.isDemo)&&(this.currentSession.demoPhrasesShown++,console.log(`[GameSession]  Frase demo mostrada. Progreso: ${this.currentSession.demoPhrasesShown}/${this.currentSession.demoPhrasesTarget}`)),this.currentSession.phrasesShown.push(t),this.currentSession.currentPartidaCount++,this.currentSession.totalPhrasesViewed++,this.currentSession.isOfflineMode&&(Dt.incrementOfflinePhrasesPlayed(),console.log("[GameSession]  Frase offline registrada")),this.currentSession.availablePool=this.currentSession.availablePool.filter(c=>c!==t),await this.saveSession();const a=this.getPhrasesPerPartida();console.log(`[GameSession] Frase ${this.currentSession.currentPartidaCount}/${a}:`,r.text||r.frase);const l=this.currentSession.isOfflineMode&&this.currentSession.currentPartidaCount>=a;return console.log("[GameSession]  Verificacin lmite offline:",{isOfflineMode:this.currentSession.isOfflineMode,currentPartidaCount:this.currentSession.currentPartidaCount,phrasesLimit:a,isOfflineLimitReached:l,hasRemoveAds:this.currentSession.hasRemoveAds}),{phrase:r,id:t,isEndOfPartida:this.currentSession.currentPartidaCount>=a,stats:this.currentSession.currentPartidaCount>=a?this.calculatePartidaStats():void 0,isOfflineLimitReached:l}}async startNewPartida(){if(!this.currentSession)throw new Error("Sesin no inicializada");console.log("[GameSession]  Iniciando nueva partida..."),console.log("[GameSession] Partida actual:",this.currentSession.partida),console.log("[GameSession] Frases en pool antes de reorganizar:",this.currentSession.availablePool.length),this.currentSession.partida++,this.currentSession.currentPartidaCount=0,this.currentSession.startTime=Date.now(),console.log("[GameSession]  Contadores reseteados, reorganizando pool..."),await this.checkAndReorganizeIfNeeded(!0),console.log("[GameSession]  Pool reorganizado, frases disponibles:",this.currentSession.availablePool.length),await this.saveSession(),console.log(`[GameSession]  Nueva partida iniciada: #${this.currentSession.partida}`)}async activateDemoMode(){if(!this.currentSession)throw new Error("Sesin no inicializada");const e=10;this.currentSession.isDemoMode=!0,this.currentSession.demoPhrasesShown=0,this.currentSession.demoPhrasesTarget=e;try{const r=[...this.phrases.map((a,l)=>l).filter(a=>{const l=this.phrases[a];return(l==null?void 0:l.isDemo)===!0}).filter(a=>!this.currentSession.phrasesShown.includes(a))];for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,console.log(`[GameSession]  Pool actualizado para modo demo. Total frases demo disponibles: ${r.length}`)}catch(t){console.warn("[GameSession]  Error reconstruyendo pool para demo, se mantiene pool actual:",t)}await this.saveSession(),console.log("[GameSession]  Modo demo activado - 10 frases demo por partida")}async deactivateDemoMode(){if(!this.currentSession)throw new Error("Sesin no inicializada");this.currentSession.isDemoMode=!1,this.currentSession.demoPhrasesShown=0,this.currentSession.demoPhrasesTarget=0,await this.saveSession(),console.log("[GameSession] Modo demo desactivado")}async activateOfflineMode(e=!1){if(!this.currentSession)throw new Error("Sesin no inicializada");this.currentSession.isOfflineMode=!0,this.currentSession.hasRemoveAds=e,this.currentSession.offlinePhrasesLimit=e?30:15,await this.saveSession(),console.log(`[GameSession]  Modo offline activado - lmite: ${this.currentSession.offlinePhrasesLimit} frases`),console.log(`[GameSession] Usuario con remove_ads: ${e}`)}async deactivateOfflineMode(){if(!this.currentSession)throw new Error("Sesin no inicializada");this.currentSession.isOfflineMode=!1,this.currentSession.offlinePhrasesLimit=30,await this.saveSession(),console.log("[GameSession] Modo offline desactivado - volviendo a lmite normal de 30 frases")}getPhrasesPerPartida(){if(!this.currentSession)return this.PHRASES_PER_PARTIDA;if(this.currentSession.isDemoMode)return console.log("[GameSession]  Lmite modo demo: 10 frases"),10;const e=this.currentSession.isOfflineMode,t=this.currentSession.hasRemoveAds===!0;return console.log("[GameSession]  Verificacin de lmites - Offline en sesin:",this.currentSession.isOfflineMode),console.log("[GameSession]  Verificacin de lmites - Usuario con remove_ads:",t),e&&!t?(console.log("[GameSession]  Lmite offline aplicado: 15 frases (usuario sin remove_ads)"),15):(console.log("[GameSession] Lmite normal: 30 frases"),this.PHRASES_PER_PARTIDA)}isPartidaLimitReached(){if(!this.currentSession)return!1;const e=this.getPhrasesPerPartida();return this.currentSession.currentPartidaCount>=e}async checkAndReorganizeIfNeeded(e=!1){if(!this.currentSession)return{};const t=this.currentSession.availablePool.length,r=this.getPhrasesPerPartida();if(console.log("[GameSession]  Verificando pool - Frases restantes:",t),console.log("[GameSession]  Frases necesarias por partida:",r),console.log("[GameSession]  Es usuario premium?:",this.currentSession.hasPremium),console.log("[GameSession]  Modo offline?:",this.currentSession.isOfflineMode),t<r){console.log("[GameSession]  Pool insuficiente para partida completa, verificando completitud...");const a=this.hasUserCompletedAvailableContent();if(console.log("[GameSession]  Ha completado todo el contenido disponible?:",a),a)if(e)console.log("[GameSession]  Contenido completado pero se permite replay: reorganizando pool y continuando"),await this.reorganizePool();else return console.log("[GameSession]  Usuario complet todo el contenido disponible - MOSTRAR MODAL"),{needsCompletion:!0};else console.log("[GameSession]  Reorganizando pool para continuar jugando..."),await this.reorganizePool()}return{}}hasUserCompletedAvailableContent(){if(!this.currentSession)return!1;const e=[...new Set(this.currentSession.phrasesShown)];console.log("[GameSession] Verificando completitud:",{uniquePhrasesPlayed:e.length,totalPhrases:this.phrases.length,isDemoMode:this.currentSession.isDemoMode,hasPremium:this.currentSession.hasPremium,category:this.currentSession.category});let t=[];this.currentSession.hasPremium?(t=this.phrases,console.log("[GameSession] Usuario premium - Todas las frases disponibles:",t.length)):this.currentSession.isDemoMode?(t=this.phrases.filter(h=>!h.isPremium||h.isDemo===!0),console.log("[GameSession] Modo demo - Frases disponibles:",t.length)):(t=this.phrases.filter(h=>!h.isPremium&&!h.isDemo),console.log("[GameSession] Modo gratuito - Frases disponibles:",t.length));const r=e.filter(h=>{var g,_;const m=this.phrases[h];return m?(g=this.currentSession)!=null&&g.hasPremium?!0:(_=this.currentSession)!=null&&_.isDemoMode?!m.isPremium||m.isDemo===!0:!m.isPremium&&!m.isDemo:!1}),a=r.length>=t.length,l=t.length-r.length,c=this.getPhrasesPerPartida(),d=l<c;return console.log("[GameSession] Estado completitud:",{playedAvailablePhrases:r.length,availablePhrases:t.length,phrasesRemaining:l,phrasesPerPartida:c,hasCompletedAllAvailable:a,insufficientForFullGame:d,shouldShowModal:a||d,percentage:Math.round(r.length/t.length*100)}),a}hasCompletedAvailableContent(){return this.hasUserCompletedAvailableContent()}async reorganizePool(){if(!this.currentSession)return;console.log("[GameSession]  Reorganizando pool de frases"),console.log("[GameSession] Estado actual:",{category:this.currentSession.category,hasPremium:this.currentSession.hasPremium,isDemoMode:this.currentSession.isDemoMode,totalPhrases:this.phrases.length,phrasesShown:this.currentSession.phrasesShown.length});let e=[];this.currentSession.hasPremium?(e=this.phrases.map((r,a)=>a),console.log("[GameSession] Modo premium: usando todas las frases")):this.currentSession.isDemoMode?(e=this.phrases.map((r,a)=>({phrase:r,index:a})).filter(({phrase:r})=>!r.isPremium||r.isDemo===!0).map(({index:r})=>r),console.log("[GameSession] Modo demo: usando frases gratuitas + demo")):(e=this.phrases.map((r,a)=>({phrase:r,index:a})).filter(({phrase:r})=>!r.isPremium&&!r.isDemo).map(({index:r})=>r),console.log("[GameSession] Modo gratuito: usando solo frases base (no premium, no demo)")),console.log("[GameSession] Frases disponibles para este modo:",e.length);const t=e.filter(r=>!this.currentSession.phrasesShown.includes(r));if(console.log("[GameSession] Reorganizacin:",{totalAvailable:e.length,alreadySeen:this.currentSession.phrasesShown.length,notSeen:t.length,hasPremium:this.currentSession.hasPremium,mode:this.currentSession.hasPremium?"premium":this.currentSession.isDemoMode?"demo":"gratuito"}),t.length===0&&e.length>0){console.log("[GameSession]  Usuario complet una vuelta completa, reiniciando pool para replay"),this.currentSession.phrasesShown=[];const r=[...e];for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,console.log("[GameSession]  Pool reiniciado con orden aleatorio. Frases disponibles:",this.currentSession.availablePool.length)}else if(t.length>0){const r=[...t];for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,console.log("[GameSession]  Pool actualizado con frases restantes mezcladas aleatoriamente:",this.currentSession.availablePool.length)}else if(console.warn("[GameSession]  No hay frases sin ver y availablePhraseIds est vaco"),console.log("[GameSession]  Forzando reinicio del pool con todas las frases disponibles"),this.phrases.length>0){const r=this.phrases.map((a,l)=>l);for(let a=r.length-1;a>0;a--){const l=Math.floor(Math.random()*(a+1));[r[a],r[l]]=[r[l],r[a]]}this.currentSession.availablePool=r,this.currentSession.phrasesShown=[],console.log("[GameSession]  Pool reiniciado con todas las frases de this.phrases mezcladas aleatoriamente:",this.currentSession.availablePool.length)}else throw console.error("[GameSession]  CRTICO: this.phrases est vaco, no hay frases para mostrar"),new Error("No hay frases disponibles para jugar");await this.saveSession()}getNextAvailablePhraseId(){if(!this.currentSession||this.currentSession.availablePool.length===0)throw new Error("No hay frases disponibles");if(!this.currentSession.isDemoMode)return this.currentSession.availablePool[0];const t=this.getPhrasesPerPartida()-this.currentSession.currentPartidaCount,r=this.currentSession.demoPhrasesTarget-this.currentSession.demoPhrasesShown,a=this.currentSession.availablePool.filter(c=>this.phrases[c]&&this.phrases[c].isDemo===!0),l=this.currentSession.availablePool.filter(c=>!this.phrases[c]||this.phrases[c].isDemo!==!0);return console.log(`[GameSession] Demo logic - Need: ${r}, Remaining: ${t}, Demo available: ${a.length}`),a.length>0?(console.log("[GameSession]  Mostrando frase demo (modo demo puro)"),a[0]):(r<=0||a.length===0)&&l.length>0?(console.log("[GameSession]  Objetivo demo cumplido o sin frases demo, mostrando frase normal"),l[0]):this.currentSession.availablePool[0]}calculatePartidaStats(){if(!this.currentSession)throw new Error("Sesin no disponible para calcular stats");const e=Date.now(),t=Math.floor((e-this.currentSession.startTime)/1e3),r=Math.floor((e-this.currentSession.sessionStartTime)/1e3),a=this.calculateContentBreakdown(),l=this.calculateMotivationalStats(),c={partidaNumber:this.currentSession.partida,phrasesInPartida:this.currentSession.currentPartidaCount,partidaDuration:t,totalPhrasesInSession:this.currentSession.totalPhrasesViewed,sessionDuration:r,contentBreakdown:a,motivation:l};return this.currentSession.isDemoMode&&(c.wasDemoMode=!0,c.demoPhrasesShown=this.currentSession.demoPhrasesShown,c.demoPhrasesTarget=this.currentSession.demoPhrasesTarget),c}calculateContentBreakdown(){if(!this.currentSession)throw new Error("Sesin no disponible");const e=this.phrases.filter(m=>!m.isPremium&&!m.isDemo),t=this.phrases.filter(m=>m.isPremium&&!m.isDemo),r=this.phrases.filter(m=>m.isDemo===!0),a=this.currentSession.phrasesShown;console.log("[GameSession] Calculando progreso:",{totalPhrases:this.phrases.length,basePhrases:e.length,premiumPhrases:t.length,demoPhrases:r.length,playedTotal:a.length});const l=a.filter(m=>{const g=this.phrases[m];return g&&!g.isPremium&&!g.isDemo}),c=a.filter(m=>{const g=this.phrases[m];return g&&g.isPremium&&!g.isDemo}),d=a.filter(m=>{const g=this.phrases[m];return g&&g.isDemo===!0});console.log("[GameSession] Frases jugadas por tipo:",{base:l.length,premium:c.length,demo:d.length});const h={basePhrases:{played:l.length,total:e.length,remaining:Math.max(0,e.length-l.length)}};return t.length>0&&(h.premiumPhrases={played:c.length,total:t.length,remaining:Math.max(0,t.length-c.length)}),r.length>0&&(h.demoPhrases={played:d.length,total:r.length,remaining:Math.max(0,r.length-d.length)}),console.log("[GameSession] Desglose final:",h),h}calculateMotivationalStats(){var T,I,A,C,L;if(!this.currentSession)throw new Error("Sesin no disponible");const e=this.currentSession.ownedPackIds||[];console.log("[GameSession]  Packs del usuario para clculo de stats:",e),console.log("[GameSession]  Total frases en this.phrases:",this.phrases.length);const r=this.phrases.filter(x=>x.isDemo?!1:!x.packIds||x.packIds.length===0?!0:x.packIds.some(U=>e.includes(U))).length;console.log("[GameSession]  Frases accesibles (sin demos):",r),console.log("[GameSession]  Desglose:",{gratuitas:this.phrases.filter(x=>!x.isDemo&&(!x.packIds||x.packIds.length===0)).length,dePacks:this.phrases.filter(x=>!x.isDemo&&x.packIds&&x.packIds.length>0&&x.packIds.some(U=>e.includes(U))).length,demos:this.phrases.filter(x=>x.isDemo).length,total:this.phrases.length});const a=[...new Set(this.currentSession.phrasesShown)].filter(x=>{const U=this.phrases[x];return U&&!U.isDemo}).length,l=Math.round(a/r*100),c=Math.max(0,r-a),d=this.currentSession.phrasesShown,h=d.filter(x=>{const U=this.phrases[x];return U&&U.isPremium&&!U.isDemo}).length,m=d.filter(x=>{const U=this.phrases[x];return U&&U.isDemo===!0}).length,g=this.phraseCounters.isLoaded?this.phraseCounters.totalPremiumPhrases:161,_=this.phraseCounters.isLoaded?this.phraseCounters.totalDemoPhrases:26;this.phraseCounters.isLoaded?console.log("[GameSession]  Usando contadores cargados - Premium:",g,"Demo:",_):console.warn("[GameSession]  Contadores no cargados, usando fallback - Premium:",g,"Demo:",_);let v=0;try{if(console.log("[GameSession]  Calculando frases premium +18..."),console.log("[GameSession] DEBUG phraseCache:",{exists:!!W,hasPremiumPhrases:((T=W==null?void 0:W.premiumPhrases)==null?void 0:T.length)>0,hasAllPhrases:((I=W==null?void 0:W.allPhrases)==null?void 0:I.length)>0,premiumPhrasesCount:(A=W==null?void 0:W.premiumPhrases)==null?void 0:A.length,allPhrasesCount:(C=W==null?void 0:W.allPhrases)==null?void 0:C.length,thisPhrases:this.phrases.length,category:(L=this.currentSession)==null?void 0:L.category}),W&&Array.isArray(W.premiumPhrases)&&W.premiumPhrases.length>0){v=W.premiumPhrases.filter(z=>z.isAdult===!0).length,console.log("[GameSession]  Frases premium +18 desde phraseCache.premiumPhrases:",v),console.log("[GameSession]  Total frases premium en cache:",W.premiumPhrases.length);const U=W.premiumPhrases.filter(z=>z.isAdult===!0).slice(0,3).map(z=>{var $;return{text:(($=z.text)==null?void 0:$.substring(0,40))+"...",isAdult:z.isAdult,isPremium:z.isPremium}});console.log("[GameSession]  Muestra de frases premium +18:",U)}else if(W&&Array.isArray(W.allPhrases)&&W.allPhrases.length>0)v=W.allPhrases.filter(U=>U.isPremium===!0&&U.isAdult===!0).length,console.log("[GameSession]  Frases premium +18 desde phraseCache.allPhrases:",v);else{console.warn("[GameSession]  phraseCache no disponible, usando valor estimado");const x=this.phraseCounters.totalPremiumPhrases||161;v=Math.floor(x*.4),console.log("[GameSession]  Frases premium +18 estimadas:",v,`(${x} * 40%)`)}}catch(x){console.error("[GameSession] Error accediendo al phraseCache:",x);const U=this.phraseCounters.totalPremiumPhrases||161;v=Math.floor(U*.4),console.log("[GameSession] Frases premium +18 estimadas (error fallback):",v)}return console.log("[GameSession] Estadsticas calculadas:",{totalPhrasesAvailable:r,totalPhrasesPlayed:a,progressPercentage:l,phrasesUntilCompletion:c,totalPremium:g,totalDemo:_,premiumViewed:h,demoViewed:m,totalPremiumAdultPhrases:v,thisPhrases:this.phrases.length,thisPhrasesWithoutDemo:this.phrases.filter(x=>!x.isDemo).length,countersLoaded:this.phraseCounters.isLoaded}),{totalPhrasesAvailable:r,totalPhrasesPlayed:a,progressPercentage:l,phrasesUntilCompletion:c,category:this.currentSession.category,premiumStats:{premiumPhrasesViewed:h,totalPremiumPhrases:g,demoPhrasesViewed:m,totalDemoPhrases:_,demoPhrasesRemaining:Math.max(0,_-m),totalPremiumAdultPhrases:v}}}getSessionStats(){return this.currentSession?this.calculatePartidaStats():null}async clearSession(e){console.log("[GameSession] Limpiando sesin"),this.currentSession=null;try{typeof window<"u"&&window.localStorage&&(e?window.localStorage.removeItem(this.getStorageKey(e)):["regular","all-categories","adult-only"].forEach(r=>{window.localStorage.removeItem(this.getStorageKey(r))}))}catch(t){console.error("[GameSession] Error limpiando sesin:",t)}}async saveSession(){if(this.currentSession)try{if(typeof window<"u"&&window.localStorage){const e=this.getStorageKey(this.currentSession.category);window.localStorage.setItem(e,JSON.stringify(this.currentSession))}}catch(e){console.error("[GameSession] Error guardando sesin:",e)}}async getStoredSession(e){try{if(typeof window<"u"&&window.localStorage){const t=window.localStorage.getItem(this.getStorageKey(e));if(t)return JSON.parse(t)}}catch(t){console.error("[GameSession] Error obteniendo sesin guardada:",t)}return null}hasActiveSession(){return this.currentSession!==null}getCurrentPartidaNumber(){var e;return((e=this.currentSession)==null?void 0:e.partida)||0}getCurrentPartidaCount(){var e;return((e=this.currentSession)==null?void 0:e.currentPartidaCount)||0}isPoolSequential(e){if(e.length<2)return!1;const t=Math.min(10,e.length);let r=0,a=0;for(let c=0;c<t-1;c++)e[c+1]===e[c]+1&&r++,e[c+1]===e[c]-1&&a++;const l=(t-1)*.7;return r>=l||a>=l}static formatTime(e){const t=Math.floor(e/60),r=e%60;return`${t}:${r.toString().padStart(2,"0")}`}}const Bt=new fM;class mM{constructor(){ke(this,"DEMO_STORAGE_KEY","premium_demo_session");ke(this,"MAX_PARTIDAS",1);ke(this,"demoSession",null);ke(this,"demoPhrases",[])}setDemoPhrases(e){this.demoPhrases=e.filter(t=>t.isDemo===!0),console.log(`[PremiumDemo] ${this.demoPhrases.length} frases demo configuradas`)}async activateDemo(){return this.demoPhrases.length===0?(console.log("[PremiumDemo] No hay frases demo disponibles"),!1):(this.demoSession={isActive:!0,startTime:Date.now(),partidasUsadas:0,maxPartidas:this.MAX_PARTIDAS,phrasesShown:0,currentIndex:0,partidaEnCurso:!1},await this.saveSession(),console.log(`[PremiumDemo]  Demo activada por ${this.MAX_PARTIDAS} partida`),!0)}async renewDemo(){return this.demoPhrases.length===0?(console.log("[PremiumDemo] No hay frases demo disponibles para renovar"),!1):(this.demoSession={isActive:!0,startTime:Date.now(),partidasUsadas:0,maxPartidas:this.MAX_PARTIDAS,phrasesShown:0,currentIndex:0,partidaEnCurso:!1},await this.saveSession(),console.log(`[PremiumDemo]  Demo renovada por ${this.MAX_PARTIDAS} partida ms`),!0)}async startDemoPartida(){if(this.demoSession){if(this.demoSession.partidaEnCurso){console.log("[PremiumDemo] La partida demo ya est en curso");return}this.demoSession.partidaEnCurso=!0,this.demoSession.partidasUsadas=Math.min(this.demoSession.partidasUsadas+1,this.demoSession.maxPartidas),await this.saveSession(),console.log("[PremiumDemo]  Demo consumida al iniciar la partida")}}async completePartida(){this.demoSession&&(this.demoSession.partidaEnCurso=!1,this.demoSession.partidasUsadas>=this.demoSession.maxPartidas&&(console.log("[PremiumDemo] Demo completada tras 1 partida"),this.demoSession.isActive=!1),await this.saveSession())}getNextDemoPhrase(){if(!this.isActive())return console.log("[PremiumDemo] Demo no activa"),null;if(!this.demoSession||this.demoSession.currentIndex>=this.demoPhrases.length)return console.log("[PremiumDemo] No hay ms frases demo disponibles"),null;const e=this.demoPhrases[this.demoSession.currentIndex];return this.demoSession.currentIndex++,this.demoSession.phrasesShown++,this.saveSession(),console.log(`[PremiumDemo] Frase demo ${this.demoSession.phrasesShown}/${this.demoPhrases.length}:`,e.text),e}isActive(){return!this.demoSession||!this.demoSession.isActive?!1:this.demoSession.partidasUsadas>=this.demoSession.maxPartidas&&!this.demoSession.partidaEnCurso?(console.log("[PremiumDemo] Demo expirada - partidas agotadas"),this.demoSession.isActive=!1,this.saveSession(),!1):!0}getDemoStatus(){if(!this.demoSession||!this.demoSession.isActive)return{isActive:!1,partidasRestantes:0,phrasesShown:0,totalPhrases:this.demoPhrases.length,canRenew:this.demoPhrases.length>0};const e=Math.max(0,this.demoSession.maxPartidas-this.demoSession.partidasUsadas);return e<=0?this.demoSession.partidaEnCurso?{isActive:!0,partidasRestantes:0,phrasesShown:this.demoSession.phrasesShown,totalPhrases:this.demoPhrases.length,canRenew:!1}:(this.demoSession.isActive=!1,this.saveSession(),{isActive:!1,partidasRestantes:0,phrasesShown:this.demoSession.phrasesShown,totalPhrases:this.demoPhrases.length,canRenew:!0}):{isActive:!0,partidasRestantes:e,phrasesShown:this.demoSession.phrasesShown,totalPhrases:this.demoPhrases.length,canRenew:(this.demoSession.partidaEnCurso,!1)}}hasAvailableDemoPhrases(){return this.demoPhrases.length>0}getAvailableDemoCount(){return this.demoPhrases.length}async initialize(){console.log("[PremiumDemo] Inicializando servicio...");try{const e=await this.getStoredSession();return e&&(this.demoSession=e,console.log("[PremiumDemo] Sesin cargada:",this.getDemoStatus())),!0}catch(e){return console.error("[PremiumDemo] Error inicializando:",e),!1}}clearSession(){console.log("[PremiumDemo] Limpiando sesin"),this.demoSession=null;try{typeof window<"u"&&window.localStorage&&window.localStorage.removeItem(this.DEMO_STORAGE_KEY)}catch(e){console.error("[PremiumDemo] Error limpiando sesin:",e)}}async saveSession(){if(this.demoSession)try{typeof window<"u"&&window.localStorage&&window.localStorage.setItem(this.DEMO_STORAGE_KEY,JSON.stringify(this.demoSession))}catch(e){console.error("[PremiumDemo] Error guardando sesin:",e)}}async getStoredSession(){try{if(typeof window<"u"&&window.localStorage){const e=window.localStorage.getItem(this.DEMO_STORAGE_KEY);if(e)return JSON.parse(e)}}catch(e){console.error("[PremiumDemo] Error obteniendo sesin guardada:",e)}return null}}const sl=new mM;var pt=(n=>(n.Success="success",n.Error="error",n.Warning="warning",n.Info="info",n))(pt||{});const pM=({message:n,type:e,onClose:t,duration:r=4e3})=>{ee.useEffect(()=>{const c=setTimeout(()=>{t()},r);return()=>clearTimeout(c)},[r,t]);const l=(()=>{switch(e){case"success":return{bg:"bg-gradient-to-r from-green-500 to-emerald-600",icon:"fa-check-circle",iconColor:"text-white"};case"error":return{bg:"bg-gradient-to-r from-red-500 to-rose-600",icon:"fa-exclamation-circle",iconColor:"text-white"};case"warning":return{bg:"bg-gradient-to-r from-yellow-500 to-amber-600",icon:"fa-exclamation-triangle",iconColor:"text-white"};case"info":return{bg:"bg-gradient-to-r from-blue-500 to-cyan-600",icon:"fa-info-circle",iconColor:"text-white"};default:return{bg:"bg-slate-700",icon:"fa-bell",iconColor:"text-slate-300"}}})();return S.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 animate-fadeIn",style:{paddingTop:"calc(env(safe-area-inset-top) + 1rem)"},children:S.jsxs("div",{className:`${l.bg} rounded-lg shadow-2xl p-4 flex items-center gap-3 max-w-lg mx-auto`,children:[S.jsx("div",{className:"flex-shrink-0",children:S.jsx("i",{className:`fas ${l.icon} ${l.iconColor} text-2xl`})}),S.jsx("div",{className:"flex-1 text-white font-medium leading-snug",children:n}),S.jsx("button",{onClick:t,className:"flex-shrink-0 text-white hover:text-gray-200 transition-colors",children:S.jsx("i",{className:"fas fa-times"})})]})})},cn=er("Preferences",{web:()=>Wt(()=>import("./web-DvIH1gxT.js"),[]).then(n=>new n.PreferencesWeb)}),qn={GAMES_PLAYED:"rate_games_played",HAS_RATED:"rate_has_rated",LAST_PROMPT:"rate_last_prompt",PROMPT_COUNT:"rate_prompt_count",DONT_SHOW_AGAIN:"rate_dont_show_again"};class gM{constructor(){ke(this,"gamesPlayed",0);ke(this,"hasRated",!1);ke(this,"lastPromptDate",null);ke(this,"promptCount",0);ke(this,"dontShowAgain",!1);ke(this,"initialized",!1)}async initialize(){if(!this.initialized)try{const[e,t,r,a,l]=await Promise.all([cn.get({key:qn.GAMES_PLAYED}),cn.get({key:qn.HAS_RATED}),cn.get({key:qn.LAST_PROMPT}),cn.get({key:qn.PROMPT_COUNT}),cn.get({key:qn.DONT_SHOW_AGAIN})]);this.gamesPlayed=parseInt(e.value||"0"),this.hasRated=t.value==="true",this.lastPromptDate=r.value?parseInt(r.value):null,this.promptCount=parseInt(a.value||"0"),this.dontShowAgain=l.value==="true",this.initialized=!0}catch(e){console.error("[RateAppService] Error initializing:",e)}}async incrementGamesPlayed(){this.initialized||await this.initialize(),this.gamesPlayed++,await cn.set({key:qn.GAMES_PLAYED,value:this.gamesPlayed.toString()}),console.log("[RateAppService] Games played:",this.gamesPlayed)}async shouldShowRateModal(){return this.initialized||await this.initialize(),!(this.hasRated||this.dontShowAgain||this.gamesPlayed<3||!((this.gamesPlayed-3)%10===0)&&this.gamesPlayed!==3||this.lastPromptDate&&(Date.now()-this.lastPromptDate)/864e5<3)}async markAsShown(){this.lastPromptDate=Date.now(),this.promptCount++,await Promise.all([cn.set({key:qn.LAST_PROMPT,value:this.lastPromptDate.toString()}),cn.set({key:qn.PROMPT_COUNT,value:this.promptCount.toString()})])}async markAsRated(){this.hasRated=!0,await cn.set({key:qn.HAS_RATED,value:"true"})}async markDontShowAgain(){this.dontShowAgain=!0,await cn.set({key:qn.DONT_SHOW_AGAIN,value:"true"})}async reset(){this.gamesPlayed=0,this.hasRated=!1,this.lastPromptDate=null,this.promptCount=0,this.dontShowAgain=!1,await Promise.all([cn.remove({key:qn.GAMES_PLAYED}),cn.remove({key:qn.HAS_RATED}),cn.remove({key:qn.LAST_PROMPT}),cn.remove({key:qn.PROMPT_COUNT}),cn.remove({key:qn.DONT_SHOW_AGAIN})]),await this.initialize()}}const ch=new gM,yM=er("AppLauncher",{web:()=>Wt(()=>import("./web-CWAYvbJ3.js"),[]).then(n=>new n.AppLauncherWeb)}),mw=(n,e)=>new Promise((t,r)=>{const a=setTimeout(()=>r(new Error("timeout")),e);n.then(l=>{clearTimeout(a),t(l)}).catch(l=>{clearTimeout(a),r(l)})}),_M=({isVisible:n,onClose:e})=>{const[t,r]=ee.useState(!1),a=async()=>{if(!t){r(!0),console.log("[RateModal]  Abriendo Google Play directamente"),await ch.markAsRated();try{await l()}catch(d){console.error("[RateModal]  Error abriendo Google Play:",d)}finally{r(!1),setTimeout(()=>{console.log("[RateModal]  Cerrando modal"),e()},300)}}},l=async()=>{const d="com.mrodr.yonunca";if(Ne.getPlatform()==="android")try{console.log("[RateModal]  Intentando abrir Play Store con AppLauncher");const g=await mw(yM.openUrl({url:`market://details?id=${d}`}),1500);if(g!=null&&g.completed){console.log("[RateModal]  Play Store abierta con AppLauncher");return}}catch(g){console.warn("[RateModal]  AppLauncher fall o tard demasiado  fallback",g)}const m=`https://play.google.com/store/apps/details?id=${d}`;console.log("[RateModal]  Abriendo URL web:",m),await mw(Ny.open({url:m,windowName:"_system"}),1500)},c=()=>{console.log('[RateModal]  Usuario seleccion "Ahora no"'),e()};return S.jsx(br,{isVisible:n,onClose:e,children:S.jsx("div",{className:"bg-gradient-to-br from-indigo-900 to-purple-900 rounded-2xl p-6 text-white max-w-sm mx-auto relative overflow-hidden shadow-2xl border border-white/10",children:S.jsxs("div",{className:"relative z-10 text-center",children:[S.jsx("div",{className:"text-5xl mb-4",children:""}),S.jsx("h2",{className:"text-xl font-bold mb-3",children:"Te lo ests pasando bien?"}),S.jsx("p",{className:"text-purple-200 mb-6 text-sm leading-relaxed",children:"Djanos una resea en Google Play y aydanos a mejorar "}),S.jsxs("div",{className:"space-y-3",children:[S.jsx(Qt,{onClick:a,fullWidth:!0,disabled:t,className:"bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white font-bold shadow-lg disabled:opacity-50",children:t?"Abriendo...":"Resear"}),S.jsx(Qt,{onClick:c,fullWidth:!0,variant:"secondary",className:"text-sm text-purple-300 hover:text-white bg-transparent",children:"Ahora no"})]})]})})})},vM=({isVisible:n,stats:e,onNewGame:t,onDemoActivated:r,onBuyPremium:a,onGoHome:l,hasPremium:c,hasRemoveAds:d,includeAdult:h,adultOnly:m,wasOfflineGame:g=!1})=>{const v=ee.useRef(!0);ee.useEffect(()=>(v.current=!0,()=>{v.current=!1}),[]);const[T,I]=ee.useState(!1),[A,C]=ee.useState(!1),[L,x]=ee.useState(!1),[U,z]=ee.useState(sl.getDemoStatus()),[$,se]=ee.useState(!1),[D,P]=ee.useState(""),[N,M]=ee.useState(null),[B,G]=ee.useState("El pack premium incluye +200 nuevas frases"),[k,Ve]=ee.useState(!1),[et,te]=ee.useState(!1);ee.useEffect(()=>{RA().then(K=>{v.current&&G(K)}).catch(K=>{console.error("[EndGameModal] Error cargando mensaje promocional:",K)})},[]),ee.useEffect(()=>{n&&(async()=>(await ch.incrementGamesPlayed(),await ch.shouldShowRateModal()&&te(!0)))()},[n]),ee.useEffect(()=>{if(n&&L&&et){const K=setTimeout(()=>{v.current&&(Ve(!0),ch.markAsShown(),te(!1))},1e3);return()=>clearTimeout(K)}},[n,L,et]),ee.useEffect(()=>{if(n&&!L){if(d){I(!1),x(!0);return}try{if(sessionStorage.getItem("suppress_endgame_ad_once")==="1"){I(!1),x(!0),sessionStorage.removeItem("suppress_endgame_ad_once");return}}catch{}he()}},[n,L]),ee.useEffect(()=>{n||(I(!1),Ve(!1),te(!1))},[n]),ee.useEffect(()=>{const K=setInterval(()=>{z(sl.getDemoStatus())},1e3);return()=>clearInterval(K)},[]),ee.useEffect(()=>{(async()=>{try{if(!n)return;if(await Dt.checkConnection(!0)){se(!1),P("");return}if(d)se(!1),P("");else{const pe=await Dt.canPlayOffline(d);pe.allowed?(se(!1),P("")):(se(!0),P(pe.reason||"Lmite offline alcanzado"))}}catch(ue){console.warn("[EndGameModal] Error verificando estado offline:",ue)}})()},[n,d]);const he=async()=>{if(!L){I(!0);try{console.log("[EndGameModal] Mostrando anuncio intersticial...");let K;const ue=new Promise(Pe=>{K=window.setTimeout(()=>{Pe({success:!1,error:"timeout"})},12e4)}),pe=await Promise.race([wr.showEndGameInterstitial({force:!0}),ue]);K&&clearTimeout(K),pe.success?console.log("[EndGameModal]  Anuncio mostrado exitosamente"):pe.error==="timeout"?console.log("[EndGameModal]  Timeout al cargar el intersticial (>10s). Continuando sin anuncio."):console.log("[EndGameModal]  Anuncio no disponible:",pe.error)}catch(K){console.error("[EndGameModal] Error mostrando anuncio:",K)}finally{if(!v.current)return;I(!1),x(!0)}}},Ie=()=>{x(!1),t()},je=K=>{const{progressPercentage:ue,phrasesUntilCompletion:pe,totalPhrasesPlayed:Pe,totalPhrasesAvailable:ze}=K;return m?pe===0?c?{emoji:"",title:"100% completado de frases +18!",subtitle:"Has descubierto todas las frases +18. Cambia al modo normal para ms contenido."}:{emoji:"",title:"100% completado de frases +18 gratuitas!",subtitle:"Compra el pack premium para desbloquear ms frases +18, o cambia al modo normal para disfrutar de muchas ms frases gratuitas."}:ue>=80?{emoji:"",title:"Casi terminas las frases +18!",subtitle:`Has visto ${Pe} de ${ze} frases +18. Solo quedan ${pe}! Tambin hay ms frases en el modo normal.`}:ue>=50?{emoji:"",title:"Vas por buen camino en +18!",subtitle:`${Pe} frases +18 vistas. Quedan ${pe} por descubrir.`}:ue>=25?{emoji:"",title:"Buen progreso en +18!",subtitle:`${Pe} frases +18 descubiertas. Quedan ${pe} ms! Tambin puedes probar el modo normal.`}:{emoji:"",title:"Acabas de empezar en +18!",subtitle:`Solo ${Pe} frases +18 vistas. ${pe} esperando! Recuerda que el modo normal tiene ms contenido.`}:ue>=80?{emoji:"",title:"Casi eres un experto!",subtitle:`Has descubierto ${Pe} de ${ze} frases.
Solo quedan ${pe}!`}:ue>=50?{emoji:"",title:"Vas por buen camino!",subtitle:`${Pe} frases vistas. Quedan ${pe} por descubrir`}:ue>=25?{emoji:"",title:"Buen progreso!",subtitle:`${Pe} frases descubiertas. Quedan ${pe} ms!`}:{emoji:"",title:"Acabas de empezar!",subtitle:`Solo ${Pe} frases vistas. ${pe} esperando por ti!`}},j=m?{text:"Nueva Partida +18",emoji:S.jsx("i",{className:"fas fa-fire text-lg"}),className:"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white shadow-lg shadow-red-500/20",wrapperClass:""}:{text:"Nueva Partida",emoji:S.jsx("i",{className:"fas fa-play text-lg"}),className:"bg-gradient-to-r from-cyan-500 to-pink-500 hover:from-cyan-600 hover:to-pink-600 text-white font-bold",wrapperClass:"main-play-button"};return S.jsxs(S.Fragment,{children:[S.jsxs(br,{isVisible:n,onClose:l,children:[S.jsxs("div",{className:"bg-gradient-to-br from-purple-900 via-blue-900 to-purple-800 rounded-2xl p-6 text-white max-w-sm mx-auto relative overflow-hidden",children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-purple-400/10 animate-pulse"}),S.jsxs("div",{className:"relative z-10",children:[S.jsxs("div",{className:"text-center mb-4",children:[S.jsx("div",{className:"text-3xl mb-1 modal-icon-bounce",children:""}),S.jsx("h2",{className:"text-xl font-bold",children:"Partida Completada!"})]}),e.wasDemoMode&&S.jsx("div",{className:"bg-white/10 rounded-xl p-3 mb-4 backdrop-blur-sm",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-sm font-semibold text-orange-400 mb-1",children:" Modo Demo"}),S.jsxs("div",{className:"text-xs text-gray-300",children:["Frases premium vistas: ",S.jsxs("span",{className:"font-bold text-orange-300",children:[e.demoPhrasesShown,"/",e.demoPhrasesTarget]})]}),e.demoPhrasesShown===e.demoPhrasesTarget&&S.jsx("div",{className:"text-xs text-green-300 mt-1",children:" Objetivo completado!"})]})}),S.jsx("div",{className:"bg-gradient-to-r from-cyan-500/10 to-purple-500/10 rounded-xl p-4 mb-4 backdrop-blur-sm border border-cyan-400/20",children:(()=>{const K=je(e.motivation);return S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-2xl mb-2",children:K.emoji}),S.jsx("div",{className:"text-sm font-semibold text-cyan-300 mb-1",children:K.title}),S.jsx("div",{className:"text-xs text-gray-300 mb-3",children:K.subtitle}),S.jsx("div",{className:"bg-gray-700 rounded-full h-2 mb-2",children:S.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-purple-500 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(e.motivation.progressPercentage,100)}%`}})}),S.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-3",children:[S.jsxs("span",{children:[e.motivation.totalPhrasesPlayed," ",m?"frases +18 vistas":"frases vistas"]}),S.jsxs("span",{children:[e.motivation.progressPercentage,"% ","completado"]})]}),!c&&S.jsx("div",{className:"space-y-2 text-xs",children:S.jsx("div",{className:"bg-orange-500/10 rounded-lg px-3 py-2",children:S.jsx("div",{className:"text-orange-300 text-center",children:S.jsx("div",{className:"text-orange-200 mt-1",children:B})})})})]})})()}),T&&!L&&S.jsx("div",{className:"bg-yellow-500/20 rounded-xl p-3 mb-4 text-center",children:S.jsxs("div",{className:"text-sm flex items-center justify-center",children:[S.jsx("i",{className:"fas fa-film text-lg mr-2 animate-bounce"}),"Cargando anuncio..."]})}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("div",{className:j.wrapperClass,children:S.jsxs(Qt,{onClick:Ie,fullWidth:!0,size:"normal",className:j.className,disabled:T&&!L,children:[S.jsx("span",{className:"mr-2",children:j.emoji}),j.text]})}),!d&&$&&S.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-3 w-full flex items-center gap-3",children:[S.jsx("i",{className:"fas fa-ban text-red-300"}),S.jsx("div",{className:"text-sm text-red-300",children:D||"Lmite offline alcanzado. Vuelve maana o desbloquea el Pack Sin Anuncios."})]}),S.jsxs("div",{className:"flex gap-3",children:[S.jsx(Qt,{onClick:a,size:"normal",className:g?"w-1/2 bg-gradient-to-r from-yellow-500 via-amber-500 to-orange-500 hover:from-yellow-600 hover:via-amber-600 hover:to-orange-600 text-white font-semibold shadow-xl shadow-amber-500/30 border-2 border-yellow-400/50":"flex-1 bg-gradient-to-r from-yellow-500 via-amber-500 to-orange-500 hover:from-yellow-600 hover:via-amber-600 hover:to-orange-600 text-white font-semibold shadow-xl shadow-amber-500/30 border-2 border-yellow-400/50",disabled:T&&!L,children:S.jsxs("span",{className:"flex items-center justify-center gap-2",children:[S.jsx("i",{className:"fas fa-store text-lg"}),S.jsx("span",{className:"text-sm font-bold",children:"Tienda"})]})}),S.jsxs(Qt,{onClick:l,variant:"secondary",size:"normal",className:g?"w-1/2":"flex-1",disabled:T&&!L,children:[S.jsx("i",{className:"fas fa-home mr-1"}),"Men"]})]})]}),U.isActive&&S.jsxs("div",{className:"mt-4 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-3 text-center border border-purple-400/30",children:[S.jsxs("div",{className:"text-sm font-medium flex items-center justify-center",children:[S.jsx("i",{className:"fas fa-gamepad mr-2 text-purple-300"}),"Demo Premium Activa"]}),S.jsxs("div",{className:"text-xs text-purple-200 mt-1",children:[U.phrasesShown," frases usadas  ",U.partidasRestantes," partida restante"]})]})]})]}),N&&S.jsx(pM,{message:N.message,type:N.type,onClose:()=>M(null)})]}),S.jsx(_M,{isVisible:k,onClose:()=>Ve(!1)})]})},EM=({isVisible:n,onContinuePlaying:e,onGoToStore:t,onGoToNormalMode:r,hasPremium:a,content:l})=>{const d=l||{icon:"fa-trophy",title:"Enhorabuena bebedor!",subtitle:"Has completado todas las frases disponibles",message:a?"Has visto todas las frases! Puedes seguir jugando para revivirlas.":"Has completado todas las frases gratuitas! Desbloquea cientos de frases adicionales con el pack premium.",showStoreButton:!a,showReplay:!0,showGoToNormal:!1,buttonText:a?"Jugar de Nuevo":"Ver Tienda Premium",primaryAction:void 0},h=d.primaryAction||(d.showStoreButton?"store":"replay");return S.jsx(br,{isVisible:n,onClose:e,children:S.jsxs("div",{className:"bg-gradient-to-br from-green-900 via-emerald-900 to-teal-800 rounded-2xl p-6 text-white max-w-sm mx-auto relative overflow-hidden",children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/10 to-green-400/10 animate-pulse"}),S.jsxs("div",{className:"relative z-10 text-center",children:[S.jsx("div",{className:"text-5xl mb-3 select-none modal-icon-bounce",children:S.jsx("i",{className:`fas ${d.icon||"fa-trophy"} text-yellow-300`})}),S.jsx("h2",{className:"text-xl font-bold mb-2 text-yellow-300",children:d.title}),d.subtitle&&S.jsx("p",{className:"text-sm text-green-200 mb-4",children:d.subtitle}),S.jsx("div",{className:"bg-white/10 rounded-xl p-4 mb-6 backdrop-blur-sm",children:S.jsx("p",{className:"text-sm text-gray-200 leading-relaxed",children:d.message})}),S.jsxs("div",{className:"bg-gradient-to-r from-emerald-500/20 to-teal-500/20 rounded-lg p-3 mb-6 border border-emerald-400/30",children:[S.jsxs("div",{className:"text-lg font-bold text-emerald-300 flex items-center justify-center gap-2",children:[S.jsx("i",{className:"fas fa-bullseye select-none"}),S.jsx("span",{children:"100% Completado"})]}),S.jsx("div",{className:"text-xs text-emerald-200 mt-1",children:a?"Coleccin completa vista":d.showGoToNormal?"Contenido gratuito +18 completado":"Contenido gratuito completado"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs(Qt,{onClick:h==="store"?t:h==="goToNormal"&&r?r:e,fullWidth:!0,size:"large",className:"bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700 text-white shadow-lg shadow-yellow-500/20",children:[S.jsx("i",{className:`fas ${h==="store"?"fa-shopping-cart":h==="goToNormal"?"fa-home":"fa-gamepad"} mr-2`}),d.buttonText]}),d.showReplay&&h!=="replay"&&S.jsxs(Qt,{onClick:e,variant:"secondary",fullWidth:!0,className:"border-emerald-400/50 text-emerald-200 hover:bg-emerald-500/10",children:[S.jsx("i",{className:"fas fa-sync-alt mr-2"}),"Jugar de Nuevo"]}),d.showGoToNormal&&r&&S.jsxs(Qt,{onClick:r,variant:"secondary",fullWidth:!0,className:"border-blue-400/50 text-blue-200 hover:bg-blue-500/10",children:[S.jsx("i",{className:"fas fa-home mr-2"}),"Volver al Men"]})]}),!a&&S.jsxs("div",{className:"mt-4 text-xs text-green-300/80 flex items-center justify-center gap-1.5",children:[S.jsx("i",{className:"fas fa-lightbulb"}),S.jsx("span",{children:"Los packs premium incluyen cientos de frases adicionales"})]})]})]})})},SM=({isVisible:n,onViewStore:e,onClose:t})=>S.jsx(br,{isVisible:n,onClose:t,children:S.jsxs("div",{className:"bg-gradient-to-b from-purple-900 to-gray-900 rounded-lg p-3 shadow-xl space-y-4 max-w-sm mx-auto",children:[S.jsxs("div",{className:"text-center space-y-1",children:[S.jsx("div",{className:"text-3xl",children:""}),S.jsx("h2",{className:"text-lg font-bold text-white",children:"Partida Offline Completada!"})]}),S.jsx("div",{className:"bg-purple-800/40 rounded-lg p-2 border border-purple-500/50",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xl font-bold text-purple-200",children:"15/15"}),S.jsx("div",{className:"text-xs text-purple-300",children:"Frases completadas"})]})}),S.jsxs("div",{className:"text-center",children:[S.jsxs("p",{className:"text-gray-200 text-sm",children:["Completaste tu ",S.jsx("strong",{className:"text-purple-300",children:"partida offline diaria"})]}),S.jsxs("p",{className:"text-xs text-gray-400",children:["Limitada a ",S.jsx("strong",{children:"15 frases"})," por estar sin conexin."]})]}),S.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[S.jsx("div",{className:"text-center text-xs font-bold text-gray-300 mb-1",children:"Modos"}),S.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[S.jsx("div",{className:"bg-red-900/30 border border-red-500/50 rounded p-1",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-lg",children:""}),S.jsx("div",{className:"text-xs font-bold text-red-200",children:"Gratis"}),S.jsxs("div",{className:"text-[10px] text-red-300",children:[S.jsx("div",{children:"1/da"}),S.jsx("div",{children:"15 frases"}),S.jsx("div",{children:"Con anuncios"})]})]})}),S.jsx("div",{className:"bg-gradient-to-br from-yellow-900/40 to-orange-900/40 border border-yellow-500/70 rounded p-1",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-lg",children:""}),S.jsx("div",{className:"text-xs font-bold text-yellow-200",children:"Sin Anuncios"}),S.jsxs("div",{className:"text-[10px] text-yellow-300",children:[S.jsx("div",{children:" offline"}),S.jsx("div",{children:"30 frases"}),S.jsx("div",{children:"Sin anuncios"})]})]})})]})]}),S.jsx("div",{className:"bg-gradient-to-r from-yellow-900/60 to-orange-900/60 border border-yellow-500/70 rounded-lg p-2",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-lg",children:""}),S.jsx("h3",{className:"font-bold text-yellow-200 text-sm",children:"Juegas sin internet?"}),S.jsxs("p",{className:"text-xs text-yellow-300",children:["Desbloquea el ",S.jsx("strong",{children:"Pack Sin Anuncios"})," para jugar ",S.jsx("strong",{children:"ilimitado"})," sin conexin"]}),S.jsxs("div",{className:"flex items-center justify-center gap-1 text-[10px] text-yellow-400",children:[S.jsx("span",{children:""}),S.jsx("span",{children:"30 frases"}),S.jsx("span",{children:""}),S.jsx("span",{children:"Sin lmite"}),S.jsx("span",{children:""}),S.jsx("span",{children:"Sin anuncios"}),S.jsx("span",{children:""})]})]})}),S.jsx("div",{children:S.jsx(Qt,{onClick:t,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 font-bold text-base py-2",children:"Volver al Inicio"})}),S.jsx("div",{className:"text-center text-[10px] text-gray-500 mt-1",children:" Tu lmite offline se renueva cada 24h"})]})}),wM=({navigate:n,hasPremium:e,hasRemoveAds:t,includeAdult:r,adultOnly:a,ownedPackIds:l=[],storeProducts:c=[]})=>{const d=l.length>0,[h,m]=ee.useState([]),[g,_]=ee.useState(null),[v,T]=ee.useState(!0),[I,A]=ee.useState(null),[C,L]=ee.useState(!1),[x,U]=ee.useState(null),[z,$]=ee.useState(!1),[se,D]=ee.useState(null),[P,N]=ee.useState(!1),[M,B]=ee.useState(!0),[G,k]=ee.useState(!1),[Ve,et]=ee.useState(!1),[te,he]=ee.useState(!1),[Ie,je]=ee.useState(!1),[Ke,j]=ee.useState(!1);ee.useEffect(()=>{if(g&&(console.log("[GameScreen]  Nueva frase cargada:",{text:g.text.substring(0,50)+"...",isPremium:g.isPremium,isAdult:g.isAdult,packIds:g.packIds,hasPackIds:!!g.packIds&&g.packIds.length>0}),g.packIds&&g.packIds.length>0)){console.log("[GameScreen]  Frase pertenece a packs:",g.packIds),console.log("[GameScreen]  Total productos cargados:",c.length);const Ee=c.find(Te=>{var be;return(be=g.packIds)==null?void 0:be.includes(Te.productId)});console.log("[GameScreen]  Producto matching encontrado:",Ee?{productId:Ee.productId,title:Ee.title,packTag:Ee.packTag}:"NINGUNO")}},[g,c]);const K=()=>a?"adult-only":r?"all-categories":"regular";ee.useEffect(()=>{(async()=>{try{T(!0),A(null),M&&a&&(await new Promise(me=>setTimeout(me,100)),B(!1));const Te=await Dt.checkConnection(!0);let be=!1;if(console.log("[GameScreen]  Verificacin de conexin:",Te?"ONLINE":"OFFLINE"),!Te){const me=await Dt.canPlayOffline(t,!0);console.log("[GameScreen]  Puede jugar offline?:",me.allowed,"- Razn:",me.reason),me.allowed?(console.log("[GameScreen]  Activando modo offline al cargar frases"),Dt.getOfflineGameData().currentGameStarted||Dt.markOfflineGameStarted(),he(!0),be=!0):(console.log("[GameScreen]  No puede jugar offline - canPlayOffline.allowed = false"),console.log("[GameScreen]  Razn completa:",me.reason))}const Ue=await bA(e,!!r,l);console.log("[GameScreen]  Resumen de frases obtenidas:"),console.log("[GameScreen] - Total frases fetch: ",Ue.length),console.log("[GameScreen] - Modo adultOnly:",a),console.log("[GameScreen] - Packs adquiridos (ownedPackIds):",l);const He={};if(Ue.forEach(me=>{me.packIds&&me.packIds.length>0&&me.packIds.forEach(ge=>{He[ge]||(He[ge]={total:0,adult:0,nonAdult:0}),He[ge].total++,me.isAdult?He[ge].adult++:He[ge].nonAdult++})}),console.log("[GameScreen]  Frases por pack:",He),console.log('[GameScreen]  Pack "starter_pack" encontrado:',l.includes("starter_pack")),l.includes("starter_pack")){const me=Ue.filter(re=>{var ye;return(ye=re.packIds)==null?void 0:ye.includes("starter_pack")}),ge=me.filter(re=>re.isAdult);console.log("[GameScreen]  Pack starter_pack (bienvenida):"),console.log("[GameScreen]   - Total frases: ",me.length),console.log("[GameScreen]   - Frases +18: ",ge.length),console.log("[GameScreen]   - Frases normales: ",me.length-ge.length)}const It=a?Ue.filter(me=>me.isAdult):Ue;if(console.log("[GameScreen]  Frases despus de filtro adultOnly:",It.length),a){const me={};It.forEach(ge=>{ge.packIds&&ge.packIds.length>0&&ge.packIds.forEach(re=>{me[re]=(me[re]||0)+1})}),console.log("[GameScreen]  Frases +18 por pack (despus de filtro):",me)}if(It.length===0)if(a){if(N(!0),!a)try{const me=c.filter(re=>re.type!=="remove_ads"&&re.type!=="premium_phrases").map(re=>re.productId),ge=me.length>0&&me.every(re=>Array.isArray(l)?l.includes(re):!1)}catch(me){console.warn("[GameScreen] No se pudo desbloquear logro completista:",me)}T(!1);return}else{A("No se encontraron frases. Intntalo ms tarde.");return}m(It),sl.setDemoPhrases(It);try{await sl.initialize()}catch(me){console.warn("[GameScreen] Advertencia inicializando demo premium:",me)}const Ze=K(),Se=l.includes("starter");await Bt.initializeSession(Ze,It,e,t,Se,l);try{const{playTimeTrackingService:me}=await Wt(async()=>{const{playTimeTrackingService:ge}=await import("./playTimeTrackingService-DLFR5eM5.js");return{playTimeTrackingService:ge}},[]);await me.trackGameStart(),console.log("[GameScreen]  Sesin de juego registrada para tracking de patrones")}catch(me){console.error("[GameScreen]  Error registrando sesin de juego:",me)}be?(console.log("[GameScreen]  Activando modo offline en gameSessionService..."),await Bt.activateOfflineMode(t),console.log("[GameScreen]  Modo offline activado en la sesin con lmite:",t?"30 frases (con remove_ads)":"15 frases (sin remove_ads)"),j(!0)):console.log("[GameScreen]  offlineModeActive = false, NO se activar modo offline en gameSessionService");const _e=await Bt.getNextPhrase();_e!=null&&_e.phrase&&_(_e.phrase)}catch(Te){A("No se pudieron cargar las frases. Revisa tu conexin."),console.error("[GameScreen] Error cargando frases:",Te)}finally{T(!1)}})()},[e,r,a,l]),ee.useEffect(()=>{console.log("[GameScreen]  Iniciando monitoreo de conexin offline");const Ee=()=>{console.log("[GameScreen]  CONEXIN PERDIDA - Mostrando modal"),te||k(!0)},Te=async()=>{console.log("[GameScreen]  CONEXIN RESTAURADA"),k(!1),te&&(Bt.deactivateOfflineMode(),he(!1));try{console.log("[GameScreen]  Recargando anuncios tras recuperar conexin..."),await wr.retryLoadAdsAfterConnectionRestored()}catch(be){console.warn("[GameScreen]  Error recargando anuncios:",be)}};return Dt.startConnectionMonitoring(Ee,Te),()=>{console.log("[GameScreen]  Deteniendo monitoreo de conexin"),Dt.stopConnectionMonitoring(),te&&Dt.hasActiveOfflineGame()&&(console.log("[GameScreen]  Partida offline en curso detectada al cerrar - marcando como usada (anti-fraude)"),Dt.markOfflineGameCompleted())}},[te]);const ue=ee.useCallback(async()=>{try{const Ee=await Bt.getNextPhrase();if(console.log("[GameScreen]  Resultado getNextPhrase:",{isOfflineLimitReached:Ee.isOfflineLimitReached,isOfflineMode:te,hasRemoveAds:t,isEndOfPartida:Ee.isEndOfPartida}),Ee.isOfflineLimitReached&&te&&!t){console.log("[GameScreen]  Lmite de partida offline alcanzado (15 frases) - Usuario sin remove_ads"),Dt.markOfflineGameCompleted(),await Bt.deactivateOfflineMode(),he(!1),j(!0),et(!0);return}if(Ee.needsCompletionModal){console.log("[GameScreen]  Mostrando modal de completitud"),ow({isPremium:e,isAdult:a||!1}),N(!0);return}if(Ee.phrase)_(Ee.phrase);else if(!Ee.isEndOfPartida){console.log("[GameScreen]  Pool agotado, reiniciando automticamente para replay"),await Bt.startNewPartida();const Te=Bt.getCurrentPhrase();Te!=null&&Te.phrase&&_(Te.phrase);return}if(Ee.isEndOfPartida&&Ee.stats){if(console.log("[GameScreen]  Fin de partida alcanzado:",Ee.stats),Ee.isOfflineLimitReached&&!t){j(!0),et(!0);return}try{if(Bt.hasCompletedAvailableContent()){console.log("[GameScreen]  Contenido 100% completado - mostrando CompletionModal"),ow({isPremium:e,isAdult:a||!1}),N(!0);return}}catch(Te){console.warn("[GameScreen] No se pudo verificar completitud al final de partida:",Te)}z&&(await sl.completePartida(),$(!1),D(null),await Bt.deactivateDemoMode(),console.log("[GameScreen] Demo partida completada")),U(Ee.stats),Ee.stats&&zk({phrasesPlayed:Ee.stats.phrasesInPartida,duration:Ee.stats.partidaDuration,includeAdult:r||!1}),j(!1),L(!0)}}catch(Ee){if(console.error("[GameScreen] Error obteniendo siguiente frase:",Ee),Ee instanceof Error&&Ee.message.includes("No hay frases disponibles")){console.log("[GameScreen]  Reiniciando pool tras error de frases agotadas");try{await Bt.startNewPartida();const Te=Bt.getCurrentPhrase();Te!=null&&Te.phrase&&_(Te.phrase)}catch(Te){console.error("[GameScreen] Error al reiniciar pool:",Te),A("Error obteniendo la siguiente frase.")}}else A("Error obteniendo la siguiente frase.")}},[z]),pe=async()=>{var Ee,Te;try{if(L(!1),T(!0),A(null),j(!1),console.log("[GameScreen]  Iniciando nueva partida..."),console.log("[GameScreen] Modo: adultOnly="+a+", includeAdult="+r),!await Dt.checkConnection(!0)){if(!(await Dt.canPlayOffline(t)).allowed){console.log("[GameScreen]  Bloqueado por lmite offline. Mostrando modal de lmites."),je(!0),k(!0),T(!1);return}Dt.markOfflineGameStarted(),await Bt.activateOfflineMode(t),he(!0)}jk({includeAdult:r||!1,adultOnly:a||!1,hasPremium:e}),await Bt.startNewPartida(),console.log("[GameScreen]  Nueva partida iniciada, obteniendo primera frase...");const Ue=Bt.getCurrentPhrase();console.log("[GameScreen] Resultado getCurrentPhrase:",{hasPhrase:!!(Ue!=null&&Ue.phrase),phraseText:(Te=(Ee=Ue==null?void 0:Ue.phrase)==null?void 0:Ee.text)==null?void 0:Te.substring(0,50)}),Ue!=null&&Ue.phrase?_(Ue.phrase):console.warn("[GameScreen]  No se obtuvo frase despus de startNewPartida")}catch(be){console.error("[GameScreen]  Error iniciando nueva partida:",be),console.error("[GameScreen] Error stack:",be instanceof Error?be.stack:"No stack"),A("Error iniciando nueva partida.")}finally{T(!1)}},Pe=async()=>{L(!1),$(!0),await Bt.activateDemoMode();try{await sl.startDemoPartida()}catch(Te){console.warn("[GameScreen] Advertencia consumiendo demo al inicio:",Te)}await Bt.startNewPartida();const Ee=Bt.getCurrentPhrase();Ee!=null&&Ee.phrase&&_(Ee.phrase),console.log("[GameScreen]  Modo demo activado - frases demo mezcladas en partida normal")},ze=()=>{try{sessionStorage.setItem("return_to_endgame","1")}catch{}L(!1),n(gt.Store)},tt=()=>{L(!1),n(gt.Home)},Mt=()=>{try{sessionStorage.setItem("return_to_completion","1")}catch{}N(!1),n(gt.Store)},vt=async()=>{N(!1);try{if(!await Dt.checkConnection(!0)){if(!(await Dt.canPlayOffline(t)).allowed){console.log("[GameScreen]  Bloqueado por lmite offline al continuar. Mostrando modal."),k(!0);return}Dt.markOfflineGameStarted(),await Bt.activateOfflineMode(t),he(!0)}await Bt.startNewPartida();const Te=Bt.getCurrentPhrase();Te!=null&&Te.phrase&&_(Te.phrase)}catch(Ee){console.error("[GameScreen] Error continuando despus de completitud:",Ee),A("Error reiniciando el juego.")}},Je=async()=>{console.log("[GameScreen]  Iniciando partida offline...");try{const Ee=await Dt.canPlayOffline(t);if(!Ee.allowed){alert(Ee.reason||"No puedes iniciar partida offline"),k(!1);return}Dt.markOfflineGameStarted(),await Bt.activateOfflineMode(t),he(!0),k(!1),console.log("[GameScreen]  Partida offline iniciada - lmite:",t?30:15,"frases")}catch(Ee){console.error("[GameScreen] Error iniciando partida offline:",Ee),alert("Error iniciando partida offline")}},Rt=async()=>{if(console.log("[GameScreen]  Usuario confirm conexin restaurada"),await Dt.checkConnection(!0)){console.log("[GameScreen]  Conexin verificada - cerrando modal"),k(!1),te&&(await Bt.deactivateOfflineMode(),he(!1));try{console.log("[GameScreen]  Recargando anuncios tras recuperar conexin..."),await wr.retryLoadAdsAfterConnectionRestored()}catch(Te){console.warn("[GameScreen]  Error recargando anuncios:",Te)}}else console.log("[GameScreen]  An sin conexin"),alert("An no hay conexin a internet. Verifica tu WiFi o datos mviles.")},ot=()=>{et(!1),n(gt.Store)},Ft=()=>{et(!1),n(gt.Home)},Xt=()=>{N(!1);try{Bt.clearSession("adult-only")}catch{}n(gt.Home)},Re=()=>(g==null?void 0:g.text)||"";ee.useEffect(()=>{try{if(sessionStorage.getItem("return_to_endgame")==="1"){try{sessionStorage.setItem("suppress_endgame_ad_once","1")}catch{}const be=Bt.getSessionStats();be&&(U(be),L(!0)),sessionStorage.removeItem("return_to_endgame")}sessionStorage.getItem("return_to_completion")==="1"&&(N(!0),sessionStorage.removeItem("return_to_completion"))}catch{}},[]);const oe=()=>{if(v)return S.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[S.jsx("i",{className:"fas fa-spinner fa-spin text-5xl text-cyan-400"}),S.jsx("p",{className:"mt-4 text-slate-300",children:"Cargando frases..."})]});if(I)return S.jsx("p",{className:"text-center text-red-400",children:I});const Ee=Re();return Ee?S.jsxs("div",{className:"text-center text-2xl md:text-3xl font-semibold leading-relaxed animate-pop-in",children:[S.jsx("span",{className:"text-slate-400",children:"Yo nunca..."}),S.jsx("br",{}),S.jsx("span",{className:"text-white drop-shadow-lg",children:Ee}),S.jsxs("div",{className:"mt-4 flex justify-center space-x-2",children:[(g==null?void 0:g.isPremium)&&!z&&S.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-yellow-400 to-amber-500 text-amber-900 shadow-lg",children:[S.jsx("i",{className:"fas fa-star mr-1 text-xs"}),"Premium"]}),!z&&!(g!=null&&g.isPremium)&&(g==null?void 0:g.packIds)&&g.packIds.length>0&&(()=>{var be;const Te=c.find(Ue=>{var He;return((He=g.packIds)==null?void 0:He.includes(Ue.productId))&&!!Ue.packTag});if(Te!=null&&Te.packTag){const Ue=Te.icon||"fas fa-box",He=(be=Te.color)!=null&&be.startsWith("bg-")?Te.color:"",It=!He&&Te.color?{background:Te.color,color:"#fff"}:void 0;return S.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium shadow-lg ${He}`.trim(),style:It,children:[S.jsx("i",{className:`${Ue} mr-1 text-xs`}),Te.packTag]})}return null})(),z&&(g==null?void 0:g.isDemo)&&S.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-orange-400 to-pink-500 text-white shadow-lg",children:[S.jsx("i",{className:"fas fa-star mr-1 text-xs"}),"Frase premium"]}),z&&S.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-purple-500 to-indigo-500 text-white shadow-lg",children:[S.jsx("i",{className:"fas fa-play mr-1 text-xs"}),"Modo Demo"]})]})]}):(console.log("[GameScreen]  No hay frase actual, intentando reiniciar pool"),Bt.startNewPartida().then(()=>{const Te=Bt.getCurrentPhrase();Te!=null&&Te.phrase&&_(Te.phrase)}),S.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[S.jsx("i",{className:"fas fa-spinner fa-spin text-5xl text-cyan-400"}),S.jsx("p",{className:"mt-4 text-slate-300",children:"Preparando frases..."})]}))},De=()=>{k(!1),Ie&&(L(!0),je(!1))};return S.jsxs("div",{className:`relative overflow-hidden flex flex-col h-screen w-full p-4 ${a&&M?"screen-slide-in":"animate-slide-in-bounce"}`,style:{paddingTop:"calc(env(safe-area-inset-top) + 1rem)",willChange:a&&M?"transform, opacity":"auto",transform:"translateZ(0)"},children:[S.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none","aria-hidden":"true",children:[a?S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"absolute -top-16 -left-16 w-72 h-72 bg-red-500/20 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute -bottom-20 -right-16 w-80 h-80 bg-pink-600/18 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[36rem] h-[36rem] bg-red-600/12 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-red-950/12 via-pink-950/8 to-red-950/18"})]}):S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"absolute -top-16 -left-16 w-72 h-72 bg-cyan-500/20 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute -bottom-20 -right-16 w-80 h-80 bg-pink-500/20 rounded-full blur-3xl"}),S.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[36rem] h-[36rem] bg-violet-500/10 rounded-full blur-3xl"})]}),S.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(120% 120% at 50% 30%, rgba(255,255,255,0.04) 0%, rgba(0,0,0,0.35) 70%)",opacity:.25}})]}),S.jsx("div",{className:"absolute left-4",style:{top:"calc(env(safe-area-inset-top) + 1rem)"},children:S.jsx("button",{onClick:()=>n(gt.Home),className:"text-slate-400 hover:text-white transition-colors",children:S.jsx("i",{className:"fas fa-arrow-left fa-lg"})})}),S.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 text-center",children:[oe(),S.jsx("div",{className:"w-full max-w-xs mt-8",children:S.jsxs(Qt,{onClick:ue,disabled:!g&&!se,fullWidth:!0,size:"large",variant:a?"secondary":"primary",className:a?"fire-button !bg-gradient-to-r !from-red-500 !to-pink-600 hover:!from-red-600 hover:!to-pink-700 !border-red-500/50 !text-white !shadow-lg !shadow-pink-500/30":"",children:[S.jsx("i",{className:"fas fa-forward mr-2"}),"Siguiente"]})})]}),C&&x&&!Ve&&S.jsx(vM,{isVisible:C,stats:x,onNewGame:pe,onDemoActivated:Pe,onBuyPremium:ze,onGoHome:tt,hasPremium:e,hasRemoveAds:t,includeAdult:r,adultOnly:a,wasOfflineGame:Ke}),P&&S.jsx(EM,{isVisible:P,hasPremium:e,onGoToStore:Mt,onContinuePlaying:vt,onGoToNormalMode:a?Xt:void 0,content:a?{icon:"fa-fire",title:"Enhorabuena bebedor!",subtitle:"100% de contenido +18 completado",message:d?"Has visto todas las frases +18! Puedes seguir jugando para revivirlas o ir al modo normal.":"Has completado todas las frases +18 gratuitas! Compra packs premium para desbloquear ms frases +18, o cambia al modo normal para disfrutar de muchas ms frases gratuitas.",showStoreButton:!d,showReplay:!0,showGoToNormal:!0,buttonText:d?"Volver a Jugar":"Ver Tienda",primaryAction:d?"replay":"store"}:void 0}),S.jsx(tR,{isOpen:G,onStartOfflineGame:Je,onConnectionRestored:Rt,onClose:De,hasRemoveAds:t}),S.jsx(SM,{isVisible:Ve,onViewStore:ot,onClose:Ft})]})},pw="device_id";async function bM(){const n=(await cn.get({key:pw})).value;if(n)return n;const e=(()=>{const t=globalThis.crypto;if(t&&typeof t.randomUUID=="function")return t.randomUUID();const r=Math.random().toString(16).slice(2);return`${Date.now()}_${r}_${Math.random().toString(16).slice(2)}`})();return await cn.set({key:pw,value:e}),e}const tl=er("App",{web:()=>Wt(()=>import("./web-C-jHzlD2.js"),[]).then(n=>new n.AppWeb)}),df=()=>typeof window<"u"&&window.CdvPurchase?window.CdvPurchase.store:null,nR=()=>typeof window<"u"&&window.CdvPurchase?window.CdvPurchase.Platform:null,TM=()=>new Promise(n=>{if(Ne.getPlatform()==="web"){console.log("[waitForCordovaReady] Platform web, resolviendo inmediatamente"),n();return}if(window.cordova){console.log("[waitForCordovaReady]  Cordova ya est disponible"),n();return}console.log("[waitForCordovaReady]  Esperando evento deviceready..."),document.addEventListener("deviceready",()=>{console.log("[waitForCordovaReady]  deviceready disparado, Cordova listo"),n()},{once:!0}),setTimeout(()=>{console.warn("[waitForCordovaReady]  Timeout esperando deviceready"),n()},1e4)}),AM=async()=>{if(!jt)return console.error("[ensureAuth] Firebase Auth no disponible"),!1;try{return jt.currentUser?console.log("[ensureAuth]  Usuario ya autenticado:",jt.currentUser.uid):(console.log("[ensureAuth]  Iniciando sesin annima..."),await af(jt),console.log("[ensureAuth]  Usuario annimo creado")),!0}catch(n){return console.error("[ensureAuth]  Error en autenticacin:",n),!1}};let gw=!1,Ic=null,yg=new Set;const _g=async n=>{var e,t;try{if(!n)return!1;if(yg.has(n))return!0;const r=df(),a=nR();if(!r||!a)return!1;const c=Ne.getPlatform()==="ios"?a.APPLE_APPSTORE:a.GOOGLE_PLAY;r.register({id:n,type:r.NON_CONSUMABLE,platform:c}),yg.add(n);try{(e=r.refresh)==null||e.call(r),(t=r.update)==null||t.call(r)}catch{}return await new Promise(d=>setTimeout(d,600)),!0}catch(r){return console.warn("[ensureProductRegistered]  No se pudo registrar",n,r),!1}},iR=async()=>{if(Ic)return console.log("[initializeStore]  Ya hay una inicializacin en curso, esperando..."),Ic;if(gw)return console.log("[initializeStore]  Store ya inicializado"),Promise.resolve();Ic=(async()=>{var d;console.log("[initializeStore]  Iniciando inicializacin del store..."),await TM();try{const h=Ne.getPlatform(),m=!!window.cordova,g=!!window.CdvPurchase;console.log("[initializeStore]  Plataforma:",h,"| cordova=",m,"| CdvPurchase=",g)}catch(h){console.log("[initializeStore]  No se pudo loguear plataforma:",h)}const n=df();if(!n)throw new Error("Plugin In-App Purchase no disponible");const e=nR();if(!e)throw new Error("CdvPurchase.Platform no disponible");const t=Ne.getPlatform(),r=t==="ios"?e.APPLE_APPSTORE:e.GOOGLE_PLAY;try{n.when&&n.when("approved",h=>{var m;try{const g=(h==null?void 0:h.acknowledged)??((m=h==null?void 0:h.transaction)==null?void 0:m.acknowledged);(g===!1||g===void 0)&&(typeof h.finish=="function"?h.finish():typeof n.finish=="function"&&n.finish(h),console.log("[initializeStore]  Acknowledge aplicado a compra restaurada"))}catch(g){console.warn("[initializeStore]  Error reconociendo compra restaurada:",g)}})}catch(h){console.warn("[initializeStore]  No se pudo configurar listener global approved:",h)}console.log("[initializeStore]  Registrando productos...");const a=["remove_ads"],l=yg;for(const h of a)try{n.register({id:h,type:n.NON_CONSUMABLE,platform:r}),l.add(h),console.log("[initializeStore]  Registrado base:",h)}catch(m){console.warn("[initializeStore]  Error registrando base",h,m)}try{const m=(await Ty()||[]).filter(_=>!((_==null?void 0:_.isActive)===!1||!(_!=null&&_.productId)));let g=m.filter(_=>{const v=Array.isArray(_==null?void 0:_.platforms)?_.platforms:null,T=v?v.map(A=>String(A||"").toLowerCase().trim()).filter(A=>!!A):null,I=String((_==null?void 0:_.platform)||"").toLowerCase().trim();return T&&T.length>0?T.includes(t):!I||I==="both"?!0:I===t});t==="ios"&&g.length===0&&(g=m);for(const _ of g){const v=String(_.productId);if(!l.has(v))try{const T=n,I=String((_==null?void 0:_.type)||"").toLowerCase().trim(),A=I==="consumable"?T.CONSUMABLE??T.NON_CONSUMABLE??n.NON_CONSUMABLE:I==="subscription"?T.PAID_SUBSCRIPTION??T.SUBSCRIPTION??T.NON_CONSUMABLE??n.NON_CONSUMABLE:T.NON_CONSUMABLE??n.NON_CONSUMABLE;n.register({id:v,type:A,platform:r}),l.add(v),console.log("[initializeStore]  Registrado dinmico:",v,"type:",_.type||"non_consumable")}catch(T){console.warn("[initializeStore]  Error registrando dinmico",v,T)}}}catch(h){console.warn("[initializeStore]  No se pudieron cargar productos dinmicos de Firestore:",h)}console.log("[initializeStore]  Productos registrados (total):",l.size),n.verbosity=n.DEBUG,console.log("[initializeStore]  Llamando a store.initialize()..."),await n.initialize([r]),console.log("[initializeStore]  store.initialize() completado"),console.log("[initializeStore]  Esperando store.ready()..."),await new Promise((h,m)=>{let g=!1;const _=()=>{g||(g=!0,console.log("[initializeStore]  store.ready() completado"),h())},v=T=>{g||(g=!0,console.error("[initializeStore]  Error en store.ready():",T),m(T))};n.ready(_),n.error(v),setTimeout(()=>{g||(g=!0,console.error("[initializeStore]  Timeout en store.ready()"),m(new Error("Timeout esperando store.ready()")))},2e4)}),console.log("[initializeStore]  Sincronizando con la tienda...");try{if(typeof n.restorePurchases=="function"){await n.restorePurchases(),console.log("[initializeStore]  Sincronizacin completada");try{(d=n.refresh)==null||d.call(n),await new Promise(h=>setTimeout(h,1500))}catch{}}else console.warn("[initializeStore]  store.restorePurchases() no disponible")}catch(h){console.warn("[initializeStore]  Error en restorePurchases():",h)}console.log("[initializeStore]  Esperando que se carguen los productos..."),await new Promise(h=>{let m=!1;const g=()=>{m||(m=!0,console.log("[initializeStore]  Productos cargados (evento updated)"),h())};n.when&&n.when("updated",g),setTimeout(()=>{m||(m=!0,console.log("[initializeStore]  Timeout esperando updated"),h())},1e4)}),console.log("[initializeStore]  Forzando actualizacin final...");try{n.update(),await new Promise(h=>setTimeout(h,2e3))}catch(h){console.warn("[initializeStore]  Error en store.update():",h)}console.log("[initializeStore]  Verificando productos cargados...");const c=n.products||[];console.log("[initializeStore] Total productos en store:",c.length),c.forEach(h=>{console.log("[initializeStore] Producto:",{id:h==null?void 0:h.id,title:h==null?void 0:h.title,state:h==null?void 0:h.state,canPurchase:h==null?void 0:h.canPurchase,price:h==null?void 0:h.price,owned:h==null?void 0:h.owned})}),c.length===0&&(console.warn("[initializeStore]  No se cargaron productos desde la tienda"),console.warn("[initializeStore] Verifica:"),console.warn("  1. Los IDs de producto en Console (Google Play / App Store)"),console.warn("  2. Que la app est publicada (al menos en prueba interna)"),console.warn("  3. Que el packageName/bundleId coincida"),console.warn("  4. Que los productos estn activos y aprobados")),gw=!0,console.log("[initializeStore]  Inicializacin completa")})();try{await Ic}finally{Ic=null}},yw=async n=>{console.log("[buyProduct]  Iniciando compra de:",n);const e=Ne.getPlatform();if(e!=="android"&&e!=="ios")throw new Error("Las compras solo estn disponibles en dispositivos mviles (Android/iOS).");try{const a=!!window.cordova,l=!!window.CdvPurchase;console.log("[buyProduct]  Entorno:",{platform:e,cordova:a,CdvPurchase:l})}catch(a){console.log("[buyProduct]  No se pudo obtener estado del entorno:",a)}await iR();const t=df();if(!t)throw new Error("Plugin In-App Purchase no disponible");await _g(n),console.log("[buyProduct]  Verificando compra previa...");let r=t.get(n);if(!r)try{await _g(n),r=t.get(n)}catch{}if(!r){const a=e==="ios"?"App Store Connect":"Google Play Console";throw new Error(`Producto ${n} no encontrado. Verifica que est configurado en ${a}.`)}if(console.log("[buyProduct]  Producto encontrado:",{id:r.id,title:r.title,state:r.state,owned:r.owned,canPurchase:r.canPurchase,price:r.price}),r.owned)throw Object.assign(new Error('Ya posees este producto. Intenta "Restaurar compras".'),{code:"ITEM_ALREADY_OWNED",alreadyOwned:!0});if(!r.canPurchase){console.log("[buyProduct]  Producto no disponible para compra. Intentando store.update()...");try{await t.update();const a=t.get(n);if(console.log("[buyProduct]  Estado tras update():",{id:a==null?void 0:a.id,state:a==null?void 0:a.state,canPurchase:a==null?void 0:a.canPurchase,price:a==null?void 0:a.price}),!(a!=null&&a.canPurchase))throw new Error("Este producto no est disponible para compra en este momento.")}catch(a){throw console.log("[buyProduct]  Error en store.update():",a),new Error("Este producto no est disponible para compra en este momento.")}}return console.log("[buyProduct]  Iniciando proceso de compra..."),new Promise((a,l)=>{var T,I;let c=!1,d;const h=()=>{var A,C;d&&clearTimeout(d),(A=t.off)==null||A.call(t,"approved",_),(C=t.off)==null||C.call(t,"error",v)},m=A=>{c||(c=!0,h(),a(A))},g=A=>{c||(c=!0,h(),l(A))},_=async A=>{var L,x,U,z,$;console.log("[buyProduct]  Compra aprobada:",A);let C=!1;try{typeof A.finish=="function"?A.finish():typeof t.finish=="function"&&t.finish(A),C=!0,console.log("[buyProduct]  Transaccin finalizada (acknowledged)")}catch(se){console.warn("[buyProduct]  Error finalizando (acknowledge):",se)}try{(L=t.update)==null||L.call(t)}catch{}try{let se=((x=A==null?void 0:A.transaction)==null?void 0:x.purchaseToken)||(A==null?void 0:A.purchaseToken)||((U=A==null?void 0:A.nativePurchase)==null?void 0:U.purchaseToken)||((z=A==null?void 0:A.transaction)==null?void 0:z.id)||"";if(!se)console.warn("[buyProduct]  No se pudo obtener el token de compra");else{if(console.log("[buyProduct]  Token obtenido"),!await AM()||!_l)throw new Error("No se pudo autenticar");console.log("[buyProduct]  Validando en servidor...");const N=await Ey(_l,"validatePurchase")({productId:n,purchaseToken:se,packageName:"com.mrodr.yonunca"});console.log("[buyProduct]  Validacin exitosa:",N.data),m({productId:n,validated:!0,finishSuccess:C,orderId:($=N.data)==null?void 0:$.orderId});return}}catch(se){console.warn("[buyProduct]  Validacin de servidor fallida o no disponible:",se)}m({productId:n,validated:!1,finishSuccess:C})},v=async A=>{console.error("[buyProduct]  Error en compra:",A);const C=(A==null?void 0:A.code)||(A==null?void 0:A.errorCode),L=(A==null?void 0:A.message)||String(A);if(C===7||L.includes("ITEM_ALREADY_OWNED")){console.log("[buyProduct]  Producto ya comprado, restaurando...");try{const x=await eu();if(n==="remove_ads"&&x.hasRemoveAds||Array.isArray(x.ownedPackIds)&&x.ownedPackIds.includes(n)){m({productId:n,alreadyOwned:!0,restored:!0});return}}catch(x){console.error("[buyProduct] Error restaurando:",x)}g(Object.assign(new Error('Ya posees este producto. Intenta "Restaurar compras".'),{code:"ITEM_ALREADY_OWNED"}));return}if(C===1||L.includes("USER_CANCELED")){g(Object.assign(new Error("Compra cancelada"),{code:"USER_CANCELED"}));return}g(A)};t.when&&t.when("approved",_),(T=t.error)==null||T.call(t,v),d=setTimeout(()=>{c||g(new Error("Timeout: La compra tard demasiado"))},6e4);try{const A=(I=r.getOffer)==null?void 0:I.call(r);A?t.order(A):t.order(r),console.log("[buyProduct]  Orden iniciada")}catch(A){g(A)}})},eu=async n=>{var I;console.log("[restorePurchases]  Iniciando restauracin modular...");const e=Ne.getPlatform();if(e!=="android"&&e!=="ios")return{hasRemoveAds:!1,hasPremium:!1,purchases:[],ownedPackIds:[]};await iR();const t=df();if(!t)throw new Error("Plugin In-App Purchase no disponible");const r=(n==null?void 0:n.removeAdsId)||"remove_ads",a=(n==null?void 0:n.storeProducts)||[],l=(n==null?void 0:n.productConfigs)||[],c=new Set,d=new Set([r]);l.forEach(A=>{var C,L;(C=A==null?void 0:A.affectsState)!=null&&C.hasPremium&&A.productId&&c.add(A.productId),((L=A==null?void 0:A.affectsState)==null?void 0:L.showAds)===!1&&A.productId&&d.add(A.productId)}),a.forEach(A=>{A!=null&&A.grantsPremium&&A.productId&&c.add(A.productId),A!=null&&A.grantsRemoveAds&&A.productId&&d.add(A.productId)});let h=new Set;d.forEach(A=>h.add(A)),c.forEach(A=>h.add(A)),l&&l.length>0&&l.forEach(A=>{A.productId&&(h.add(A.productId),console.log(`[restorePurchases]  Agregando productId modular: ${A.productId}`))}),a.length>0&&a.forEach(A=>{A.productId&&!h.has(A.productId)&&(h.add(A.productId),console.log(`[restorePurchases]  Agregando productId de storeProducts: ${A.productId}`))}),await Promise.allSettled(Array.from(h).map(A=>_g(A))),console.log("[restorePurchases]  Sincronizando con la tienda...");try{typeof t.restorePurchases=="function"&&(await t.restorePurchases(),console.log("[restorePurchases]  Sincronizacin completada"),await new Promise(A=>setTimeout(A,2e3)))}catch(A){console.warn("[restorePurchases]  Error en restorePurchases():",A)}try{(I=t.refresh)==null||I.call(t),await new Promise(A=>setTimeout(A,2e3))}catch(A){console.warn("[restorePurchases]  Error en refresh():",A)}try{t.update(),await new Promise(A=>setTimeout(A,1e3))}catch(A){console.warn("[restorePurchases]  Error en update():",A)}const m=A=>{var C;try{const L=t.get(A);if(!L)return console.log("[restorePurchases] ",A,"no encontrado"),!1;const x=D=>String(D??"").toLowerCase(),U=x(((C=L==null?void 0:L.state)==null?void 0:C.name)??(L==null?void 0:L.state)),z=[];L!=null&&L.transaction&&z.push(L.transaction),Array.isArray(L==null?void 0:L.transactions)&&z.push(...L.transactions),Array.isArray(L==null?void 0:L.ownedTransactions)&&z.push(...L.ownedTransactions);const $=z.some(D=>{const P=x((D==null?void 0:D.state)??(D==null?void 0:D.transactionState)??(D==null?void 0:D.purchaseState)??(D==null?void 0:D.status));return P.includes("owned")||P.includes("purchased")||P.includes("approved")||P.includes("finished")||P.includes("restored")}),se=!!(L.owned===!0||U.includes("owned")||U.includes("approved")||U.includes("purchased")||U.includes("finished")||U.includes("restored")||$);return console.log("[restorePurchases]",A,"- owned:",se),se}catch(L){return console.error("[restorePurchases] Error verificando",A,":",L),!1}},g=Array.from(d).some(A=>m(A)),_=Array.from(c).some(A=>m(A)),v=[];g&&v.push({productId:r,type:"remove_ads"});const T=[];if(l&&l.length>0)for(const A of l)A.productId&&!d.has(A.productId)&&m(A.productId)&&!T.includes(A.productId)&&(T.push(A.productId),v.push({productId:A.productId,type:"pack"}),console.log(`[restorePurchases]  Pack dinmico comprado: ${A.productId}`));for(const A of a)A.productId&&!T.includes(A.productId)&&!d.has(A.productId)&&m(A.productId)&&(T.push(A.productId),v.push({productId:A.productId,type:"pack"}),console.log(`[restorePurchases]  Pack comprado: ${A.productId}`));return console.log("[restorePurchases]  Resultado modular:",{hasRemoveAds:g,hasPremium:_,ownedPackIds:T,purchases:v.length,dynamicPacksDetected:(l==null?void 0:l.length)||0}),{hasRemoveAds:g,hasPremium:_,purchases:v,ownedPackIds:T}},RM=async n=>{var r;const e=(n==null?void 0:n.delayMs)??1500,t=(n==null?void 0:n.silent)??!1;t||console.log(`[autoRestorePurchases]  Esperando ${e}ms para permitir que servidor registre compra...`),await new Promise(a=>setTimeout(a,e)),t||console.log("[autoRestorePurchases]  Iniciando restauracin automtica de compras...");try{const a=await eu(n);return t||console.log("[autoRestorePurchases]  Restauracin automtica completada:",{hasRemoveAds:a.hasRemoveAds,hasPremium:a.hasPremium,packCount:((r=a.ownedPackIds)==null?void 0:r.length)||0}),a}catch(a){return console.warn("[autoRestorePurchases]  Error en restauracin automtica:",a),{hasRemoveAds:!1,hasPremium:!1,ownedPackIds:[],purchases:[],error:a}}};class IM{constructor(){ke(this,"configs",new Map)}register(e){console.log(`[ProductConfigManager]  Registrando producto: ${e.productId} (${e.type})`),this.configs.set(e.productId,e)}registerBatch(e){console.log(`[ProductConfigManager]  Registrando ${e.length} productos`),e.forEach(t=>this.register(t))}get(e){return this.configs.get(e)}getAll(){return Array.from(this.configs.values())}getAllProductIds(){return Array.from(this.configs.keys())}getByType(e){return Array.from(this.configs.values()).filter(t=>t.type===e)}executeCallbacks(e){console.log(`[ProductConfigManager]  Ejecutando ${e.length} callbacks`),e.forEach(({productId:t,callback:r})=>{try{console.log(`[ProductConfigManager]  Ejecutando callback para: ${t}`),r()}catch(a){console.error(`[ProductConfigManager]  Error ejecutando callback para ${t}:`,a)}})}clear(){this.configs.clear(),console.log("[ProductConfigManager]  Configuracin limpiada")}}const tu=new IM,PM=n=>{console.log("[initializeDefaultProducts]  Inicializando productos por defecto (solo especiales)"),tu.registerBatch([{productId:"remove_ads",type:"remove_ads",callbacks:{onOwned:n.onRemoveAdsPurchased},affectsState:{showAds:!1}}])},CM=(n,e)=>{console.log(`[addDynamicProductsFromFirestore]  Agregando ${n.length} packs desde Firestore`);const t=n.filter(r=>!(r.productId==="remove_ads"||r.isActive===!1)).map(r=>{const a={ownedPackIds:!0};return r.grantsPremium&&(a.hasPremium=!0),r.grantsRemoveAds&&(a.showAds=!1),{productId:r.productId,type:"pack",callbacks:{onOwned:()=>{console.log(`[DynamicProduct]  Pack comprado: ${r.productId}`),e!=null&&e.onPackPurchased&&e.onPackPurchased(r.productId)}},affectsState:a}});t.length>0&&tu.registerBatch(t)},Ya=class Ya{constructor(){ke(this,"environment","pro")}static getInstance(){return Ya.instance||(Ya.instance=new Ya),Ya.instance}async initialize(e){this.environment=e,console.log(`[AppEnvironment] Inicializado con ambiente: ${e}`)}getEnvironment(){return this.environment}isProduction(){return this.environment==="pro"}isPreProduction(){return this.environment==="pre"}filterProductsByEnvironment(e){return e.filter(t=>{const r=(t==null?void 0:t.environment)||"both";return this.isProduction()?r==="both"||r==="pro":(this.isPreProduction(),!0)})}getLabel(){return this.isProduction()?" PRO":" PRE"}getDescription(){return this.isProduction()?"Compilacin de Produccin":"Compilacin de Testing/Pre-Produccin"}};ke(Ya,"instance");let vg=Ya;const Eg=vg.getInstance(),_w=({endDate:n,large:e=!1,bare:t=!1,className:r})=>{const[a,l]=ee.useState(null);return ee.useEffect(()=>{const c=()=>{const h=Date.now(),g=new Date(n).getTime()-h;if(g<=0){l({days:0,hours:0,minutes:0,seconds:0});return}const _=Math.floor(g/(1e3*60*60*24)),v=Math.floor(g%(1e3*60*60*24)/(1e3*60*60)),T=Math.floor(g%(1e3*60*60)/(1e3*60)),I=Math.floor(g%(1e3*60)/1e3);l({days:_,hours:v,minutes:T,seconds:I})};c();const d=setInterval(c,1e3);return()=>clearInterval(d)},[n]),!a||a.days===0&&a.hours===0&&a.minutes===0&&a.seconds===0?null:e?S.jsx("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded p-1.5 shadow-md border border-purple-500/20",children:S.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:a.days})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Das"})]}),S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:String(a.hours).padStart(2,"0")})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Hrs"})]}),S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:String(a.minutes).padStart(2,"0")})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Min"})]}),S.jsxs("div",{className:"flex flex-col items-center",children:[S.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded p-1 w-full text-center",children:S.jsx("div",{className:"text-base sm:text-xl font-black",children:String(a.seconds).padStart(2,"0")})}),S.jsx("span",{className:"text-[9px] sm:text-[10px] text-slate-400 mt-0.5 font-semibold",children:"Seg"})]})]})}):t?S.jsxs("span",{className:r||"text-[10px] sm:text-xs whitespace-nowrap font-bold",children:[a.days>0&&`${a.days} dias `,String(a.hours).padStart(2,"0"),":",String(a.minutes).padStart(2,"0"),":",String(a.seconds).padStart(2,"0")]}):S.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-gradient-to-r from-pink-600 via-red-500 to-orange-500 text-white px-2.5 py-1 rounded-md shadow-lg border border-pink-400/30",children:[S.jsx("i",{className:"fas fa-fire text-yellow-200 text-xs"}),S.jsxs("span",{className:"text-[10px] sm:text-xs font-bold whitespace-nowrap",children:["Termina en ",a.days>0&&`${a.days}d `,String(a.hours).padStart(2,"0"),":",String(a.minutes).padStart(2,"0"),":",String(a.seconds).padStart(2,"0")]})]})},vw=({icon:n,title:e,description:t,price:r,onClick:a,disabled:l,disabledText:c,discountPercent:d,discountReason:h,benefits:m,badge:g,isPopular:_,soldOut:v,comingSoon:T,promoEndDate:I,owned:A,productType:C,isAdultPack:L,originalPriceDisplay:x})=>{if(T&&I)return S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"absolute -top-3 -right-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold px-2.5 py-1 rounded-full shadow-lg z-10 badge-bounce",children:g||"PRONTO!"}),S.jsx("div",{className:"relative rounded-xl p-0.5 transition-all overflow-hidden",style:{borderRadius:"0.75rem",backgroundImage:"linear-gradient(to bottom right, #7c3aed, #db2777)"},children:S.jsxs("div",{className:"rounded-xl p-2 sm:p-3 bg-gradient-to-br from-slate-900 via-indigo-900/1 to-slate-900 shadow-sm ring-2 ring-indigo-800/3 relative overflow-hidden",style:{backgroundImage:"linear-gradient(135deg, rgba(31, 22, 58, 0.90), rgba(168, 85, 247, 0.25), rgba(236, 72, 153, 0.22))"},children:[S.jsx("div",{className:"absolute inset-0 opacity-10",children:S.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(139, 92, 246, 0.3) 10px, rgba(139, 92, 246, 0.3) 20px)"}})}),S.jsxs("div",{className:"relative z-10",children:[S.jsxs("div",{className:"flex items-start gap-1.5 mb-1.5",children:[S.jsx("div",{className:"flex-shrink-0 text-purple-300 text-2xl sm:text-3xl drop-shadow-md",children:S.jsx("i",{className:n})}),S.jsxs("div",{className:"flex-grow",children:[S.jsx("h3",{className:"text-base sm:text-lg font-bold text-white leading-tight mb-0.5",children:e}),S.jsx("p",{className:"text-slate-300 text-xs leading-snug",children:t})]})]}),S.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg p-1 mb-1.5 text-center shadow",children:S.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[S.jsx("i",{className:"fas fa-rocket text-yellow-200 text-xs sm:text-sm"}),S.jsx("span",{className:"text-white font-black text-xs sm:text-sm tracking-wide",children:"PRXIMAMENTE"}),S.jsx(_w,{endDate:I,bare:!0,className:"text-white text-[10px] sm:text-xs font-bold tracking-wide whitespace-nowrap"})]})}),m&&m.length>0&&S.jsx("ul",{className:"space-y-1 mb-1.5",children:m.map((je,Ke)=>S.jsxs("li",{className:"flex items-start gap-1.5 text-slate-300 text-xs sm:text-sm",children:[S.jsx("i",{className:"fas fa-check-circle text-purple-300 mt-0.5 flex-shrink-0 text-xs"}),S.jsx("span",{children:je})]},Ke))})]})]})})]});const U=!!A,z=!!v&&!U,$=!z&&d&&d>0&&!U,se=I?new Date(I).getTime():0,D=Date.now(),P=!z&&!!I&&se>D&&!U,N=!z&&d&&d>0&&!U,M=!z&&!U&&!d&&g&&g!=="PREMIUM",B=z||U||c&&/Agotado|Ya es tuyo!/i.test(c),G=U||z,k=$?"text-2xl sm:text-3xl":"text-3xl sm:text-4xl",Ve=$?"text-base sm:text-lg":"text-lg sm:text-xl",et=$?"text-xs":"text-xs sm:text-sm",te=!G&&!$&&!P,he=!G&&!$&&!P,Ie=U?"linear-gradient(to bottom right, #7eff7eff, #1b7200ff)":z?"linear-gradient(to bottom right, #ff938fff, #720000ff)":$?"linear-gradient(to bottom right, #fff7ed, #fde68a, #f59e0b, #b45309)":"linear-gradient(135deg, #10edfdff, #22dcf8ff, #007db8ff)";return S.jsxs("div",{className:"relative",children:[N&&S.jsxs("div",{className:"absolute -top-3 -right-3 bg-gradient-to-r from-yellow-300 via-amber-400 to-amber-600 text-white text-sm font-bold px-3 py-1 rounded-full shadow z-10 badge-bounce",children:["-",d,"%"]}),M&&S.jsx("div",{className:"absolute -top-3 -right-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow z-10 badge-bounce",children:g}),S.jsx("div",{className:`relative rounded-xl p-0.5 transition-all ${!l&&!G?"hover:scale-[1.005]":""} ${A?"opacity-60":""}`,style:{borderRadius:"0.75rem",backgroundImage:Ie},children:S.jsxs("div",{className:`rounded-xl flex flex-col transition-all shadow-sm h-full ${z?"bg-red-950/90":"bg-slate-800"} relative overflow-hidden ${he?"justify-center px-3 sm:px-4 pt-2 pb-3 sm:pt-2 sm:pb-4":"p-3 sm:p-4"}`,style:{backgroundImage:$?"linear-gradient(to bottom right, rgba(0, 0, 0, 0.16), rgba(0, 0, 0, 0.24)), linear-gradient(to bottom right, rgba(255, 247, 237, 0.12), rgba(253, 230, 138, 0.18), rgba(245, 158, 11, 0.22), rgba(180, 83, 9, 0.20))":z?"linear-gradient(135deg, rgba(255, 68, 68, 0.75), rgba(155, 0, 0, 0.7), rgba(0, 0, 0, 0.8))":void 0},children:[G&&S.jsx("div",{className:`absolute inset-0 ${z?"bg-black/60":"bg-black/45"} rounded-xl z-10 pointer-events-none`}),z&&S.jsx("div",{className:"absolute top-2 right-2 z-20 pointer-events-none",children:S.jsx("div",{className:"bg-red-700/90 text-white px-2 py-0.5 rounded-md shadow-md border border-red-500",children:S.jsx("span",{className:"text-xs font-semibold tracking-wide flex items-center gap-1",children:" Agotado"})})}),U&&S.jsx("div",{className:"absolute top-2 right-2 z-20 pointer-events-none",children:S.jsx("div",{className:"bg-green-700/90 text-white px-2 py-0.5 rounded-md shadow-md border border-green-500",children:S.jsx("span",{className:"text-xs font-semibold tracking-wide flex items-center gap-1",children:" Adquirido"})})}),S.jsxs("div",{className:`flex items-start gap-2 sm:gap-3 ${he?"":"mb-2 sm:mb-3"} relative z-20 ${he?"my-0":""}`,children:[S.jsx("div",{className:`flex-shrink-0 ${$?"text-amber-300":"text-cyan-300"} ${k} drop-shadow-md`,children:S.jsx("i",{className:`${n} ${$?"gradient-white-gold":"text-cyan-300"} opacity-95 drop-shadow-md`})}),S.jsxs("div",{className:"flex-grow",children:[S.jsx("h3",{className:`${Ve} font-bold text-white leading-tight m-0`,children:e}),S.jsx("p",{className:`${$?"text-amber-200":"text-cyan-300"} ${et} ${he?"":"mt-0.5 sm:mt-1"} leading-snug m-0`,children:t})]}),te&&S.jsx("div",{className:"flex-shrink-0 ml-2",children:S.jsx(Qt,{onClick:a,variant:"primary",shimmerVariant:"default",className:"px-3 sm:px-5 py-1.5 sm:py-2.5 text-sm sm:text-base font-bold text-white ring-1 ring-white/20 shadow-md hover:shadow-lg whitespace-nowrap bg-blue-700 hover:bg-blue-800",children:Ew(r,d)})})]}),!G&&m&&m.length>0&&S.jsx("ul",{className:`space-y-1 sm:space-y-1.5 ${he?"mb-0 mt-0":"mb-2 sm:mb-2.5"}`,children:m.map((je,Ke)=>S.jsxs("li",{className:"flex items-start gap-1.5 sm:gap-2 text-slate-300 text-xs sm:text-sm",children:[S.jsx("i",{className:"fas fa-check-circle text-green-300 mt-0.5 flex-shrink-0 text-xs sm:text-sm"}),S.jsx("span",{children:je})]},Ke))}),!G&&(()=>{const je=d&&d>0&&!!h||P;return je||$?S.jsxs("div",{className:`flex items-center ${je?"justify-between":"justify-end"} gap-2 sm:gap-3 mt-auto`,children:[je&&S.jsxs("div",{className:"flex flex-col",children:[d&&d>0&&h&&S.jsx("p",{className:`text-xs ${$?"text-amber-200":"text-cyan-300"} font-semibold`,children:h}),P&&S.jsx(_w,{endDate:I,bare:!0,className:`text-[10px] sm:text-xs font-bold ${$?"text-amber-200":"text-cyan-300"} mt-0.5`})]}),S.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-auto",children:[(()=>{const j=OM({originalPriceDisplay:x,discountPercent:d},r);return j&&!l?S.jsx("span",{className:"text-red-500 text-sm sm:text-base font-bold line-through",children:j}):null})(),!l&&$&&S.jsx(Qt,{onClick:a,variant:"custom",shimmerVariant:"default",className:"px-3 sm:px-5 py-1.5 sm:py-2.5 text-sm sm:text-base font-bold text-white ring-1 ring-white/20 shadow-md hover:shadow-lg whitespace-nowrap gold-shimmer-bg hover:brightness-110",children:Ew(r,d)}),l&&!B&&S.jsx("p",{className:"text-xs sm:text-sm font-bold text-green-300 text-center py-1.5 sm:py-2 px-3 sm:px-4 bg-green-500/15 rounded-lg whitespace-nowrap",children:c||"No disponible"})]})]}):null})()]})})]})},Ew=(n,e)=>{if(!n)return"";const t=n.trim().toLowerCase();if(t.includes("gratis"))return"GRATIS";const r=t.replace(/[^0-9.,-]/g,"").replace(",","."),a=r?parseFloat(r):NaN;return!isNaN(a)&&a===0||typeof e=="number"&&e>=100?"GRATIS":n},Sw=n=>{const e=typeof(n==null?void 0:n.priceDisplay)=="string"?n.priceDisplay.trim():"";if(e){const a=e.toLowerCase().trim();return a==="0"||a==="0"||a==="0,00"||a==="0.00"||a==="gratis"?"GRATIS":e}const t=typeof(n==null?void 0:n.price)=="number"?n.price:void 0;if(typeof t=="number"){if(t<=0||typeof(n==null?void 0:n.discountPercent)=="number"&&n.discountPercent>=100||(n==null?void 0:n.isFree)===!0)return"GRATIS";try{return new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(t)}catch{return`${t.toFixed(2).replace(".",",")} `}}const r=String((n==null?void 0:n.price)||"").trim();return r||""},NM=(n,e)=>{if(typeof n!="string"||!n||e<=0)return"";const t=n.match(/^([^0-9.,]*)([0-9.,]+)(.*)$/);if(!t)return"";const[,r,a,l]=t,c=parseFloat(a.replace(",","."));if(isNaN(c))return"";const h=(c/(1-e/100)).toFixed(2).replace(".",",");return`${r}${h}${l}`},OM=(n,e)=>{const t=typeof(n==null?void 0:n.originalPriceDisplay)=="string"?n.originalPriceDisplay.trim():"";return t||typeof(n==null?void 0:n.discountPercent)=="number"&&n.discountPercent>0&&NM(e,n.discountPercent)||""};function xM({navigate:n,onPurchaseRemoveAds:e,onPurchasePremium:t,onPurchasePack:r,showAds:a,hasPremium:l,ownedPackIds:c,enableRemoveAdsPurchase:d=!0,enablePremiumPurchase:h=!0,deepLinkAction:m}){const g=Ne.getPlatform()==="ios",[_,v]=ee.useState(!1),[T,I]=ee.useState(!1),[A,C]=ee.useState(null),[L,x]=ee.useState([]),[U,z]=ee.useState(!1),[$,se]=ee.useState(!1),[D,P]=ee.useState(null),[N,M]=ee.useState(pt.Info),[B,G]=ee.useState(!1),[k,Ve]=ee.useState(!1),[et,te]=ee.useState(""),[he,Ie]=ee.useState(null),[je,Ke]=ee.useState(!1),[j,K]=ee.useState(null),[ue,pe]=ee.useState(null),[Pe,ze]=ee.useState(!1),[tt,Mt]=ee.useState(null),[vt,Je]=ee.useState(!1),[Rt,ot]=ee.useState(!1),[Ft,Xt]=ee.useState(!1),Re=ee.useRef(null),oe=(Se,_e)=>{P(Se),M(_e),Se.toLowerCase().includes("integridad")&&G(!0)},De=()=>{P(null),G(!1)};ee.useEffect(()=>{try{new URLSearchParams(window.location.search).get("help")==="1"&&ot(!0)}catch{}},[]),ee.useEffect(()=>{if(!(m!=null&&m.nonce)||Re.current===m.nonce||!m.packId||!L||L.length===0)return;const Se=L.find(_e=>(_e==null?void 0:_e.productId)===m.packId);Se&&(Re.current=m.nonce,Ie(Se),K(null),te(m.promoCode??""),Se.requiresPromoCode===!0&&m.openRedeem!==!1&&Ve(!0))},[m,L]),ee.useEffect(()=>{Hk();const Se=async()=>{try{console.log("[StoreScreen]  Iniciando carga de productos desde Firestore..."),console.log("[StoreScreen]  Forzando recarga de configuracin para obtener ltimos cambios..."),await AA();const _e=await Ty();console.log("[StoreScreen]  Productos obtenidos:",_e.length,"productos"),console.log("[StoreScreen]  Productos completos:",JSON.stringify(_e,null,2));const me=_e.filter(re=>{const ye=Ne.getPlatform(),$e=Array.isArray(re.platforms)?re.platforms:null,qe=$e?$e.map(oi=>String(oi||"").toLowerCase().trim()).filter(oi=>!!oi):null,Pt=String(re.platform||"").toLowerCase().trim(),yt=qe&&qe.length>0?!!(qe.includes(ye)||ye==="web"&&qe.includes("android")):!Pt||Pt==="both"||Pt===ye||ye==="web"&&Pt==="android",Fe=re.isActive!==!1,Et=Eg.getEnvironment(),ai=re.environment||"both";return yt&&Fe&&(Et==="pre"||ai==="both"||ai===Et)});console.log("[StoreScreen]  Productos filtrados (activos + android + ambiente):",me.length),console.log(`[StoreScreen]  Ambiente actual: ${Eg.getEnvironment().toUpperCase()}`);try{for(const re of me){if(console.log(`[StoreScreen]  Procesando producto: ${re.title}, soldOut inicial: ${re.soldOut}`),(!re.discountPercent||re.discountPercent===0)&&(re.discountPercent=void 0,re.discountReason=""),re.promoEndDate){const ye=new Date(re.promoEndDate);new Date>ye&&(re.discountPercent=void 0,re.discountReason="")}if(re.isFree===!0&&re.requiresPromoCode===!0){console.log(`[StoreScreen]  Cargando cdigos promo para: ${re.productId}`);const ye=await CA(re.productId);console.log(`[StoreScreen]  Stats: total=${ye.total}, available=${ye.available}, assigned=${ye.assigned}`),(ye.available<=0||re.soldOut)&&(console.log(`[StoreScreen]  Marcando como AGOTADO (cdigos disponibles: ${ye.available}, soldOut manual: ${re.soldOut})`),re.soldOut=!0),re.promoStats=ye}}}catch(re){console.warn("[StoreScreen] Error cargando cdigos promo:",re)}const ge=me.sort((re,ye)=>{if(re.soldOut&&!ye.soldOut)return 1;if(!re.soldOut&&ye.soldOut)return-1;const $e=re.order??999,qe=ye.order??999;return $e-qe});x(ge)}catch(_e){console.error("[StoreScreen]  ERROR cargando productos de tienda:",_e),console.error("[StoreScreen] Stack trace:",_e==null?void 0:_e.stack),oe("Error al cargar los productos. Intenta ms tarde.",pt.Error)}finally{console.log("[StoreScreen]  Marcando purchasesRestored=true"),z(!0)}};console.log("[StoreScreen]  Componente montado, iniciando carga"),Se()},[]);const Ee=async(Se,_e)=>{var me;try{console.log("[StoreScreen]  Iniciando compra de producto:",_e),console.log("[StoreScreen] Llamando a buyProduct...");const ge=L.find(ye=>ye.productId===_e);Bk(_e,(ge==null?void 0:ge.type)||"unknown");const re=await yw(_e);if(console.log("[StoreScreen]  Compra completada exitosamente:",JSON.stringify(re)),re&&(re.validated||re.finishSuccess||re.alreadyOwned||re.restored)){try{console.log("[StoreScreen] Logro desbloqueado: Por fin alguien paga!")}catch(ye){console.warn("[StoreScreen] No se pudo desbloquear logro Por fin alguien paga!:",ye)}if(_e==="remove_ads"||(ge==null?void 0:ge.type)==="remove_ads")try{console.log("[StoreScreen] Logro desbloqueado: Hroe del Silencio")}catch(ye){console.warn("[StoreScreen] No se pudo desbloquear logro Hroe del Silencio:",ye)}try{const ye=L.filter(qe=>qe.type!=="remove_ads"&&qe.type!=="premium_phrases").map(qe=>qe.productId);ye.length>0&&ye.every(qe=>Array.isArray(c)?c.includes(qe):!1)&&console.log("[StoreScreen] Logro desbloqueado: Hombre de negocios")}catch(ye){console.warn("[StoreScreen] No se pudo desbloquear logro Hombre de negocios:",ye)}if(console.log("[StoreScreen]  Compra finalizada/validada, ejecutando callback de accin..."),Hd({productId:_e,productType:(ge==null?void 0:ge.type)||"unknown",price:(ge==null?void 0:ge.price)||0,currency:"EUR"}),$k({productId:_e,productType:(ge==null?void 0:ge.type)||"unknown",price:(ge==null?void 0:ge.price)||0,currency:"EUR"}),_e==="premium_phrases"||(ge==null?void 0:ge.type)==="premium_phrases"){console.log("[StoreScreen]  Compra de premium detectada, verificando cach de frases...");try{const{phraseCache:ye}=await Wt(async()=>{const{phraseCache:qe}=await Promise.resolve().then(()=>Ki);return{phraseCache:qe}},void 0);ye.premiumPhrases.length>0?console.log("[StoreScreen]  Frases premium ya estn en cach, omitiendo descarga"):(console.log("[StoreScreen]  No hay frases premium en cach, descargando..."),await dl(!0),console.log("[StoreScreen]  Frases premium descargadas correctamente"))}catch(ye){console.warn("[StoreScreen]  Error verificando/actualizando cach de frases:",ye)}}if(r&&(ge!=null&&ge.productId)&&(console.log("[StoreScreen]  Pack comprado:",ge.productId),r(ge.productId),window.optimizedCache&&typeof window.optimizedCache.invalidateUserCache=="function"&&window.optimizedCache.invalidateUserCache(((me=auth.currentUser)==null?void 0:me.uid)||"")),Se(),re.alreadyOwned||re.restored?oe(" Producto restaurado exitosamente. Ya lo tenas comprado!",pt.Success):re.validated?oe(" Compra realizada con xito! Sincronizando...",pt.Success):re.finishSuccess&&oe(" Compra finalizada. Sincronizando...",pt.Success),re.validated||re.finishSuccess){console.log("[StoreScreen]  Iniciando restauracin automtica post-compra...");try{const ye=Ne.getPlatform(),$e=Fe=>{const Et=Array.isArray(Fe==null?void 0:Fe.platforms)?Fe.platforms:null,ai=Et?Et.map(oi=>String(oi||"").toLowerCase().trim()).filter(oi=>!!oi):null,Ei=String((Fe==null?void 0:Fe.platform)||"").toLowerCase().trim();return ai&&ai.length>0?!!(ai.includes(ye)||ye==="web"&&ai.includes("android")):!Ei||Ei==="both"||Ei===ye||ye==="web"&&Ei==="android"},qe=L.find(Fe=>Fe.type==="remove_ads"&&$e(Fe)),Pt=L.find(Fe=>Fe.type==="premium_phrases"&&$e(Fe)),yt=tu.getAll();RM({removeAdsId:qe==null?void 0:qe.productId,premiumId:Pt==null?void 0:Pt.productId,storeProducts:L,productConfigs:yt,delayMs:1500,silent:!0}).then(Fe=>{Fe.hasRemoveAds&&e(),Fe.hasPremium&&t(),Fe.ownedPackIds&&Fe.ownedPackIds.length>0&&r&&Fe.ownedPackIds.forEach(Et=>r(Et)),console.log("[StoreScreen]  Restauracin automtica completada")}).catch(Fe=>{console.warn("[StoreScreen]  Error en restauracin automtica:",Fe)})}catch(ye){console.warn("[StoreScreen]  Error iniciando restauracin automtica:",ye)}}re.finishSuccess||(console.warn("[StoreScreen]  La transaccin no se pudo finalizar completamente"),setTimeout(async()=>{try{console.log("[StoreScreen]  Ejecutando restauracin de respaldo (finalizacin incompleta)..."),await Ze()}catch(ye){console.warn("[StoreScreen]  Error en restauracin de respaldo:",ye)}},4e3))}else{console.warn("[StoreScreen]  Compra completada pero sin validacin");try{console.log("[StoreScreen]  Intentando restauracin automtica tras compra sin validacin...");const ye=await eu();if(ye.hasRemoveAds&&e(),ye.hasPremium){t();try{const{phraseCache:$e}=await Wt(async()=>{const{phraseCache:Pt}=await Promise.resolve().then(()=>Ki);return{phraseCache:Pt}},void 0);$e.premiumPhrases.length>0||await dl(!0)}catch{}}ye.hasRemoveAds||ye.hasPremium?oe(" Compra activada automticamente tras verificacin local.",pt.Success):oe(' Compra procesada. Si no aparece activada, intenta "Restaurar compras" en unos segundos.',pt.Warning)}catch{oe(' Compra procesada. Si no aparece activada, intenta "Restaurar compras" en unos segundos.',pt.Warning)}}console.log("[StoreScreen]  Compra procesada correctamente")}catch(ge){console.error("[StoreScreen]  ERROR en compra:",ge),console.error("[StoreScreen] Error message:",ge==null?void 0:ge.message),console.error("[StoreScreen] Error stack:",ge==null?void 0:ge.stack),console.error("[StoreScreen] Error completo:",JSON.stringify(ge,Object.getOwnPropertyNames(ge)));const re=String((ge==null?void 0:ge.message)||String(ge)),ye=ge==null?void 0:ge.code;ye==="ITEM_ALREADY_OWNED"||re.includes("already owned")||re.includes("Ya posees")?oe('Ya posees este producto. Si no aparece activado, usa el botn "Restaurar compras".',pt.Warning):ye==="USER_CANCELED"||re.includes("canceled")||re.includes("cancelled")?oe("Compra cancelada",pt.Info):ye==="SERVICE_UNAVAILABLE"||re.includes("service unavailable")||re.includes("no disponible")?oe("El servicio de la tienda no est disponible temporalmente. Intenta ms tarde.",pt.Error):ye==="BILLING_UNAVAILABLE"||re.includes("billing unavailable")||re.includes("facturacin")?oe("Las compras no estn disponibles en este dispositivo o regin.",pt.Error):ye==="ITEM_UNAVAILABLE"||re.includes("item unavailable")||re.includes("producto no est disponible")?oe("Este producto no est disponible para compra. Verifica tu conexin e intenta ms tarde.",pt.Error):ye==="DEVELOPER_ERROR"||re.includes("developer error")||re.includes("configuracin")?oe("Error de configuracin del sistema. Contacta al soporte tcnico.",pt.Error):re.includes("Timeout")||re.includes("tard")?oe('La compra tard mucho tiempo. Si ya pagaste, intenta "Restaurar compras" en unos minutos.',pt.Warning):re.includes("Plugin")||re.includes("no est")?oe("Error del sistema de compras. Asegrate de estar usando la app desde Google Play Store.",pt.Error):re.includes("autenticar")||re.includes("auth")?oe("Error de autenticacin. Intenta cerrar y abrir la app nuevamente.",pt.Error):oe("Error en la compra: "+re,pt.Error)}},Te=async Se=>{try{if(c&&c.includes(Se.productId)){oe(" Ya tienes este pack adquirido",pt.Success),r&&r(Se.productId);return}console.log("[StoreScreen]  Adquiriendo pack gratuito:",Se.productId),oe(` ${Se.title} adquirido con xito!`,pt.Success),r&&r(Se.productId),Hd({productId:Se.productId,productType:Se.type||"other",price:0,currency:"EUR"})}catch(_e){console.error("[StoreScreen] Error adquiriendo pack gratuito:",_e),oe("Error inesperado. Intntalo de nuevo.",pt.Error)}},be=Se=>{Ie(Se),te(""),K(null),Ve(!0)},Ue=async()=>{try{if(!he)return;K(null),Je(!0);const Se=he.productId;if(he.requiresPromoCode){const Fe=await hg(Se),Et=(et||"").trim(),ai=Et.replace(/\s+/g,"").toLowerCase();if(!Fe.map(ji=>(ji||"").replace(/\s+/g,"").toLowerCase()).includes(ai)){K("Cdigo no vlido."),Je(!1);return}console.log("[StoreScreen]  Cdigo encontrado, intentando adquirir...");try{Ve(!1),oe(` ${he.title} adquirido con xito!`,pt.Success),Mt(Et),r&&r(Se),Hd({productId:Se,productType:he.type||"other",price:0,currency:"EUR"})}catch(ji){console.error("[StoreScreen] Error adquiriendo pack con cdigo:",ji),K("Error inesperado. Intntalo de nuevo."),Ve(!0)}Je(!1);return}const me=await hg(Se),re=(et||"").trim().replace(/\s+/g,"").toLowerCase(),$e=me.map(Fe=>(Fe||"").replace(/\s+/g,"").toLowerCase()).includes(re),qe=$e?me.find(Fe=>(Fe||"").replace(/\s+/g,"").toLowerCase()===re)||re:null;if(!$e){K("Cdigo no vlido."),Je(!1);return}const Pt=`starter_code_assigned_${Se}`,yt=localStorage.getItem(Pt);if(yt){K(`Cdigo ya asignado en este dispositivo: ${yt}`),Je(!1);return}Je(!1),Ke(!0),localStorage.setItem(Pt,qe||re);try{await IA(Se,qe||re)}catch(Fe){console.warn("[StoreScreen] No se pudo registrar uso del cdigo de entrada:",Fe)}Ve(!1),oe(` ${he.title} adquirido con xito!`,pt.Success),r&&r(Se),Hd({productId:Se,productType:he.type||"other",price:0,currency:"EUR"}),Ke(!1)}catch(Se){console.error("[StoreScreen] error confirmPromoEntry",Se),K("Error al solicitar cdigo. Intenta de nuevo ms tarde.")}finally{Ke(!1)}},He=ee.useMemo(()=>{const Se=L||[];if(!Se.length)return Se;const _e=[],me=[],ge=[],re=ye=>{const $e=Number(ye==null?void 0:ye.order);return Number.isFinite($e)?$e:9999};for(const ye of Se){if(!(ye.type!=="remove_ads"&&ye.type!=="premium_phrases")){_e.push(ye);continue}(c&&Array.isArray(c)?c.includes(ye.productId):!1)?ge.push(ye):me.push(ye)}return _e.sort((ye,$e)=>re(ye)-re($e)),me.sort((ye,$e)=>re(ye)-re($e)),ge.sort((ye,$e)=>re(ye)-re($e)),[..._e,...me,...ge]},[L,c]),It=async()=>{if(!(!ue||Pe)){ze(!0);try{const Se=await yw(ue);Se&&(Se.validated||Se.finishSuccess||Se.alreadyOwned||Se.restored)?(Ve(!1),oe(" Compra gratis activada y validada! Disfruta del pack.",pt.Success)):oe(' Compra procesada. Si no aparece activada, usa "Restaurar compras" en unos minutos.',pt.Warning)}catch(Se){const _e=String((Se==null?void 0:Se.message)||String(Se));oe("Error en la compra: "+_e,pt.Error)}finally{ze(!1),pe(null)}}};ee.useEffect(()=>{if(!ue||Ne.getPlatform()!=="android")return;let Se,_e=!1;const me=ge=>{ge.isActive&&!_e&&(_e=!0,It())};try{Se=tl.addListener("appStateChange",me)}catch(ge){console.warn("[StoreScreen] No se pudo agregar listener de app state:",ge)}return()=>{try{Se&&Se.remove&&Se.remove()}catch{}}},[ue]);const Ze=async()=>{var Se;if(!$){se(!0);try{console.log("[StoreScreen]  Iniciando restauracin manual de compras...");const _e=Ne.getPlatform(),me=qe=>{const Pt=Array.isArray(qe==null?void 0:qe.platforms)?qe.platforms:null,yt=Pt?Pt.map(Et=>String(Et||"").toLowerCase().trim()).filter(Et=>!!Et):null,Fe=String((qe==null?void 0:qe.platform)||"").toLowerCase().trim();return yt&&yt.length>0?!!(yt.includes(_e)||_e==="web"&&yt.includes("android")):!Fe||Fe==="both"||Fe===_e||_e==="web"&&Fe==="android"},ge=L.find(qe=>qe.type==="remove_ads"&&me(qe)),re=L.find(qe=>qe.type==="premium_phrases"&&me(qe)),ye=tu.getAll();console.log("[StoreScreen]  Configuracin de productos registrada:",ye.length);const $e=await eu({removeAdsId:ge==null?void 0:ge.productId,storeProducts:L,productConfigs:ye});if(console.log("[StoreScreen]  Restauracin completada:",$e),$e.hasRemoveAds||$e.hasPremium||$e.ownedPackIds&&$e.ownedPackIds.length>0){const qe=($e.hasRemoveAds?1:0)+($e.hasPremium?1:0)+(((Se=$e.ownedPackIds)==null?void 0:Se.length)||0);if(Fk(qe),$e.hasRemoveAds&&e(),$e.hasPremium){t(),console.log("[StoreScreen]  Premium restaurado, verificando cach de frases...");try{const{phraseCache:yt}=await Wt(async()=>{const{phraseCache:Et}=await Promise.resolve().then(()=>Ki);return{phraseCache:Et}},void 0);yt.premiumPhrases.length>0?console.log("[StoreScreen]  Frases premium ya estn en cach, omitiendo descarga"):(console.log("[StoreScreen]  No hay frases premium en cach, descargando..."),await dl(!0),console.log("[StoreScreen]  Frases premium descargadas correctamente"))}catch(yt){console.warn("[StoreScreen]  Error verificando/actualizando cach de frases:",yt)}}if($e.ownedPackIds&&$e.ownedPackIds.length>0&&r)for(const yt of $e.ownedPackIds)r(yt);const Pt=[];$e.hasRemoveAds&&Pt.push("Sin anuncios"),$e.hasPremium&&Pt.push("Frases premium"),$e.ownedPackIds&&$e.ownedPackIds.length>0&&Pt.push(`${$e.ownedPackIds.length} pack(s)`),oe(` Compras restauradas con xito!

Productos: ${Pt.join(", ")}`,pt.Success)}else oe("No se encontraron compras para restaurar.",pt.Info)}catch(_e){console.error("[StoreScreen]  Error en restauracin:",_e);const me=_e.message||_e.toString();me.includes("play store")||me.includes("google play")?oe("Error del sistema de compras. Asegrate de estar usando la app desde Google Play Store.",pt.Error):me.includes("autenticar")||me.includes("auth")?oe("Error de autenticacin. Intenta iniciar sesin nuevamente.",pt.Error):me.includes("red")||me.includes("conexin")||me.includes("network")?oe("Error de conexin. Verifica tu conexin a internet e intenta nuevamente.",pt.Error):oe("Error restaurando compras: "+me,pt.Error)}finally{se(!1)}}};return S.jsxs("div",{className:"relative overflow-hidden flex flex-col w-full min-h-screen animate-fadeIn",children:[B&&D&&S.jsx(br,{isVisible:!0,onClose:De,children:S.jsxs("div",{className:"bg-slate-800/95 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-red-700 text-center",children:[S.jsx("div",{className:"text-2xl text-red-400 mb-2",children:S.jsx("i",{className:"fas fa-shield-alt"})}),S.jsx("div",{className:"text-lg font-bold text-red-300 mb-2",children:"Error de integridad"}),S.jsx("div",{className:"text-white mb-4 whitespace-pre-line",children:D}),S.jsx("button",{className:"mt-2 px-4 py-2 bg-red-600 text-white rounded shadow",onClick:De,children:"Cerrar"})]})}),D&&!B&&S.jsx("div",{className:`fixed top-4 left-1/2 z-50 -translate-x-1/2 px-4 py-2 rounded shadow-lg font-semibold ${N===pt.Error?"bg-red-600 text-white":N===pt.Success?"bg-green-600 text-white":"bg-slate-700 text-white"}`,onClick:De,style:{cursor:"pointer"},children:D}),k&&S.jsx(br,{isVisible:!0,onClose:()=>Ve(!1),children:S.jsxs("div",{className:"bg-slate-800/95 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-slate-700 text-center max-w-md mx-auto",children:[S.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:(he==null?void 0:he.title)||"Pack especial"}),S.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Introduce tu cdigo promocional para desbloquear este contenido"}),S.jsx("input",{type:"text",value:et,onChange:Se=>te(Se.target.value),placeholder:"Cdigo promocional",className:"w-full px-4 py-3 bg-slate-700 text-white rounded-lg border border-slate-600 focus:border-cyan-500 focus:outline-none mb-2"}),j&&S.jsx("p",{className:"text-red-400 text-sm mb-4",children:j}),S.jsxs("div",{className:"flex gap-3",children:[S.jsx("button",{onClick:()=>Ve(!1),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition",children:"Cancelar"}),S.jsx("button",{onClick:Ue,disabled:vt||je||!et.trim(),className:"flex-1 px-4 py-2 bg-gradient-to-r from-cyan-500 to-pink-500 hover:from-cyan-600 hover:to-pink-600 text-white font-bold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:vt||je?"Validando...":"Confirmar"})]})]})}),S.jsxs("div",{className:"flex-1 w-full max-w-2xl mx-auto px-5 sm:px-4 md:px-0 py-6",children:[S.jsxs("div",{className:"relative mb-6 pt-[calc(env(safe-area-inset-top)+0.75rem)]",children:[S.jsx("button",{onClick:()=>{try{const Se=(()=>{try{const _e=sessionStorage.getItem("return_to_endgame")==="1",me=sessionStorage.getItem("return_to_completion")==="1";return _e||me}catch{return!1}})();n(Se?gt.Game:gt.Home)}catch(Se){console.log("Fallo al navegar, intentando historial...",Se),window.history.length>1&&window.history.back()}},className:"absolute left-0 text-white text-2xl",children:S.jsx("i",{className:"fas fa-arrow-left"})}),S.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-center mt-3",children:[S.jsx("i",{className:"fas fa-store mr-3 gold-shimmer text-4xl md:text-5xl"}),S.jsx("span",{className:"gold-shimmer text-4xl md:text-5xl",children:"Tienda"})]}),S.jsx("p",{className:"text-center gold-static text-base md:text-lg mt-2",children:"Desbloquea todo el potencial!"})]}),S.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5 sm:gap-6",children:He.length===0?S.jsx("div",{className:"col-span-2 text-center text-slate-400",children:"No hay productos disponibles."}):(()=>{const Se=[],_e=[];return He.forEach(me=>{(me.type==="remove_ads"?!a:me.type==="premium_phrases"?!!l:Array.isArray(c)?c.includes(me.productId):!1)?_e.push(me):Se.push(me)}),S.jsxs(S.Fragment,{children:[Se.map(me=>{const ge=Sw(me),re=!1,ye=me.soldOut?()=>{}:me.requiresPromoCode===!0?()=>be(me):me.isFree===!0?()=>Te(me):()=>Ee(()=>{me.type==="remove_ads"?e():me.type==="premium_phrases"?t():r&&r(me.productId)},me.productId);return S.jsx(vw,{...me,price:ge,onClick:ye,owned:re,productType:me.type},me.productId)}),_e.length>0&&S.jsx("div",{className:"col-span-1 sm:col-span-2 my-4",children:S.jsxs("button",{onClick:()=>Xt(!Ft),className:"w-full flex items-center gap-3 py-3 px-4 bg-slate-800/60 hover:bg-slate-800/80 rounded-lg border border-slate-700/50 transition-all group",children:[S.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-slate-600 to-slate-500"}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("i",{className:"fas fa-check-circle text-green-400 text-sm group-hover:text-green-300 transition-colors"}),S.jsxs("span",{className:"text-slate-400 group-hover:text-slate-300 text-sm font-semibold transition-colors",children:["Mis packs adquiridos (",_e.length,")"]}),S.jsx("i",{className:`fas fa-chevron-${Ft?"up":"down"} text-slate-400 group-hover:text-slate-300 text-xs transition-all`})]}),S.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-500 via-slate-600 to-transparent"})]})}),Ft&&_e.map(me=>{const ge=Sw(me),re=!0,ye=()=>{};return S.jsx(vw,{...me,price:ge,onClick:ye,owned:re,productType:me.type},me.productId)})]})})()}),S.jsxs("div",{className:"mt-3 flex items-center justify-center bg-slate-700/40 text-slate-200 rounded-lg px-3 py-2 ring-1 ring-white/10",children:[S.jsx("i",{className:"fas fa-lock text-green-300 mr-2"}),S.jsx("span",{className:"text-xs sm:text-sm",children:g?"Pago seguro con Apple Pay":"Pago seguro con Google Play"}),S.jsx("i",{className:`fab ${g?"fa-apple-pay":"fa-google-play"} text-green-300 ml-2`})]}),S.jsx("div",{className:"flex justify-center mt-4",children:S.jsxs("button",{className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-200 font-bold py-2 px-6 rounded-lg shadow transition-all text-base",onClick:()=>ot(!0),children:[S.jsx("i",{className:"fas fa-question-circle"}),"Ayuda"]})}),Rt&&S.jsx(br,{onClose:()=>ot(!1),isVisible:!0,children:S.jsxs("div",{className:"bg-slate-800/95 backdrop-blur-sm rounded-xl p-6 shadow-2xl border border-slate-700 relative max-w-md mx-auto text-center",children:[S.jsx("h2",{className:"text-xl font-bold text-slate-100 mb-4",children:"Centro de ayuda y soporte"}),S.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[S.jsxs("button",{className:"flex items-center gap-2 bg-gradient-to-r from-cyan-500 to-pink-500 hover:from-cyan-600 hover:to-pink-600 text-white font-bold py-2 px-5 rounded-lg shadow-lg transition-all text-base disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>{Ze(),ot(!1)},type:"button",disabled:$,children:[S.jsx("i",{className:"fas fa-sync-alt"}),"Restaurar mis compras"]}),S.jsx("span",{className:"text-xs text-slate-400 text-center max-w-xs",children:"Si has cambiado de mvil, reinstalado la app o no ves tus compras activas, pulsa aqu para recuperarlas automticamente."}),S.jsxs("a",{href:"mailto:sinami.studio22@gmail.com?subject=%5BYoNunca%5D%20Problema%20en%20compras",className:"flex items-center gap-2 bg-slate-700 hover:bg-slate-600 text-slate-200 font-bold py-2 px-5 rounded-lg shadow transition-all text-base",style:{textDecoration:"none"},target:"_blank",rel:"noopener noreferrer",children:[S.jsx("i",{className:"fas fa-envelope"}),"Contactar soporte compras"]}),S.jsxs("button",{className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-lg shadow transition-all text-base mt-2",style:{textDecoration:"none"},onClick:async()=>{let Se=A;if(!Se)try{Se=await bM(),C(Se)}catch{}const _e=`https://miguelrs01.github.io/yo-nunca-app-web/delete-account.html${Se?`?deviceId=${encodeURIComponent(Se)}`:""}`;window.open(_e,"_blank")},type:"button",children:[S.jsx("i",{className:"fas fa-user-slash"}),"Eliminar mi cuenta"]}),S.jsx("span",{className:"text-xs text-slate-400 text-center max-w-xs mt-1 block",children:`Si accedes desde la app, tu identificador se rellenar automticamente. Si accedes desde la web, te solicitar el siguiente identificador de dispositivo${A?`: ${A}`:""}`})]}),S.jsx("button",{className:"absolute top-3 right-3 text-slate-400 hover:text-slate-200 transition",onClick:()=>ot(!1),"aria-label":"Cerrar ayuda",children:S.jsx("i",{className:"fas fa-times"})})]})})]})]})}const DM=({onClose:n})=>{const[e,t]=ee.useState(""),[r,a]=ee.useState(!1),[l,c]=ee.useState(""),[d,h]=ee.useState(!1),m=async g=>{if(g.preventDefault(),e.trim().length<10){c("La frase debe tener al menos 10 caracteres.");return}c(""),a(!0);try{await TA(e),Gk(),h(!0),setTimeout(()=>{n()},2e3)}catch{c("No se pudo enviar la sugerencia. Intntalo de nuevo."),a(!1)}};return S.jsx(br,{onClose:n,children:S.jsx("div",{className:"p-6",children:d?S.jsxs("div",{className:"text-center",children:[S.jsx("i",{className:"fas fa-check-circle text-5xl text-green-400 mb-4"}),S.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Gracias!"}),S.jsx("p",{className:"text-slate-300",children:"Tu sugerencia ha sido enviada para revisin."})]}):S.jsxs(S.Fragment,{children:[S.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Sugerir una Frase"}),S.jsx("p",{className:"text-slate-400 mb-6",children:"Tienes una idea genial? Comprtela con nosotros! Si es aprobada, aparecer en el juego."}),S.jsxs("form",{onSubmit:m,children:[S.jsxs("div",{className:"relative",children:[S.jsx("span",{className:"absolute left-4 top-3 text-slate-400",children:"Yo nunca..."}),S.jsx("input",{type:"text",value:e,onChange:g=>t(g.target.value),placeholder:"he hecho...",className:"w-full bg-slate-700 border border-slate-600 rounded-md py-3 pr-4 pl-36 focus:ring-2 focus:ring-cyan-400 focus:outline-none transition",disabled:r})]}),l&&S.jsx("p",{className:"text-red-400 text-sm mt-2",children:l}),S.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[S.jsx(Qt,{type:"button",variant:"secondary",onClick:n,disabled:r,children:"Cancelar"}),S.jsx(Qt,{type:"submit",disabled:r||e.trim()==="",children:r?S.jsxs(S.Fragment,{children:[S.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Enviando..."]}):"Enviar Sugerencia"})]})]})]})})})},kM=({title:n,message:e,buttonText:t,onClose:r,showPlayStoreButton:a=!1,playStoreButtonText:l="Descargar App",playStoreUrl:c=""})=>{const d=async()=>{if(c)try{await Ny.open({url:c})}catch(h){console.error("[PopupModal] Error abriendo Play Store:",h),window.open(c,"_blank")}};return S.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 p-4",children:S.jsxs("div",{className:"bg-gradient-to-br from-purple-900 to-indigo-900 rounded-2xl shadow-2xl max-w-md w-full p-6 border-2 border-purple-500",children:[n&&S.jsx("h2",{className:"text-2xl font-bold text-white mb-4 text-center",children:n}),e&&S.jsx("p",{className:"text-gray-200 mb-6 text-center leading-relaxed whitespace-pre-line",children:e}),S.jsxs("div",{className:"space-y-3",children:[a&&c&&S.jsxs("button",{onClick:d,className:`w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold py-3 px-6 rounded-lg 
                                     hover:from-green-600 hover:to-emerald-700 transition-all duration-200 
                                     shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center justify-center gap-2`,children:[S.jsx("i",{className:"fab fa-google-play text-xl"}),l]}),S.jsx("button",{onClick:r,className:`w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white font-semibold py-3 px-6 rounded-lg 
                                 hover:from-pink-600 hover:to-purple-700 transition-all duration-200 
                                 shadow-lg hover:shadow-xl transform hover:scale-105 `,children:t})]})]})})},MM=()=>(ee.useRef(null),ee.useEffect(()=>{let n=!0;(async()=>{try{Ne.getPlatform()!=="web"&&await wr.showBanner()}catch(r){console.error("Error al cargar el anuncio:",r)}})();const t=()=>{n&&Ne.getPlatform()!=="web"&&wr.showBanner()};return window.addEventListener("online",t),()=>{n=!1,Ne.getPlatform()!=="web"&&wr.hideBanner().catch(()=>{}),window.removeEventListener("online",t)}},[]),null),$d="1.0.0",xp=1440*60*1e3,LM=5*1024*1024,Pc="yo_nunca_cache_";class UM{constructor(){ke(this,"memoryCache",new Map);ke(this,"stats",{totalSize:0,itemCount:0,hitRate:0,hits:0,misses:0,lastCleanup:Date.now()})}async incrementDataVersion(){try{if(!Ht)return;const e=At(it,"consolidated","metadata");await da(e,{dataVersion:Date.now(),lastUpdate:Jc()},{merge:!0}),console.log("[OptimizedCache]  Data version incremented")}catch(e){console.error("[OptimizedCache]  Error incrementing data version:",e)}}setMemoryCache(e,t,r){const a=JSON.stringify(t),l=new Blob([a]).size;this.memoryCache.set(e,{data:t,metadata:r,size:l}),this.stats.itemCount=this.memoryCache.size,console.log(`[OptimizedCache]  Memory cached: ${e} (${(l/1024).toFixed(2)} KB)`)}getMemoryCache(e){const t=this.memoryCache.get(e);return t?Date.now()-t.metadata.timestamp>xp?(this.memoryCache.delete(e),this.stats.misses++,console.log(`[OptimizedCache]  Memory cache expired: ${e}`),null):(this.stats.hits++,t):(this.stats.misses++,null)}setLocalStorage(e,t,r){try{const a=Pc+e,l={data:t,metadata:r,size:0},c=JSON.stringify(l),d=new Blob([c]).size;return d>LM?(console.warn(`[OptimizedCache]  Data too large for localStorage: ${e} (${(d/1024).toFixed(2)} KB)`),!1):(l.size=d,localStorage.setItem(a,JSON.stringify(l)),this.stats.totalSize+=d,console.log(`[OptimizedCache]  localStorage saved: ${e} (${(d/1024).toFixed(2)} KB)`),!0)}catch(a){return console.error("[OptimizedCache]  Error saving to localStorage:",a),this.cleanExpiredCache(),!1}}getLocalStorage(e){try{const t=Pc+e,r=localStorage.getItem(t);if(!r)return this.stats.misses++,null;const a=JSON.parse(r);return a.metadata.version!==$d?(localStorage.removeItem(t),this.stats.misses++,console.log(`[OptimizedCache]  Version mismatch: ${e}`),null):Date.now()-a.metadata.timestamp>xp?(localStorage.removeItem(t),this.stats.misses++,console.log(`[OptimizedCache]  localStorage cache expired: ${e}`),null):(this.stats.hits++,a)}catch(t){return console.error("[OptimizedCache]  Error reading from localStorage:",t),this.stats.misses++,null}}async loadPhrases(e,t,r=!1){const a=`phrases_${e}`,l="[OptimizedCache:Phrases]";if(console.log(`${l}  Loading phrases for user: ${e}`),console.log(`${l}  Owned packs: [${t.join(", ")}]`),console.log(`${l}  Force refresh: ${r}`),!r){const m=this.getMemoryCache(a);if(m){const g=Object.keys(m.data.packPhrases);if(t.length===g.length&&t.every(v=>g.includes(v)))return console.log(`${l}  Memory cache HIT (0 reads)`),m.data;console.log(`${l}  Memory cache packs mismatch`)}}if(!r){const m=this.getLocalStorage(a);if(m){const g=Object.keys(m.data.packPhrases);if(t.length===g.length&&t.every(v=>g.includes(v)))return console.log(`${l}  localStorage cache HIT (0 reads)`),this.setMemoryCache(a,m.data,m.metadata),m.data;console.log(`${l}  localStorage cache packs mismatch`)}}console.log(`${l}  Fetching from Firestore (selective download)`);const c=Date.now();let d=0;const h={freePhrases:[],packPhrases:{},adultPhrases:[],allPhrases:[]};try{if(!Ht)return console.warn(`${l}  Firebase disabled, returning empty data`),h;const m=At(it,"consolidated","phrases_free"),g=await En(m);if(d++,g.exists()){const I=g.data().phrases||[];h.freePhrases=I.filter(A=>!A.packIds||A.packIds.length===0||A.isDemo===!0),h.allPhrases.push(...h.freePhrases),console.log(`${l}  Free phrases loaded: ${h.freePhrases.length}`)}for(const T of t)if(T!=="remove_ads")try{const I=At(it,"consolidated",`phrases_pack_${T}`),A=await En(I);if(d++,A.exists()){const L=A.data().phrases||[];h.packPhrases[T]=L,h.allPhrases.push(...L),console.log(`${l}  Pack ${T} loaded: ${L.length} phrases`)}else console.warn(`${l}  Pack document not found: ${T}`)}catch(I){console.error(`${l}  Error loading pack ${T}:`,I)}h.adultPhrases=h.allPhrases.filter(T=>T.isAdult===!0);const _=Date.now()-c;console.log(`${l}  Firestore load complete:`),console.log(`${l}    - Reads: ${d}`),console.log(`${l}    - Time: ${_}ms`),console.log(`${l}    - Total phrases: ${h.allPhrases.length}`),console.log(`${l}    - Free: ${h.freePhrases.length}`),console.log(`${l}    - Packs: ${Object.keys(h.packPhrases).length}`),console.log(`${l}    - Adult: ${h.adultPhrases.length}`);const v={version:$d,timestamp:Date.now(),dataVersion:Date.now(),userId:e,ownedPacks:t};return this.setMemoryCache(a,h,v),this.setLocalStorage(a,h,v),h}catch(m){return console.error(`${l}  Error loading phrases:`,m),h}}async loadAppConfig(e=!1){const t="app_config",r="[OptimizedCache:Config]";if(console.log(`${r}  Loading app config`),!e){const a=this.getMemoryCache(t);if(a)return console.log(`${r}  Memory cache HIT (0 reads)`),a.data}if(!e){const a=this.getLocalStorage(t);if(a)return console.log(`${r}  localStorage cache HIT (0 reads)`),this.setMemoryCache(t,a.data,a.metadata),a.data}console.log(`${r}  Fetching from Firestore`);try{if(!Ht)return null;const a=At(it,"consolidated","app_config"),l=await En(a);if(!l.exists())return console.warn(`${r}  Config document not found`),null;const c=l.data();console.log(`${r}  Config loaded (1 read)`);const d={version:$d,timestamp:Date.now(),dataVersion:Date.now(),ownedPacks:[]};return this.setMemoryCache(t,c,d),this.setLocalStorage(t,c,d),c}catch(a){return console.error(`${r}  Error loading config:`,a),null}}async loadUserPacks(e){const t="[OptimizedCache:UserPacks]";try{if(!Ht)return[];console.log(`${t}  Fetching user packs for: ${e}`);const r=At(it,"userPacks",e),a=await En(r);if(!a.exists())return console.log(`${t}  No packs found for user`),[];const c=a.data().packs||[];return console.log(`${t}  User packs loaded: [${c.join(", ")}] (1 read, ~100 bytes)`),c}catch(r){return console.error(`${t}  Error loading user packs:`,r),[]}}invalidateUserCache(e){const t=`phrases_${e}`;this.memoryCache.delete(t);const r=Pc+t;localStorage.removeItem(r),console.log(`[OptimizedCache]  Cache invalidated for user: ${e}`)}invalidateAllCache(){this.memoryCache.clear(),Object.keys(localStorage).forEach(t=>{t.startsWith(Pc)&&localStorage.removeItem(t)}),console.log("[OptimizedCache]  All cache invalidated")}cleanExpiredCache(){const e="[OptimizedCache:Cleanup]";console.log(`${e}  Starting cache cleanup`);let t=0;const r=Date.now();Object.keys(localStorage).forEach(l=>{if(l.startsWith(Pc))try{const c=localStorage.getItem(l);if(!c)return;const d=JSON.parse(c);(r-d.metadata.timestamp>xp||d.metadata.version!==$d)&&(localStorage.removeItem(l),t++)}catch{localStorage.removeItem(l),t++}}),this.stats.lastCleanup=r,console.log(`${e}  Cleanup complete: ${t} items removed`)}getStats(){return this.stats.hitRate=this.stats.hits+this.stats.misses>0?this.stats.hits/(this.stats.hits+this.stats.misses)*100:0,{...this.stats}}resetStats(){this.stats.hits=0,this.stats.misses=0,this.stats.hitRate=0}printStats(){const e=this.getStats();console.log("========================================"),console.log("OPTIMIZED CACHE STATISTICS"),console.log("========================================"),console.log(`Hit Rate: ${e.hitRate.toFixed(2)}%`),console.log(`Hits: ${e.hits}`),console.log(`Misses: ${e.misses}`),console.log(`Memory Items: ${e.itemCount}`),console.log(`Total Size: ${(e.totalSize/1024).toFixed(2)} KB`),console.log(`Last Cleanup: ${new Date(e.lastCleanup).toLocaleString()}`),console.log("========================================")}}const xy=new UM;xy.cleanExpiredCache();setInterval(()=>{xy.cleanExpiredCache()},3600*1e3);const Ha=async(n,e)=>{try{const t=Oy();return await xy.loadPhrases(t,e,n)}catch(t){return console.error("[updatePhraseCache]  Error actualizando cache:",t),null}},Qo=er("PushNotifications",{});var ww;(function(n){n[n.Sunday=1]="Sunday",n[n.Monday=2]="Monday",n[n.Tuesday=3]="Tuesday",n[n.Wednesday=4]="Wednesday",n[n.Thursday=5]="Thursday",n[n.Friday=6]="Friday",n[n.Saturday=7]="Saturday"})(ww||(ww={}));const fr=er("LocalNotifications",{web:()=>Wt(()=>import("./web-XzrX-B8n.js"),[]).then(n=>new n.LocalNotificationsWeb)}),qd="usage_sessions",Yd=1001,Kd=1002;class VM{constructor(){ke(this,"sessions",[]);ke(this,"initialized",!1)}async initialize(){if(this.initialized){console.log("[UsageTracker] Ya inicializado");return}if(!Ne.isNativePlatform()){console.log("[UsageTracker] No disponible en web");return}try{console.log("[UsageTracker]  Inicializando...");const{value:e}=await cn.get({key:qd});if(e&&(this.sessions=JSON.parse(e),console.log("[UsageTracker] Sesiones cargadas:",this.sessions.length)),(await fr.checkPermissions()).display!=="granted"&&(await fr.requestPermissions()).display!=="granted"){console.warn("[UsageTracker]  Permisos de notificaciones locales denegados");return}this.registerLocalNotificationListeners(),this.initialized=!0,console.log("[UsageTracker]  Inicializado correctamente"),await this.analyzeAndSchedule()}catch(e){console.error("[UsageTracker]  Error inicializando:",e)}}registerLocalNotificationListeners(){fr.addListener("localNotificationActionPerformed",async e=>{console.log("[UsageTracker]  Notificacin local tocada:",e.notification.id),await this.cancelAllNotifications(),await this.trackSession()})}async trackSession(){this.initialized||await this.initialize();const e=new Date,t={timestamp:e.getTime(),dayOfWeek:e.getDay(),hour:e.getHours()};this.sessions.push(t),this.sessions.length>50&&(this.sessions=this.sessions.slice(-50)),await cn.set({key:qd,value:JSON.stringify(this.sessions)}),console.log("[UsageTracker]  Sesin registrada:",{day:this.getDayName(t.dayOfWeek),hour:`${t.hour}:00`}),await this.cancelAllNotifications(),await this.analyzeAndSchedule()}async analyzeAndSchedule(){if(this.sessions.length<5){console.log("[UsageTracker]  Pocas sesiones para analizar patrones (mnimo 5)"),await this.scheduleComebackNotification();return}const e={};this.sessions.forEach(a=>{const l=`${a.dayOfWeek}-${a.hour}`;e[l]=(e[l]||0)+1});let t="",r=0;if(Object.entries(e).forEach(([a,l])=>{l>r&&(r=l,t=a)}),r>=3){const[a,l]=t.split("-"),c=parseInt(a),d=parseInt(l);console.log(`[UsageTracker]  Patrn detectado: ${this.getDayName(c)} a las ${d}:00 (${r} veces)`),await this.scheduleSmartNotification(c,d)}else console.log("[UsageTracker]  Sin patrn claro detectado an"),await this.scheduleComebackNotification()}async scheduleSmartNotification(e,t){try{let r=t,a=30,l=e;t===0?(r=23,a=30,l=e===0?6:e-1):r=t-1,console.log("[UsageTracker]  Programando notificacin inteligente:"),console.log(`   Da: ${this.getDayName(l)} a las ${r}:${a}`),await fr.cancel({notifications:[{id:Yd},{id:Kd}]}),await fr.schedule({notifications:[{id:Yd,title:" Ya casi es tu hora!",body:"Con ganas de un Yo Nunca? Entra y descubre nuevas frases ",schedule:{on:{weekday:l+1,hour:r,minute:a},allowWhileIdle:!0,repeats:!0},sound:void 0,actionTypeId:"",extra:{type:"smart_pattern"}}]}),console.log("[UsageTracker]  Notificacin inteligente programada correctamente")}catch(r){console.error("[UsageTracker]  Error programando notificacin inteligente:",r)}}async scheduleComebackNotification(){try{console.log("[UsageTracker]  Programando notificacin de recordatorio..."),await fr.cancel({notifications:[{id:Yd},{id:Kd}]});const e=new Date;e.setHours(e.getHours()+24),await fr.schedule({notifications:[{id:Kd,title:" Te echamos de menos!",body:"Volvemos a jugar? Hay nuevos desafos esperndote ",schedule:{at:e,allowWhileIdle:!0},sound:void 0,actionTypeId:"",extra:{type:"comeback"}}]}),console.log("[UsageTracker]  Notificacin de recordatorio programada")}catch(e){console.error("[UsageTracker]  Error programando notificacin de recordatorio:",e)}}async cancelAllNotifications(){try{const e=await fr.getPending();e.notifications.length>0&&(await fr.cancel({notifications:[{id:Yd},{id:Kd}]}),console.log("[UsageTracker]  Notificaciones canceladas:",e.notifications.length))}catch(e){console.error("[UsageTracker]  Error cancelando notificaciones:",e)}}async getPendingNotifications(){try{const e=await fr.getPending();return console.log("[UsageTracker]  Notificaciones pendientes:",e.notifications),e.notifications}catch(e){return console.error("[UsageTracker]  Error obteniendo pendientes:",e),[]}}async clearAllData(){try{this.sessions=[],await cn.remove({key:qd}),await this.cancelAllNotifications(),console.log("[UsageTracker]  Todos los datos limpiados")}catch(e){console.error("[UsageTracker]  Error limpiando datos:",e)}}async simulateData(){console.log("[UsageTracker]  Simulando datos de prueba...");const e=[];for(let t=0;t<5;t++)e.push({timestamp:Date.now()-t*24*60*60*1e3,dayOfWeek:4,hour:22});this.sessions=e,await cn.set({key:qd,value:JSON.stringify(this.sessions)}),console.log("[UsageTracker]  Datos simulados:",e.length,"sesiones"),await this.analyzeAndSchedule()}getDayName(e){return["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"][e]}getUsageStats(){if(this.sessions.length===0)return{totalSessions:0,message:"Sin datos an"};const e={};this.sessions.forEach(a=>{e[a.hour]=(e[a.hour]||0)+1});let t=0,r=0;return Object.entries(e).forEach(([a,l])=>{l>r&&(r=l,t=parseInt(a))}),{totalSessions:this.sessions.length,favoriteHour:`${t}:00`,message:`Has jugado ${this.sessions.length} veces. Tu hora favorita es a las ${t}:00`}}}const Dc=new VM;class jM{constructor(){ke(this,"initialized",!1);ke(this,"currentToken",null);ke(this,"deviceId",null)}async initialize(){if(this.initialized){X.info("[Push] Ya inicializado");return}if(!Ne.isNativePlatform()){X.info("[Push] No disponible en web");return}try{if(X.info("[Push]  Inicializando FCM..."),!await this.requestPermissions()){X.warn("[Push]  Permisos denegados");return}this.registerListeners(),await Qo.register(),this.initialized=!0,X.info("[Push]  FCM inicializado correctamente")}catch(e){X.error("[Push]  Error inicializando:",e)}}async requestPermissions(){try{const e=await Qo.requestPermissions();return e.receive==="granted"?(X.info("[Push]  Permisos concedidos"),!0):(X.warn("[Push]  Permisos no concedidos:",e.receive),!1)}catch(e){return X.error("[Push]  Error solicitando permisos:",e),!1}}registerListeners(){Qo.addListener("registration",async e=>{X.info("[Push]  Token FCM recibido:",e.value),this.currentToken=e.value,await this.saveTokenToFirestore(e.value)}),Qo.addListener("registrationError",e=>{X.error("[Push]  Error en registro:",e)}),Qo.addListener("pushNotificationReceived",e=>{X.info("[Push]  Notificacin recibida (foreground):",e)}),Qo.addListener("pushNotificationActionPerformed",async e=>{X.info("[Push]  Notificacin PUSH tocada:",e);const t=e.notification.data;await this.trackNotificationOpen(t),await Dc.trackSession()})}async saveTokenToFirestore(e){try{const t=jt.currentUser;if(!t){X.warn("[Push]  Usuario no autenticado, no se puede guardar token");return}this.deviceId=await this.getDeviceId();const r=Ne.getPlatform();X.info("[Push]  Guardando token en Firestore..."),X.info("[Push] UserID:",t.uid),X.info("[Push] DeviceID:",this.deviceId),X.info("[Push] Platform:",r);const a=At(it,"consolidated","user_tokens"),l=await En(a),c={fcmToken:e,platform:r,lastActive:kt.now(),notificationsEnabled:!0,appVersion:"1.0.0"};l.exists()?await Ac(a,{[`tokens.${t.uid}.${this.deviceId}`]:c}):await da(a,{tokens:{[t.uid]:{[this.deviceId]:c}}}),X.info("[Push]  Token FCM guardado exitosamente")}catch(t){X.error("[Push]  Error guardando token:",t)}}async trackNotificationOpen(e){try{const t=jt.currentUser;if(!t||!this.deviceId)return;const r=At(it,"consolidated","user_tokens");await Ac(r,{[`tokens.${t.uid}.${this.deviceId}.lastActive`]:kt.now(),[`tokens.${t.uid}.${this.deviceId}.lastNotificationOpened`]:kt.now()}),X.info("[Push]  Apertura de notificacin registrada")}catch(t){X.error("[Push]  Error registrando apertura:",t)}}async getDeviceId(){try{const e=localStorage.getItem("device_id");if(e)return e;const t=Ne.getPlatform(),r=Date.now(),a=Math.random().toString(36).substr(2,9),l=`${t}_${r}_${a}`;return localStorage.setItem("device_id",l),X.info("[Push] Nuevo Device ID generado:",l),l}catch{return`${Ne.getPlatform()}_${Date.now()}`}}async removeToken(){try{const e=jt.currentUser;if(!e||!this.deviceId){X.warn("[Push] No hay token para eliminar");return}X.info("[Push]  Eliminando token FCM...");const t=At(it,"consolidated","user_tokens");await Ac(t,{[`tokens.${e.uid}.${this.deviceId}`]:null}),this.currentToken=null,X.info("[Push]  Token FCM eliminado")}catch(e){X.error("[Push]  Error eliminando token:",e)}}async setNotificationsEnabled(e){try{const t=jt.currentUser;if(!t||!this.deviceId)return;const r=At(it,"consolidated","user_tokens");await Ac(r,{[`tokens.${t.uid}.${this.deviceId}.notificationsEnabled`]:e}),X.info("[Push]  Notificaciones PUSH",e?"habilitadas":"deshabilitadas")}catch(t){X.error("[Push]  Error actualizando estado:",t)}}async updateLastActive(){try{const e=jt.currentUser;if(!e||!this.deviceId)return;const t=At(it,"consolidated","user_tokens");await Ac(t,{[`tokens.${e.uid}.${this.deviceId}.lastActive`]:kt.now()}),X.info("[Push]  ltima actividad actualizada")}catch(e){X.error("[Push]  Error actualizando actividad:",e)}}getCurrentToken(){return this.currentToken}isInitialized(){return this.initialized}getDeviceIdSync(){return this.deviceId}}const bw=new jM,Dp={BASE_URL:"/apps/yo-nunca/play/",DEV:!1,MODE:"web",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"pro"},kp="1.1.021";WI();const zM=()=>{const[n,e]=ee.useState(gt.Home),[t,r]=ee.useState(!1),[a,l]=ee.useState(!0),[c,d]=ee.useState(!1),[h,m]=ee.useState([]),[g,_]=ee.useState([]),[v,T]=ee.useState(!1),[I,A]=ee.useState(!1),[C,L]=ee.useState(!1),[x,U]=ee.useState(null),[z,$]=ee.useState(void 0),[se,D]=ee.useState("Bienvenido a Yo Nunca! Descubre frases divertidas y atrvete a jugar con tus amigos."),[P,N]=ee.useState(!1),[M,B]=ee.useState({title:"",message:"",buttonText:"Entendido"}),[G,k]=ee.useState(null),Ve=ee.useRef(!1),et=ee.useRef(!1),te=ee.useRef(gt.Home);ee.useEffect(()=>{Ve.current=P},[P]),ee.useEffect(()=>{et.current=t},[t]),ee.useEffect(()=>{te.current=n},[n]);const[he,Ie]=ee.useState(!1),[je,Ke]=ee.useState([]),[j,K]=ee.useState("Desconocido"),ue=(()=>{try{const Re=Dp==null?void 0:Dp.VITE_DEBUG_OVERLAY;if(Re==null)return!1;const oe=String(Re).toLowerCase().trim();return oe==="true"||oe==="1"||oe==="yes"}catch{return!1}})();ee.useEffect(()=>{const Re=oe=>{Ke(De=>[oe,...De].slice(0,50))};return cE.addListener(Re),()=>cE.removeListener(Re)},[]);const pe=Re=>X.info(Re),Pe=async()=>{pe("Iniciando diagnstico...");try{let Re=jt==null?void 0:jt.currentUser;if(Re)pe(`Auth User: ${Re.uid}`);else{pe(" Usuario no logueado. Intentando login forzado...");try{const{signInAnonymously:oe}=await Wt(async()=>{const{signInAnonymously:Ee}=await Promise.resolve().then(()=>jS);return{signInAnonymously:Ee}},void 0);Re=(await oe(jt)).user,pe(` Login forzado OK: ${Re.uid}`)}catch(oe){pe(` Login forzado FALL: ${oe.message}`)}}if(pe("Probando Firestore..."),typeof cg=="function"){const oe=await cg();oe.success?(pe(` Firestore OK: ${oe.message}`),K("Conectado")):(pe(` Firestore ERROR: ${oe.message} (${oe.code})`),K("Error: "+oe.code))}else pe(" testFirestoreConnection no es una funcin")}catch(Re){pe(` Excepcin Global: ${Re.message}`),K("Excepcin")}};ee.useEffect(()=>{Ne.getPlatform()==="ios"&&setTimeout(Pe,5e3)},[]),ee.useEffect(()=>{(async()=>{try{const{signInAnonymously:oe,onAuthStateChanged:De}=await Wt(async()=>{const{signInAnonymously:be,onAuthStateChanged:Ue}=await Promise.resolve().then(()=>jS);return{signInAnonymously:be,onAuthStateChanged:Ue}},void 0),{auth:Ee}=await Wt(async()=>{const{auth:be}=await Promise.resolve().then(()=>a2);return{auth:be}},void 0),{Capacitor:Te}=await Wt(async()=>{const{Capacitor:be}=await Promise.resolve().then(()=>s2);return{Capacitor:be}},void 0);X.info("[Auth]  Iniciando autenticacin..."),De(Ee,be=>{be?(X.info(`[Auth]  Estado cambi: LOGUEADO (${be.uid})`),pe(` Auth State: LOGUEADO (${be.uid})`)):(X.info("[Auth]  Estado cambi: NO LOGUEADO"),pe(" Auth State: NO LOGUEADO"))});try{if(Ee.currentUser)X.info("[Auth]  Ya autenticado en JS:",Ee.currentUser.uid);else{X.info("[Auth]  No hay usuario, intentando signInAnonymously...");const be=await oe(Ee);X.info("[Auth]  Autenticacin JS exitosa:",be.user.uid),localStorage.setItem("firebase_uid",be.user.uid)}}catch(be){X.error("[Auth]  Error en autenticacin JS:",be.message),pe(` Auth Error: ${be.message}`)}await ze()}catch(oe){X.error("[Auth]  Error general en inicializacin:",oe.message),pe(` Init Error: ${oe.message}`)}})()},[]);const ze=async()=>{try{if(X.info("[Notifications]  Inicializando servicios de notificaciones..."),!Ne.isNativePlatform()){X.info("[Notifications]  No disponible en web, saltando inicializacin");return}try{await bw.initialize(),X.info("[Notifications]  Push notifications (FCM) inicializadas")}catch(Re){X.error("[Notifications]  Error inicializando push notifications:",Re)}try{await Dc.initialize(),X.info("[Notifications]  Usage Tracker inicializado"),await Dc.trackSession(),X.info("[Notifications]  Primera sesin trackeada")}catch(Re){X.error("[Notifications]  Error inicializando Usage Tracker:",Re)}X.info("[Notifications]  Servicios de notificaciones listos")}catch(Re){X.error("[Notifications]  Error general inicializando notificaciones:",Re)}};ee.useEffect(()=>{if(!Ne.isNativePlatform())return;const Re=async De=>{if(De.isActive){X.info("[App]  App pas a foreground");try{await bw.updateLastActive(),await Dc.trackSession(),X.info("[App]  Actividad registrada")}catch(Ee){X.warn("[App]  Error registrando actividad:",Ee)}}},oe=tl.addListener("appStateChange",Re);return()=>{oe.then(De=>De.remove()).catch(()=>{})}},[]),ee.useEffect(()=>{(async()=>{await Eg.initialize("pro"),X.info(`[App]  Ambiente inicializado: ${"pro".toUpperCase()}`),xi&&(Uk(xi),Vk(),X.info("[App]  Analytics inicializado"));const De=uM();X.info("[App]  Informacin del dispositivo:",De),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (no-auth) owned=[]"),await Ha(!1,[]),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (no-auth)"),await OA.loadCounters();try{X.info("[App] Inicializando AdService..."),await wr.initialize()?X.info("[App]  AdService inicializado correctamente"):X.warn("[App]  AdService no pudo inicializarse")}catch(Ee){X.error("[App]  Error inicializando AdService:",Ee)}})()},[]),ee.useEffect(()=>{(async()=>{try{X.info("[PHRASE_FLOW][APP]  ownedPackIds change",h),Array.isArray(h)&&h.length>0?(h.length>0?(X.info("[PHRASE_FLOW][APP]  FULL reload (primera deteccin packs) owned=",h),await Ha(!0,h)):(X.info("[PHRASE_FLOW][APP]  updatePhraseCache (owned change) owned=",h),await Ha(!1,h)),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (owned change)")):X.info("[PHRASE_FLOW][APP]  ownedPackIds vaco; no actualizamos cache")}catch(Re){X.warn("[App]  Error sincronizando cach tras cambio de ownedPackIds:",Re)}})()},[h]),ee.useEffect(()=>{(async()=>{try{X.info("[App]  Inicializando configuracin de productos..."),PM({onRemoveAdsPurchased:()=>{X.info("[App]  Remove Ads comprado"),l(!1)}});const{getStoreProducts:oe}=await Wt(async()=>{const{getStoreProducts:He}=await Promise.resolve().then(()=>Ki);return{getStoreProducts:He}},void 0),De=await oe();X.info("[App]  Productos cargados desde Firestore:",De.length),_(De),CM(De,{onPackPurchased:async He=>{X.info("[PHRASE_FLOW][APP]  onPackPurchased pack=",He),m(It=>{const Ze=Array.from(new Set([...It,He]));return X.info("[PHRASE_FLOW][APP]  Packs actualizados post-compra:",Ze),Ze}),X.info("[PHRASE_FLOW][APP]  Forzando actualizacin de cach post-compra"),await Ha(!1,[...h,He]),X.info("[PHRASE_FLOW][APP]  Cach actualizado post-compra")}});const Ee=tu.getAll(),Te=Ne.getPlatform(),be=De.find(He=>{if((He==null?void 0:He.type)!=="remove_ads")return!1;const It=((He==null?void 0:He.platform)||"").toLowerCase().trim();return!It||It==="both"||It===Te});X.info("[PHRASE_FLOW][APP]  restorePurchases inicio");const Ue=await eu({removeAdsId:be==null?void 0:be.productId,storeProducts:De,productConfigs:Ee});if(Ue){X.info("[PHRASE_FLOW][APP]  restorePurchases fin",Ue);const{syncUserPacks:He,acquireFreePack:It}=await Wt(async()=>{const{syncUserPacks:re,acquireFreePack:ye}=await import("./userPacksService-Dl74yIvt.js");return{syncUserPacks:re,acquireFreePack:ye}},[]);let Ze=[];try{Ze=await He()}catch(re){X.warn("[PHRASE_FLOW][APP]  syncUserPacks fall:",re)}const Se=Array.isArray(Ue.ownedPackIds)?Ue.ownedPackIds:[],_e=Array.from(new Set([...Se||[],...Ze||[]])),me=De.filter(re=>re.grantsPremium).map(re=>re.productId),ge=new Set;if(De.forEach(re=>{(re==null?void 0:re.type)==="remove_ads"&&(re!=null&&re.productId)&&ge.add(re.productId),re!=null&&re.grantsRemoveAds&&(re!=null&&re.productId)&&ge.add(re.productId)}),Ue.hasRemoveAds&&l(!1),Array.from(ge).some(re=>_e.includes(re))&&l(!1),me.some(re=>_e.includes(re))&&d(!0),_e.length>0){X.info("[PHRASE_FLOW][APP]  setOwnedPackIds (merged restore)",_e),m(_e);try{X.info("[PHRASE_FLOW][APP]  updatePhraseCache (post-restore) owned=",_e),await Ha(!1,_e),X.info("[PHRASE_FLOW][APP]  updatePhraseCache (post-restore)")}catch(re){X.warn("[PHRASE_FLOW][APP]  updatePhraseCache fallo (post-restore)",re)}}else X.warn("[PHRASE_FLOW][APP]  restore sin packs (IAP+UserPacks)");if(Se.length>0)try{await Promise.allSettled(Se.map(re=>It(re)))}catch(re){X.warn("[PHRASE_FLOW][APP]  persistencia de packs restaurados fall:",re)}}else X.warn("[PHRASE_FLOW][APP]  restorePurchases null/undefined")}catch(oe){X.warn("No se pudieron restaurar compras al iniciar:",oe)}})()},[]),ee.useEffect(()=>{(async()=>{try{const[oe,De,Ee,Te,be]=await Promise.all([(await Wt(async()=>{const{getFeatureFlags:Ze}=await Promise.resolve().then(()=>Ki);return{getFeatureFlags:Ze}},void 0)).getFeatureFlags(),(await Wt(async()=>{const{getAppSettings:Ze}=await Promise.resolve().then(()=>Ki);return{getAppSettings:Ze}},void 0)).getAppSettings(),(await Wt(async()=>{const{getPlayStoreUrl:Ze}=await Promise.resolve().then(()=>Ki);return{getPlayStoreUrl:Ze}},void 0)).getPlayStoreUrl(),(await Wt(async()=>{const{getWelcomeMessage:Ze}=await Promise.resolve().then(()=>Ki);return{getWelcomeMessage:Ze}},void 0)).getWelcomeMessage(),(await Wt(async()=>{const{getPopupConfig:Ze}=await Promise.resolve().then(()=>Ki);return{getPopupConfig:Ze}},void 0)).getPopupConfig()]);U(oe),$(Ee||"https://play.google.com/store"),D(Te),be.enabled&&be.title&&be.message&&(B({title:be.title,message:be.message,buttonText:be.buttonText,showPlayStoreButton:be.showPlayStoreButton,playStoreButtonText:be.playStoreButtonText,playStoreUrl:be.playStoreUrl}),sessionStorage.getItem("popup_shown")||(N(!0),sessionStorage.setItem("popup_shown","true")));const Ue=(Ne==null?void 0:Ne.getPlatform)&&Ne.getPlatform()||"web",He=Ue==="android",It=Ue==="ios";if(He&&De.required_update_version){const Ze=De.required_update_version;vt(kp,Ze)&&L(!0)}if(It&&De.required_update_version){const Ze=De.required_update_version;vt(kp,Ze)&&L(!0)}}catch(oe){X.error("Error cargando configuracin remota:",oe)}})()},[]);const tt=Re=>{try{const oe=new URL(Re);if((oe.protocol||"").replace(":","")!=="yonunca")return null;const Ee=oe.searchParams.get("code")||oe.searchParams.get("promo")||void 0,Te=oe.searchParams.get("redeem")!=="0";let be=oe.searchParams.get("pack")||oe.searchParams.get("packId")||oe.searchParams.get("product")||void 0;const Ue=(oe.host||"").trim(),He=new Set(["promo","store","event","pack","redeem"]);if(!be){const It=(oe.pathname||"").split("/").filter(Boolean);It.length>0&&(be=It[It.length-1])}return!be&&Ue&&!He.has(Ue)&&(be=Ue),!be&&(Ue==="promo"||Ue==="event")&&(be="starter_pack"),be?{packId:be,promoCode:Ee,openRedeem:Te}:null}catch{return null}},Mt=ee.useCallback(Re=>{if(C)return;const oe=tt(Re);oe&&(k({nonce:String(Date.now()),packId:oe.packId,promoCode:oe.promoCode,openRedeem:oe.openRedeem}),e(gt.Store),aw("Store"))},[C]);ee.useEffect(()=>{if(!Ne.isNativePlatform())return;const Re=tl.addListener("appUrlOpen",oe=>{oe!=null&&oe.url&&Mt(oe.url)});return tl.getLaunchUrl().then(oe=>{const De=oe==null?void 0:oe.url;De&&Mt(De)}).catch(()=>{}),()=>{Re.then(oe=>oe.remove()).catch(()=>{})}},[Mt]),ee.useEffect(()=>{n===gt.Home&&wr.hideBanner().catch(()=>{})},[n]);const vt=(Re,oe)=>{const De=be=>be.trim().split(".").map(Ue=>parseInt(Ue.replace(/\D/g,""),10)||0),Ee=De(Re),Te=De(oe);for(let be=0;be<Math.max(Ee.length,Te.length);be++){const Ue=Ee[be]??0,He=Te[be]??0;if(Ue<He)return!0;if(Ue>He)return!1}return!1},Je=ee.useCallback(Re=>{if(C)return;e(Re);const oe={[gt.Home]:"Home",[gt.Game]:"Game",[gt.Store]:"Store"};aw(oe[Re]||"Unknown"),Re===gt.Game&&Ne.isNativePlatform()&&Dc.trackSession().catch(De=>{X.warn("[App]  Error trackeando sesin al entrar a Game:",De)})},[C]),Rt=async()=>{l(!1);try{await wr.removeBanner(),console.log("Banner eliminado exitosamente")}catch(Re){console.warn("No se pudo eliminar el banner:",Re)}alert("Gracias! Los anuncios han sido eliminados."),e(gt.Home)},ot=()=>{try{sessionStorage.removeItem("return_to_endgame"),sessionStorage.removeItem("return_to_completion")}catch{}d(!0),alert("Gracias! Has comprado el paquete de frases premium."),e(gt.Home)},Ft=async Re=>{X.info("[PHRASE_FLOW][APP] "),X.info("[PHRASE_FLOW][APP]  handlePurchasePack INICIO"),X.info("[PHRASE_FLOW][APP]  packId recibido:",Re),X.info("[PHRASE_FLOW][APP]  ownedPackIds ANTES:",h),X.info("[PHRASE_FLOW][APP] ");try{X.info("[PHRASE_FLOW][APP]  PASO 1: Actualizando ownedPackIds local (aadiendo pack)");const oe=[...h,Re];X.info("[PHRASE_FLOW][APP]  updatedPacks calculado:",oe),m(oe),X.info("[PHRASE_FLOW][APP]  setOwnedPackIds ejecutado con:",oe),X.info("[PHRASE_FLOW][APP]  PASO 3: Actualizando cach con nuevos packs..."),await Ha(!0,oe),X.info("[PHRASE_FLOW][APP]  Cach actualizado con nuevos packs"),X.info("[PHRASE_FLOW][APP] "),X.info("[PHRASE_FLOW][APP]  handlePurchasePack COMPLETADO EXITOSAMENTE "),X.info("[PHRASE_FLOW][APP]  ownedPackIds final:",oe),X.info("[PHRASE_FLOW][APP] ")}catch(oe){X.error("[PHRASE_FLOW][APP] "),X.error("[PHRASE_FLOW][APP]  ERROR en handlePurchasePack "),X.error("[PHRASE_FLOW][APP] Error:",oe),X.error("[PHRASE_FLOW][APP] Stack:",oe==null?void 0:oe.stack),X.error("[PHRASE_FLOW][APP] "),X.info("[PHRASE_FLOW][APP]  FALLBACK: actualizando estado local solo"),m(De=>{if(X.info("[PHRASE_FLOW][APP]  prev:",De),X.info("[PHRASE_FLOW][APP]  packId a agregar:",Re),!De.includes(Re)){const Ee=[...De,Re];return X.info("[PHRASE_FLOW][APP]  updated (fallback):",Ee),Ha(!0,Ee).catch(Te=>X.error("[PHRASE_FLOW][APP]  Error actualizando cach en fallback:",Te)),Ee}return X.info("[PHRASE_FLOW][APP]  Pack ya estaba en lista, sin cambios"),De})}};ee.useEffect(()=>{try{if(((Ne==null?void 0:Ne.getPlatform)&&Ne.getPlatform()||"web")!=="android")return;const oe=async()=>{if(Ve.current){N(!1);return}if(et.current){r(!1);return}const De=te.current;try{if(De===gt.Store&&(sessionStorage.getItem("return_to_endgame")==="1"||sessionStorage.getItem("return_to_completion")==="1")){e(gt.Game);return}}catch{}if(De!==gt.Home){e(gt.Home);return}try{await tl.minimizeApp()}catch{}};return tl.addListener("backButton",oe),()=>{}}catch(Re){X.warn("[App] No se pudo registrar handler de botn atrs:",Re)}},[]);const Xt=()=>{if(C)return S.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[S.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Actualizacin requerida"}),S.jsxs("p",{className:"text-slate-300 mb-2",children:["Tu versin (",kp,") es inferior a la mnima requerida."]}),S.jsx("p",{className:"text-slate-400 mb-6",children:"Actualiza desde Google Play para continuar."}),S.jsx("a",{href:z,className:"bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded",children:"Abrir Google Play"})]});switch(n){case gt.Game:return S.jsx("div",{style:{position:"relative",width:"100%",height:"100%"},children:S.jsx(wM,{navigate:Je,hasPremium:c,hasRemoveAds:!a,includeAdult:v,adultOnly:I,ownedPackIds:h,storeProducts:g})});case gt.Store:return S.jsx(xM,{navigate:Je,onPurchaseRemoveAds:Rt,onPurchasePremium:ot,onPurchasePack:Ft,showAds:a,hasPremium:c,enableRemoveAdsPurchase:(x==null?void 0:x.enable_remove_ads_purchase)!==!1,enablePremiumPurchase:(x==null?void 0:x.enable_premium_purchase)!==!1,ownedPackIds:h,deepLinkAction:G||void 0});case gt.Home:default:return S.jsx(hM,{navigate:Je,onSuggestClick:()=>r(!0),onStartGame:(Re,oe)=>{T(Re),A(oe)},disablePlay:(x==null?void 0:x.enable_play)===!1,disableStore:(x==null?void 0:x.enable_store)===!1,disableShare:(x==null?void 0:x.enable_share_button)===!1,disableAdultMode:(x==null?void 0:x.enable_adult_mode)===!1,welcomeMessage:se,hasPremium:c,hasRemoveAds:!a,ownedPackIds:h,playStoreUrl:z,appStoreUrl:"https://tiendaapple.com"})}};return S.jsxs("div",{className:"w-full min-h-screen relative",children:[Xt(),ue&&S.jsx("div",{style:{position:"fixed",top:"40px",left:"10px",zIndex:9999,opacity:.8},children:S.jsxs("button",{onClick:()=>{Ie(!he),Pe()},style:{fontSize:"10px",padding:"5px",background:"red",color:"white",border:"none",borderRadius:"4px"},children:["DEBUG ",j]})}),ue&&he&&S.jsxs("div",{style:{position:"fixed",top:"80px",left:"10px",right:"10px",bottom:"10px",background:"rgba(0,0,0,0.9)",color:"#0f0",padding:"10px",zIndex:9999,overflowY:"auto",fontFamily:"monospace",fontSize:"12px",border:"1px solid #0f0"},children:[S.jsx("h3",{children:"Diagnstico Firebase"}),S.jsx("button",{onClick:()=>Ie(!1),style:{float:"right",color:"white"},children:"Cerrar"}),S.jsx("button",{onClick:Pe,style:{marginRight:"10px",color:"black",background:"#0f0"},children:"Re-Test"}),S.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},style:{marginRight:"10px",color:"white",background:"red"},children:"Reset App"}),S.jsx("hr",{}),S.jsx("div",{children:"Estado Auth:  No logueado"}),S.jsxs("div",{children:["Plataforma: ",Ne.getPlatform()]}),S.jsx("hr",{}),je.map((Re,oe)=>S.jsx("div",{children:Re},oe))]}),t&&S.jsx(DM,{onClose:()=>r(!1)}),P&&S.jsx(kM,{title:M.title,message:M.message,buttonText:M.buttonText,showPlayStoreButton:M.showPlayStoreButton,playStoreButtonText:M.playStoreButtonText,playStoreUrl:M.playStoreUrl,onClose:()=>N(!1)}),a&&n!==gt.Home&&S.jsx(MM,{})]})},BM=async()=>{if(Ne.isNativePlatform())try{if(await Di.initialize({initializeForTesting:!0}),console.log("AdMob iniciado correctamente"),Ne.getPlatform()==="ios"){await Di.requestTrackingAuthorization();const n=await Di.trackingAuthorizationStatus();console.log("Tracking authorization status:",n)}}catch(n){console.error("Error inicializando AdMob:",n)}};BM().then(()=>{GI.createRoot(document.getElementById("root")).render(S.jsx(wg.StrictMode,{children:S.jsx(zM,{})}))}).catch(n=>console.error("Error al iniciar la app:",n));export{QS as A,Ne as C,Ht as F,kt as T,Sy as W,jt as a,it as b,Oy as c,At as d,g2 as e,y2 as f,En as g,da as h,X as l,er as r,Jc as s,Ac as u};
